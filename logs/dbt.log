

============================== 2022-04-24 19:35:21.321929 | 7899179d-1776-4c66-88ca-71467985ee8d ==============================
19:35:21.321929 [info ] [MainThread]: Running with dbt=1.0.4
19:35:21.322914 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
19:35:21.324912 [debug] [MainThread]: Tracking: tracking
19:35:21.342915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233C40>]}
19:35:21.362912 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
19:35:21.362912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7899179d-1776-4c66-88ca-71467985ee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5312430A0>]}
19:35:21.665913 [debug] [MainThread]: Parsing macros\adapters.sql
19:35:21.692913 [debug] [MainThread]: Parsing macros\catalog.sql
19:35:21.698914 [debug] [MainThread]: Parsing macros\etc.sql
19:35:21.700915 [debug] [MainThread]: Parsing macros\materializations\copy.sql
19:35:21.703914 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
19:35:21.720915 [debug] [MainThread]: Parsing macros\materializations\seed.sql
19:35:21.723914 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
19:35:21.725914 [debug] [MainThread]: Parsing macros\materializations\table.sql
19:35:21.729913 [debug] [MainThread]: Parsing macros\materializations\view.sql
19:35:21.733914 [debug] [MainThread]: Parsing macros\adapters\columns.sql
19:35:21.743915 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
19:35:21.747913 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
19:35:21.753912 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
19:35:21.769912 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
19:35:21.775915 [debug] [MainThread]: Parsing macros\adapters\relation.sql
19:35:21.785915 [debug] [MainThread]: Parsing macros\adapters\schema.sql
19:35:21.788915 [debug] [MainThread]: Parsing macros\etc\datetime.sql
19:35:21.797914 [debug] [MainThread]: Parsing macros\etc\statement.sql
19:35:21.802913 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
19:35:21.804915 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
19:35:21.805916 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
19:35:21.806915 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
19:35:21.807915 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
19:35:21.809914 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
19:35:21.811914 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
19:35:21.814915 [debug] [MainThread]: Parsing macros\materializations\configs.sql
19:35:21.817915 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
19:35:21.822914 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
19:35:21.827915 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
19:35:21.838914 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
19:35:21.839915 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
19:35:21.852226 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
19:35:21.868215 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
19:35:21.872219 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
19:35:21.880215 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
19:35:21.883216 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
19:35:21.886216 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
19:35:21.888215 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
19:35:21.896217 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
19:35:21.913213 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
19:35:21.920213 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
19:35:21.939215 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
19:35:21.957215 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
19:35:21.959218 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
19:35:21.979243 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
19:35:21.982245 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
19:35:21.988215 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
19:35:21.991218 [debug] [MainThread]: Parsing tests\generic\builtin.sql
19:35:22.245249 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_CreditCard.sql
19:35:22.264232 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
19:35:22.268216 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
19:35:22.273213 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
19:35:22.277213 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
19:35:22.281215 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
19:35:22.285214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
19:35:22.290215 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
19:35:22.294214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
19:35:22.297214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
19:35:22.300212 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
19:35:22.303211 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
19:35:22.383214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BC970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BCEE0>]}


============================== 2022-04-24 20:26:21.186495 | 0c4f3b28-9007-403d-8310-8dd09fff71b5 ==============================
20:26:21.186495 [info ] [MainThread]: Running with dbt=1.0.4
20:26:21.187495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
20:26:21.188497 [debug] [MainThread]: Tracking: tracking
20:26:21.223495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001249232D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492331DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124923312E0>]}
20:26:22.290769 [debug] [MainThread]: Executing "git --help"
20:26:22.396768 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
20:26:22.397768 [debug] [MainThread]: STDERR: "b''"
20:26:22.402769 [debug] [MainThread]: Acquiring new bigquery connection "debug"
20:26:22.403769 [debug] [MainThread]: Opening a new connection, currently in state init
20:26:22.418767 [debug] [MainThread]: On debug: select 1 as id
20:26:23.892504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001249016E2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124A3052B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124A3052340>]}
20:26:24.621151 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-04-25 13:36:42.181084 | c7e512cf-ba70-44bf-bf92-57d8b87dc842 ==============================
13:36:42.181084 [info ] [MainThread]: Running with dbt=1.0.4
13:36:42.183057 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:36:42.183057 [debug] [MainThread]: Tracking: tracking
13:36:42.198056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D23E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D233D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D23C40>]}
13:36:42.217060 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:36:42.218091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7e512cf-ba70-44bf-bf92-57d8b87dc842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D732E0>]}
13:36:42.516084 [debug] [MainThread]: Parsing macros\adapters.sql
13:36:42.541075 [debug] [MainThread]: Parsing macros\catalog.sql
13:36:42.547090 [debug] [MainThread]: Parsing macros\etc.sql
13:36:42.549090 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:36:42.552090 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:36:42.567084 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:36:42.570084 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:36:42.572087 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:36:42.576090 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:36:42.579057 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:36:42.589090 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:36:42.593090 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:36:42.596092 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:36:42.603092 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:36:42.608083 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:36:42.618095 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:36:42.621090 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:36:42.629090 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:36:42.634090 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:36:42.636090 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:36:42.637056 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:36:42.638056 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:36:42.639055 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:36:42.641054 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:36:42.644055 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:36:42.646090 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:36:42.649092 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:36:42.654089 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:36:42.659055 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:36:42.670090 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:36:42.671090 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:36:42.683092 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:36:42.698084 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:36:42.701084 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:36:42.709090 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:36:42.712090 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:36:42.714090 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:36:42.716091 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:36:42.723090 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:36:42.739084 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:36:42.746084 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:36:42.757084 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:36:42.770055 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:36:42.772061 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:36:42.789090 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:36:42.792086 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:36:42.796090 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:36:42.799090 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:36:43.005070 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_CreditCard.sql
13:36:43.018081 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:36:43.021090 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:36:43.024054 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:36:43.028084 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:36:43.031084 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:36:43.034090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:36:43.037055 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:36:43.041066 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
13:36:43.044090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
13:36:43.047092 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:36:43.049092 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:36:43.052090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:36:43.114088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF9A0>]}


============================== 2022-04-25 13:37:44.521613 | 0077e611-be19-45e9-b9fe-9babadd40927 ==============================
13:37:44.521613 [info ] [MainThread]: Running with dbt=1.0.4
13:37:44.522614 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:37:44.523615 [debug] [MainThread]: Tracking: tracking
13:37:44.537619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF469E1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03AC0>]}
13:37:44.537619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A038B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03130>]}


============================== 2022-04-25 13:38:10.280942 | db920e06-469e-42b9-ba24-1267682ea14a ==============================
13:38:10.280942 [info ] [MainThread]: Running with dbt=1.0.4
13:38:10.281941 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
13:38:10.282944 [debug] [MainThread]: Tracking: tracking
13:38:10.311952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774895B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489EB0>]}
13:38:10.314952 [debug] [MainThread]: Set downloads directory='C:\Users\jpedr\AppData\Local\Temp\dbt-downloads-3_jtrqln'
13:38:10.315940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
13:38:11.554041 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
13:38:11.555070 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
13:38:11.668077 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
13:38:11.692076 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
13:38:11.838630 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
13:38:11.839621 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
13:38:12.220763 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
13:38:12.243798 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
13:38:12.402793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
13:38:12.403791 [info ] [MainThread]: Installing dbt-labs/dbt_utils
13:38:13.355635 [info ] [MainThread]:   Installed from version 0.8.4
13:38:13.356637 [info ] [MainThread]:   Up to date!
13:38:13.357634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db920e06-469e-42b9-ba24-1267682ea14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774DE9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774DE3A0>]}
13:38:13.359634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677506220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146775062B0>]}


============================== 2022-04-25 13:39:06.555110 | b64a9cb8-2a45-41a2-89a7-d3ec49bb4c68 ==============================
13:39:06.555110 [info ] [MainThread]: Running with dbt=1.0.4
13:39:06.556137 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:39:06.556137 [debug] [MainThread]: Tracking: tracking
13:39:06.570086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E698E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E6C4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E6C45E0>]}
13:39:06.592092 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:39:06.594099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b64a9cb8-2a45-41a2-89a7-d3ec49bb4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E719280>]}
13:39:07.014556 [debug] [MainThread]: Parsing macros\adapters.sql
13:39:07.041553 [debug] [MainThread]: Parsing macros\catalog.sql
13:39:07.047557 [debug] [MainThread]: Parsing macros\etc.sql
13:39:07.049553 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:39:07.052553 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:39:07.067553 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:39:07.070553 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:39:07.072553 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:39:07.077553 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:39:07.080553 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:39:07.089552 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:39:07.093581 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:39:07.096553 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:39:07.103553 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:39:07.108553 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:39:07.117553 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:39:07.120553 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:39:07.128553 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:39:07.133553 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:39:07.135581 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:39:07.136560 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:39:07.137553 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:39:07.138554 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:39:07.140553 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:39:07.142553 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:39:07.145553 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:39:07.147553 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:39:07.152562 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:39:07.157553 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:39:07.167552 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:39:07.170553 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:39:07.181551 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:39:07.196552 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:39:07.200552 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:39:07.207553 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:39:07.210552 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:39:07.213552 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:39:07.214553 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:39:07.222584 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:39:07.238583 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:39:07.245553 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:39:07.256553 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:39:07.268564 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:39:07.270555 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:39:07.287553 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:39:07.289553 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:39:07.294553 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:39:07.297555 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:39:07.301555 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
13:39:07.302555 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
13:39:07.304555 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
13:39:07.306555 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
13:39:07.308555 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
13:39:07.312554 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
13:39:07.319553 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
13:39:07.322553 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
13:39:07.333554 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
13:39:07.334555 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
13:39:07.336553 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
13:39:07.338554 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
13:39:07.340553 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
13:39:07.342553 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
13:39:07.344553 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
13:39:07.348552 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
13:39:07.350553 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
13:39:07.359553 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
13:39:07.360553 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
13:39:07.362553 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
13:39:07.364553 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
13:39:07.366553 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
13:39:07.369553 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
13:39:07.371552 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
13:39:07.377553 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
13:39:07.379553 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
13:39:07.380554 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
13:39:07.383553 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
13:39:07.385553 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
13:39:07.387553 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
13:39:07.402552 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
13:39:07.405552 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
13:39:07.407553 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
13:39:07.409553 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
13:39:07.420552 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
13:39:07.422552 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
13:39:07.424553 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
13:39:07.426552 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
13:39:07.428552 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
13:39:07.431552 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
13:39:07.434551 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
13:39:07.436553 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
13:39:07.437554 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
13:39:07.442554 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
13:39:07.443555 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
13:39:07.445554 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
13:39:07.446554 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
13:39:07.448553 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
13:39:07.472553 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
13:39:07.476552 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
13:39:07.480552 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
13:39:07.484551 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
13:39:07.490553 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
13:39:07.493551 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
13:39:07.496551 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
13:39:07.499553 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
13:39:07.503553 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
13:39:07.510553 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
13:39:07.512553 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
13:39:07.514553 [debug] [MainThread]: Parsing macros\sql\groupby.sql
13:39:07.516552 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
13:39:07.522552 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
13:39:07.524553 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
13:39:07.526553 [debug] [MainThread]: Parsing macros\sql\pivot.sql
13:39:07.530553 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
13:39:07.532553 [debug] [MainThread]: Parsing macros\sql\star.sql
13:39:07.536553 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
13:39:07.540553 [debug] [MainThread]: Parsing macros\sql\union.sql
13:39:07.550554 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
13:39:07.559553 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
13:39:07.562553 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
13:39:07.564553 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
13:39:07.943583 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:39:07.972553 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:39:07.974553 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:39:07.978557 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:39:07.981558 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:39:07.984584 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:39:07.987593 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:39:07.990594 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:39:07.993590 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:39:07.995590 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
13:39:07.998563 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
13:39:08.001553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:39:08.004553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:39:08.007553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:39:08.076553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0DF0>]}


============================== 2022-04-25 13:43:05.011676 | 8f7603df-9049-48dc-be9c-86c67fa05acc ==============================
13:43:05.011676 [info ] [MainThread]: Running with dbt=1.0.4
13:43:05.011676 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:05.012676 [debug] [MainThread]: Tracking: tracking
13:43:05.026677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8984EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8995AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A89957F0>]}
13:43:05.047674 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:43:05.047674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A89D6280>]}
13:43:05.159674 [debug] [MainThread]: Parsing macros\adapters.sql
13:43:05.183674 [debug] [MainThread]: Parsing macros\catalog.sql
13:43:05.188675 [debug] [MainThread]: Parsing macros\etc.sql
13:43:05.190675 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:43:05.193675 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:43:05.208675 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:43:05.211675 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:43:05.213675 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:43:05.217675 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:43:05.220675 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:43:05.231675 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:43:05.234675 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:43:05.238675 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:43:05.245675 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:43:05.251675 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:43:05.263677 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:43:05.268677 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:43:05.277675 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:43:05.282675 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:43:05.283676 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:43:05.284675 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:43:05.285675 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:43:05.287675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:43:05.288675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:43:05.290675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:43:05.293674 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:43:05.296674 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:43:05.300675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:43:05.305676 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:43:05.316674 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:43:05.318675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:43:05.329675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:43:05.345675 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:43:05.348674 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:43:05.355674 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:43:05.358675 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:43:05.361675 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:43:05.362675 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:43:05.370675 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:43:05.386674 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:43:05.392674 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:43:05.403768 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:43:05.414675 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:43:05.416675 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:43:05.433674 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:43:05.435675 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:43:05.440674 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:43:05.442675 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:43:05.445675 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
13:43:05.447675 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
13:43:05.449686 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
13:43:05.451676 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
13:43:05.453676 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
13:43:05.457675 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
13:43:05.463677 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
13:43:05.466675 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
13:43:05.475674 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
13:43:05.477676 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
13:43:05.479675 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
13:43:05.481676 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
13:43:05.483675 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
13:43:05.485674 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
13:43:05.487675 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
13:43:05.491675 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
13:43:05.492676 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
13:43:05.501674 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
13:43:05.503676 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
13:43:05.504676 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
13:43:05.506676 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
13:43:05.509675 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
13:43:05.511674 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
13:43:05.513674 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
13:43:05.519674 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
13:43:05.521674 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
13:43:05.522675 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
13:43:05.525674 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
13:43:05.526675 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
13:43:05.529674 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
13:43:05.533675 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
13:43:05.535675 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
13:43:05.537675 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
13:43:05.539675 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
13:43:05.548674 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
13:43:05.551674 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
13:43:05.553674 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
13:43:05.555674 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
13:43:05.557675 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
13:43:05.560674 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
13:43:05.563676 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
13:43:05.566676 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
13:43:05.567677 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
13:43:05.572676 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
13:43:05.573676 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
13:43:05.575676 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
13:43:05.577675 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
13:43:05.579675 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
13:43:05.606677 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
13:43:05.611678 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
13:43:05.614678 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
13:43:05.619678 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
13:43:05.624678 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
13:43:05.627679 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
13:43:05.630675 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
13:43:05.634675 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
13:43:05.637675 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
13:43:05.645675 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
13:43:05.647675 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
13:43:05.649688 [debug] [MainThread]: Parsing macros\sql\groupby.sql
13:43:05.651676 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
13:43:05.657674 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
13:43:05.660674 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
13:43:05.662675 [debug] [MainThread]: Parsing macros\sql\pivot.sql
13:43:05.667711 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
13:43:05.669712 [debug] [MainThread]: Parsing macros\sql\star.sql
13:43:05.673711 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
13:43:05.677675 [debug] [MainThread]: Parsing macros\sql\union.sql
13:43:05.688675 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
13:43:05.696674 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
13:43:05.698675 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
13:43:05.700675 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
13:43:06.089677 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:43:06.118679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:43:06.120679 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:43:06.123679 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:43:06.126712 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:43:06.129711 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:43:06.132693 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:43:06.135711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:43:06.138711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:43:06.141713 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:43:06.143711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:43:06.146712 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:43:06.149677 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:43:06.152711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:43:06.263675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8C860A0>]}
13:43:06.279676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8C86130>]}
13:43:06.279676 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
13:43:06.282681 [info ] [MainThread]: 
13:43:06.284679 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:06.286682 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:06.286682 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:07.389955 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:07.391957 [info ] [MainThread]: 
13:43:07.452480 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.452480 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.454474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:07.455477 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:07.456478 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.456478 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.457476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.458476 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.461476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:07.466477 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:07.471476 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.471476 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.472477 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.473475 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.474474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.475475 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.476474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:07.477485 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:07.478474 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.478474 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.479474 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.480476 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.488474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:07.493473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:07.495473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.496474 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.496474 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.497475 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.498473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.499476 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:07.499476 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.500477 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.501474 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:07.502490 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.503473 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.507474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:07.508474 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.513473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:07.513473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.515474 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.515474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.516481 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.517474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:07.518512 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.518512 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.519473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.520483 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.521474 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:07.524471 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:07.525481 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.526473 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.530506 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:07.530506 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.531472 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.532473 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.533478 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.534472 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:07.535473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.535473 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.536473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.537479 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.538487 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Product"
13:43:07.559472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:07.560472 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.561473 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Product
13:43:07.589473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
13:43:07.590471 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.591475 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.591475 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.592473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.592473 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.593473 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.593473 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.594473 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.595496 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.596473 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:07.596473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.597472 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.598473 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:07.599475 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.599475 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.616473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:07.617474 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.630473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:07.630473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.631474 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.631474 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.632474 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.633477 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.634473 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.635472 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.636473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.637472 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.638474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:07.639472 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.639472 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.671472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:07.707472 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.707472 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.708473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.708473 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.710473 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:07.710473 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:07.711473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:07.711473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:07.723473 [info ] [MainThread]: Done.
13:43:07.724472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D625E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D62A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D62A30>]}


============================== 2022-04-25 14:44:23.610395 | 80cf16fe-adee-4842-995a-9caa6ad05295 ==============================
14:44:23.610395 [info ] [MainThread]: Running with dbt=1.0.4
14:44:23.611396 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:44:23.612397 [debug] [MainThread]: Tracking: tracking
14:44:23.627397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784766DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847673700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847673220>]}
14:44:23.753432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:44:23.753432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:44:23.762435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178478A90D0>]}
14:44:23.776396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178477DD280>]}
14:44:23.777397 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:44:23.780397 [info ] [MainThread]: 
14:44:23.781401 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:44:23.783398 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:44:23.784413 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:44:24.891575 [debug] [ThreadPool]: Acquiring new bigquery connection "create_valid-sol-346522_AdventureWorks_marts"
14:44:24.892571 [debug] [ThreadPool]: Acquiring new bigquery connection "create_valid-sol-346522_AdventureWorks_marts"
14:44:24.893573 [debug] [ThreadPool]: BigQuery adapter: Creating schema "valid-sol-346522.AdventureWorks_marts".
14:44:24.893573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:44:25.932788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:44:25.932788 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:44:26.742033 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:44:26.742033 [info ] [MainThread]: 
14:44:26.750032 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.750032 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.751039 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:44:26.751039 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:44:26.752031 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.753031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.753031 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.754042 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.758029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:44:26.761029 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:44:26.762922 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.763928 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.763928 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.764917 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.765918 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.765918 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:44:26.766919 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.766919 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.767956 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:44:26.767956 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.768918 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.770917 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.776947 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:44:26.780917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:44:26.782247 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.782247 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.783251 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.783251 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.784234 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.785232 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.786267 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:44:26.786267 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:44:26.787232 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.787232 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.788231 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.788231 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.793231 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:44:26.796016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:44:26.797037 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.798016 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.799047 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.799047 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.800018 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.801022 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.801022 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:44:26.802058 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:44:26.803039 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.803039 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.803733 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.804232 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.807245 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:44:26.810280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:44:26.812242 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.812242 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.813253 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.813253 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.814277 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.815263 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.816242 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:44:26.817254 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Product....................... [RUN]
14:44:26.818246 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.819245 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.819245 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.820242 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.820242 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.821261 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Product
14:44:26.861278 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.877278 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.879248 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.879248 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.880253 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.913280 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.913280 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.917277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.920180 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:44:26.921181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:44:26.927211 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by creditCard_id) as reason_sk --auto incremental surrogate key
            ,to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as reason_sk_test
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:44:26.927211 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Product: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Product"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Product`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        "name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by product_id) as product_sk --auto incremental surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:44:27.814761 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got string literal "name" at [23:9]')
14:44:29.181571 [debug] [Thread-1  ]: finished collecting timing info
14:44:29.182603 [debug] [Thread-1  ]: Database Error in model dim_Product (models\marts\dim_Product.sql)
  Syntax error: Expected ")" but got string literal "name" at [23:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Product.sql
14:44:29.182603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479283D0>]}
14:44:29.183603 [error] [Thread-1  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Product.............. [[31mERROR[0m in 2.36s]
14:44:29.184567 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Product
14:44:29.185564 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.186568 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:44:29.187567 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.187567 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.188577 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.199594 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.200982 [debug] [Thread-1  ]: finished collecting timing info
14:44:29.200982 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.203991 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.204993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:44:29.210991 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by salesReason_id) as Reason_sk --auto incremental surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:44:30.983668 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name salesReason_id is ambiguous at [55:41]')
14:44:31.073862 [debug] [Thread-2  ]: finished collecting timing info
14:44:31.073862 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178478EB460>]}
14:44:31.074864 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.26s]
14:44:31.076829 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:31.077829 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.077829 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:44:31.079829 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.079829 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.079829 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.095827 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.096828 [debug] [Thread-2  ]: finished collecting timing info
14:44:31.097827 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.102826 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.103827 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:44:31.109827 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by territory_id) as territory_sk --auto incremental surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:44:31.901154 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:44:32.954042 [debug] [Thread-1  ]: finished collecting timing info
14:44:32.955032 [debug] [Thread-1  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Column name salesReason_id is ambiguous at [55:41]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:44:32.955032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847972520>]}
14:44:32.956076 [error] [Thread-1  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.77s]
14:44:32.958034 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:33.223673 [debug] [Thread-2  ]: finished collecting timing info
14:44:33.224668 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:44:33.225631 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847972FA0>]}
14:44:33.225631 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.15s]
14:44:33.227632 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:33.228630 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:44:33.229629 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:44:33.230682 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:44:33.232696 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:44:33.233698 [info ] [MainThread]: 
14:44:33.234696 [info ] [MainThread]: Finished running 5 table models in 9.45s.
14:44:33.236694 [debug] [MainThread]: Connection 'master' was properly closed.
14:44:33.236694 [debug] [MainThread]: Connection 'create_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:44:33.237696 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:44:33.237696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:44:33.238702 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:44:33.251693 [info ] [MainThread]: 
14:44:33.252693 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:44:33.254699 [info ] [MainThread]: 
14:44:33.255698 [error] [MainThread]: [33mDatabase Error in model dim_Product (models\marts\dim_Product.sql)[0m
14:44:33.257698 [error] [MainThread]:   Syntax error: Expected ")" but got string literal "name" at [23:9]
14:44:33.258701 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Product.sql
14:44:33.259694 [info ] [MainThread]: 
14:44:33.260707 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:44:33.262696 [error] [MainThread]:   Column name salesReason_id is ambiguous at [55:41]
14:44:33.263698 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:44:33.265695 [info ] [MainThread]: 
14:44:33.266693 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:44:33.267700 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:44:33.269704 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:44:33.270708 [info ] [MainThread]: 
14:44:33.271706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:44:33.272694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479DDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479DDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178477D5AF0>]}


============================== 2022-04-25 14:52:11.510518 | aa3e762f-84b9-4684-a97a-0ad64fd642ab ==============================
14:52:11.510518 [info ] [MainThread]: Running with dbt=1.0.4
14:52:11.512520 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:52:11.513519 [debug] [MainThread]: Tracking: tracking
14:52:11.529520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF34C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF3040>]}
14:52:11.725516 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
14:52:11.726520 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
14:52:11.727518 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_Product.sql
14:52:11.728525 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:52:11.729519 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
14:52:11.730520 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:52:11.752520 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Products.sql
14:52:11.773516 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
14:52:11.777517 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:52:11.781519 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
14:52:11.799518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa3e762f-84b9-4684-a97a-0ad64fd642ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DF790D0>]}
14:52:11.814519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa3e762f-84b9-4684-a97a-0ad64fd642ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DE45B80>]}
14:52:11.815518 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:52:11.817518 [info ] [MainThread]: 
14:52:11.818517 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:11.820518 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:11.820518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:12.786643 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:12.788645 [info ] [MainThread]: 
14:52:12.797644 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.797644 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.798643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:12.799641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:12.800642 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.800642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.801642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.802642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.806642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:12.810642 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:12.811643 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.812643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.813644 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.814644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.814644 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.815642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.815642 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:12.816641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:12.817643 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.818642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.818642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.819642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.822641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:12.826646 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:12.828645 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.829643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.829643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.831642 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.831642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.832644 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.833642 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:12.834641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:12.835641 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.835641 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.836642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.836642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.839641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:12.842641 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:12.844644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.844644 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.845643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.846643 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.847642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.847642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.848644 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:12.849643 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:12.850642 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.850642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.851641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.851641 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.855643 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:12.859643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:12.861643 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.861643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.862642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.863641 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.864641 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.865642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.866643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:12.866643 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:12.867641 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.867641 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.868641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.868641 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:12.915640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:12.935643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:12.937645 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.937645 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.938644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.939642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.940648 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.941643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:12.941643 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.942643 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.963642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:12.964642 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.964642 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.965644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.965644 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.966643 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.967642 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.968641 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.968641 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.969642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.970642 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:12.971643 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.971643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.993643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:12.995645 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.996653 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.997658 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.999644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:13.000643 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.001648 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:13.002646 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.003643 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.076644 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:13.078645 [debug] [Thread-1  ]: finished collecting timing info
14:52:13.078645 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.079643 [debug] [Thread-1  ]: finished collecting timing info
14:52:13.080643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.082642 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:13.083643 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:13.084643 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:52:13.084643 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:52:13.163643 [info ] [MainThread]: Done.
14:52:13.165643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1FA0>]}


============================== 2022-04-25 14:52:48.736862 | 74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d ==============================
14:52:48.736862 [info ] [MainThread]: Running with dbt=1.0.4
14:52:48.737874 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:52:48.738834 [debug] [MainThread]: Tracking: tracking
14:52:48.752833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C50E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C74B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C74F70>]}
14:52:48.867831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:52:48.867831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:52:48.874831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EAA0D0>]}
14:52:48.886831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65DDD2B0>]}
14:52:48.887832 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:52:48.890833 [info ] [MainThread]: 
14:52:48.891833 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:48.893832 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:52:48.894832 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:49.482232 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:49.483260 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:50.107754 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:50.108796 [info ] [MainThread]: 
14:52:50.116790 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.116790 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.117760 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:50.119758 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:50.120774 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.120774 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.121762 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.122761 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.125757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:50.128789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:50.129764 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.130755 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.131774 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.131774 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.132768 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.133771 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:50.133771 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.134752 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.135760 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:50.136759 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.137763 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.140781 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:50.141755 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.145757 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:50.145757 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.147753 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.147753 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.147753 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.148752 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.149753 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:50.150769 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.150769 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.151765 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:50.152757 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.153759 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.157798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:50.157798 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.161789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:50.161789 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.162783 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.163756 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.163756 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.164757 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.165756 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:50.165756 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.166756 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.167755 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:50.167755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.168754 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.172757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:50.173762 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.176789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:50.177752 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.177752 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.178758 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.178758 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.179768 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.180753 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:52:50.180753 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.182758 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.182758 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:52:50.183754 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.184754 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.185757 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.185757 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.224797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.224797 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:50.242792 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.242792 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.243773 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.244776 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.258791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:50.259788 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.284788 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.286755 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:50.293783 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by product_id) as product_sk --auto incremental surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:52:50.858602 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.859576 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by creditCard_id) as reason_sk --auto incremental surrogate key
            ,to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as reason_sk_test
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:52:51.618301 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellstartdatsellStartDate at [79:14]')
14:52:52.924521 [debug] [Thread-2  ]: finished collecting timing info
14:52:52.925514 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellstartdatsellStartDate at [79:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:52:52.926531 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65F3DA90>]}
14:52:52.927523 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.74s]
14:52:52.929533 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:52.930523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.930523 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:52:52.932518 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.933516 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.934514 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.946513 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.947514 [debug] [Thread-2  ]: finished collecting timing info
14:52:52.948513 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.952523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.953516 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:52.959533 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by SalesOrderSalesReason.salesReason_id) as Reason_sk --auto incremental surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:52:54.168864 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name salesorderid not found inside SalesOrderSalesReason at [57:36]')
14:52:54.766361 [debug] [Thread-1  ]: finished collecting timing info
14:52:54.767328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B66FB7F70>]}
14:52:54.767328 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.58s]
14:52:54.770350 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:54.770350 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.771364 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:52:54.772331 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.773330 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.773330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.788329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.790331 [debug] [Thread-1  ]: finished collecting timing info
14:52:54.790331 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.793366 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.795327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:54.800365 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by territory_id) as territory_sk --auto incremental surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:52:55.756815 [debug] [Thread-2  ]: finished collecting timing info
14:52:55.757814 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Name salesorderid not found inside SalesOrderSalesReason at [57:36]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:52:55.757814 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B670215E0>]}
14:52:55.758816 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.83s]
14:52:55.759815 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:56.491177 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:52:57.545131 [debug] [Thread-1  ]: finished collecting timing info
14:52:57.545131 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:52:57.546124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EFF850>]}
14:52:57.546124 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.77s]
14:52:57.548093 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:57.549092 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:57.550126 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:52:57.552093 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:57.553093 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:57.554117 [info ] [MainThread]: 
14:52:57.555092 [info ] [MainThread]: Finished running 5 table models in 8.66s.
14:52:57.556092 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:57.556092 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:52:57.557091 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:57.557091 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:52:57.558097 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:52:57.568109 [info ] [MainThread]: 
14:52:57.569111 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:52:57.571130 [info ] [MainThread]: 
14:52:57.572104 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:52:57.573104 [error] [MainThread]:   Unrecognized name: sellstartdatsellStartDate at [79:14]
14:52:57.575102 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:52:57.576093 [info ] [MainThread]: 
14:52:57.578093 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:52:57.579092 [error] [MainThread]:   Name salesorderid not found inside SalesOrderSalesReason at [57:36]
14:52:57.580112 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:52:57.582091 [info ] [MainThread]: 
14:52:57.582091 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:52:57.584103 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:52:57.585090 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:52:57.586096 [info ] [MainThread]: 
14:52:57.587090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:52:57.588091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65DD53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65FDC1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EF1C70>]}


============================== 2022-04-26 13:43:46.349726 | 1ee67fab-0ee4-44ec-89a9-0dfc96feee47 ==============================
13:43:46.349726 [info ] [MainThread]: Running with dbt=1.0.4
13:43:46.350728 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:46.351724 [debug] [MainThread]: Tracking: tracking
13:43:46.367723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BD1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BF3CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BF38B0>]}
13:43:47.206810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
13:43:47.208811 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
13:43:47.208811 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
13:43:47.209819 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
13:43:47.210813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
13:43:47.211813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
13:43:47.211813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
13:43:47.212812 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
13:43:47.212812 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
13:43:47.213815 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
13:43:47.213815 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritory.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:43:47.215811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
13:43:47.215811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:43:47.229811 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:43:47.266848 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:43:47.269833 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:43:47.275834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:43:47.277839 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:43:47.281839 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritory.sql
13:43:47.287850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritory.sql
13:43:47.289817 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:43:47.292850 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:43:47.295851 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:43:47.302814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:43:47.304814 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:43:47.307838 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:43:47.311829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:43:47.315842 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:43:47.322840 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:43:47.324849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:43:47.327817 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:43:47.405606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ee67fab-0ee4-44ec-89a9-0dfc96feee47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426F010D0>]}
13:43:47.417571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ee67fab-0ee4-44ec-89a9-0dfc96feee47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426DFE070>]}
13:43:47.418585 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:43:47.420572 [info ] [MainThread]: 
13:43:47.421574 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:47.424572 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:47.425572 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:48.890504 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:48.890504 [info ] [MainThread]: 
13:43:48.937901 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.937901 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.938899 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:48.938899 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:48.939923 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.939923 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.940900 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.940900 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.944903 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:48.948904 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:48.949905 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.950917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.951905 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.951905 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.952902 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.953906 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:48.954924 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.954924 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.955902 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:48.956901 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.957140 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.960503 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:48.961504 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.965020 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:48.965020 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.965981 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.967019 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.967019 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.967984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:48.968994 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.968994 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.969984 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.970983 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.970983 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:48.974017 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:48.975001 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.975001 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.975985 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.978983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:48.979994 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.980990 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.981994 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:48.981994 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.981994 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.982984 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.982984 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.983982 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.987020 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:48.987985 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:48.988377 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.989403 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.989403 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.992423 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:48.993390 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.994303 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.995330 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:48.996317 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.996317 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.997314 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.997314 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.998313 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.014620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:49.015055 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:43:49.015614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.016625 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:43:49.023658 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.035631 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:43:49.035631 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:49.036561 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.037570 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:49.038580 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.038580 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.039585 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.040585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:49.040585 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.041573 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.041573 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.042571 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.043571 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.056571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:49.056571 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:49.057586 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.058570 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.058570 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.070569 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:49.071574 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.072571 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.073594 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.074590 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.074590 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.075573 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.077573 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.078573 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.079749 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:49.079749 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.080772 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.111772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:49.112773 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.112773 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.113773 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.114775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.116774 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:49.116774 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:49.117778 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:49.117778 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:49.128807 [info ] [MainThread]: Done.
13:43:49.129773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056850>]}


============================== 2022-04-26 13:43:53.929832 | 8971f773-2c09-4152-a2e9-3cece4d245f2 ==============================
13:43:53.929832 [info ] [MainThread]: Running with dbt=1.0.4
13:43:53.930819 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:53.930819 [debug] [MainThread]: Tracking: tracking
13:43:53.946835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BCE0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BD04130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BD04370>]}
13:43:54.115819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:43:54.116817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:43:54.124818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8971f773-2c09-4152-a2e9-3cece4d245f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF460D0>]}
13:43:54.136818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8971f773-2c09-4152-a2e9-3cece4d245f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF0C5E0>]}
13:43:54.136818 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:43:54.139820 [info ] [MainThread]: 
13:43:54.141821 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:54.144820 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:54.144820 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:55.205532 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:55.206521 [info ] [MainThread]: 
13:43:55.214523 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.214523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.215541 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:55.216519 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:55.216519 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.217546 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.218532 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.218532 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.222539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:55.226525 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:55.227525 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.228533 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.229520 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.230524 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.230524 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.231522 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.232520 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:55.233519 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:55.233519 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.234525 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.234525 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.235522 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.238545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:55.241519 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:55.243522 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.243522 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.244521 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.245521 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.246522 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.246522 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.247519 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:55.248521 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:55.248521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.249520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.250520 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.251521 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.254520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:55.259558 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:55.260521 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.261524 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.262540 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.263536 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.264521 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.264521 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.265521 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:55.266558 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:55.267521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.267521 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.268521 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.268521 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.271557 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:55.274556 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:55.275529 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.276519 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.276519 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.277519 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.278521 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.279526 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.279526 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:55.280577 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:43:55.281520 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.281520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.282539 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.282539 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:43:55.315555 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:55.332555 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:43:55.334519 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.335520 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.335520 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.336520 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.336520 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.337530 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.338522 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.338522 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.339535 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.340523 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:55.340523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.341534 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.342540 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:55.342540 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.343520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.356545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:55.356545 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.371518 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:55.372518 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.372518 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.373519 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.373519 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.374525 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.375521 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.376533 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.377523 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.378530 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.378530 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:55.379529 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.379529 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.416522 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:55.417523 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.417523 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.418522 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.419538 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.420565 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:55.421555 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:55.421555 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:55.422519 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:55.432519 [info ] [MainThread]: Done.
13:43:55.433520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF0C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF16520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF16490>]}


============================== 2022-04-26 14:27:13.437528 | 656e4bb5-35b4-4b73-a7eb-6de8acc96e03 ==============================
14:27:13.437528 [info ] [MainThread]: Running with dbt=1.0.4
14:27:13.440526 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:27:13.440526 [debug] [MainThread]: Tracking: tracking
14:27:13.457528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA2DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA33B20>]}
14:27:13.654528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:27:13.654528 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:27:13.668527 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:27:13.711528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:27:13.731527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCDEF10>]}
14:27:13.749526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFC479D0>]}
14:27:13.749526 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:27:13.752530 [info ] [MainThread]: 
14:27:13.753530 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:13.755528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:27:13.756529 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:16.416209 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:16.417210 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:17.184209 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:17.185209 [info ] [MainThread]: 
14:27:17.196212 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.196212 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.198214 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:27:17.199211 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:17.199211 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.200211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.200211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.201210 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.207215 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:27:17.212216 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:17.214211 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.215213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.215213 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.216211 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.217213 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.218211 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.219210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:17.220212 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:17.221214 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.222211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.222211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.223213 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.226214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:17.229209 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:17.230209 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.231213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.232214 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.233212 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.234210 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.235216 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.235216 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:17.236214 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:17.237226 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.238210 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.238210 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.239209 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.242213 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:17.246210 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:17.248209 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.249213 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.249213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.249213 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.250213 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.251210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:17.252222 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.252222 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.253212 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:27:17.254210 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.254210 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.257211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:17.258216 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.262219 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:27:17.262219 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.263210 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.264211 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.264211 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.265210 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.266210 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:27:17.267221 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.268210 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:27:17.268210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:17.270213 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.270213 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.271211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.271211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.272215 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:27:17.295212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:17.317213 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.318210 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.319214 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.319214 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.337211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:17.338212 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.374210 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.398209 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:17.404210 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:27:18.134645 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:18.136643 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:27:18.870501 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellstartdatsellStartDate at [83:14]')
14:27:20.831423 [debug] [Thread-2  ]: finished collecting timing info
14:27:20.832423 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellstartdatsellStartDate at [83:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:27:20.833422 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFD50B50>]}
14:27:20.833422 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.56s]
14:27:20.835423 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:27:20.835423 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.836423 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:27:20.837421 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.838422 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.838422 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.860880 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.862497 [debug] [Thread-2  ]: finished collecting timing info
14:27:20.863031 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.868319 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.869409 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:20.877418 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:27:21.286987 [debug] [Thread-1  ]: finished collecting timing info
14:27:21.287986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFD7BCA0>]}
14:27:21.287986 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.02s]
14:27:21.289993 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:21.290986 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.290986 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:27:21.293000 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.293000 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.294412 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.312929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.313929 [debug] [Thread-1  ]: finished collecting timing info
14:27:21.314930 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.317930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.319931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:21.325932 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:27:22.108818 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:27:22.339844 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name salesReason_id is ambiguous at [55:43]')
14:27:23.450817 [debug] [Thread-1  ]: finished collecting timing info
14:27:23.450817 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:27:23.451813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE73EB0>]}
14:27:23.451813 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.16s]
14:27:23.453815 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:24.281002 [debug] [Thread-2  ]: finished collecting timing info
14:27:24.282004 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Column name salesReason_id is ambiguous at [55:43]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:27:24.283004 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE7F610>]}
14:27:24.283004 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.45s]
14:27:24.285004 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:24.286003 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:24.286003 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:27:24.287001 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:24.289005 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:24.290003 [info ] [MainThread]: 
14:27:24.292005 [info ] [MainThread]: Finished running 5 table models in 10.54s.
14:27:24.293010 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:27:24.295003 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:27:24.307004 [info ] [MainThread]: 
14:27:24.308011 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:27:24.310006 [info ] [MainThread]: 
14:27:24.312005 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:27:24.314012 [error] [MainThread]:   Unrecognized name: sellstartdatsellStartDate at [83:14]
14:27:24.315003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:27:24.316010 [info ] [MainThread]: 
14:27:24.317003 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:27:24.318004 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:27:24.319003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:27:24.321005 [info ] [MainThread]: 
14:27:24.322008 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:27:24.323005 [error] [MainThread]:   Column name salesReason_id is ambiguous at [55:43]
14:27:24.324003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:27:24.325005 [info ] [MainThread]: 
14:27:24.326004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:27:24.327004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCB5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCB5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE4C7C0>]}


============================== 2022-04-26 14:33:19.157400 | 1df07343-a2c3-4157-93eb-050db0523eac ==============================
14:33:19.157400 [info ] [MainThread]: Running with dbt=1.0.4
14:33:19.158417 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:33:19.158417 [debug] [MainThread]: Tracking: tracking
14:33:19.173401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F3F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F36D0>]}
14:33:19.307401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
14:33:19.308401 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
14:33:19.309405 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritory.sql
14:33:19.310402 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:33:19.327400 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:33:19.358401 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:33:19.472403 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
14:33:19.476401 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:33:19.482403 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:33:19.497400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2569350D0>]}
14:33:19.509402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905B50>]}
14:33:19.510400 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:33:19.513400 [info ] [MainThread]: 
14:33:19.515404 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:19.517402 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:33:19.518402 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:20.765580 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:33:20.765580 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:21.596163 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:33:21.597165 [info ] [MainThread]: 
14:33:21.607178 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.608166 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.609166 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:33:21.611167 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:33:21.611167 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.612174 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.613170 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.613170 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.618165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:33:21.623167 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:33:21.625165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.626165 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.626165 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.627183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.628166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.629166 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.630183 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:33:21.631184 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:33:21.632164 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.633180 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.633180 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.634165 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.640167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:33:21.644163 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:33:21.645164 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.645164 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.646165 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.647166 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.647166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.648163 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.649165 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:33:21.650167 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:33:21.651165 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.651165 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.652166 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.653182 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.656164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:33:21.659164 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:33:21.660163 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.661164 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.661164 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.662168 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.663164 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.664164 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:33:21.664164 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.665165 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.667166 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:33:21.667166 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.668166 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.673164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:33:21.673164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.678164 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:33:21.679165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.680182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.680182 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.681164 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.682165 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.682165 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:33:21.683165 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.684166 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:21.685182 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:33:21.686166 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.687164 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.687164 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.688165 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.706164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:21.707164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:33:21.731165 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.732165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.732165 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.733167 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.754164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:21.754164 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.779163 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.781164 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:33:21.789164 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:33:22.966164 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:22.967164 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:33:23.330752 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
14:33:25.036373 [debug] [Thread-2  ]: finished collecting timing info
14:33:25.036373 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:33:25.037373 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256A577C0>]}
14:33:25.037373 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.35s]
14:33:25.039373 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:33:25.040374 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.040374 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:33:25.042373 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.043375 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.043375 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.070375 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.072375 [debug] [Thread-2  ]: finished collecting timing info
14:33:25.073377 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.079381 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.080378 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:33:25.089372 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:33:26.493962 [debug] [Thread-1  ]: finished collecting timing info
14:33:26.494962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256AB2040>]}
14:33:26.495962 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.81s]
14:33:26.496963 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:26.497961 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.498962 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:33:26.500963 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.500963 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.501962 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.519963 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.520963 [debug] [Thread-1  ]: finished collecting timing info
14:33:26.521965 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.526979 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.528963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:26.535963 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:33:26.722099 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name salesorderid not found inside SalesOrderSalesReason at [61:36]')
14:33:27.338232 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:33:28.478761 [debug] [Thread-1  ]: finished collecting timing info
14:33:28.479761 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:33:28.480761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D257AF3FA0>]}
14:33:28.481762 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 1.98s]
14:33:28.482775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:28.831903 [debug] [Thread-2  ]: finished collecting timing info
14:33:28.832903 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Name salesorderid not found inside SalesOrderSalesReason at [61:36]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:33:28.833903 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256A4A5E0>]}
14:33:28.833903 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.79s]
14:33:28.835905 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:28.836903 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:33:28.836903 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:33:28.838904 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:33:28.839904 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:28.841905 [info ] [MainThread]: 
14:33:28.842906 [info ] [MainThread]: Finished running 5 table models in 9.33s.
14:33:28.843909 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:28.844931 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:33:28.844931 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:33:28.845912 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:33:28.845912 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:33:28.858905 [info ] [MainThread]: 
14:33:28.859905 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:33:28.861906 [info ] [MainThread]: 
14:33:28.862905 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:33:28.864908 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
14:33:28.865910 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:33:28.867904 [info ] [MainThread]: 
14:33:28.868912 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:33:28.870904 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:33:28.871905 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:33:28.872904 [info ] [MainThread]: 
14:33:28.873906 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:33:28.875906 [error] [MainThread]:   Name salesorderid not found inside SalesOrderSalesReason at [61:36]
14:33:28.876906 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:33:28.877919 [info ] [MainThread]: 
14:33:28.878905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:33:28.879904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D257ABFBE0>]}


============================== 2022-04-26 14:43:35.390241 | 7b82b561-ab3e-4602-a87d-4c92cd68dcfe ==============================
14:43:35.390241 [info ] [MainThread]: Running with dbt=1.0.4
14:43:35.391239 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:43:35.392240 [debug] [MainThread]: Tracking: tracking
14:43:35.406241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F61F1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6213370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6213A90>]}
14:43:35.552105 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
14:43:35.553104 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:43:35.553104 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:43:35.554105 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritory.sql
14:43:35.554105 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritory.sql
14:43:35.555122 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:43:35.556105 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:43:35.570107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:43:35.584104 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:43:35.607105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:43:35.611121 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:43:35.627107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:43:35.629123 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:43:35.642643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:43:35.660435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b82b561-ab3e-4602-a87d-4c92cd68dcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64470D0>]}
14:43:35.684437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b82b561-ab3e-4602-a87d-4c92cd68dcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64214F0>]}
14:43:35.685436 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:43:35.689436 [info ] [MainThread]: 
14:43:35.690436 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:43:35.693437 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:43:35.694437 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:43:36.572025 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:43:36.574035 [info ] [MainThread]: 
14:43:36.582023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.583023 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.583023 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:43:36.584026 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:43:36.584026 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.585025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.585025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.586025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.589029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:43:36.595034 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:43:36.596053 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.597036 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.598033 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.599043 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.599043 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.600035 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.601030 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:43:36.602045 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:43:36.603030 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.604036 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.604036 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.605032 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.609032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:43:36.614028 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:43:36.616032 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.617027 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.618025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.618025 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.619030 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.620025 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.621031 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:43:36.622025 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:43:36.623025 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.623025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.624025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.625025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.629025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:43:36.635024 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:43:36.637026 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.638026 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.639025 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.639025 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.640027 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.641026 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:43:36.642025 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.643024 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.644024 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:43:36.644024 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.645031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.650024 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:43:36.651029 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.657024 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:43:36.657024 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.659024 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.659973 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.660621 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.662140 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.663140 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:43:36.664140 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.665140 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.667140 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:43:36.667140 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.668140 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.701140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:43:36.701140 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:43:36.727139 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:43:36.727139 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.728139 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.729140 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.729140 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.729140 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.730140 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.731141 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.732141 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.732349 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.733140 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:43:36.734140 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.734140 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.735141 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:43:36.736151 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.736151 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.758405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:43:36.758926 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.792445 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:43:36.793447 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.794897 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.795479 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.796025 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.797221 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.798291 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.799380 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.800992 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.802068 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.803770 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:43:36.804872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.805932 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.899089 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:43:36.901089 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.901089 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.902093 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.903097 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.905099 [debug] [MainThread]: Connection 'master' was properly closed.
14:43:36.906099 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:43:36.907093 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:43:36.907093 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:43:36.927089 [info ] [MainThread]: Done.
14:43:36.929089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F63FC040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6424760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64247C0>]}


============================== 2022-04-26 14:46:08.839003 | d28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3 ==============================
14:46:08.839003 [info ] [MainThread]: Running with dbt=1.0.4
14:46:08.840003 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:46:08.840003 [debug] [MainThread]: Tracking: tracking
14:46:08.856004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03693DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036943FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036943D30>]}
14:46:09.012005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:46:09.012005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:46:09.022011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036B860D0>]}
14:46:09.037004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0369B45B0>]}
14:46:09.038018 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:46:09.042004 [info ] [MainThread]: 
14:46:09.044004 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:09.045003 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:46:09.046003 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:09.866004 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:46:09.867006 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:10.629356 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:46:10.630355 [info ] [MainThread]: 
14:46:10.637355 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.637355 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.638356 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:46:10.638356 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:46:10.639358 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.639358 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.640357 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.640357 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.643356 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:46:10.647355 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:46:10.649356 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.650357 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.650357 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.651356 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.652370 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.653357 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.653357 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:46:10.655231 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:46:10.655760 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.656304 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.656861 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.657975 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.664679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:46:10.670776 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:46:10.672414 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.673488 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.674024 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.674535 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.675546 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.676549 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.677544 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:46:10.678543 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:46:10.679545 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.680545 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.680545 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.681561 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.685544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:46:10.691543 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:46:10.692557 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.693599 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.694107 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.695118 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.696125 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.697117 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.697117 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:46:10.698117 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:10.699117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.699117 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.700116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.700116 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.704116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:46:10.708115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:10.709115 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.710117 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.711115 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.711115 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.712115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.713116 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.713116 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:46:10.714115 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:46:10.715116 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:10.716133 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.716133 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.717117 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.718116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.718116 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:46:10.765658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:10.787967 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.789968 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.789968 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.790970 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.790970 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.814532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:10.838533 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.840532 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:10.849537 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:46:11.632681 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:11.633681 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:46:12.372975 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
14:46:14.321982 [debug] [Thread-2  ]: finished collecting timing info
14:46:14.323000 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:46:14.323982 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037C9BD90>]}
14:46:14.325347 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.61s]
14:46:14.326984 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:46:14.326984 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.327982 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:46:14.328982 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.328982 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.329983 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.347984 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.349985 [debug] [Thread-2  ]: finished collecting timing info
14:46:14.349985 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.353983 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.355982 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:14.360983 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:46:14.518774 [debug] [Thread-1  ]: finished collecting timing info
14:46:14.519306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036C46A30>]}
14:46:14.519830 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 3.80s]
14:46:14.521416 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:14.521949 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.522473 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:46:14.523479 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.523479 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.524480 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.539479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.540480 [debug] [Thread-1  ]: finished collecting timing info
14:46:14.541480 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.545480 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.580478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:14.587479 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
14:46:15.417886 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:46:15.820123 [debug] [Thread-1  ]: finished collecting timing info
14:46:15.821129 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:46:15.822124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037D1F550>]}
14:46:15.823124 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.30s]
14:46:15.824124 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:17.732572 [debug] [Thread-2  ]: finished collecting timing info
14:46:17.733571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036BB0B50>]}
14:46:17.734572 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (27.6k rows, 432.2 KB processed)[0m in 3.40s]
14:46:17.735572 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:17.736573 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:46:17.736573 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:46:17.738578 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:46:17.740573 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:17.741572 [info ] [MainThread]: 
14:46:17.742573 [info ] [MainThread]: Finished running 5 table models in 8.70s.
14:46:17.743573 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:17.744572 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:46:17.745574 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:46:17.745574 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:46:17.746572 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:46:17.761572 [info ] [MainThread]: 
14:46:17.762572 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
14:46:17.764575 [info ] [MainThread]: 
14:46:17.765573 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:46:17.766576 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
14:46:17.767573 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:46:17.768574 [info ] [MainThread]: 
14:46:17.769572 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:46:17.770572 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:46:17.772586 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:46:17.773574 [info ] [MainThread]: 
14:46:17.774574 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
14:46:17.776573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036C126A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0369B4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037D028E0>]}


============================== 2022-04-26 22:53:40.071800 | f2267904-6a04-49b2-a472-3fdaffb4a61f ==============================
22:53:40.071800 [info ] [MainThread]: Running with dbt=1.0.4
22:53:40.073799 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:53:40.073799 [debug] [MainThread]: Tracking: tracking
22:53:40.091831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A27EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A284F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A284BB0>]}
22:53:41.352007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:53:41.352007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:53:41.362998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A4C80D0>]}
22:53:41.380997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6550>]}
22:53:41.381997 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
22:53:41.384996 [info ] [MainThread]: 
22:53:41.385997 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:41.387996 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
22:53:41.388997 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:42.184568 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
22:53:42.184568 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:42.782485 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
22:53:42.784207 [info ] [MainThread]: 
22:53:42.919886 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.920884 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.921885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
22:53:42.921885 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
22:53:42.922886 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.923884 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.924103 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.924704 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.930715 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
22:53:42.935742 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
22:53:42.937715 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.938715 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.938715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.939716 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.940716 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.941717 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.941717 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:42.942714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:42.943717 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.944731 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.945728 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.946720 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.950752 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:42.953715 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:42.955891 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.955891 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.956913 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.957891 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.957891 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.958891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.960894 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:42.961893 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:42.962908 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.963899 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.963899 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.964929 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.967891 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:42.971745 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:42.972735 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.973736 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.973736 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.974757 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.974757 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.975736 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
22:53:42.976738 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.977742 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.978743 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:42.979742 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.980739 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.984772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
22:53:42.985757 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.989737 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:42.989737 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.990742 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.990742 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.991737 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:42.992743 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.993739 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
22:53:42.995742 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:53:42.997746 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
22:53:42.997746 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:42.999741 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:53:42.999741 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.000737 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:53:43.000737 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.001737 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:53:43.042772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:43.066772 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:43.081744 [debug] [Thread-1  ]: finished collecting timing info
22:53:43.081744 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.098737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:43.120993 [debug] [Thread-2  ]: finished collecting timing info
22:53:43.122009 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:53:43.151028 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:43.153988 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:43.158987 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
22:53:43.697636 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:43.698638 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
22:53:44.415289 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
22:53:46.322345 [debug] [Thread-2  ]: finished collecting timing info
22:53:46.323333 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:53:46.323333 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B5ECC40>]}
22:53:46.324332 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.32s]
22:53:46.325334 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:53:46.326334 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.327335 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
22:53:46.328339 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.329334 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.330428 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.349367 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.351352 [debug] [Thread-2  ]: finished collecting timing info
22:53:46.352339 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.354337 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:46.936597 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.939565 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
22:53:47.300621 [debug] [Thread-1  ]: finished collecting timing info
22:53:47.301623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A552F40>]}
22:53:47.302624 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.30s]
22:53:47.304624 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:47.305643 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.306622 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
22:53:47.308623 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.309624 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.310626 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.329624 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.330623 [debug] [Thread-1  ]: finished collecting timing info
22:53:47.331623 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.334660 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.338622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:47.345622 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
22:53:48.000355 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
22:53:49.298829 [debug] [Thread-1  ]: finished collecting timing info
22:53:49.299828 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
22:53:49.300828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B66DDF0>]}
22:53:49.301831 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.99s]
22:53:49.303831 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:49.992920 [debug] [Thread-2  ]: finished collecting timing info
22:53:49.993920 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A4F0DF0>]}
22:53:49.993920 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.67s]
22:53:49.995919 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:49.996924 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:49.997919 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
22:53:49.999921 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:50.001921 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:50.002956 [info ] [MainThread]: 
22:53:50.002956 [info ] [MainThread]: Finished running 5 table models in 8.62s.
22:53:50.003921 [debug] [MainThread]: Connection 'master' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
22:53:50.005919 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
22:53:50.050454 [info ] [MainThread]: 
22:53:50.051454 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
22:53:50.054473 [info ] [MainThread]: 
22:53:50.055454 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
22:53:50.057455 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
22:53:50.058456 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:53:50.060455 [info ] [MainThread]: 
22:53:50.062455 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
22:53:50.065469 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
22:53:50.067454 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
22:53:50.068493 [info ] [MainThread]: 
22:53:50.069455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
22:53:50.071453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B647820>]}


============================== 2022-04-26 23:02:55.039061 | 9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0 ==============================
23:02:55.039061 [info ] [MainThread]: Running with dbt=1.0.4
23:02:55.040062 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
23:02:55.041035 [debug] [MainThread]: Tracking: tracking
23:02:55.055039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D13EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D24490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D24340>]}
23:02:55.172060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:02:55.173063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:02:55.180061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850F570D0>]}
23:02:55.192031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D82610>]}
23:02:55.193042 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:02:55.196032 [info ] [MainThread]: 
23:02:55.198034 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:02:55.199032 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:02:55.200033 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:02:55.917481 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:02:55.918483 [info ] [MainThread]: 
23:02:55.925480 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.926479 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.927483 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:02:55.928481 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:02:55.928481 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.929482 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.930525 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.930525 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.934518 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:02:55.938484 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:02:55.940335 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.940335 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.941341 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.942340 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.942340 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.943335 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.944366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:02:55.945341 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:02:55.946345 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.947339 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.947339 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.948338 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.951334 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:02:55.954082 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:02:55.956119 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.956119 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.957083 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.958087 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.958087 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.959084 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.960084 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:02:55.961084 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:02:55.962087 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.963092 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.963092 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.964090 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.968083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:02:55.970086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:02:55.972083 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.972083 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.973094 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.974089 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.974089 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.975085 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.976085 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:02:55.976085 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:02:55.977083 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.978085 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.978085 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.979093 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.983121 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:02:55.986083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:02:55.987085 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.988085 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.988085 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.988085 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.989085 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.990090 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:02:55.991114 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:02:55.992092 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.992092 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:02:55.993084 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.993084 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.028086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:02:56.029086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:02:56.048082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:02:56.048082 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.049083 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:56.050083 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.050083 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.051083 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.051083 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:56.052083 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.053098 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.054083 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.054083 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:02:56.055083 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.056083 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.056083 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:02:56.057143 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.057143 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.071118 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:02:56.071118 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.083953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:02:56.084915 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.084915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.085924 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.085924 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.086918 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.087924 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.087924 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.089917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.090917 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.090917 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:02:56.091915 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.091915 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.124952 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:02:56.125951 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.126915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.126915 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.127916 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.129926 [debug] [MainThread]: Connection 'master' was properly closed.
23:02:56.129926 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:02:56.130920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:02:56.130920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
23:02:56.140935 [info ] [MainThread]: Done.
23:02:56.141927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088730>]}


============================== 2022-04-26 23:53:39.231693 | 247066ce-e39a-4c7e-9caf-6bf0c5e336db ==============================
23:53:39.231693 [info ] [MainThread]: Running with dbt=1.0.4
23:53:39.232705 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:53:39.232705 [debug] [MainThread]: Tracking: tracking
23:53:39.249695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A6BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A93670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A93280>]}
23:53:39.473693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
23:53:39.474693 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:53:39.475696 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
23:53:39.522706 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:53:39.543695 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
23:53:39.566693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
23:53:39.583695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9D3D0D0>]}
23:53:39.595694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9CA59D0>]}
23:53:39.595694 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:53:39.598696 [info ] [MainThread]: 
23:53:39.600704 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:53:39.601695 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:53:39.602695 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:40.402592 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:53:40.403591 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:40.995127 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:53:40.996121 [info ] [MainThread]: 
23:53:41.004123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.004123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.006122 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:53:41.007122 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:53:41.007122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.008139 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.009125 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.009125 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.014159 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:53:41.018125 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:53:41.020124 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.021121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.021121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.021121 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.023121 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.024124 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:53:41.025122 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.025122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.027131 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:53:41.027131 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.028133 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.034134 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:53:41.035140 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.041120 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:53:41.043122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.045121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.046122 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.047124 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:53:41.048122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.049132 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.056121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:53:41.061122 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.063123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.064123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.065123 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:53:41.067123 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.068121 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.067123 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.076124 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:53:41.082123 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.084123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.085121 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:53:41.085121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.086121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.087123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.087123 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.088121 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.093121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:53:41.094122 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:53:41.096121 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.096121 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.097122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.102123 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:53:41.103124 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.104122 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.105124 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:53:41.106125 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.107123 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.108123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.109121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.110123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.110123 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.111123 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:53:41.138145 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.140136 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.140136 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.141122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.141122 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:53:41.142121 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.171120 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.187156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:53:41.188121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.188121 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.212123 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.214120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:53:41.220155 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:53:41.808033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.808995 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:53:42.745016 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:53:43.969666 [debug] [Thread-2  ]: finished collecting timing info
23:53:43.970669 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:53:43.971664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E09280>]}
23:53:43.971664 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.83s]
23:53:43.974665 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:53:43.974665 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:43.975665 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:53:43.977670 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:43.977670 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:43.978684 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:53:44.002663 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:44.004664 [debug] [Thread-2  ]: finished collecting timing info
23:53:44.004664 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:44.009665 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:53:44.578402 [debug] [Thread-1  ]: finished collecting timing info
23:53:44.579399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E07EB0>]}
23:53:44.580403 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.47s]
23:53:44.582364 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:44.583364 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.583364 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:53:44.585365 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.585365 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.586368 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.603400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.604368 [debug] [Thread-1  ]: finished collecting timing info
23:53:44.605363 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.611361 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.613398 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:44.614362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:53:44.615363 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:53:44.620392 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:53:45.240496 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:53:46.517329 [debug] [Thread-1  ]: finished collecting timing info
23:53:46.517878 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:53:46.518434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AAE9FEB0>]}
23:53:46.519592 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.93s]
23:53:46.521299 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:48.241196 [debug] [Thread-2  ]: finished collecting timing info
23:53:48.242176 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9DBA1F0>]}
23:53:48.242176 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.27s]
23:53:48.244176 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:48.245188 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:53:48.245188 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:53:48.247190 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:53:48.249176 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:53:48.250176 [info ] [MainThread]: 
23:53:48.251176 [info ] [MainThread]: Finished running 5 table models in 8.65s.
23:53:48.253179 [debug] [MainThread]: Connection 'master' was properly closed.
23:53:48.253179 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:53:48.254177 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:53:48.254177 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:53:48.255178 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:53:48.279179 [info ] [MainThread]: 
23:53:48.281177 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:53:48.282179 [info ] [MainThread]: 
23:53:48.284179 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:53:48.285177 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:53:48.286177 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:53:48.288180 [info ] [MainThread]: 
23:53:48.289175 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:53:48.291179 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:53:48.292177 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:53:48.294180 [info ] [MainThread]: 
23:53:48.295177 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:53:48.297177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E1CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9B04310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AAE79730>]}


============================== 2022-04-26 23:55:08.396209 | dfc8bff0-99b8-4510-b9a7-d649c52bfe23 ==============================
23:55:08.396209 [info ] [MainThread]: Running with dbt=1.0.4
23:55:08.397221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:55:08.398211 [debug] [MainThread]: Tracking: tracking
23:55:08.412217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB4DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB53D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB536A0>]}
23:55:08.537244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:55:08.537244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:55:08.545244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6ED970D0>]}
23:55:08.557245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC55B0>]}
23:55:08.557245 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:55:08.561244 [info ] [MainThread]: 
23:55:08.563213 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:08.565214 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:55:08.565214 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:09.191947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:55:09.192986 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:09.816155 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:55:09.817194 [info ] [MainThread]: 
23:55:09.825153 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.826154 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.827156 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:09.828158 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:09.828158 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.829153 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.829153 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.830153 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.832614 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:09.835650 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:09.837619 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.837619 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.838630 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.839616 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.839616 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.840618 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.841614 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:09.842616 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:09.842616 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.843619 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.843619 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.844615 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.848620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:09.852652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:09.853615 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.854617 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.855623 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.856637 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.857625 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.858634 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:09.859620 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.860644 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.860644 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:09.861619 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.862136 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.865184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:09.865184 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.868994 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:09.868994 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.869958 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.869958 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.870960 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.871972 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:09.872970 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.873965 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.874961 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.874961 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.875960 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:09.878957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:09.878957 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.879959 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.880958 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.883994 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:09.883994 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.884960 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.885971 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:55:09.885971 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.887960 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:09.888975 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.889958 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.890962 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:55:09.891974 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.892959 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:55:09.932956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:09.933977 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:55:09.933977 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:55:09.934958 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:55:09.934958 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.958983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:09.959990 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.982994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:09.983960 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.983960 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:55:10.006005 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:10.009960 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:10.014994 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:55:10.610236 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:10.612194 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:55:11.430275 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:55:13.376535 [debug] [Thread-1  ]: finished collecting timing info
23:55:13.377518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FEB30D0>]}
23:55:13.377518 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.49s]
23:55:13.379518 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:13.380531 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.381533 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:55:13.382521 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.382521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.383542 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.400551 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.402541 [debug] [Thread-1  ]: finished collecting timing info
23:55:13.402541 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.408520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:13.561638 [debug] [Thread-2  ]: finished collecting timing info
23:55:13.562605 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:13.562605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FEACBB0>]}
23:55:13.563603 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.63s]
23:55:13.565605 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:55:13.566619 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.567614 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:55:13.569610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.569610 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.570608 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.584640 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.586623 [debug] [Thread-2  ]: finished collecting timing info
23:55:13.586623 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.591604 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.592604 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:13.598602 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:55:13.969975 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.970976 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:55:14.196799 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:55:15.530547 [debug] [Thread-2  ]: finished collecting timing info
23:55:15.531586 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:15.531586 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FF080A0>]}
23:55:15.532548 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.96s]
23:55:15.534548 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:17.230954 [debug] [Thread-1  ]: finished collecting timing info
23:55:17.231918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EDC0CA0>]}
23:55:17.232917 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.85s]
23:55:17.234922 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:17.235920 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:17.236917 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:55:17.237923 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:17.240922 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:17.240922 [info ] [MainThread]: 
23:55:17.242919 [info ] [MainThread]: Finished running 5 table models in 8.68s.
23:55:17.243921 [debug] [MainThread]: Connection 'master' was properly closed.
23:55:17.243921 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:55:17.244919 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:55:17.245918 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:55:17.245918 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:55:17.264953 [info ] [MainThread]: 
23:55:17.265919 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:55:17.267920 [info ] [MainThread]: 
23:55:17.269925 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:55:17.271918 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:55:17.272919 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:17.273919 [info ] [MainThread]: 
23:55:17.274918 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:55:17.276919 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:55:17.277922 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:17.279919 [info ] [MainThread]: 
23:55:17.280919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:55:17.282921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EDC0BB0>]}


============================== 2022-04-26 23:55:32.521907 | ef37e0ad-c3a9-44ff-9442-429fa9877cc2 ==============================
23:55:32.521907 [info ] [MainThread]: Running with dbt=1.0.4
23:55:32.522873 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:55:32.523872 [debug] [MainThread]: Tracking: tracking
23:55:32.538879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5D1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5F4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5F4B20>]}
23:55:32.665871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:55:32.666872 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:55:32.683873 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:55:32.710908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA826F70>]}
23:55:32.722876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA808A60>]}
23:55:32.723877 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:55:32.726908 [info ] [MainThread]: 
23:55:32.727874 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:32.729872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:55:32.730890 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:33.369300 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:55:33.370301 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:33.955210 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:55:33.956586 [info ] [MainThread]: 
23:55:33.964599 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.965601 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.966600 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:33.967598 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:33.967598 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.968607 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.969597 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.969597 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.972598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:33.977596 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:33.978597 [debug] [Thread-1  ]: finished collecting timing info
23:55:33.979597 [debug] [Thread-2  ]: finished collecting timing info
23:55:33.980597 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.981597 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.982605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.983606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.984600 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:33.985597 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:33.985597 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.986597 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.987614 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.987614 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.990635 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:33.994632 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:33.995596 [debug] [Thread-1  ]: finished collecting timing info
23:55:33.996598 [debug] [Thread-2  ]: finished collecting timing info
23:55:33.997596 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.998599 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.999610 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.000600 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.001611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:34.002601 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:34.002601 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.003601 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.003601 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.004598 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.007632 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:34.010636 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:34.011597 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.012595 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.012595 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.013612 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.014605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.014605 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.016599 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:34.017606 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:34.018599 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.018599 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.019598 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.019598 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.022634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:34.025600 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:34.027599 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.028597 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.028597 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.028597 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.029597 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.030630 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:55:34.031597 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.033598 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.033598 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:55:34.034597 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.035598 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.036599 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.072597 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.073610 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.074602 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:55:34.075614 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.095594 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.096596 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.112595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:34.112595 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.113597 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.139594 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.141594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:34.147594 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate as sellEndDate -- see below
        --,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:55:34.728599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.729574 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:55:35.574386 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2012-05-30T00:00:00.000000Z'")
23:55:37.574048 [debug] [Thread-2  ]: finished collecting timing info
23:55:37.575040 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2012-05-30T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:37.575040 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA914460>]}
23:55:37.576002 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.54s]
23:55:37.577006 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:55:37.578008 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.579005 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:55:37.580005 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:37.580005 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.581006 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.594042 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:37.595002 [debug] [Thread-2  ]: finished collecting timing info
23:55:37.596002 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.599002 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:37.692938 [debug] [Thread-1  ]: finished collecting timing info
23:55:37.693899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8FF9D0>]}
23:55:37.694901 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.66s]
23:55:37.696911 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:37.697901 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.697901 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:55:37.699734 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.700720 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.700720 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.712765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.714730 [debug] [Thread-1  ]: finished collecting timing info
23:55:37.714730 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.717731 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.719733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:37.725766 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:55:38.162740 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:38.163739 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:55:38.381306 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:55:38.916182 [debug] [Thread-1  ]: finished collecting timing info
23:55:38.916182 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:38.917217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCB9C56D0>]}
23:55:38.917217 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.22s]
23:55:38.919178 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:41.410406 [debug] [Thread-2  ]: finished collecting timing info
23:55:41.411369 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8285E0>]}
23:55:41.411369 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.83s]
23:55:41.413376 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:41.414409 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:41.415371 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:55:41.417371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:41.419371 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:41.419371 [info ] [MainThread]: 
23:55:41.420409 [info ] [MainThread]: Finished running 5 table models in 8.69s.
23:55:41.421370 [debug] [MainThread]: Connection 'master' was properly closed.
23:55:41.422369 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:55:41.423372 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:55:41.424374 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:55:41.425370 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:55:41.440452 [info ] [MainThread]: 
23:55:41.441462 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:55:41.443463 [info ] [MainThread]: 
23:55:41.444462 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:55:41.446463 [error] [MainThread]:   Invalid date: '2012-05-30T00:00:00.000000Z'
23:55:41.448465 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:41.449464 [info ] [MainThread]: 
23:55:41.450464 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:55:41.452462 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:55:41.453463 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:41.454464 [info ] [MainThread]: 
23:55:41.455465 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:55:41.457478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA935EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8081C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCB9B1070>]}


============================== 2022-04-26 23:56:20.795479 | ca53a700-d8b9-4608-b0ee-9d6e0912bb4a ==============================
23:56:20.795479 [info ] [MainThread]: Running with dbt=1.0.4
23:56:20.796495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:56:20.797450 [debug] [MainThread]: Tracking: tracking
23:56:20.810453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964083D5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640843C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640843B50>]}
23:56:20.935449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:56:20.936449 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:56:20.949450 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:56:20.976110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A74F70>]}
23:56:20.988123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A58A00>]}
23:56:20.989091 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:56:20.992122 [info ] [MainThread]: 
23:56:20.993095 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:56:20.996097 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:56:20.997117 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:56:21.654540 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:56:21.655543 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:56:22.242887 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:56:22.243896 [info ] [MainThread]: 
23:56:22.250888 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.250888 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.251890 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:56:22.252889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:56:22.253903 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.253903 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.254909 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.255891 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.258894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:56:22.262922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:56:22.263888 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.264890 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.265888 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.266888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.266888 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.267891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.268891 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:56:22.268891 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:56:22.269942 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.270903 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.271912 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.271912 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.275921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:56:22.279887 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:56:22.280889 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.281889 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.281889 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.282887 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.283887 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.283887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.284888 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:56:22.285889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:56:22.285889 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.286888 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.287888 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.287888 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.291916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:56:22.294924 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:56:22.296736 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.297747 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.297747 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.297747 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.298746 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.299751 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:56:22.299751 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.300744 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.301369 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:56:22.301369 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.302380 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.306383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:56:22.307394 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.310751 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:56:22.310751 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.311715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.312716 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.312716 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.313718 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.314716 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:56:22.314716 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.316719 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:22.316719 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:56:22.317752 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.318714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.318714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.359718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:22.360716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.361715 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:56:22.361715 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.381751 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.382713 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.391713 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.399713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:56:22.400674 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.422091 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.425071 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:56:22.430091 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate as sellEndDate 
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,sellstartdate as sellStartDate-- see below
        --,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:56:23.147707 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:23.148706 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:56:23.670778 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name sellEndDate is ambiguous at [82:14]')
23:56:24.680817 [debug] [Thread-2  ]: finished collecting timing info
23:56:24.681813 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Column name sellEndDate is ambiguous at [82:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:56:24.681813 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BE2BE0>]}
23:56:24.682816 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.36s]
23:56:24.684817 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:56:24.684817 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.685849 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:56:24.686814 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:24.687818 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.687818 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.705816 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:24.706817 [debug] [Thread-2  ]: finished collecting timing info
23:56:24.707813 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.711853 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:56:25.277610 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:25.279538 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:56:26.199042 [debug] [Thread-1  ]: finished collecting timing info
23:56:26.199042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BE1940>]}
23:56:26.200048 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.88s]
23:56:26.202018 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:26.203012 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.204015 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:56:26.205015 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.206018 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.207015 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.221034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.222043 [debug] [Thread-1  ]: finished collecting timing info
23:56:26.223019 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.227014 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.228016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:56:26.233048 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:56:26.891285 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:56:28.186771 [debug] [Thread-1  ]: finished collecting timing info
23:56:28.187808 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:56:28.188766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641C36250>]}
23:56:28.188766 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.98s]
23:56:28.190766 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:28.558182 [debug] [Thread-2  ]: finished collecting timing info
23:56:28.558182 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A77760>]}
23:56:28.559182 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.87s]
23:56:28.561151 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:28.562146 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:56:28.563144 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:56:28.564149 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:56:28.566151 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:56:28.567145 [info ] [MainThread]: 
23:56:28.568144 [info ] [MainThread]: Finished running 5 table models in 7.57s.
23:56:28.570149 [debug] [MainThread]: Connection 'master' was properly closed.
23:56:28.570149 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:56:28.571147 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:56:28.572144 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:56:28.572144 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:56:28.583146 [info ] [MainThread]: 
23:56:28.584163 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:56:28.586165 [info ] [MainThread]: 
23:56:28.588147 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:56:28.590157 [error] [MainThread]:   Column name sellEndDate is ambiguous at [82:14]
23:56:28.591143 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:56:28.592144 [info ] [MainThread]: 
23:56:28.593145 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:56:28.595146 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:56:28.596144 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:56:28.597147 [info ] [MainThread]: 
23:56:28.598150 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:56:28.600157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BC90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640AF05B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A76700>]}


============================== 2022-04-26 23:57:35.973581 | 4f536f65-a96d-40ff-bc29-8d8bdb42c2bc ==============================
23:57:35.973581 [info ] [MainThread]: Running with dbt=1.0.4
23:57:35.974582 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:57:35.975592 [debug] [MainThread]: Tracking: tracking
23:57:35.988588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E91193E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E911B4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E911B4430>]}
23:57:36.116583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:57:36.117594 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:57:36.131600 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:57:36.166583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913E5F70>]}
23:57:36.180585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913C8A60>]}
23:57:36.181584 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:57:36.183586 [info ] [MainThread]: 
23:57:36.184584 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:36.186591 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:57:36.187584 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:36.995722 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:57:36.995722 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:37.631306 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:57:37.632307 [info ] [MainThread]: 
23:57:37.640314 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.641306 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:57:37.642312 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.643316 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.643316 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:57:37.666308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:57:37.670311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:57:37.693343 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.694307 [debug] [Thread-1  ]: finished collecting timing info
23:57:37.695306 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.733856 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.735823 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:57:37.740833 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,sellstartdate as sellStartDate-- see below
        --,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:57:39.228564 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:57:41.296161 [debug] [Thread-1  ]: finished collecting timing info
23:57:41.297158 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:57:41.297158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E914B4940>]}
23:57:41.298159 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.65s]
23:57:41.300152 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:57:41.303152 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:41.304158 [info ] [MainThread]: 
23:57:41.305157 [info ] [MainThread]: Finished running 1 table model in 5.12s.
23:57:41.306155 [debug] [MainThread]: Connection 'master' was properly closed.
23:57:41.306155 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:57:41.307157 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:57:41.307157 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:57:41.318154 [info ] [MainThread]: 
23:57:41.319163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:57:41.321152 [info ] [MainThread]: 
23:57:41.322151 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:57:41.324165 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:57:41.325158 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:57:41.326164 [info ] [MainThread]: 
23:57:41.328151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:57:41.330154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913B8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913B8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913E6A90>]}


============================== 2022-04-26 23:58:17.489967 | cfe37798-cc01-4bea-bf3f-a21aae4f3ba2 ==============================
23:58:17.489967 [info ] [MainThread]: Running with dbt=1.0.4
23:58:17.490967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:58:17.491978 [debug] [MainThread]: Tracking: tracking
23:58:17.506987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A147585E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1475A5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1475A5A30>]}
23:58:17.631003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:58:17.631967 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:58:17.645006 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:58:17.671546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477D6F70>]}
23:58:17.683511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477B9A60>]}
23:58:17.683511 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:58:17.686511 [info ] [MainThread]: 
23:58:17.688515 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:58:17.689514 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:58:17.690515 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:58:18.311708 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:58:18.311708 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:58:18.909706 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:58:18.910707 [info ] [MainThread]: 
23:58:18.919705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:58:18.920703 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:58:18.921705 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:58:18.922706 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:58:18.922706 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:58:18.950706 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:58:18.957704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:58:18.980707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:58:18.981704 [debug] [Thread-1  ]: finished collecting timing info
23:58:18.981704 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:58:19.018703 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:58:19.020704 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:58:19.025703 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:58:20.186041 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discontinuedDate at [84:14]')
23:58:21.660619 [debug] [Thread-1  ]: finished collecting timing info
23:58:21.661578 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: discontinuedDate at [84:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:58:21.661578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1478A0F10>]}
23:58:21.662616 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.74s]
23:58:21.664583 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:58:21.665581 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:58:21.666619 [info ] [MainThread]: 
23:58:21.667617 [info ] [MainThread]: Finished running 1 table model in 3.98s.
23:58:21.669172 [debug] [MainThread]: Connection 'master' was properly closed.
23:58:21.670169 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:58:21.670169 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:58:21.671169 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:58:21.682170 [info ] [MainThread]: 
23:58:21.683177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:58:21.685168 [info ] [MainThread]: 
23:58:21.686169 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:58:21.688169 [error] [MainThread]:   Unrecognized name: discontinuedDate at [84:14]
23:58:21.689053 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:58:21.690065 [info ] [MainThread]: 
23:58:21.691064 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:58:21.692081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477A8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477A8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477D7910>]}


============================== 2022-04-26 23:59:11.031081 | f003ff7a-01fa-4415-b767-0f3a4af85b1b ==============================
23:59:11.031081 [info ] [MainThread]: Running with dbt=1.0.4
23:59:11.032082 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:59:11.033052 [debug] [MainThread]: Tracking: tracking
23:59:11.048052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548695EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155486A5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155486A5310>]}
23:59:11.171087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:59:11.172087 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:59:11.184087 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:59:11.211051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488C5F10>]}
23:59:11.224052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488A9A90>]}
23:59:11.225052 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:59:11.229053 [info ] [MainThread]: 
23:59:11.231058 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:11.233054 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:59:11.233054 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:11.870398 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:59:11.871392 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:12.459781 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:59:12.460780 [info ] [MainThread]: 
23:59:12.469755 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.469755 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:59:12.470755 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.471755 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.471755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:59:12.500755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:59:12.505756 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:59:12.528791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.529759 [debug] [Thread-1  ]: finished collecting timing info
23:59:12.530794 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.568758 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.570756 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:59:12.577755 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,discontinueddate as discontinuedDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:59:14.002422 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:59:15.481329 [debug] [Thread-1  ]: finished collecting timing info
23:59:15.482326 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:15.482326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548994070>]}
23:59:15.483324 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.01s]
23:59:15.484327 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:59:15.486324 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:15.487361 [info ] [MainThread]: 
23:59:15.488326 [info ] [MainThread]: Finished running 1 table model in 4.26s.
23:59:15.489326 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:15.490328 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:59:15.490328 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:59:15.491326 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:59:15.504333 [info ] [MainThread]: 
23:59:15.505789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:15.506801 [info ] [MainThread]: 
23:59:15.508803 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:59:15.509800 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:59:15.510809 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:15.511809 [info ] [MainThread]: 
23:59:15.512799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:59:15.513820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548964700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548964B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488C79D0>]}


============================== 2022-04-26 23:59:52.028973 | c03ffff9-e971-4b9d-a8f7-520fe206ed61 ==============================
23:59:52.028973 [info ] [MainThread]: Running with dbt=1.0.4
23:59:52.029975 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:59:52.030974 [debug] [MainThread]: Tracking: tracking
23:59:52.046975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C187FEE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18804BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18804A90>]}
23:59:52.176032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:59:52.177010 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:59:52.191009 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:59:52.217973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A34F10>]}
23:59:52.229979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A18A30>]}
23:59:52.230974 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:59:52.233974 [info ] [MainThread]: 
23:59:52.235974 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:52.237974 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:59:52.237974 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:52.996888 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:59:52.996888 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:53.647331 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:59:53.648339 [info ] [MainThread]: 
23:59:53.655701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.656704 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:59:53.657700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.658705 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.659701 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:59:53.682743 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:59:53.685736 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:59:53.706734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.707713 [debug] [Thread-1  ]: finished collecting timing info
23:59:53.708700 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.743479 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.744482 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:59:53.749481 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,modifieddate as modifiedDate
        --,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:59:55.167572 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:59:57.277086 [debug] [Thread-1  ]: finished collecting timing info
23:59:57.278142 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:57.279099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18B04820>]}
23:59:57.280098 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.62s]
23:59:57.281100 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:59:57.283103 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:57.284104 [info ] [MainThread]: 
23:59:57.285108 [info ] [MainThread]: Finished running 1 table model in 5.05s.
23:59:57.287102 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:57.287102 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:59:57.288102 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:59:57.288102 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:59:57.299143 [info ] [MainThread]: 
23:59:57.300098 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:57.301097 [info ] [MainThread]: 
23:59:57.303104 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:59:57.304100 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:59:57.306099 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:57.307097 [info ] [MainThread]: 
23:59:57.308099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:59:57.309097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18AD4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18AD4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A36D00>]}


============================== 2022-04-27 00:00:25.712096 | 99f86e8a-00c3-4070-88ac-06e5073c402f ==============================
00:00:25.712096 [info ] [MainThread]: Running with dbt=1.0.4
00:00:25.713088 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:00:25.713088 [debug] [MainThread]: Tracking: tracking
00:00:25.728104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021B3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021D40A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021D4A00>]}
00:00:25.849088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:00:25.850088 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:00:25.863087 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:00:25.890102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B02405F70>]}
00:00:25.902088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023E8A60>]}
00:00:25.903093 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:00:25.905090 [info ] [MainThread]: 
00:00:25.907090 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:25.908090 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:00:25.909089 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:26.542693 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:00:26.542693 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:27.143218 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:00:27.144213 [info ] [MainThread]: 
00:00:27.152175 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.153177 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:00:27.155234 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.156181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.157191 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:00:27.178184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:00:27.183178 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:00:27.203211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.205175 [debug] [Thread-1  ]: finished collecting timing info
00:00:27.206175 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.242205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.243224 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:00:27.249204 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        --,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        --,cast(sellstartdate as date) as sellStartDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,modifieddate as modifiedDate
        --,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:00:28.776852 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellEndDate at [81:14]')
00:00:30.576718 [debug] [Thread-1  ]: finished collecting timing info
00:00:30.577717 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellEndDate at [81:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:00:30.578715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B024D4B20>]}
00:00:30.578715 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.42s]
00:00:30.580715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:00:30.582715 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:30.583717 [info ] [MainThread]: 
00:00:30.584756 [info ] [MainThread]: Finished running 1 table model in 4.68s.
00:00:30.585718 [debug] [MainThread]: Connection 'master' was properly closed.
00:00:30.586716 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:00:30.586716 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:00:30.587722 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:00:30.599720 [info ] [MainThread]: 
00:00:30.600720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:00:30.602721 [info ] [MainThread]: 
00:00:30.603735 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:00:30.605739 [error] [MainThread]:   Unrecognized name: sellEndDate at [81:14]
00:00:30.606739 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:00:30.607769 [info ] [MainThread]: 
00:00:30.608766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:00:30.609759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023D8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023D8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B02406A30>]}


============================== 2022-04-27 00:01:58.391987 | 6752875d-787d-4c6f-a8ae-b93299860ecd ==============================
00:01:58.391987 [info ] [MainThread]: Running with dbt=1.0.4
00:01:58.392990 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:01:58.393970 [debug] [MainThread]: Tracking: tracking
00:01:58.408952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B43A0>]}
00:01:58.528948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:01:58.529978 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:01:58.530984 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:01:58.542989 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:01:58.577978 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:01:58.581972 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:01:58.602949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564EEF10>]}
00:01:58.616962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8A60>]}
00:01:58.616962 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:01:58.619950 [info ] [MainThread]: 
00:01:58.620949 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:01:58.622951 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:01:58.622951 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:59.266474 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:01:59.266474 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:59.854958 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:01:59.855995 [info ] [MainThread]: 
00:01:59.862979 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.863957 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:01:59.864963 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.865965 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.865965 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:01:59.871961 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:01:59.875965 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:01:59.898966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.900965 [debug] [Thread-1  ]: finished collecting timing info
00:01:59.900965 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.936996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.937966 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:01:59.943959 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:03.300192 [debug] [Thread-1  ]: finished collecting timing info
00:02:03.301192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F565BDA00>]}
00:02:03.302204 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.44s]
00:02:03.304196 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:03.306198 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:03.307215 [info ] [MainThread]: 
00:02:03.308196 [info ] [MainThread]: Finished running 1 table model in 4.69s.
00:02:03.309197 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:03.310215 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:03.311244 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:03.311244 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:03.322203 [info ] [MainThread]: 
00:02:03.324197 [info ] [MainThread]: [32mCompleted successfully[0m
00:02:03.325196 [info ] [MainThread]: 
00:02:03.326195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:02:03.328195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564B8B80>]}


============================== 2022-04-27 00:02:14.376320 | e5694c9a-c13b-443b-9d50-d85819364958 ==============================
00:02:14.376320 [info ] [MainThread]: Running with dbt=1.0.4
00:02:14.377308 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:14.378322 [debug] [MainThread]: Tracking: tracking
00:02:14.392309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C56A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C5DC0>]}
00:02:14.517312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:02:14.518312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:02:14.527308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB0B0D0>]}
00:02:14.540323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AAD75B0>]}
00:02:14.541309 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:14.544308 [info ] [MainThread]: 
00:02:14.545312 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:14.546324 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:14.547344 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:15.174019 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:15.174019 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:15.775120 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:15.776082 [info ] [MainThread]: 
00:02:15.784081 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.785085 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:15.788082 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:15.789086 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.789086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:15.811116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:15.815116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:15.837088 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:15.839082 [debug] [Thread-1  ]: finished collecting timing info
00:02:15.839082 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.856110 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:16.426621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:16.428597 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:19.087919 [debug] [Thread-1  ]: finished collecting timing info
00:02:19.088919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AC1FE80>]}
00:02:19.089890 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.30s]
00:02:19.090897 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:19.092894 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:19.093890 [info ] [MainThread]: 
00:02:19.094921 [info ] [MainThread]: Finished running 1 table model in 4.55s.
00:02:19.096890 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:19.096890 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:19.097911 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:19.097911 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:19.117889 [info ] [MainThread]: 
00:02:19.119892 [info ] [MainThread]: [32mCompleted successfully[0m
00:02:19.121889 [info ] [MainThread]: 
00:02:19.122894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:02:19.124890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AAFC580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB68F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB68CA0>]}


============================== 2022-04-27 00:02:32.219837 | f46d6c41-5866-4ded-9824-b02f758052a3 ==============================
00:02:32.219837 [info ] [MainThread]: Running with dbt=1.0.4
00:02:32.220797 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:32.220797 [debug] [MainThread]: Tracking: tracking
00:02:32.234799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B41C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B4F40>]}
00:02:32.358799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:02:32.359834 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:02:32.372840 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:02:32.412798 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:02:32.432801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB5DF70>]}
00:02:32.446799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DAC7880>]}
00:02:32.446799 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:32.451800 [info ] [MainThread]: 
00:02:32.453801 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:32.455802 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:32.456802 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:33.099440 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:33.099440 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:33.705555 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:33.706512 [info ] [MainThread]: 
00:02:33.715515 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.716516 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:33.718513 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:33.718513 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.719538 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:33.724547 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:33.728514 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:33.747547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:33.749517 [debug] [Thread-1  ]: finished collecting timing info
00:02:33.750517 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.767537 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:34.430006 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:34.432046 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:35.545527 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
00:02:37.654873 [debug] [Thread-1  ]: finished collecting timing info
00:02:37.655869 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:37.656835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DBE28B0>]}
00:02:37.656835 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.94s]
00:02:37.658836 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:37.660835 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:37.660835 [info ] [MainThread]: 
00:02:37.661836 [info ] [MainThread]: Finished running 1 table model in 5.21s.
00:02:37.662838 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:37.663833 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:37.664832 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:37.664832 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:37.675866 [info ] [MainThread]: 
00:02:37.676832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:02:37.678831 [info ] [MainThread]: 
00:02:37.679833 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:02:37.681845 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
00:02:37.682833 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:37.684834 [info ] [MainThread]: 
00:02:37.685870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:02:37.686832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB06A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB12100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB6B8B0>]}


============================== 2022-04-27 00:02:52.680542 | 21fcc1f0-973d-4295-9f21-38e54095d6ae ==============================
00:02:52.680542 [info ] [MainThread]: Running with dbt=1.0.4
00:02:52.681537 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:52.682507 [debug] [MainThread]: Tracking: tracking
00:02:52.696509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9D4EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9E5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9E5130>]}
00:02:52.818012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:02:52.818012 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:02:52.833013 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:02:52.866979 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:02:52.881014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC7BFD0>]}
00:02:52.894018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EBE6AC0>]}
00:02:52.894018 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:52.895978 [info ] [MainThread]: 
00:02:52.897981 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:52.898979 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:52.899990 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:53.640205 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:53.640205 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:54.276998 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:54.278001 [info ] [MainThread]: 
00:02:54.284999 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.284999 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:54.287004 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.287004 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.288000 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:54.293999 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:54.298035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:54.318036 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.320083 [debug] [Thread-1  ]: finished collecting timing info
00:02:54.320999 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.337033 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:54.944570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.945537 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:56.107207 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2012-05-30T00:00:00.000000Z'")
00:02:58.198381 [debug] [Thread-1  ]: finished collecting timing info
00:02:58.198381 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2012-05-30T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:58.199382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58ED140D0>]}
00:02:58.200382 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.91s]
00:02:58.202390 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:58.204380 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:58.205381 [info ] [MainThread]: 
00:02:58.207381 [info ] [MainThread]: Finished running 1 table model in 5.31s.
00:02:58.208382 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:58.209381 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:58.210382 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:58.210382 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:58.221382 [info ] [MainThread]: 
00:02:58.222379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:02:58.223399 [info ] [MainThread]: 
00:02:58.224415 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:02:58.226399 [error] [MainThread]:   Invalid date: '2012-05-30T00:00:00.000000Z'
00:02:58.227392 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:58.229379 [info ] [MainThread]: 
00:02:58.230381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:02:58.232380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC54220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC317C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC26EE0>]}


============================== 2022-04-27 00:07:02.686996 | b32aa472-700a-4242-a946-62a3cec65ab5 ==============================
00:07:02.686996 [info ] [MainThread]: Running with dbt=1.0.4
00:07:02.687998 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:07:02.689000 [debug] [MainThread]: Tracking: tracking
00:07:02.704003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963B3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963D4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963D4AC0>]}
00:07:02.865999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:07:02.867000 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:07:02.868002 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:07:02.885999 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:07:02.924034 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:07:02.927012 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:07:02.943001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296605F70>]}
00:07:02.957003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222965E6A60>]}
00:07:02.957003 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:07:02.959999 [info ] [MainThread]: 
00:07:02.961999 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:07:02.963030 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:07:02.964004 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:07:03.735999 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:07:03.735999 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:07:04.358000 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:07:04.359030 [info ] [MainThread]: 
00:07:04.367000 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.368013 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:07:04.369001 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:07:04.370002 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.371000 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:07:04.378049 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:07:04.382035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:07:04.413002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:07:04.414004 [debug] [Thread-1  ]: finished collecting timing info
00:07:04.415002 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.441002 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:07:05.013563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:07:05.014564 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as TIMESTAMP_NTZ) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:07:05.924564 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: TIMESTAMP_NTZ at [34:30]')
00:07:07.808218 [debug] [Thread-1  ]: finished collecting timing info
00:07:07.809214 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Type not found: TIMESTAMP_NTZ at [34:30]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:07:07.810217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296702A30>]}
00:07:07.811217 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.44s]
00:07:07.813241 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:07:07.815230 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:07:07.816237 [info ] [MainThread]: 
00:07:07.817270 [info ] [MainThread]: Finished running 1 table model in 4.86s.
00:07:07.819241 [debug] [MainThread]: Connection 'master' was properly closed.
00:07:07.819241 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:07:07.820245 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:07:07.820245 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:07:07.830219 [info ] [MainThread]: 
00:07:07.831217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:07:07.833219 [info ] [MainThread]: 
00:07:07.834218 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:07:07.836218 [error] [MainThread]:   Type not found: TIMESTAMP_NTZ at [34:30]
00:07:07.837218 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:07:07.838219 [info ] [MainThread]: 
00:07:07.839219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:07:07.840218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229662F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296658DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296640220>]}


============================== 2022-04-27 00:08:18.567814 | 6cb08608-f515-41f1-9de3-d6753b15e231 ==============================
00:08:18.567814 [info ] [MainThread]: Running with dbt=1.0.4
00:08:18.568811 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:08:18.568811 [debug] [MainThread]: Tracking: tracking
00:08:18.582811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7243E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7264670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7264AF0>]}
00:08:18.721317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:08:18.722316 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:08:18.735317 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:08:18.763316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7498F70>]}
00:08:18.776318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E747AA60>]}
00:08:18.777337 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:08:18.779319 [info ] [MainThread]: 
00:08:18.780319 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:08:18.782323 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:08:18.783319 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:19.486316 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:08:19.487366 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:20.067984 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:08:20.068986 [info ] [MainThread]: 
00:08:20.076991 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.076991 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:08:20.078988 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.079991 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.080995 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:08:20.108025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:08:20.112026 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:08:20.135042 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.137116 [debug] [Thread-1  ]: finished collecting timing info
00:08:20.137116 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.153181 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:08:20.754741 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.756672 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate::timestamp_ntz as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:08:21.048299 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ":" at [34:21]')
00:08:21.357533 [debug] [Thread-1  ]: finished collecting timing info
00:08:21.358569 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Syntax error: Expected ")" but got ":" at [34:21]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:08:21.359527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E758ACA0>]}
00:08:21.359527 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 1.28s]
00:08:21.361529 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:08:21.362529 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:08:21.364548 [info ] [MainThread]: 
00:08:21.365530 [info ] [MainThread]: Finished running 1 table model in 2.58s.
00:08:21.366550 [debug] [MainThread]: Connection 'master' was properly closed.
00:08:21.367544 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:08:21.367544 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:08:21.368530 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:08:21.378530 [info ] [MainThread]: 
00:08:21.379528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:08:21.381534 [info ] [MainThread]: 
00:08:21.383527 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:08:21.385531 [error] [MainThread]:   Syntax error: Expected ")" but got ":" at [34:21]
00:08:21.386550 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:08:21.387530 [info ] [MainThread]: 
00:08:21.388529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:08:21.389531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7468B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7468F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7499610>]}


============================== 2022-04-27 00:12:25.034181 | dda5ca89-220c-4235-a314-2839d5a2f041 ==============================
00:12:25.034181 [info ] [MainThread]: Running with dbt=1.0.4
00:12:25.035183 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:12:25.036182 [debug] [MainThread]: Tracking: tracking
00:12:25.052210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A882E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A8A5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A8A5640>]}
00:12:25.173181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:12:25.173181 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:12:25.187181 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:12:25.216968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAD5F70>]}
00:12:25.230996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAB8A60>]}
00:12:25.231965 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:12:25.233968 [info ] [MainThread]: 
00:12:25.235965 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:12:25.236967 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:12:25.237967 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:12:25.913124 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:12:25.914123 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:12:26.491122 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:12:26.492141 [info ] [MainThread]: 
00:12:26.499123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.499123 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:12:26.500123 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:12:26.501127 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.501127 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:12:26.527154 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:12:26.531129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:12:26.553912 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:12:26.554912 [debug] [Thread-1  ]: finished collecting timing info
00:12:26.555929 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.572946 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:12:27.194050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:12:27.196052 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:12:29.956183 [debug] [Thread-1  ]: finished collecting timing info
00:12:29.957183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAD7100>]}
00:12:29.958183 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.46s]
00:12:29.959183 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:12:29.961182 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:12:29.961182 [info ] [MainThread]: 
00:12:29.962182 [info ] [MainThread]: Finished running 1 table model in 4.73s.
00:12:29.963187 [debug] [MainThread]: Connection 'master' was properly closed.
00:12:29.964187 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:12:29.964187 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:12:29.965183 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:12:29.977212 [info ] [MainThread]: 
00:12:29.978193 [info ] [MainThread]: [32mCompleted successfully[0m
00:12:29.980184 [info ] [MainThread]: 
00:12:29.981184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:12:29.983191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAA8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAA8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAB8910>]}


============================== 2022-04-27 00:13:08.498738 | 51172ace-ac48-4ec3-a5c4-e2a507270015 ==============================
00:13:08.498738 [info ] [MainThread]: Running with dbt=1.0.4
00:13:08.499708 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:13:08.500709 [debug] [MainThread]: Tracking: tracking
00:13:08.514713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163C3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163E4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163E4A30>]}
00:13:08.659705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:13:08.659705 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:13:08.660680 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:13:08.673706 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:13:08.688675 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:13:08.710674 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:13:08.726232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0166860D0>]}
00:13:08.739224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0165F6A60>]}
00:13:08.740195 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:13:08.743206 [info ] [MainThread]: 
00:13:08.744245 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:08.747198 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:13:08.747198 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:09.369229 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:13:09.370201 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:09.963874 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:13:09.964904 [info ] [MainThread]: 
00:13:09.972844 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:13:09.973852 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:13:09.976847 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:13:09.977867 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:13:09.978845 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:13:09.985844 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:13:09.988847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:13:10.013884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:13:10.015848 [debug] [Thread-1  ]: finished collecting timing info
00:13:10.015848 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:13:10.035847 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:13:10.635732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:13:10.636770 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:13:13.340174 [debug] [Thread-1  ]: finished collecting timing info
00:13:13.340174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016708A00>]}
00:13:13.341174 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.36s]
00:13:13.343164 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:13:13.346143 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:13.347140 [info ] [MainThread]: 
00:13:13.348140 [info ] [MainThread]: Finished running 1 table model in 4.60s.
00:13:13.349176 [debug] [MainThread]: Connection 'master' was properly closed.
00:13:13.349176 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:13:13.350141 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:13:13.350141 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:13:13.359869 [info ] [MainThread]: 
00:13:13.360878 [info ] [MainThread]: [32mCompleted successfully[0m
00:13:13.361880 [info ] [MainThread]: 
00:13:13.363907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:13:13.364881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016653B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016653280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0165F67C0>]}


============================== 2022-04-27 00:13:45.692651 | 10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6 ==============================
00:13:45.692651 [info ] [MainThread]: Running with dbt=1.0.4
00:13:45.693652 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:13:45.694660 [debug] [MainThread]: Tracking: tracking
00:13:45.733652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4EB0>]}
00:13:46.375720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:13:46.376721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:13:46.384718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445390D0>]}
00:13:46.397737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026144505580>]}
00:13:46.397737 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:13:46.400721 [info ] [MainThread]: 
00:13:46.401719 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:46.403725 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:13:46.403725 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:47.176383 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:13:47.177386 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:47.756941 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:13:47.757942 [info ] [MainThread]: 
00:13:47.764941 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.765941 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:13:47.766940 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.767945 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.767945 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.790970 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:13:47.794941 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:13:47.812973 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.814940 [debug] [Thread-1  ]: finished collecting timing info
00:13:47.814940 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.850976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.851938 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:13:47.856936 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
00:13:48.494200 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
00:13:49.793350 [debug] [Thread-1  ]: finished collecting timing info
00:13:49.794353 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
00:13:49.795349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445F9550>]}
00:13:49.796350 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.03s]
00:13:49.797351 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:49.799349 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:49.800350 [info ] [MainThread]: 
00:13:49.801354 [info ] [MainThread]: Finished running 1 table model in 3.40s.
00:13:49.802350 [debug] [MainThread]: Connection 'master' was properly closed.
00:13:49.803352 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:13:49.804352 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:13:49.805353 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:13:49.818350 [info ] [MainThread]: 
00:13:49.820349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:13:49.822352 [info ] [MainThread]: 
00:13:49.823350 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
00:13:49.825354 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
00:13:49.827365 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
00:13:49.828367 [info ] [MainThread]: 
00:13:49.829351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:13:49.831353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445054F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614452C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614464E0A0>]}


============================== 2022-04-27 01:33:23.071706 | 3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee ==============================
01:33:23.071706 [info ] [MainThread]: Running with dbt=1.0.4
01:33:23.072755 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
01:33:23.073709 [debug] [MainThread]: Tracking: tracking
01:33:23.088712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AD3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AF4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AF48B0>]}
01:33:23.278739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
01:33:23.279740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
01:33:23.287733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7D390D0>]}
01:33:23.301741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7B635E0>]}
01:33:23.302705 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
01:33:23.304717 [info ] [MainThread]: 
01:33:23.306735 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:33:23.308708 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
01:33:23.309706 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:33:25.513257 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
01:33:25.514257 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:33:26.202772 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
01:33:26.203771 [info ] [MainThread]: 
01:33:26.212773 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.213769 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
01:33:26.214771 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.215779 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.216789 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.241773 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
01:33:26.244774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
01:33:26.267773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.268773 [debug] [Thread-1  ]: finished collecting timing info
01:33:26.269771 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.306805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.308770 [debug] [Thread-1  ]: Opening a new connection, currently in state init
01:33:26.315769 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
01:33:27.187656 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
01:33:28.616998 [debug] [Thread-1  ]: finished collecting timing info
01:33:28.617957 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
01:33:28.618955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7DE06D0>]}
01:33:28.619955 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.40s]
01:33:28.620957 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:28.622961 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:33:28.623956 [info ] [MainThread]: 
01:33:28.624956 [info ] [MainThread]: Finished running 1 table model in 5.32s.
01:33:28.625958 [debug] [MainThread]: Connection 'master' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
01:33:28.639957 [info ] [MainThread]: 
01:33:28.640958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
01:33:28.641957 [info ] [MainThread]: 
01:33:28.642955 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
01:33:28.643957 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
01:33:28.643957 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
01:33:28.644981 [info ] [MainThread]: 
01:33:28.645955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
01:33:28.646955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7B634C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7D2A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7E4F1F0>]}


============================== 2022-04-27 14:13:23.387145 | 92004c19-4ba0-4fed-9317-7c279b47f70a ==============================
14:13:23.387145 [info ] [MainThread]: Running with dbt=1.0.4
14:13:23.389073 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:13:23.390077 [debug] [MainThread]: Tracking: tracking
14:13:23.406647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E10E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E34430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E34AF0>]}
14:13:24.248390 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:13:24.249365 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:13:24.249365 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:13:24.250342 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:13:24.250342 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:13:24.251335 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:13:24.252296 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:13:24.252296 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:13:24.253281 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:13:24.254247 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:13:24.255225 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:13:24.255225 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:13:24.256201 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:13:24.256201 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:13:24.257177 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:13:24.257177 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:13:24.258154 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:13:24.258154 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:13:24.258154 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:13:24.259130 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:13:24.259130 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:13:24.260109 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:13:24.260109 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:13:24.274755 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:13:24.320683 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:13:24.323595 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:13:24.326538 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:13:24.329468 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:13:24.332397 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:13:24.341186 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:13:24.342164 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:13:24.349001 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:13:24.350953 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:13:24.353881 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:13:24.356811 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:13:24.359740 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:13:24.366576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:13:24.368502 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:13:24.373410 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:13:24.379269 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:13:24.392914 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:13:24.394867 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:13:24.422237 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_CreditCard' in the 'models' section of file 'models\marts\dim_CreditCards.yml'
14:13:24.496420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A069790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A093040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A0936A0>]}


============================== 2022-04-27 14:14:46.385779 | 1ac5ba0a-9bab-4d31-91e3-5a61edaace24 ==============================
14:14:46.385779 [info ] [MainThread]: Running with dbt=1.0.4
14:14:46.386756 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:14:46.386756 [debug] [MainThread]: Tracking: tracking
14:14:46.403364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DCDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DD3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DD3220>]}
14:14:46.529348 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:14:46.530328 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:14:46.530328 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:14:46.531304 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:14:46.532253 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:14:46.532253 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:14:46.533239 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:14:46.533239 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:14:46.535183 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:14:46.535183 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:14:46.536193 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:14:46.537145 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:14:46.537145 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:14:46.538113 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:14:46.538113 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:14:46.539092 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:14:46.539092 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:14:46.540072 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:14:46.540072 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:14:46.542019 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:14:46.555690 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:14:46.576195 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:14:46.598657 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:14:46.600613 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:14:46.604525 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:14:46.607448 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:14:46.615260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:14:46.617214 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:14:46.623072 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:14:46.625028 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:14:46.628936 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:14:46.631860 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:14:46.634790 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:14:46.640649 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:14:46.642602 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:14:46.645551 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:14:46.648462 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:14:46.654320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:14:46.656275 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:14:46.742198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA008760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA07DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA07DDF0>]}


============================== 2022-04-27 14:15:19.651730 | 3c2412e8-034c-40a2-a725-1268add661a4 ==============================
14:15:19.651730 [info ] [MainThread]: Running with dbt=1.0.4
14:15:19.652702 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:15:19.652702 [debug] [MainThread]: Tracking: tracking
14:15:19.677114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C33A0>]}
14:15:19.817730 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:15:19.817730 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:15:19.818710 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:15:19.819688 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:15:19.820661 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:15:19.820661 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:15:19.821639 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:15:19.822614 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:15:19.824565 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:15:19.826518 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:15:19.826518 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:15:19.827498 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:15:19.827498 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:15:19.828472 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:15:19.828472 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:15:19.829448 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:15:19.829448 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:15:19.830425 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:15:19.830425 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:15:19.831405 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:15:19.831405 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:15:19.832377 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:19.833354 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:15:19.847025 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:15:19.884132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:15:19.886084 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:15:19.891943 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:15:19.896832 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:15:19.901722 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:15:19.909521 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:15:19.912451 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:15:19.919286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:15:19.921252 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:15:19.925145 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:15:19.928074 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:15:19.931980 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:19.938819 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:19.940769 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:15:19.945651 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:15:19.951512 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:19.961279 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:19.963230 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:15:20.073573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2AF8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2B59D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2B59910>]}


============================== 2022-04-27 14:15:49.951783 | eeee387c-aa23-45d1-b1fb-e419b8b443b9 ==============================
14:15:49.951783 [info ] [MainThread]: Running with dbt=1.0.4
14:15:49.952772 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:15:49.953736 [debug] [MainThread]: Tracking: tracking
14:15:49.970342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04430>]}
14:15:50.150015 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:15:50.150992 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:15:50.151969 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:15:50.152942 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:15:50.152942 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:15:50.153933 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:15:50.153933 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:15:50.154895 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:15:50.155871 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:15:50.156847 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:15:50.157838 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:15:50.157838 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:15:50.158801 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:15:50.158801 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:15:50.159785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:15:50.159785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:15:50.160753 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:15:50.160753 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:15:50.161731 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:15:50.161731 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:15:50.162707 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:15:50.162707 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:15:50.163683 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:50.178330 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:15:50.194930 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:15:50.224262 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:15:50.226181 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:15:50.230088 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:15:50.233014 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:15:50.241802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:15:50.244353 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:15:50.252172 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:15:50.255103 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:15:50.258031 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:15:50.261937 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:15:50.265844 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:50.272679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:50.274630 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:15:50.278538 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:15:50.282444 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:50.290254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:50.292207 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:15:50.452384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeee387c-aa23-45d1-b1fb-e419b8b443b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE708F0D0>]}
14:15:50.473836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeee387c-aa23-45d1-b1fb-e419b8b443b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6E8F340>]}
14:15:50.473836 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:50.478720 [info ] [MainThread]: 
14:15:50.480677 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:50.482627 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:50.482627 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:52.107335 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:52.109292 [info ] [MainThread]: 
14:15:52.168711 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.168711 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.169697 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:52.170688 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:52.170688 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.171652 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.171652 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.172631 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.175592 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:52.178521 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:52.179465 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.179465 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.180441 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.181418 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.182397 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.183378 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.184347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:52.185322 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:52.186305 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.186305 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.187301 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.187301 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.193168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:52.196098 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:52.198016 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.198995 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.198995 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.199983 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.200947 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.200947 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:52.201922 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.202898 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.202898 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:52.203877 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.204856 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.207819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:52.208772 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.211722 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:52.212681 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.213642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.213642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.213642 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.214625 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:52.215593 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.216576 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.216576 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.217576 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.217576 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:52.222468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:52.222468 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.223405 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.224382 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.227310 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:52.228289 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.229278 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.230242 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:52.230242 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.230242 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.231220 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.232229 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.233169 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.236135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:52.237077 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:52.237077 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.238053 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.239036 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.255665 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:52.255665 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.256642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.258558 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:15:52.258558 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.258558 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.259539 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.259539 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:15:52.260511 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.281052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:52.281052 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.282972 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.282972 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:52.283947 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.283947 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.296649 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:52.363552 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.364528 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.365501 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.366481 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.366481 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.367457 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:52.368445 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.368445 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.388939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:52.488061 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.489036 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.489036 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.490010 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.624742 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.625716 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.625716 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.626696 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.627669 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.628648 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:52.628648 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.629622 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.683366 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:52.691159 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.691159 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.692121 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.693131 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.694071 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:15:52.707745 [info ] [MainThread]: Done.
14:15:52.708741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6E8F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D5BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D5B190>]}


============================== 2022-04-27 14:16:02.354979 | 9141af10-df57-4088-92a3-376eef45e06a ==============================
14:16:02.354979 [info ] [MainThread]: Running with dbt=1.0.4
14:16:02.354979 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:16:02.356927 [debug] [MainThread]: Tracking: tracking
14:16:02.378414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580D9EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DA4EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DA4220>]}
14:16:02.515138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:16:02.516114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:16:02.523948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580FFE0D0>]}
14:16:02.537580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580F0E6D0>]}
14:16:02.538561 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:16:02.542466 [info ] [MainThread]: 
14:16:02.543441 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:16:02.545423 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:16:02.546368 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:16:03.130566 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:16:03.131545 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:16:03.821598 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:16:03.823540 [info ] [MainThread]: 
14:16:03.831354 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.832329 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.833304 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:16:03.834281 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:16:03.835256 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.836245 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.837228 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.837228 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.842094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:16:03.846973 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:16:03.848474 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.848474 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.849448 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.851404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.852382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.853358 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.854332 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:16:03.855317 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:16:03.856301 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.856301 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.857263 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.857263 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.861169 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:16:03.865076 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:16:03.867035 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.868003 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.868980 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.869958 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.869958 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.870932 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.871908 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:16:03.872902 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:16:03.872902 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.873863 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.873863 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.874838 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.878741 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:16:03.882652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:16:03.884605 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.884605 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.885581 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.886555 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.887552 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.888524 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.888524 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:16:03.889485 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:16:03.890475 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.890475 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.892417 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.892417 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.896328 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:16:03.899251 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:16:03.901211 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.901211 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.902185 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.903156 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.904135 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.904135 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.905113 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:16:03.906086 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:16:03.907063 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.909020 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:03.909020 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.909996 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.914876 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:16:03.915858 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.946124 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.957840 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:03.958817 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.959811 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:16:03.960769 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:16:03.961746 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.962735 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:16:03.963699 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.964679 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:16:03.989090 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:16:04.007644 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:04.032069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:16:04.033027 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:16:04.034032 [debug] [Thread-1  ]: finished collecting timing info
14:16:04.034995 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:16:04.039868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:16:04.041820 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:16:04.617954 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:16:04.618933 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:16:07.243977 [debug] [Thread-2  ]: finished collecting timing info
14:16:07.244923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810C1A30>]}
14:16:07.244923 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.34s]
14:16:07.247857 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:07.247857 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.248834 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:16:07.250786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.250786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.251765 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.275194 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.277154 [debug] [Thread-2  ]: finished collecting timing info
14:16:07.278126 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.281088 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:16:07.727346 [debug] [Thread-1  ]: finished collecting timing info
14:16:07.728292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810986D0>]}
14:16:07.729289 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.77s]
14:16:07.731221 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:16:07.731221 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.732199 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:16:07.734153 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.734153 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.735159 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.756610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.757641 [debug] [Thread-1  ]: finished collecting timing info
14:16:07.758567 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.762470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.763482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:16:07.769305 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            --,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:16:07.826920 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.828873 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:16:08.378642 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:16:09.162142 [debug] [Thread-1  ]: finished collecting timing info
14:16:09.163122 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:16:09.163122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5821AEE50>]}
14:16:09.164097 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.43s]
14:16:09.166070 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:11.164036 [debug] [Thread-2  ]: finished collecting timing info
14:16:11.165012 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DF1700>]}
14:16:11.165991 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.92s]
14:16:11.167944 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:11.169896 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:16:11.169896 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:16:11.171851 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:16:11.174778 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:16:11.176734 [info ] [MainThread]: 
14:16:11.177709 [info ] [MainThread]: Finished running 5 table models in 8.63s.
14:16:11.178686 [debug] [MainThread]: Connection 'master' was properly closed.
14:16:11.179661 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:16:11.180637 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:16:11.180637 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:16:11.181615 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:16:11.232011 [info ] [MainThread]: 
14:16:11.232986 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:16:11.234939 [info ] [MainThread]: 
14:16:11.235916 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:16:11.236893 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:16:11.238849 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:16:11.239825 [info ] [MainThread]: 
14:16:11.240798 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:16:11.243730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810A6E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580F0E1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5821A2A90>]}


============================== 2022-04-27 14:17:49.677058 | 35ed8691-bb7c-4f6d-9121-72249556c0a3 ==============================
14:17:49.677058 [info ] [MainThread]: Running with dbt=1.0.4
14:17:49.678022 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:17:49.678998 [debug] [MainThread]: Tracking: tracking
14:17:49.692670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F4EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F54D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F54340>]}
14:17:49.812805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:17:49.812805 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:17:49.825500 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:17:49.855748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:17:49.885044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76823A0D0>]}
14:17:49.898717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7680A3B20>]}
14:17:49.899685 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:17:49.902616 [info ] [MainThread]: 
14:17:49.904574 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:49.906526 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:17:49.906526 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:50.479865 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:17:50.480853 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:51.025392 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:17:51.026368 [info ] [MainThread]: 
14:17:51.035156 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.036134 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.037112 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:51.038092 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:51.038092 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.039081 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.040043 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.040043 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.042966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:51.045933 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:51.046877 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.047852 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.047852 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.048829 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.048829 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.049806 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.050786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:51.051758 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:51.051758 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.052740 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.053714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.053714 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.057619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:51.061557 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:51.062501 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.063484 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.064455 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.064455 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.065462 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.066408 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.067381 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:51.068357 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:51.068357 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.069335 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.070309 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.071286 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.074218 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:51.077180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:51.079101 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.080079 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.080079 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.080079 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.081053 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:51.082028 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.082028 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.083002 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.083981 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.084960 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:51.088868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:51.089839 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.090825 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.093780 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:51.094741 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.095715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.096675 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.096675 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.097668 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.098630 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:51.098630 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.099608 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.100637 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:17:51.100637 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.103513 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.106475 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:51.107416 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.108395 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.114287 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.127958 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.127958 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.128902 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.130853 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:17:51.130853 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.131833 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.132816 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.133797 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.155266 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:51.156247 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:17:51.182609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.184565 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.186512 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.189473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:51.747865 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.748842 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.750795 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:17:51.750795 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:17:54.500963 [debug] [Thread-1  ]: finished collecting timing info
14:17:54.501923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7682B9A60>]}
14:17:54.502897 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.37s]
14:17:54.504868 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:17:54.505840 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.505840 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:17:54.507782 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:54.507782 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.508762 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.525376 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:54.527311 [debug] [Thread-1  ]: finished collecting timing info
14:17:54.527311 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.530240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:54.686478 [debug] [Thread-2  ]: finished collecting timing info
14:17:54.687480 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D768311B80>]}
14:17:54.688432 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.58s]
14:17:54.690404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:54.691366 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.692338 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:17:54.693349 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.694310 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.694310 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.721638 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.726515 [debug] [Thread-2  ]: finished collecting timing info
14:17:54.727492 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.731399 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.733352 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:54.740189 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:17:55.068299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:55.070255 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:17:55.325304 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:17:56.611121 [debug] [Thread-2  ]: finished collecting timing info
14:17:56.612098 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:17:56.613097 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7682B8970>]}
14:17:56.614052 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.92s]
14:17:56.615035 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:58.058295 [debug] [Thread-1  ]: finished collecting timing info
14:17:58.059275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767FA2F40>]}
14:17:58.059275 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.55s]
14:17:58.061229 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:58.063194 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:58.063194 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:17:58.065148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:58.067086 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:58.068062 [info ] [MainThread]: 
14:17:58.069057 [info ] [MainThread]: Finished running 5 table models in 8.16s.
14:17:58.070016 [debug] [MainThread]: Connection 'master' was properly closed.
14:17:58.070992 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:17:58.071969 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:17:58.071969 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:17:58.072945 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:17:58.090524 [info ] [MainThread]: 
14:17:58.091498 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:17:58.093450 [info ] [MainThread]: 
14:17:58.094432 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:17:58.095402 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:17:58.096379 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:17:58.097357 [info ] [MainThread]: 
14:17:58.098334 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:17:58.100288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76816FF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7680A3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76833A7F0>]}


============================== 2022-04-27 14:18:35.200902 | 994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe ==============================
14:18:35.200902 [info ] [MainThread]: Running with dbt=1.0.4
14:18:35.201847 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:35.202821 [debug] [MainThread]: Tracking: tracking
14:18:35.217472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFC2E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFE5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFE53A0>]}
14:18:35.349893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:18:35.349893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:18:35.361581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D23F0D0>]}
14:18:35.380136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D059700>]}
14:18:35.380136 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:35.383069 [info ] [MainThread]: 
14:18:35.384043 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:35.385998 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:18:35.386976 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:35.951763 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:18:35.952762 [info ] [MainThread]: 
14:18:35.961526 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.962506 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:18:35.963482 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.963482 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.967391 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:18:35.968367 [debug] [Thread-1  ]: finished collecting timing info
14:18:35.969345 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.970318 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:35.971332 [info ] [MainThread]: 
14:18:35.972270 [info ] [MainThread]: Finished running  in 0.59s.
14:18:35.973247 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:35.973247 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:18:35.974225 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories' was properly closed.
14:18:35.986952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D130DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D059CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D0596D0>]}


============================== 2022-04-27 14:18:58.631773 | 07ae3af3-bf10-4e00-8ce1-c376b089a408 ==============================
14:18:58.631773 [info ] [MainThread]: Running with dbt=1.0.4
14:18:58.632750 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_CountryRegions'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:58.633732 [debug] [MainThread]: Tracking: tracking
14:18:58.649352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472C9EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472CA4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472CA4220>]}
14:18:58.765554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:18:58.766531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:18:58.774342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ae3af3-bf10-4e00-8ce1-c376b089a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472EFF0D0>]}
14:18:58.787037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ae3af3-bf10-4e00-8ce1-c376b089a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D196D0>]}
14:18:58.788014 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:58.789969 [info ] [MainThread]: 
14:18:58.791922 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:58.793873 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:18:58.793873 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:59.334961 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:18:59.335935 [info ] [MainThread]: 
14:18:59.343748 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.344726 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:18:59.345702 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.345702 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.350619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:18:59.351559 [debug] [Thread-1  ]: finished collecting timing info
14:18:59.352533 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.354488 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:59.355466 [info ] [MainThread]: 
14:18:59.356441 [info ] [MainThread]: Finished running  in 0.56s.
14:18:59.357417 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:59.358392 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:18:59.359378 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions' was properly closed.
14:18:59.373048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472DF0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D19B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D19730>]}


============================== 2022-04-27 14:19:19.723407 | cbb866cf-da66-472b-a933-a900f41cda77 ==============================
14:19:19.723407 [info ] [MainThread]: Running with dbt=1.0.4
14:19:19.724384 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:19:19.724384 [debug] [MainThread]: Tracking: tracking
14:19:19.741965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B6F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B75BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B75B50>]}
14:19:19.871870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:19:19.872847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:19:19.880623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90DD00D0>]}
14:19:19.893319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90CB66A0>]}
14:19:19.894295 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:19:19.896248 [info ] [MainThread]: 
14:19:19.897225 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:19.899181 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:19:19.900171 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:20.484522 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:19:20.485465 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:21.033638 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:19:21.034620 [info ] [MainThread]: 
14:19:21.042430 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.043409 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:19:21.045366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.045366 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.046376 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.070776 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:21.073710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:21.074661 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:21.077616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:21.097114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.099071 [debug] [Thread-1  ]: finished collecting timing info
14:19:21.099071 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.133276 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.135197 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:19:21.140111 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:19:21.698047 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:19:22.057163 [debug] [Thread-1  ]: finished collecting timing info
14:19:22.058176 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:19:22.059148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90EA3790>]}
14:19:22.059148 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.01s]
14:19:22.061069 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:22.063038 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:22.064023 [info ] [MainThread]: 
14:19:22.064971 [info ] [MainThread]: Finished running 1 table model in 2.17s.
14:19:22.065950 [debug] [MainThread]: Connection 'master' was properly closed.
14:19:22.066924 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:19:22.067899 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:19:22.067899 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:19:22.081570 [info ] [MainThread]: 
14:19:22.082548 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:19:22.084511 [info ] [MainThread]: 
14:19:22.085476 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:19:22.087427 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:19:22.088408 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:19:22.089382 [info ] [MainThread]: 
14:19:22.091356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:19:22.092312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90EAA1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90CB61C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90E4CA90>]}


============================== 2022-04-27 14:32:08.743710 | 6275035c-351d-4be4-b6db-072c2fedc771 ==============================
14:32:08.743710 [info ] [MainThread]: Running with dbt=1.0.4
14:32:08.744687 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:32:08.745652 [debug] [MainThread]: Tracking: tracking
14:32:08.760294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBAFFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBB05EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBB05220>]}
14:32:08.907727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
14:32:08.908705 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:32:08.908705 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:32:08.909682 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:32:08.910659 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:32:08.927261 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:32:08.962411 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:32:08.964368 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:32:08.972177 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:32:08.974129 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:32:08.982921 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:32:08.984874 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:32:08.991709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:32:09.083501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBE910A0>]}
14:32:09.103030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD24850>]}
14:32:09.103030 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:32:09.106970 [info ] [MainThread]: 
14:32:09.108890 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:32:09.110843 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:32:09.111819 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:11.003684 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:32:11.003684 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:12.299422 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:32:12.300398 [info ] [MainThread]: 
14:32:12.308207 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.309185 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:32:12.311146 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:12.312112 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.313090 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.319926 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:32:12.323866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:32:12.341443 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:12.342384 [debug] [Thread-1  ]: finished collecting timing info
14:32:12.342384 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.360976 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:32:13.660807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:13.662709 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:32:16.894227 [debug] [Thread-1  ]: finished collecting timing info
14:32:16.896182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD8D220>]}
14:32:16.896182 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.59s]
14:32:16.899075 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:16.901031 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:32:16.902004 [info ] [MainThread]: 
14:32:16.902984 [info ] [MainThread]: Finished running 1 table model in 7.79s.
14:32:16.903960 [debug] [MainThread]: Connection 'master' was properly closed.
14:32:16.904936 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:32:16.905931 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:32:16.905931 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:32:16.920561 [info ] [MainThread]: 
14:32:16.921534 [info ] [MainThread]: [32mCompleted successfully[0m
14:32:16.923486 [info ] [MainThread]: 
14:32:16.924464 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:32:16.925444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD24970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD243A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD8DA90>]}


============================== 2022-04-27 14:33:07.914517 | 4cfcd44a-2e32-4970-91db-f1e91091558b ==============================
14:33:07.914517 [info ] [MainThread]: Running with dbt=1.0.4
14:33:07.915495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:33:07.916472 [debug] [MainThread]: Tracking: tracking
14:33:07.931119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD143A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD14430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD14160>]}
14:33:08.064935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:33:08.064935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:33:08.074664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cfcd44a-2e32-4970-91db-f1e91091558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF820D0>]}
14:33:08.088334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cfcd44a-2e32-4970-91db-f1e91091558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAE777C0>]}
14:33:08.088334 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:33:08.093221 [info ] [MainThread]: 
14:33:08.094199 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:08.097125 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:33:08.098123 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:09.409766 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:33:09.411715 [info ] [MainThread]: 
14:33:09.420506 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.421482 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.421482 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:33:09.422457 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:33:09.424410 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.426365 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.427342 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.429294 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.428320 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.430270 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.455666 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.462500 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.464445 [debug] [Thread-1  ]: finished collecting timing info
14:33:09.464445 [debug] [Thread-2  ]: finished collecting timing info
14:33:09.465423 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.466406 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.504483 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.506469 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.508394 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:33:09.509364 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:33:09.514254 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:33:09.516200 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:33:12.034747 [debug] [Thread-1  ]: finished collecting timing info
14:33:12.035724 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.61s]
14:33:12.037674 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:12.277324 [debug] [Thread-2  ]: finished collecting timing info
14:33:12.278322 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.85s]
14:33:12.280261 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:12.284153 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:12.284153 [info ] [MainThread]: 
14:33:12.285126 [info ] [MainThread]: Finished running 2 tests in 4.19s.
14:33:12.287086 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:12.287086 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:33:12.288053 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:33:12.288053 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:33:12.307631 [info ] [MainThread]: 
14:33:12.308562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:33:12.310515 [info ] [MainThread]: 
14:33:12.311490 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:33:12.313476 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:33:12.314420 [info ] [MainThread]: 
14:33:12.315394 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:33:12.317351 [info ] [MainThread]: 
14:33:12.319306 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:33:12.320278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF41BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF4A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAFF88E0>]}


============================== 2022-04-28 13:48:25.286199 | 89c22c29-2f1e-44f8-9c76-e86bc9116047 ==============================
13:48:25.286199 [info ] [MainThread]: Running with dbt=1.0.4
13:48:25.346162 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:48:25.347083 [debug] [MainThread]: Tracking: tracking
13:48:25.421382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D079EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D07A4BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D07A45E0>]}
13:48:26.123238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:48:26.124238 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
13:48:26.135237 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
13:48:26.167238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
13:48:26.206237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c22c29-2f1e-44f8-9c76-e86bc9116047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A750D0>]}
13:48:26.219238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c22c29-2f1e-44f8-9c76-e86bc9116047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A013D0>]}
13:48:26.220238 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:48:26.222240 [info ] [MainThread]: 
13:48:26.223237 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:48:26.225239 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:48:26.226260 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:48:27.129012 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:48:27.129974 [info ] [MainThread]: 
13:48:27.140997 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.141971 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:48:27.142976 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.143972 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.147995 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:48:27.149235 [debug] [Thread-1  ]: finished collecting timing info
13:48:27.149235 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.151246 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:48:27.151246 [info ] [MainThread]: 
13:48:27.152250 [info ] [MainThread]: Finished running  in 0.93s.
13:48:27.153247 [debug] [MainThread]: Connection 'master' was properly closed.
13:48:27.153247 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:48:27.153247 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories' was properly closed.
13:48:27.169165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DF10>]}


============================== 2022-04-28 13:49:00.687760 | 6ac02cce-7ba6-4b7a-8978-c69a76a2d34c ==============================
13:49:00.687760 [info ] [MainThread]: Running with dbt=1.0.4
13:49:00.688760 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_CountryRegions'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:49:00.688760 [debug] [MainThread]: Tracking: tracking
13:49:00.703735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C365EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C374940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C374580>]}
13:49:00.824760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:49:00.825761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:49:00.833766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac02cce-7ba6-4b7a-8978-c69a76a2d34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C5D20D0>]}
13:49:00.847736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac02cce-7ba6-4b7a-8978-c69a76a2d34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B97F0>]}
13:49:00.847736 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:49:00.850761 [info ] [MainThread]: 
13:49:00.851730 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:00.853762 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:49:00.854748 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:49:01.535686 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:49:01.536687 [info ] [MainThread]: 
13:49:01.544723 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.545688 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:49:01.545688 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.546725 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.550715 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:49:01.559578 [debug] [Thread-1  ]: finished collecting timing info
13:49:01.560588 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.562591 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:01.563596 [info ] [MainThread]: 
13:49:01.564609 [info ] [MainThread]: Finished running  in 0.71s.
13:49:01.566625 [debug] [MainThread]: Connection 'master' was properly closed.
13:49:01.567588 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:49:01.567588 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions' was properly closed.
13:49:01.578592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C59A820>]}


============================== 2022-04-28 13:50:25.085237 | 9ce746e8-4425-49a3-95c8-a5802ba0344e ==============================
13:50:25.085237 [info ] [MainThread]: Running with dbt=1.0.4
13:50:25.086237 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:50:25.087238 [debug] [MainThread]: Tracking: tracking
13:50:25.102239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749894FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498955DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174989556A0>]}
13:50:25.218237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:50:25.219237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:50:25.226237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498BC30D0>]}
13:50:25.239238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498AB3790>]}
13:50:25.239238 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:50:25.243238 [info ] [MainThread]: 
13:50:25.244238 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:50:25.246255 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
13:50:25.247247 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:25.869849 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:50:25.870887 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:26.479095 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:50:26.480095 [info ] [MainThread]: 
13:50:26.487096 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.488099 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
13:50:26.489096 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.491098 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.491098 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.516094 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:50:26.520095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:50:26.522094 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:50:26.526095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:50:26.550097 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.552106 [debug] [Thread-1  ]: finished collecting timing info
13:50:26.553105 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.593096 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.594117 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:50:26.599094 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
13:50:27.261451 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
13:50:28.562509 [debug] [Thread-1  ]: finished collecting timing info
13:50:28.563510 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
13:50:28.564507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498C2B3D0>]}
13:50:28.565507 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.08s]
13:50:28.567508 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:28.569508 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:50:28.570507 [info ] [MainThread]: 
13:50:28.572510 [info ] [MainThread]: Finished running 1 table model in 3.33s.
13:50:28.573509 [debug] [MainThread]: Connection 'master' was properly closed.
13:50:28.573509 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
13:50:28.574508 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:50:28.575509 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:50:28.594508 [info ] [MainThread]: 
13:50:28.595508 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:50:28.597508 [info ] [MainThread]: 
13:50:28.598508 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
13:50:28.599508 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
13:50:28.601509 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
13:50:28.602509 [info ] [MainThread]: 
13:50:28.603510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:50:28.605509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174989A2B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498BA7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498C2B340>]}


============================== 2022-04-28 14:08:42.727702 | 807d246a-8ac7-4a37-a46c-613ca3aee9af ==============================
14:08:42.727702 [info ] [MainThread]: Running with dbt=1.0.4
14:08:42.728702 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:08:42.729670 [debug] [MainThread]: Tracking: tracking
14:08:42.743669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3DC0>]}
14:08:42.862696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:08:42.862696 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:08:42.874701 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:08:42.904695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:08:42.944702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7414830D0>]}
14:08:42.957670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74140F430>]}
14:08:42.958669 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:08:42.961672 [info ] [MainThread]: 
14:08:42.962680 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:08:42.964666 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:08:42.965669 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:43.727872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:08:43.727872 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:44.357888 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:08:44.358892 [info ] [MainThread]: 
14:08:44.368893 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.368893 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.369889 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:08:44.370888 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:08:44.370888 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.371886 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.372885 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.372885 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.377885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:08:44.384887 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:08:44.385889 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.386887 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.387889 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.387889 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.388888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.389890 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:08:44.390891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.391889 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.392889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:08:44.392889 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.393886 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.397887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:08:44.397887 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.403899 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:08:44.404885 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.405888 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.405888 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.406887 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.406887 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.408887 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:08:44.408887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.409899 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.409899 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:08:44.410921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.411887 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.414886 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:08:44.415890 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.418922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:08:44.419884 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.420885 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.420885 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.420885 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.421884 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:08:44.422888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.423887 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.424887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.425887 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.426890 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:08:44.431885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:08:44.432890 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.433907 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.436916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:08:44.437889 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.438886 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.438886 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.439885 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.439885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:08:44.440890 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.441885 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.441885 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.442887 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.443918 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:08:44.446884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:08:44.448890 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:44.449906 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.450894 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.450894 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.451886 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.473921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:44.473921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.474888 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:08:44.475886 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.476885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:08:44.476885 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.477885 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.494923 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:08:44.494923 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:08:44.516890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:08:44.519885 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.521883 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.524885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:08:45.162524 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:45.163525 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:08:45.182529 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:08:45.190793 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:08:48.258031 [debug] [Thread-2  ]: finished collecting timing info
14:08:48.259032 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74156A580>]}
14:08:48.259032 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.81s]
14:08:48.261034 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:48.262036 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.263032 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:08:48.264031 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.264031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.265033 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.287069 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.289067 [debug] [Thread-1  ]: finished collecting timing info
14:08:48.290033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74152AC10>]}
14:08:48.290033 [debug] [Thread-2  ]: finished collecting timing info
14:08:48.291034 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.81s]
14:08:48.291034 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.296032 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:08:48.296032 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:08:48.297035 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.298033 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:08:48.300035 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.300035 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.301034 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.319059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.322057 [debug] [Thread-1  ]: finished collecting timing info
14:08:48.324032 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.328065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.329076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:08:48.334033 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:08:48.926369 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.927367 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:08:48.968724 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:08:50.264988 [debug] [Thread-1  ]: finished collecting timing info
14:08:50.265982 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:08:50.266943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D742615A30>]}
14:08:50.266943 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.97s]
14:08:50.269167 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:52.246979 [debug] [Thread-2  ]: finished collecting timing info
14:08:52.247968 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74130A070>]}
14:08:52.247968 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.98s]
14:08:52.250943 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:52.251937 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:08:52.251937 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:08:52.253978 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:08:52.255944 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:08:52.256942 [info ] [MainThread]: 
14:08:52.256942 [info ] [MainThread]: Finished running 5 table models in 9.29s.
14:08:52.257942 [debug] [MainThread]: Connection 'master' was properly closed.
14:08:52.258945 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:08:52.259939 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:08:52.259939 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:08:52.260942 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:08:52.275591 [info ] [MainThread]: 
14:08:52.276398 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:08:52.277411 [info ] [MainThread]: 
14:08:52.279413 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:08:52.281408 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:08:52.283410 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:08:52.284446 [info ] [MainThread]: 
14:08:52.285409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:08:52.287413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590FD0>]}


============================== 2022-04-28 14:14:35.409302 | 2fe89707-29a3-4944-8fad-8924351215b3 ==============================
14:14:35.409302 [info ] [MainThread]: Running with dbt=1.0.4
14:14:35.410303 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:14:35.411306 [debug] [MainThread]: Tracking: tracking
14:14:35.426307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2D0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2F4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2F4880>]}
14:14:35.548308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:14:35.549327 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:14:35.550304 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:14:35.561303 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:14:35.575303 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:14:35.595304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:14:35.635309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC5CC0D0>]}
14:14:35.648305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC4509D0>]}
14:14:35.649305 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:14:35.652309 [info ] [MainThread]: 
14:14:35.654308 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:35.655305 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:14:35.656305 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:36.420443 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:14:36.421400 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:37.019709 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:14:37.020757 [info ] [MainThread]: 
14:14:37.028607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.028607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.029607 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:14:37.030609 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:14:37.030609 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.031608 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.031608 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.032607 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.036608 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:14:37.040647 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:14:37.042607 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.042607 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.043608 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.043608 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.044607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.045609 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.046608 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:14:37.047610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:14:37.047610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.048609 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.048609 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.049612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.052646 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:14:37.056646 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:14:37.057605 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.058607 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.058607 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.059606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.060607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.060607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.061607 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:14:37.062610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:14:37.063607 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.063607 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.064607 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.065619 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.069607 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:14:37.072642 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:14:37.073607 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.074606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.075611 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.075611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.076606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.076606 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:14:37.077607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.078608 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.078608 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:37.079642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.079642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.084647 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:14:37.085616 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.089605 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:37.089605 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.090629 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.091606 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.091606 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.092605 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:14:37.093606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.093606 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.094606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.094606 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.095605 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:14:37.098643 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:14:37.100609 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.101606 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.101606 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.102604 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.121644 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.122606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.123605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.124610 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:14:37.124610 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.125605 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.126609 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.126609 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.142644 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:14:37.143641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:14:37.168401 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.170399 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.171407 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.174437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:37.775060 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.776029 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:14:37.800096 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.802068 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:14:40.865021 [debug] [Thread-1  ]: finished collecting timing info
14:14:40.866022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC6AE370>]}
14:14:40.866987 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.74s]
14:14:40.868988 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:14:40.868988 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.869990 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:14:40.870984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:40.871985 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.871985 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.891025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:40.892008 [debug] [Thread-1  ]: finished collecting timing info
14:14:40.893001 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.895985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:41.555211 [debug] [Thread-2  ]: finished collecting timing info
14:14:41.556210 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC6ACA90>]}
14:14:41.556210 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.45s]
14:14:41.558537 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:41.558537 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.559543 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:14:41.560537 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.561537 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.562538 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.582536 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.583537 [debug] [Thread-2  ]: finished collecting timing info
14:14:41.584535 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.587572 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.588536 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:14:41.593570 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:14:41.624577 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:41.625579 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:14:42.995076 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name countryRegion_id is ambiguous at [69:14]')
14:14:44.832257 [debug] [Thread-2  ]: finished collecting timing info
14:14:44.833257 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Column name countryRegion_id is ambiguous at [69:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:14:44.833257 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185ED73FC40>]}
14:14:44.834256 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 3.27s]
14:14:44.836528 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:45.004853 [debug] [Thread-1  ]: finished collecting timing info
14:14:45.005892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC564D60>]}
14:14:45.006858 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.13s]
14:14:45.007856 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:45.008855 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:14:45.009890 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:14:45.011853 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:14:45.013854 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:45.014851 [info ] [MainThread]: 
14:14:45.014851 [info ] [MainThread]: Finished running 5 table models in 9.36s.
14:14:45.016858 [debug] [MainThread]: Connection 'master' was properly closed.
14:14:45.017857 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:14:45.017857 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:14:45.018853 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:14:45.019898 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:14:45.036855 [info ] [MainThread]: 
14:14:45.037690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:14:45.039702 [info ] [MainThread]: 
14:14:45.040702 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:14:45.041700 [error] [MainThread]:   Column name countryRegion_id is ambiguous at [69:14]
14:14:45.042706 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:14:45.044714 [info ] [MainThread]: 
14:14:45.045720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:14:45.047706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC450D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC4508E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC66E850>]}


============================== 2022-04-28 14:15:21.166022 | 440bf19c-205c-4245-b1d7-eb4d660ae89f ==============================
14:15:21.166022 [info ] [MainThread]: Running with dbt=1.0.4
14:15:21.167008 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:21.167008 [debug] [MainThread]: Tracking: tracking
14:15:21.179997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FDE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FE5A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FE5F10>]}
14:15:21.304033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:15:21.305028 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:21.317995 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:21.348022 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:21.388022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242B60D0>]}
14:15:21.400023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A224241400>]}
14:15:21.401023 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:21.404012 [info ] [MainThread]: 
14:15:21.404992 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:21.407000 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:21.408007 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:22.066674 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:22.066674 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:22.693373 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:22.694372 [info ] [MainThread]: 
14:15:22.701374 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.702373 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:15:22.704377 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.705372 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.705372 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.711371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:22.715410 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:22.716726 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:22.720740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:22.738764 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.739737 [debug] [Thread-1  ]: finished collecting timing info
14:15:22.740749 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.775735 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.777750 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:22.782736 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:15:26.257361 [debug] [Thread-1  ]: finished collecting timing info
14:15:26.257361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242EFC10>]}
14:15:26.258356 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.55s]
14:15:26.260358 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:26.262358 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:26.263357 [info ] [MainThread]: 
14:15:26.264361 [info ] [MainThread]: Finished running 1 table model in 4.86s.
14:15:26.265359 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:26.266361 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:26.267360 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:26.267360 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:15:26.285358 [info ] [MainThread]: 
14:15:26.287368 [info ] [MainThread]: [32mCompleted successfully[0m
14:15:26.289358 [info ] [MainThread]: 
14:15:26.290387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:15:26.291359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DB220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DBB80>]}


============================== 2022-04-28 14:15:33.485935 | 9ddd682b-3fc1-40b7-95df-29a467b7cddb ==============================
14:15:33.485935 [info ] [MainThread]: Running with dbt=1.0.4
14:15:33.486936 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:33.487939 [debug] [MainThread]: Tracking: tracking
14:15:33.499935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD11E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD340A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD34880>]}
14:15:33.630933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:15:33.630933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:15:33.638933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFFA20D0>]}
14:15:33.651933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFDB77C0>]}
14:15:33.651933 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:33.654935 [info ] [MainThread]: 
14:15:33.655933 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:33.658937 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:33.658937 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:34.276937 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:34.277935 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:34.965933 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:34.966934 [info ] [MainThread]: 
14:15:34.975935 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.975935 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.976936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:34.977936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:34.978937 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.979938 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.979938 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.980946 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.984934 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:34.987934 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:34.989936 [debug] [Thread-1  ]: finished collecting timing info
14:15:34.990941 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.990941 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.991935 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.992934 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.992934 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:34.993936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:34.994936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:34.995955 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.995955 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:34.996935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.996935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:35.000945 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:35.004939 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:35.005936 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.006939 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.006939 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:35.007936 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:35.008936 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.009952 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.010935 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:35.010935 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:35.011935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.011935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.012934 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.012934 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.016937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:35.020938 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:35.022935 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.022935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.023936 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.024936 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.025935 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.026935 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.026935 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:35.027936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:35.028935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.028935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.029935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.029935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.034935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:35.037935 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:35.038935 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.039935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.039935 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.040937 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.041937 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.041937 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.042936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:35.043937 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:15:35.044942 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.045937 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.045937 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.048936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:35.049935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.050939 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.056936 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.087934 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.087934 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.088957 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.089935 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:15:35.089935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.091936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.091936 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.092936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.110964 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:35.110964 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:15:35.134948 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.136063 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.137951 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.140933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:35.796964 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.798964 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.800940 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:15:35.801937 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:15:38.286964 [debug] [Thread-1  ]: finished collecting timing info
14:15:38.288940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B007FC40>]}
14:15:38.288940 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.20s]
14:15:38.290946 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:15:38.291936 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.292950 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:15:38.293938 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.294936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.295938 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.309970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.311946 [debug] [Thread-1  ]: finished collecting timing info
14:15:38.312939 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.315936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:38.543933 [debug] [Thread-2  ]: finished collecting timing info
14:15:38.544933 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00DCC70>]}
14:15:38.546934 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.50s]
14:15:38.548940 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:38.549936 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.550937 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:15:38.551937 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:38.552935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.552935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.575936 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:38.576935 [debug] [Thread-2  ]: finished collecting timing info
14:15:38.577936 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.584937 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:38.904933 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.905933 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:15:39.272933 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:39.274933 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:15:42.660743 [debug] [Thread-2  ]: finished collecting timing info
14:15:42.660743 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00C2BE0>]}
14:15:42.661703 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.11s]
14:15:42.663705 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:42.828889 [debug] [Thread-1  ]: finished collecting timing info
14:15:42.829890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00C2E20>]}
14:15:42.830891 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.54s]
14:15:42.832895 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:42.833896 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.834891 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:15:42.835895 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.836891 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.837928 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.871921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.873932 [debug] [Thread-2  ]: finished collecting timing info
14:15:42.874893 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.877887 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.878891 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:42.884894 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purcharseordernumber as purcharseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqyt as orderQyt
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purcharseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:15:44.207405 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]')
14:15:46.099151 [debug] [Thread-2  ]: finished collecting timing info
14:15:46.100149 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:15:46.101148 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B1113A30>]}
14:15:46.101148 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.27s]
14:15:46.103148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:46.105149 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:46.106177 [info ] [MainThread]: 
14:15:46.108152 [info ] [MainThread]: Finished running 5 table models in 12.45s.
14:15:46.109149 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:46.110151 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:46.110151 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:46.111149 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:15:46.112148 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:15:46.128202 [info ] [MainThread]: 
14:15:46.129153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:15:46.132151 [info ] [MainThread]: 
14:15:46.133149 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:15:46.135152 [error] [MainThread]:   Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]
14:15:46.136149 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:15:46.137148 [info ] [MainThread]: 
14:15:46.138153 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:15:46.140152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B003F280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B0042730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B0042B20>]}


============================== 2022-04-28 14:17:31.862493 | 5a398e25-15e3-44f1-8a02-351cd1635da6 ==============================
14:17:31.862493 [info ] [MainThread]: Running with dbt=1.0.4
14:17:31.863494 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:17:31.863494 [debug] [MainThread]: Tracking: tracking
14:17:31.878499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB11E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB34400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB34880>]}
14:17:31.996494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:17:31.996494 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:17:31.997495 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:17:32.008494 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:17:32.039494 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:17:32.041506 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:17:32.057494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787ED960D0>]}
14:17:32.070495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EBB7910>]}
14:17:32.071495 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:17:32.075496 [info ] [MainThread]: 
14:17:32.077500 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:32.079516 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:17:32.080497 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:32.777710 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:17:32.777710 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:33.420387 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:17:33.421391 [info ] [MainThread]: 
14:17:33.429390 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.429390 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.430387 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:33.430387 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:33.431391 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.432392 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.433387 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.433387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.436387 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:33.440410 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:33.443393 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.443393 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.444391 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.445387 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.445387 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.446387 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.446387 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:33.447390 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:33.447936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.448337 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.448793 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.449240 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.452285 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:33.455262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:33.457250 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.457250 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.458250 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.459250 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.459250 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.460268 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.461258 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:33.462250 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:33.463249 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.463249 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.464252 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.465272 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.467663 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:33.472845 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:33.473862 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.474849 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.475846 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.475846 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.476844 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.477845 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.477845 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:33.478844 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:33.479845 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.479845 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.480712 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.481073 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.484120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:33.486082 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:33.488084 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.489084 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.489084 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.491083 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.491083 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.492091 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.493084 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:33.494084 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:17:33.494084 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.495084 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.496088 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:33.499119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:33.500099 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.500354 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.501365 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.518400 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:33.519456 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.520382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.521365 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.522368 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:17:33.523365 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.524366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:17:33.540402 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:33.541380 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.542366 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:17:33.563363 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:33.565385 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.566373 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.568363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:34.241046 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:34.243085 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:17:34.250722 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:34.251722 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:17:36.930016 [debug] [Thread-1  ]: finished collecting timing info
14:17:36.930016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEFD1C0>]}
14:17:36.931011 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.41s]
14:17:36.932984 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:17:36.933982 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.934989 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:17:36.935983 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:36.936984 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.936984 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.954982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:36.957003 [debug] [Thread-1  ]: finished collecting timing info
14:17:36.957003 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.959980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:37.559197 [debug] [Thread-2  ]: finished collecting timing info
14:17:37.560155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEB1FD0>]}
14:17:37.560155 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.06s]
14:17:37.562154 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:37.563153 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.564167 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:17:37.565153 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:37.565153 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.566153 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.582152 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:37.584188 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:37.585175 [debug] [Thread-2  ]: finished collecting timing info
14:17:37.586152 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:17:37.586152 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.597196 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:38.314547 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:38.315510 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:17:40.638066 [debug] [Thread-1  ]: finished collecting timing info
14:17:40.639070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787FF23490>]}
14:17:40.639070 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.70s]
14:17:40.641069 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:41.043939 [debug] [Thread-2  ]: finished collecting timing info
14:17:41.044951 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EECD5B0>]}
14:17:41.045950 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.48s]
14:17:41.047954 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:41.048956 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.049953 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:17:41.050953 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.051950 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.051950 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.087952 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.088952 [debug] [Thread-1  ]: finished collecting timing info
14:17:41.089950 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.092952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.093965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:41.098946 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqyt as orderQyt
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:17:42.414658 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]')
14:17:44.229727 [debug] [Thread-1  ]: finished collecting timing info
14:17:44.230687 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:17:44.230687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787FF3EF40>]}
14:17:44.231724 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.18s]
14:17:44.233689 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:44.235714 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:44.235714 [info ] [MainThread]: 
14:17:44.237690 [info ] [MainThread]: Finished running 5 table models in 12.16s.
14:17:44.238691 [debug] [MainThread]: Connection 'master' was properly closed.
14:17:44.239690 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:17:44.239690 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:17:44.240696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:17:44.240696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:17:44.254686 [info ] [MainThread]: 
14:17:44.255690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:17:44.257705 [info ] [MainThread]: 
14:17:44.258691 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:17:44.260701 [error] [MainThread]:   Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]
14:17:44.262686 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:17:44.263688 [info ] [MainThread]: 
14:17:44.265824 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:17:44.267722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEABE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEAB790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEABD00>]}


============================== 2022-04-28 14:18:59.689881 | 22508579-45f9-4287-b1c1-3da40ae2554c ==============================
14:18:59.689881 [info ] [MainThread]: Running with dbt=1.0.4
14:18:59.690882 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:59.690882 [debug] [MainThread]: Tracking: tracking
14:18:59.705884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF723820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF723100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF7235E0>]}
14:18:59.832912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:18:59.832912 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
14:18:59.844912 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:18:59.871881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF9C70D0>]}
14:18:59.884882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF95AD90>]}
14:18:59.884882 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:59.887914 [info ] [MainThread]: 
14:18:59.889883 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:59.891915 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:18:59.892896 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:00.532420 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:19:00.532420 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:01.161108 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:19:01.162132 [info ] [MainThread]: 
14:19:01.171113 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.171113 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.172126 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:01.173109 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:19:01.174114 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.175109 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.175109 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.175706 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.178120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:01.181114 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:19:01.182116 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.183114 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.183114 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.184116 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.185115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.186116 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.187128 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:19:01.188117 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:19:01.188117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.188862 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.188862 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.189874 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.191909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:19:01.194908 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:19:01.195872 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.196877 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.196877 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.196877 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.197873 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.198874 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:19:01.198874 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.199872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.200876 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:19:01.201888 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.202877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.206872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:19:01.206872 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.210908 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:19:01.210908 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.211874 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.212873 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.212873 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.213872 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.214873 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:19:01.215877 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.215877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.216893 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:19:01.217876 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.218877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.221909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:19:01.222909 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.227911 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:19:01.227911 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.228904 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.229874 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.229874 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.230872 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:01.235876 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.236877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.237873 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.238873 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.238873 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:19:01.241935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:01.243884 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:01.243884 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.245905 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.245905 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.246893 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.281929 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:01.282900 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.283895 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:19:01.284903 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.286919 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:19:01.287894 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.287894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.303928 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:01.304893 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:19:01.326931 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:19:01.328893 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.329893 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.334914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:02.035867 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:02.036866 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:19:02.037887 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:19:02.039876 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:19:05.077910 [debug] [Thread-1  ]: finished collecting timing info
14:19:05.078910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFA99DC0>]}
14:19:05.079911 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.79s]
14:19:05.081463 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:19:05.082474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.082474 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:19:05.084476 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.084476 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.084476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.099473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.100477 [debug] [Thread-1  ]: finished collecting timing info
14:19:05.101478 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.105476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:05.393091 [debug] [Thread-2  ]: finished collecting timing info
14:19:05.393091 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFA13D90>]}
14:19:05.394091 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.15s]
14:19:05.396056 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:05.397058 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.397058 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:19:05.398058 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:05.399057 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.400059 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.416065 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:05.417516 [debug] [Thread-2  ]: finished collecting timing info
14:19:05.417516 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.421528 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:05.718016 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.719975 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:19:06.034798 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:06.036082 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:19:08.995347 [debug] [Thread-2  ]: finished collecting timing info
14:19:08.996307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFAE9640>]}
14:19:08.996307 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.60s]
14:19:08.998306 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:09.385431 [debug] [Thread-1  ]: finished collecting timing info
14:19:09.386387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFB20D00>]}
14:19:09.386387 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.30s]
14:19:09.388388 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:09.390422 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.390422 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:19:09.392390 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.392390 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.393387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.435410 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.437408 [debug] [Thread-2  ]: finished collecting timing info
14:19:09.437408 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.440421 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.441422 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:09.446420 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:19:10.689642 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_sk at [81:13]')
14:19:12.530530 [debug] [Thread-2  ]: finished collecting timing info
14:19:12.531526 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: customer_sk at [81:13]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:19:12.532527 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFB6C8E0>]}
14:19:12.532527 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.14s]
14:19:12.534525 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:12.536525 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:12.537561 [info ] [MainThread]: 
14:19:12.538528 [info ] [MainThread]: Finished running 5 table models in 12.65s.
14:19:12.539529 [debug] [MainThread]: Connection 'master' was properly closed.
14:19:12.539529 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:19:12.557528 [info ] [MainThread]: 
14:19:12.558988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:19:12.560001 [info ] [MainThread]: 
14:19:12.561999 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:19:12.563003 [error] [MainThread]:   Unrecognized name: customer_sk at [81:13]
14:19:12.563999 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:19:12.565999 [info ] [MainThread]: 
14:19:12.567006 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:19:12.568010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF9C7A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF7A7B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFAE9310>]}


============================== 2022-04-28 14:20:30.118548 | 4c089fec-2aa2-46dd-97da-8478f97b9e3b ==============================
14:20:30.118548 [info ] [MainThread]: Running with dbt=1.0.4
14:20:30.119549 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:30.120523 [debug] [MainThread]: Tracking: tracking
14:20:30.136525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564040>]}
14:20:30.267526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:20:30.268523 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:20:30.281524 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:20:30.321519 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:20:30.338556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A657B40D0>]}
14:20:30.352551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6578ADF0>]}
14:20:30.353525 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:30.358554 [info ] [MainThread]: 
14:20:30.359548 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:30.361522 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:30.362520 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:31.098735 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:31.098735 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:31.713381 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:31.714381 [info ] [MainThread]: 
14:20:31.722381 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.722381 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.723382 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:20:31.724379 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:20:31.724379 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.725396 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.726381 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.727385 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.731383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:20:31.735416 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:20:31.737381 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.737381 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.738381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.738381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.739407 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.740380 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.741401 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:20:31.741401 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:20:31.742413 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.743387 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.743387 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.743387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.747382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:20:31.751379 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:20:31.752382 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.752382 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.753381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.754381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.755382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.755382 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.756381 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:20:31.757380 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:20:31.757380 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.758379 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.758379 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.759381 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.763389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:20:31.768382 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:20:31.769386 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.770381 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.771381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.771381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.772381 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.773392 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.773392 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:20:31.774379 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:31.775399 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.775399 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.776396 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.776728 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.780256 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:20:31.783297 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:31.785257 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.785257 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.786261 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.787257 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.787257 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.788256 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.789256 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:20:31.789256 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:20:31.790255 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.791496 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.792520 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:31.795508 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:20:31.796509 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.797522 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.797522 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.818544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:31.818544 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.819588 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.820601 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:20:31.821600 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.822601 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:20:31.822601 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.823604 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.840635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:31.840635 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:20:31.868635 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:20:31.870598 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.871598 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.874635 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:32.468215 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:20:32.469215 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:20:32.502790 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:32.503752 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:20:35.249232 [debug] [Thread-2  ]: finished collecting timing info
14:20:35.250232 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65938610>]}
14:20:35.251196 [info ] [Thread-2  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.43s]
14:20:35.253211 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:20:35.254205 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.255197 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:35.256198 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.257196 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.257196 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.271195 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.273044 [debug] [Thread-2  ]: finished collecting timing info
14:20:35.273044 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.275053 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:35.544600 [debug] [Thread-1  ]: finished collecting timing info
14:20:35.545600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658CB9A0>]}
14:20:35.545600 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.75s]
14:20:35.548594 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:35.548594 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.549627 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:20:35.550598 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:35.551596 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.552595 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.569634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:35.571703 [debug] [Thread-1  ]: finished collecting timing info
14:20:35.571703 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.578712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:35.861682 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.862716 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:20:36.191330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:36.192291 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:20:39.192621 [debug] [Thread-2  ]: finished collecting timing info
14:20:39.194627 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A66946430>]}
14:20:39.195614 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.94s]
14:20:39.197615 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:39.962473 [debug] [Thread-1  ]: finished collecting timing info
14:20:39.962473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A657CACA0>]}
14:20:39.963477 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.41s]
14:20:39.965758 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:39.966754 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:39.966754 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:20:39.968755 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:39.968755 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:39.969755 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:40.008788 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:40.009807 [debug] [Thread-2  ]: finished collecting timing info
14:20:40.010753 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:40.014752 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:40.016753 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:40.021787 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:20:41.318013 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: employee_sk at [88:13]')
14:20:43.130865 [debug] [Thread-2  ]: finished collecting timing info
14:20:43.131853 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: employee_sk at [88:13]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:20:43.132856 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6695D820>]}
14:20:43.132856 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.16s]
14:20:43.134818 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:43.136819 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:43.137819 [info ] [MainThread]: 
14:20:43.138822 [info ] [MainThread]: Finished running 5 table models in 12.78s.
14:20:43.139820 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:43.140816 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:43.140816 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:43.141821 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:20:43.141821 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:20:43.157819 [info ] [MainThread]: 
14:20:43.159817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:20:43.161819 [info ] [MainThread]: 
14:20:43.162821 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:20:43.164820 [error] [MainThread]:   Unrecognized name: employee_sk at [88:13]
14:20:43.165826 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:20:43.167818 [info ] [MainThread]: 
14:20:43.168816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:20:43.169816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE0D0>]}


============================== 2022-04-28 14:21:38.841253 | 305d7c9f-3433-48ed-9211-e3e3df14f41a ==============================
14:21:38.841253 [info ] [MainThread]: Running with dbt=1.0.4
14:21:38.841253 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:21:38.842214 [debug] [MainThread]: Tracking: tracking
14:21:38.856245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071241E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071263370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071263A90>]}
14:21:38.981244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:21:38.981244 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:21:38.992244 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:21:39.025251 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:21:39.040253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210714BA0D0>]}
14:21:39.064217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107149ADF0>]}
14:21:39.065215 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:21:39.069244 [info ] [MainThread]: 
14:21:39.070266 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:39.072216 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:21:39.072216 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:39.713503 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:21:39.714500 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:40.328010 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:21:40.329025 [info ] [MainThread]: 
14:21:40.337040 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.337040 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.338025 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:21:40.340024 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:21:40.340024 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.341025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.342047 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.343023 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.346025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:21:40.349027 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:21:40.350027 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.351025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.352023 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.352023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.353023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.354036 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:21:40.355032 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.355032 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.356025 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:21:40.357026 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.357026 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.360025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:21:40.360025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.364028 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:21:40.364028 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.366026 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.366026 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.367029 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.367029 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.368060 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:21:40.368060 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.369039 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.370023 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:21:40.370023 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.371023 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.374060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:21:40.374060 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.378046 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:21:40.379046 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.380025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.381024 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.381024 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.382029 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.383027 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:21:40.384090 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.385028 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.385028 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:21:40.386059 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.386059 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.390060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:21:40.390060 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.393058 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:21:40.394044 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.395029 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.395029 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.396023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.397023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.397023 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:21:40.398021 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.399025 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.399025 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:21:40.400073 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.401087 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:40.404096 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:21:40.405101 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.406105 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.406105 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.425133 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:40.425133 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.426097 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.427097 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.428096 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:21:40.428096 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.430105 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:21:40.445133 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:40.446103 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.447103 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:21:40.470096 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:21:40.472098 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.473098 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.476096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:41.056551 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:41.057975 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:21:41.086401 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:21:41.087364 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:21:43.705750 [debug] [Thread-1  ]: finished collecting timing info
14:21:43.706768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071525820>]}
14:21:43.707713 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.28s]
14:21:43.709713 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:21:43.709713 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.710713 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:21:43.712714 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:43.712714 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.713711 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.726737 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:43.728712 [debug] [Thread-1  ]: finished collecting timing info
14:21:43.728712 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.731739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:44.127438 [debug] [Thread-2  ]: finished collecting timing info
14:21:44.128400 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210715DF2B0>]}
14:21:44.129399 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.73s]
14:21:44.131401 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:44.131401 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.132403 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:21:44.133401 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.133401 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.134401 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.152400 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.153436 [debug] [Thread-2  ]: finished collecting timing info
14:21:44.154398 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.160436 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:44.347055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:44.349017 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:21:44.816140 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.817102 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:21:47.770405 [debug] [Thread-2  ]: finished collecting timing info
14:21:47.770405 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107161B220>]}
14:21:47.771404 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.64s]
14:21:47.773411 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:47.953672 [debug] [Thread-1  ]: finished collecting timing info
14:21:47.954673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021072633490>]}
14:21:47.955674 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.24s]
14:21:47.956674 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:47.957674 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.958675 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:21:47.960675 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:47.960675 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.961679 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.998704 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:47.999702 [debug] [Thread-2  ]: finished collecting timing info
14:21:48.000689 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:48.003672 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:48.005688 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:48.010697 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,reason_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:21:49.351467 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]')
14:21:51.614671 [debug] [Thread-2  ]: finished collecting timing info
14:21:51.614671 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:21:51.615664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107267DC10>]}
14:21:51.616631 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.66s]
14:21:51.617630 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:51.619628 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:51.620668 [info ] [MainThread]: 
14:21:51.621632 [info ] [MainThread]: Finished running 5 table models in 12.55s.
14:21:51.622631 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:51.623631 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:21:51.624632 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:51.624632 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:21:51.625633 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:21:51.640628 [info ] [MainThread]: 
14:21:51.641629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:21:51.643634 [info ] [MainThread]: 
14:21:51.644632 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:21:51.646665 [error] [MainThread]:   Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]
14:21:51.647631 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:21:51.648660 [info ] [MainThread]: 
14:21:51.649633 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:21:51.650642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107262E4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021072667130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107161C9A0>]}


============================== 2022-04-28 14:24:35.995996 | eeea4bf7-62e0-4db4-838c-9245eba32f58 ==============================
14:24:35.995996 [info ] [MainThread]: Running with dbt=1.0.4
14:24:35.996993 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:24:35.996993 [debug] [MainThread]: Tracking: tracking
14:24:36.012000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF42E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF434C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF4346A0>]}
14:24:36.131996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:24:36.132996 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:24:36.145996 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:24:36.175992 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:24:36.191992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF6940D0>]}
14:24:36.203994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF66ABB0>]}
14:24:36.204994 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:36.207998 [info ] [MainThread]: 
14:24:36.209999 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:36.210996 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:24:36.211999 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:36.891118 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:36.891118 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:37.681942 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:24:37.682937 [info ] [MainThread]: 
14:24:37.690972 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.690972 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.691938 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:37.692955 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:24:37.692955 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.693938 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.694466 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.694911 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.697957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:37.699921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:24:37.701921 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.701921 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.701921 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.702960 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.703923 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.704922 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.704922 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:24:37.705921 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:24:37.705921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.706924 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.706924 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.706924 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.709959 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:24:37.712920 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:24:37.713922 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.713922 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.714923 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.715921 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.715921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.716920 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.717921 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:24:37.717921 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:24:37.718921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.719925 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.719925 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.720923 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.724957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:24:37.729925 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:24:37.730922 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.731923 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.731923 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.732922 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.733922 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.733922 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:24:37.734924 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.735921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.736922 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:24:37.737928 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.738923 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.741921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:24:37.742957 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.745921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:24:37.746926 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.746926 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.747923 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.747923 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.748923 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.749939 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:37.750928 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.750928 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.751922 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:24:37.752921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.754925 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:37.757956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:37.757956 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.758921 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.766920 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.777923 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:37.778960 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.779921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.780932 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.781923 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:24:37.781923 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.784930 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:24:37.801919 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:24:37.801919 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.802920 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:24:37.829920 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:24:37.831920 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.833924 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.837943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:38.652440 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:24:38.653422 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:38.655414 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:24:38.655414 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:24:41.468861 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.469825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF6F7220>]}
14:24:41.470838 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.69s]
14:24:41.472832 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:24:41.472832 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.474824 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:24:41.475847 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:41.476894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.476894 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.495857 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:41.497465 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.497465 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.499510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:41.752674 [debug] [Thread-2  ]: finished collecting timing info
14:24:41.754673 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D07F7790>]}
14:24:41.755672 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.00s]
14:24:41.757669 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:41.758669 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.759670 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:24:41.760670 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.761668 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.761668 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.779702 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.780750 [debug] [Thread-2  ]: finished collecting timing info
14:24:41.781667 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.788674 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:24:42.138948 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:42.140909 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:24:42.388334 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:42.389337 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:24:45.535530 [debug] [Thread-1  ]: finished collecting timing info
14:24:45.536490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF702FD0>]}
14:24:45.536490 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.06s]
14:24:45.538490 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:45.765130 [debug] [Thread-2  ]: finished collecting timing info
14:24:45.766126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF702E20>]}
14:24:45.767093 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.01s]
14:24:45.769090 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:45.770090 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.770090 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:24:45.771090 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.772091 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.773086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.809117 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.810922 [debug] [Thread-1  ]: finished collecting timing info
14:24:45.810922 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.813967 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.814968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:45.820953 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:24:47.094881 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]')
14:24:48.892858 [debug] [Thread-1  ]: finished collecting timing info
14:24:48.892858 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:24:48.893862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D0856B80>]}
14:24:48.893862 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.12s]
14:24:48.895829 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:48.896829 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:48.897829 [info ] [MainThread]: 
14:24:48.899830 [info ] [MainThread]: Finished running 5 table models in 12.69s.
14:24:48.900831 [debug] [MainThread]: Connection 'master' was properly closed.
14:24:48.900831 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:24:48.901830 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:24:48.901830 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:24:48.902832 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:24:48.916829 [info ] [MainThread]: 
14:24:48.918833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:24:48.920832 [info ] [MainThread]: 
14:24:48.921839 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:24:48.923834 [error] [MainThread]:   Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]
14:24:48.924843 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:24:48.925829 [info ] [MainThread]: 
14:24:48.927830 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:24:48.928848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D0851FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF802A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF802EE0>]}


============================== 2022-04-28 14:25:16.451560 | 34e4fc14-cdf0-4e68-8acc-b4dd5588c046 ==============================
14:25:16.451560 [info ] [MainThread]: Running with dbt=1.0.4
14:25:16.452560 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:25:16.453565 [debug] [MainThread]: Tracking: tracking
14:25:16.467587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B74EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B84AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B84D00>]}
14:25:16.599560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:25:16.600560 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:25:16.612560 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:25:16.645562 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:25:16.662561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DCA0D0>]}
14:25:16.675562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DAADF0>]}
14:25:16.676561 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:25:16.679561 [info ] [MainThread]: 
14:25:16.681561 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:16.682567 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:25:16.683601 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:17.348339 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:25:17.348339 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:17.985726 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:25:17.986756 [info ] [MainThread]: 
14:25:17.994729 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:17.994729 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:17.995726 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:25:17.997732 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:25:17.997732 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:17.998731 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:17.999732 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:18.000730 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:18.003729 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:25:18.007762 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:25:18.008739 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.009729 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.009729 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:18.011736 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:18.012737 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.013726 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.014728 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:25:18.015727 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:25:18.015727 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.016726 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.017727 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.017727 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.020725 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:25:18.023724 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:25:18.025726 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.025726 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.026734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.027727 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.028730 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.028730 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.030728 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:25:18.031728 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:25:18.031728 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.032729 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.032729 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.033728 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.036731 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:25:18.040761 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:25:18.042730 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.042730 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.043736 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.044728 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.045730 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.046748 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.047743 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:25:18.048725 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:25:18.049725 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.049725 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.050748 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.050748 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.053762 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:25:18.057762 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:25:18.058729 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.059731 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.059731 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.060726 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.061732 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.062727 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.064729 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:25:18.064729 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:25:18.065726 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.066729 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.067726 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.067726 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.071761 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:25:18.071761 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.091764 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.092789 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.094727 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.094727 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.095729 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.096729 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.096729 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:25:18.114727 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:18.116729 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.117730 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.117730 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:25:18.141728 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.143746 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.144730 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.148734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:18.759490 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.761491 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.763490 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:25:18.763490 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:25:21.560105 [debug] [Thread-1  ]: finished collecting timing info
14:25:21.561106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1EA1310>]}
14:25:21.561106 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.44s]
14:25:21.564107 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:25:21.564107 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.565138 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:25:21.566110 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:21.567117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.567117 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.582107 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:21.583108 [debug] [Thread-1  ]: finished collecting timing info
14:25:21.583108 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.586359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:21.685456 [debug] [Thread-2  ]: finished collecting timing info
14:25:21.686452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1F558E0>]}
14:25:21.687454 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.62s]
14:25:21.689453 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:21.689453 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.690455 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:25:21.691452 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:21.691452 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.692458 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.708490 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:21.709454 [debug] [Thread-2  ]: finished collecting timing info
14:25:21.710452 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.716493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:22.240786 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:22.242786 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:25:22.428582 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:22.429580 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:25:25.256803 [debug] [Thread-1  ]: finished collecting timing info
14:25:25.257818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE2F4DFA0>]}
14:25:25.258798 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.69s]
14:25:25.260800 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:25.438797 [debug] [Thread-2  ]: finished collecting timing info
14:25:25.439798 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9AF0>]}
14:25:25.439798 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.75s]
14:25:25.441801 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:25.442800 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.443798 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:25:25.444805 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.444805 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.445797 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.480798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.481798 [debug] [Thread-1  ]: finished collecting timing info
14:25:25.482799 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.486801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.488799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:25.494799 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:25:26.757563 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]')
14:25:28.090091 [debug] [Thread-1  ]: finished collecting timing info
14:25:28.091016 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:25:28.091978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE2F90E20>]}
14:25:28.092978 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 2.65s]
14:25:28.093977 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:28.096991 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:28.097992 [info ] [MainThread]: 
14:25:28.098998 [info ] [MainThread]: Finished running 5 table models in 11.42s.
14:25:28.099983 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:28.100978 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:25:28.101981 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:25:28.101981 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:25:28.102991 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:25:28.118042 [info ] [MainThread]: 
14:25:28.118979 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:28.120979 [info ] [MainThread]: 
14:25:28.122004 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:25:28.122978 [error] [MainThread]:   Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]
14:25:28.123978 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:25:28.124979 [info ] [MainThread]: 
14:25:28.126980 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:25:28.127979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1F2BAC0>]}


============================== 2022-04-28 14:26:59.430810 | c87f0be3-81e9-4bc5-89aa-eac0085b6fed ==============================
14:26:59.430810 [info ] [MainThread]: Running with dbt=1.0.4
14:26:59.431833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:59.432858 [debug] [MainThread]: Tracking: tracking
14:26:59.446856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA883EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA894AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA894D00>]}
14:26:59.573892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:59.574856 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:26:59.585890 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:26:59.616893 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:26:59.631884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAE50D0>]}
14:26:59.644854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAABADF0>]}
14:26:59.645865 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:59.649885 [info ] [MainThread]: 
14:26:59.651858 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:59.653860 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:59.654856 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:00.470943 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:00.470943 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:01.114753 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:01.115765 [info ] [MainThread]: 
14:27:01.123765 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.123765 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.124767 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:27:01.125766 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:27:01.126765 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.127765 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.127765 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.128765 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.132792 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:27:01.134792 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:27:01.136770 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.137770 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.138770 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.138770 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.139769 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.140788 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.141768 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:01.142787 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:01.142787 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.143769 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.143769 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.144764 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.147811 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:01.150838 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:01.151789 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.152770 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.153782 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.153782 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.154783 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.155779 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.156778 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:01.157778 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:01.158278 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.158278 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.159289 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.159643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.162654 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:01.166652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:01.167663 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.168654 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.168654 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.169657 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.170654 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.170654 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.171654 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:01.172652 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:01.173658 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.173658 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.174654 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.174654 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.178689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:01.181652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:01.183186 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.183186 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.184188 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.185188 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.185188 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.186187 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.187204 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:27:01.188188 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:27:01.189190 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.190188 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.190188 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.191188 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.194186 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:27:01.194186 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.213224 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.214194 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.215186 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.215186 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.216186 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.216186 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:27:01.217199 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.233222 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:01.234222 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:27:01.235196 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.236190 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:27:01.259216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:01.261216 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.263186 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.265185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:01.891049 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.892045 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:27:02.020400 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:02.022358 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:27:05.039832 [debug] [Thread-1  ]: finished collecting timing info
14:27:05.040815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECABB2820>]}
14:27:05.041791 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.81s]
14:27:05.043790 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:27:05.043790 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.044821 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:27:05.045801 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.046792 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.046792 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.061826 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.063805 [debug] [Thread-1  ]: finished collecting timing info
14:27:05.063805 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.066820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:05.180518 [debug] [Thread-2  ]: finished collecting timing info
14:27:05.180518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC62670>]}
14:27:05.181517 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.99s]
14:27:05.183483 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:05.184484 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.184484 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:27:05.186532 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.186532 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.187482 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.205483 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.207502 [debug] [Thread-2  ]: finished collecting timing info
14:27:05.207502 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.215515 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:05.708927 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.709931 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:27:05.830558 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.831569 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:27:09.158140 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.159104 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAFADC0>]}
14:27:09.159104 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.97s]
14:27:09.161170 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:09.315657 [debug] [Thread-1  ]: finished collecting timing info
14:27:09.316651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECBC56DF0>]}
14:27:09.317616 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.27s]
14:27:09.319635 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:09.320616 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.321617 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:27:09.322616 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.322616 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.323617 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.358618 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.360620 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.361614 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.364648 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.365647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:09.370614 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:27:11.114764 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-07-31T00:00:00.000000Z'")
14:27:13.517650 [debug] [Thread-2  ]: finished collecting timing info
14:27:13.518649 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Invalid date: '2013-09-19T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:27:13.518649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECBC9D0A0>]}
14:27:13.519682 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 4.20s]
14:27:13.521751 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:13.522648 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:13.523673 [info ] [MainThread]: 
14:27:13.524649 [info ] [MainThread]: Finished running 5 table models in 13.87s.
14:27:13.525649 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:13.526649 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:27:13.527650 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:13.527650 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:27:13.528664 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:27:13.544658 [info ] [MainThread]: 
14:27:13.545645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:27:13.546646 [info ] [MainThread]: 
14:27:13.548646 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:27:13.549646 [error] [MainThread]:   Invalid date: '2013-09-19T00:00:00.000000Z'
14:27:13.551645 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:27:13.552643 [info ] [MainThread]: 
14:27:13.553655 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:27:13.555655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAFA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC4C580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC4CAC0>]}


============================== 2022-04-28 14:29:04.195462 | eb640256-7fd0-47d5-8dd9-be4688b080d7 ==============================
14:29:04.195462 [info ] [MainThread]: Running with dbt=1.0.4
14:29:04.196491 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:29:04.197463 [debug] [MainThread]: Tracking: tracking
14:29:04.213468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CD1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CF3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CF3370>]}
14:29:04.369459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:29:04.369459 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:29:04.383461 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:29:04.413460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2F970D0>]}
14:29:04.428459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2D6EDF0>]}
14:29:04.429468 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:29:04.432462 [info ] [MainThread]: 
14:29:04.434460 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:29:04.435460 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:29:04.436459 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:29:05.098788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:29:05.098788 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:29:05.707806 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:29:05.708797 [info ] [MainThread]: 
14:29:05.716733 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.716733 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.717743 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:29:05.718715 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:29:05.718715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.719714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.719714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.720713 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.724714 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:29:05.728714 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:29:05.729715 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.730715 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.730715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.732717 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.732717 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.733716 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.735752 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:29:05.736715 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:29:05.736715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.737734 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.737734 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.738715 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.743750 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:29:05.747749 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:29:05.749714 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.749714 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.750719 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.752728 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.752728 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.753737 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.754713 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:29:05.755714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:29:05.755714 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.756714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.757716 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.757716 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.762716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:29:05.765756 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:29:05.767716 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.768737 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.768737 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.769716 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.770734 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.770734 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.771733 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:29:05.772718 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:29:05.773716 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.773716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.774718 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.775748 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.779745 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:29:05.783741 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:29:05.785714 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.785714 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.786733 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.787713 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.787713 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.788721 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.789715 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:29:05.790734 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:29:05.791715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.792725 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.793714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:05.797716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:29:05.798716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.799714 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.805743 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.837749 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:05.838714 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.839714 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.840713 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:29:05.841715 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.842716 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:29:05.843728 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.844723 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.862714 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:05.862714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:29:05.885738 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:29:05.887713 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.889715 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.895751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:29:06.529065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:29:06.530030 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:29:06.544291 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:06.546292 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:29:09.345013 [debug] [Thread-1  ]: finished collecting timing info
14:29:09.346012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA3063E20>]}
14:29:09.346012 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.50s]
14:29:09.349013 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:29:09.351019 [debug] [Thread-2  ]: finished collecting timing info
14:29:09.351019 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.352019 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA306E8B0>]}
14:29:09.353022 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:29:09.354013 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.56s]
14:29:09.355012 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:09.356014 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.357023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:09.358016 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.359014 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.373015 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:09.374013 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:29:09.376016 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:09.376016 [debug] [Thread-1  ]: finished collecting timing info
14:29:09.377021 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.377021 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.378013 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.381050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:29:09.399043 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:09.401013 [debug] [Thread-2  ]: finished collecting timing info
14:29:09.402013 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.406016 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:10.024486 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:10.026446 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:29:10.041073 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:10.042073 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:29:12.927408 [debug] [Thread-2  ]: finished collecting timing info
14:29:12.928405 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40F5AC0>]}
14:29:12.928405 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.55s]
14:29:12.930403 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:13.044404 [debug] [Thread-1  ]: finished collecting timing info
14:29:13.045434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40B2FD0>]}
14:29:13.046403 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.69s]
14:29:13.048405 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:13.049407 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.050407 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:29:13.051406 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.052404 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.052404 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.112404 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.113405 [debug] [Thread-2  ]: finished collecting timing info
14:29:13.114404 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.120405 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.122404 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:13.128404 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:29:14.981860 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-07-31T00:00:00.000000Z'")
14:29:16.449197 [debug] [Thread-2  ]: finished collecting timing info
14:29:16.450230 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Invalid date: '2014-06-20T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:29:16.451231 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40FE1C0>]}
14:29:16.452229 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.40s]
14:29:16.453189 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:16.455193 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:29:16.456230 [info ] [MainThread]: 
14:29:16.457193 [info ] [MainThread]: Finished running 5 table models in 12.02s.
14:29:16.458192 [debug] [MainThread]: Connection 'master' was properly closed.
14:29:16.459196 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:29:16.472201 [info ] [MainThread]: 
14:29:16.473209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:29:16.475190 [info ] [MainThread]: 
14:29:16.476190 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:29:16.477191 [error] [MainThread]:   Invalid date: '2014-06-20T00:00:00.000000Z'
14:29:16.478192 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:29:16.479191 [info ] [MainThread]: 
14:29:16.480191 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:29:16.481191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2FECB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2D6E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40F2670>]}


============================== 2022-04-28 14:30:20.661846 | 6be13fec-c8ca-4e7f-ba88-30d034bd357e ==============================
14:30:20.661846 [info ] [MainThread]: Running with dbt=1.0.4
14:30:20.662846 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:30:20.663858 [debug] [MainThread]: Tracking: tracking
14:30:20.678850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E89033A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8903430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8903100>]}
14:30:20.798849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
14:30:20.798849 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
14:30:20.799849 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:30:20.800850 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesReason.sql
14:30:20.800850 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:30:20.801865 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:30:20.801865 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Customer.sql
14:30:20.820866 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:30:20.835849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:30:20.838851 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:30:20.841849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:30:20.844849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:30:20.847849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:30:20.865849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8BAA0D0>]}
14:30:20.879851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E895B580>]}
14:30:20.879851 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:30:20.884850 [info ] [MainThread]: 
14:30:20.885849 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:30:20.888847 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:30:20.888847 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:21.535211 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:30:21.535211 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:22.151959 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:30:22.151959 [info ] [MainThread]: 
14:30:22.159603 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.159603 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.160601 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:30:22.161610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:30:22.161610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.162602 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.162602 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.163602 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.165629 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:30:22.168629 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:30:22.170602 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.170602 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.171606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.172602 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.172602 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.173602 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.174602 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:30:22.174602 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:30:22.175631 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.175631 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.176603 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.176603 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.180630 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:30:22.183600 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:30:22.184602 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.185603 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.186603 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.186603 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.187602 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.188602 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.189603 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:30:22.190605 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:30:22.191602 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.191602 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.192612 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.192612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.196641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:30:22.200601 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:30:22.202058 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.202058 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.203057 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.203057 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.204061 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.205059 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:30:22.206069 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.207058 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.208060 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:30:22.208060 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.209058 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.214057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:30:22.215059 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.218093 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:30:22.219073 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.219073 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.220058 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.220058 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.221061 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.223061 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:30:22.223061 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.224074 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.225079 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:30:22.225079 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.230057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:30:22.230057 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:22.231058 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.231058 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.231058 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.270093 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:22.270093 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.272060 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.273106 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.274058 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:30:22.274058 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.276061 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:30:22.294061 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:22.295064 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.296060 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:30:22.320094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:30:22.323061 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.324060 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.327068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:23.542973 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:30:23.543998 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:30:23.548997 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:23.550985 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:30:26.151884 [debug] [Thread-1  ]: finished collecting timing info
14:30:26.151884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C1C3D0>]}
14:30:26.152884 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.88s]
14:30:26.154869 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:30:26.155849 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.156857 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:30:26.158849 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.158849 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.158849 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.174850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.176849 [debug] [Thread-1  ]: finished collecting timing info
14:30:26.176849 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.179851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:26.568649 [debug] [Thread-2  ]: finished collecting timing info
14:30:26.569641 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8CDA640>]}
14:30:26.570656 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.34s]
14:30:26.572647 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:26.573651 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.574654 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:30:26.576641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:26.577643 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.577643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.596645 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:26.598638 [debug] [Thread-2  ]: finished collecting timing info
14:30:26.598638 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.607639 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:26.758433 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.760433 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:30:27.202187 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:27.203152 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:30:30.209678 [debug] [Thread-2  ]: finished collecting timing info
14:30:30.210675 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8B63D60>]}
14:30:30.211674 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.64s]
14:30:30.213494 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:31.270053 [debug] [Thread-1  ]: finished collecting timing info
14:30:31.271088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E9CECFA0>]}
14:30:31.272050 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 5.11s]
14:30:31.274048 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:31.275050 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.276050 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:30:31.277052 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.277052 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.278077 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.313081 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.314084 [debug] [Thread-2  ]: finished collecting timing info
14:30:31.315067 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.318084 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.320051 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:31.326048 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:30:50.785697 [debug] [Thread-2  ]: finished collecting timing info
14:30:50.786657 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C221C0>]}
14:30:50.786657 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (10.2m rows, 26.6 MB processed)[0m in 19.51s]
14:30:50.788657 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:50.791683 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:30:50.792658 [info ] [MainThread]: 
14:30:50.793684 [info ] [MainThread]: Finished running 5 table models in 29.91s.
14:30:50.794658 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:50.794658 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:30:50.795657 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:30:50.796657 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:30:50.796657 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:30:50.812668 [info ] [MainThread]: 
14:30:50.815658 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:50.817661 [info ] [MainThread]: 
14:30:50.819678 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:30:50.820670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8DA60>]}


============================== 2022-05-04 11:19:33.399376 | 24582295-911c-46b9-910e-2a0cd71b3489 ==============================
11:19:33.399376 [info ] [MainThread]: Running with dbt=1.0.4
11:19:33.415009 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
11:19:33.415009 [debug] [MainThread]: Tracking: tracking
11:19:33.431586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D0F3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D103CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D103580>]}
11:19:34.341129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:19:34.341129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:19:34.356749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24582295-911c-46b9-910e-2a0cd71b3489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D3620D0>]}
11:19:34.372372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24582295-911c-46b9-910e-2a0cd71b3489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D1807F0>]}
11:19:34.372372 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
11:19:34.381872 [info ] [MainThread]: 
11:19:34.382872 [debug] [MainThread]: Acquiring new bigquery connection "master"
11:19:34.384869 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
11:19:34.384869 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:19:35.174194 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
11:19:35.174194 [info ] [MainThread]: 
11:19:35.219431 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.220429 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.220429 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
11:19:35.221443 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
11:19:35.222427 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.224431 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.224431 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.225431 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.225431 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.226429 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.239428 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.244430 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.246429 [debug] [Thread-1  ]: finished collecting timing info
11:19:35.247428 [debug] [Thread-2  ]: finished collecting timing info
11:19:35.247428 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.247428 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.278430 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.281433 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.283433 [debug] [Thread-2  ]: Opening a new connection, currently in state init
11:19:35.288430 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
11:19:35.345244 [debug] [Thread-1  ]: Opening a new connection, currently in state init
11:19:35.345244 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
11:19:37.020547 [debug] [Thread-1  ]: finished collecting timing info
11:19:37.021547 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.80s]
11:19:37.022548 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:37.023547 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.024554 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
11:19:37.025549 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.026549 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.026549 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.035552 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.036552 [debug] [Thread-1  ]: finished collecting timing info
11:19:37.037549 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.040834 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.040834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:37.040834 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
11:19:37.070033 [debug] [Thread-2  ]: finished collecting timing info
11:19:37.070033 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.85s]
11:19:37.072040 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:37.073035 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.074042 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
11:19:37.075046 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.076037 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.077039 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.082030 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.083031 [debug] [Thread-2  ]: finished collecting timing info
11:19:37.084033 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.087034 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.089033 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:37.098036 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
11:19:38.698079 [debug] [Thread-1  ]: finished collecting timing info
11:19:38.698079 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.67s]
11:19:38.713702 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:38.715293 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.716292 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
11:19:38.717712 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.717712 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.718714 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.728714 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.731716 [debug] [Thread-2  ]: finished collecting timing info
11:19:38.732716 [debug] [Thread-1  ]: finished collecting timing info
11:19:38.732716 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.66s]
11:19:38.733713 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.737713 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.738715 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:38.739720 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.740714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:38.740714 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
11:19:38.742717 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.743718 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.743718 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.752713 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.753723 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:38.754713 [debug] [Thread-2  ]: finished collecting timing info
11:19:38.756713 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.759715 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.762713 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:38.778715 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:40.501624 [debug] [Thread-2  ]: finished collecting timing info
11:19:40.501624 [debug] [Thread-1  ]: finished collecting timing info
11:19:40.501624 [error] [Thread-2  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 1.76s]
11:19:40.501624 [error] [Thread-1  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.78s]
11:19:40.501624 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:40.514075 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.515351 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
11:19:40.515506 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:40.516507 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.516507 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.517545 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.517545 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
11:19:40.518508 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.519506 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.527539 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.528506 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.528506 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.534516 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.534516 [debug] [Thread-2  ]: finished collecting timing info
11:19:40.535515 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.538542 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.538542 [debug] [Thread-1  ]: finished collecting timing info
11:19:40.539505 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.541505 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.542550 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:40.543506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:40.548517 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:40.549507 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:42.155266 [debug] [Thread-1  ]: finished collecting timing info
11:19:42.155266 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.64s]
11:19:42.170597 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:42.193463 [debug] [Thread-2  ]: finished collecting timing info
11:19:42.193601 [error] [Thread-2  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 1.68s]
11:19:42.193601 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:42.196568 [debug] [MainThread]: Acquiring new bigquery connection "master"
11:19:42.197567 [info ] [MainThread]: 
11:19:42.198676 [info ] [MainThread]: Finished running 8 tests in 7.81s.
11:19:42.199932 [debug] [MainThread]: Connection 'master' was properly closed.
11:19:42.199932 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
11:19:42.200936 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
11:19:42.201163 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
11:19:42.201163 [info ] [MainThread]: 
11:19:42.216771 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
11:19:42.216771 [info ] [MainThread]: 
11:19:42.216771 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
11:19:42.216771 [error] [MainThread]:   Got 504 results, configured to fail if != 0
11:19:42.216771 [info ] [MainThread]: 
11:19:42.225450 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
11:19:42.226451 [info ] [MainThread]: 
11:19:42.227442 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
11:19:42.229438 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
11:19:42.231438 [info ] [MainThread]: 
11:19:42.232453 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
11:19:42.234443 [info ] [MainThread]: 
11:19:42.236438 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
11:19:42.238457 [error] [MainThread]:   Got 10 results, configured to fail if != 0
11:19:42.239439 [info ] [MainThread]: 
11:19:42.240441 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
11:19:42.242440 [info ] [MainThread]: 
11:19:42.243447 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
11:19:42.245438 [error] [MainThread]:   Got 7 results, configured to fail if != 0
11:19:42.247438 [info ] [MainThread]: 
11:19:42.248439 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
11:19:42.250438 [info ] [MainThread]: 
11:19:42.251441 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
11:19:42.252439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D32AEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6E4C8DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6E4C80A0>]}


============================== 2022-05-09 13:49:00.769714 | 94306435-df1e-43e7-a1aa-a388250d542b ==============================
13:49:00.769714 [info ] [MainThread]: Running with dbt=1.0.4
13:49:00.770715 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:49:00.771731 [debug] [MainThread]: Tracking: tracking
13:49:00.799715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076921E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076943460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769438B0>]}
13:49:01.662822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
13:49:01.663822 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
13:49:01.663822 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
13:49:01.664823 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
13:49:01.665794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
13:49:01.665794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
13:49:01.666794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
13:49:01.666794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
13:49:01.667794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
13:49:01.668104 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
13:49:01.668794 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
13:49:01.668794 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:49:01.669897 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
13:49:01.670429 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
13:49:01.670822 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:49:01.683822 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:49:01.716824 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:49:01.717823 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
13:49:01.724823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
13:49:01.726822 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
13:49:01.729829 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
13:49:01.736829 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
13:49:01.737830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
13:49:01.740830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:49:01.742830 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:49:01.749832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:49:01.750829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:49:01.753850 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:49:01.756829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:49:01.759829 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:49:01.765832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:49:01.766830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:49:01.769825 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:49:01.773828 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
13:49:02.039556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94306435-df1e-43e7-a1aa-a388250d542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076D030D0>]}
13:49:02.052556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94306435-df1e-43e7-a1aa-a388250d542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769D88E0>]}
13:49:02.052556 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:49:02.056556 [info ] [MainThread]: 
13:49:02.057558 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:02.059903 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:49:02.060556 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:49:03.740635 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:49:03.741705 [info ] [MainThread]: 
13:49:03.768423 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.769433 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.769433 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
13:49:03.769433 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
13:49:03.771435 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.772440 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.772440 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.773435 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.773435 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.774433 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.786471 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.791464 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.793934 [debug] [Thread-1  ]: finished collecting timing info
13:49:03.793934 [debug] [Thread-2  ]: finished collecting timing info
13:49:03.794738 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.794738 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.817469 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.821436 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.823437 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:49:03.824901 [debug] [Thread-2  ]: Opening a new connection, currently in state init
13:49:03.830462 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
13:49:03.831462 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
13:49:06.084369 [debug] [Thread-2  ]: finished collecting timing info
13:49:06.085370 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.31s]
13:49:06.086346 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:06.088343 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.088841 [info ] [Thread-2  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
13:49:06.090345 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.091346 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.092147 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.097345 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.099402 [debug] [Thread-2  ]: finished collecting timing info
13:49:06.099874 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.115377 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.116395 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:06.122340 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
13:49:06.374987 [debug] [Thread-1  ]: finished collecting timing info
13:49:06.376091 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.60s]
13:49:06.376948 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:06.377947 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.379171 [info ] [Thread-1  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
13:49:06.380948 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.380948 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.382088 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.385986 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.386947 [debug] [Thread-1  ]: finished collecting timing info
13:49:06.387951 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.389988 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.391788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:06.396982 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
13:49:08.343144 [debug] [Thread-2  ]: finished collecting timing info
13:49:08.344142 [info ] [Thread-2  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.25s]
13:49:08.345145 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:08.346142 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.347146 [info ] [Thread-2  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
13:49:08.348145 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.348682 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.349344 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.359144 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.361144 [debug] [Thread-2  ]: finished collecting timing info
13:49:08.361815 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.371147 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.396042 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:08.401041 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:08.794282 [debug] [Thread-1  ]: finished collecting timing info
13:49:08.794282 [info ] [Thread-1  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.41s]
13:49:08.796247 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:08.797246 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.797246 [info ] [Thread-1  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
13:49:08.798245 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.799245 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.799667 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.807289 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.809291 [debug] [Thread-1  ]: finished collecting timing info
13:49:08.809532 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.812281 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.861780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:08.867231 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:10.771020 [debug] [Thread-2  ]: finished collecting timing info
13:49:10.772067 [error] [Thread-2  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.42s]
13:49:10.774029 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:10.774029 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.775030 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
13:49:10.776031 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.776031 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.777233 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.783028 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.785030 [debug] [Thread-2  ]: finished collecting timing info
13:49:10.786363 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.789029 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.790883 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:10.796029 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:11.238738 [debug] [Thread-1  ]: finished collecting timing info
13:49:11.239736 [error] [Thread-1  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 2.44s]
13:49:11.241737 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:11.241737 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.242809 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
13:49:11.243739 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.244738 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.245274 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.251737 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.253965 [debug] [Thread-1  ]: finished collecting timing info
13:49:11.254739 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.259281 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.260796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:11.266774 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:13.024415 [debug] [Thread-2  ]: finished collecting timing info
13:49:13.025415 [error] [Thread-2  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 2.25s]
13:49:13.027544 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:13.697855 [debug] [Thread-1  ]: finished collecting timing info
13:49:13.698855 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.45s]
13:49:13.699858 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:13.701860 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:13.702861 [info ] [MainThread]: 
13:49:13.703870 [info ] [MainThread]: Finished running 8 tests in 11.65s.
13:49:13.704859 [debug] [MainThread]: Connection 'master' was properly closed.
13:49:13.705932 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:49:13.706859 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:49:13.706859 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
13:49:13.736955 [info ] [MainThread]: 
13:49:13.738570 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
13:49:13.739856 [info ] [MainThread]: 
13:49:13.741858 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
13:49:13.742858 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
13:49:13.744860 [info ] [MainThread]: 
13:49:13.746858 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
13:49:13.748350 [info ] [MainThread]: 
13:49:13.749887 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
13:49:13.750857 [error] [MainThread]:   Got 504 results, configured to fail if != 0
13:49:13.752869 [info ] [MainThread]: 
13:49:13.753907 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
13:49:13.756160 [info ] [MainThread]: 
13:49:13.757020 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
13:49:13.758856 [error] [MainThread]:   Got 7 results, configured to fail if != 0
13:49:13.760122 [info ] [MainThread]: 
13:49:13.761884 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
13:49:13.762858 [info ] [MainThread]: 
13:49:13.763861 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
13:49:13.765876 [error] [MainThread]:   Got 10 results, configured to fail if != 0
13:49:13.766856 [info ] [MainThread]: 
13:49:13.767934 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
13:49:13.768855 [info ] [MainThread]: 
13:49:13.770856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
13:49:13.771859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769439D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107699C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021077E104C0>]}


============================== 2022-05-09 13:58:59.655347 | 6abcbcc6-25fe-49be-95ce-292de25bb424 ==============================
13:58:59.655347 [info ] [MainThread]: Running with dbt=1.0.4
13:58:59.655347 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:58:59.656348 [debug] [MainThread]: Tracking: tracking
13:58:59.670366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B48E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B74C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B74880>]}
13:58:59.797345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
13:58:59.797345 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:58:59.798347 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
13:58:59.798997 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:58:59.799346 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
13:58:59.800540 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
13:58:59.811376 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:58:59.842346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:58:59.844347 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:58:59.851347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:58:59.853347 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:58:59.861346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:58:59.863357 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
13:58:59.866347 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
13:58:59.872347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
13:58:59.933345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6abcbcc6-25fe-49be-95ce-292de25bb424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2EFA0D0>]}
13:58:59.946347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6abcbcc6-25fe-49be-95ce-292de25bb424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2D9CA90>]}
13:58:59.947684 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:58:59.950348 [info ] [MainThread]: 
13:58:59.952347 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:58:59.954348 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:58:59.954348 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:59:00.945714 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:59:00.946661 [info ] [MainThread]: 
13:59:00.954674 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.955670 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.956660 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
13:59:00.957014 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
13:59:00.958532 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:00.960302 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:00.960302 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.961299 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.961299 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.961299 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.973302 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:00.977456 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:00.979712 [debug] [Thread-1  ]: finished collecting timing info
13:59:00.979712 [debug] [Thread-2  ]: finished collecting timing info
13:59:00.980476 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.981471 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:01.003491 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:01.006491 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:01.008839 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:59:01.009455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
13:59:01.014459 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
13:59:01.015458 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
13:59:02.653611 [debug] [Thread-1  ]: finished collecting timing info
13:59:02.654525 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.70s]
13:59:02.656241 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:02.657255 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.657692 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
13:59:02.658254 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.659419 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.659419 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.665274 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.666500 [debug] [Thread-1  ]: finished collecting timing info
13:59:02.667649 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.670253 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.672255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:02.677250 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
13:59:03.026917 [debug] [Thread-2  ]: finished collecting timing info
13:59:03.027882 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.07s]
13:59:03.028881 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:03.029882 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.030977 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
13:59:03.031882 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.032883 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.032883 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.037904 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.039725 [debug] [Thread-2  ]: finished collecting timing info
13:59:03.039884 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.041904 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.044035 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:03.051883 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
13:59:04.198795 [debug] [Thread-1  ]: finished collecting timing info
13:59:04.199787 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.54s]
13:59:04.200807 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:04.201802 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.203028 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
13:59:04.203786 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.204790 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.205228 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.214787 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.215825 [debug] [Thread-1  ]: finished collecting timing info
13:59:04.217141 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.224820 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.225787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:04.232784 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:04.673785 [debug] [Thread-2  ]: finished collecting timing info
13:59:04.674930 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.64s]
13:59:04.676795 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:04.677788 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.678536 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
13:59:04.679785 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.680785 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.681783 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.695786 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.697475 [debug] [Thread-2  ]: finished collecting timing info
13:59:04.698246 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.703785 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.704786 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:04.710787 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:06.154871 [debug] [Thread-1  ]: finished collecting timing info
13:59:06.155870 [error] [Thread-1  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.95s]
13:59:06.157878 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:06.157878 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.158912 [info ] [Thread-1  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
13:59:06.159872 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.160872 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.160872 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.165891 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.167880 [debug] [Thread-1  ]: finished collecting timing info
13:59:06.168873 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.171899 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.173870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:06.178871 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:06.499909 [debug] [Thread-2  ]: finished collecting timing info
13:59:06.501351 [error] [Thread-2  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 1.82s]
13:59:06.503350 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:06.503350 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.504350 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
13:59:06.506352 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.506352 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.507671 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.516350 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.518102 [debug] [Thread-2  ]: finished collecting timing info
13:59:06.518697 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.521349 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.523360 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:06.529834 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:07.888154 [debug] [Thread-1  ]: finished collecting timing info
13:59:07.889152 [error] [Thread-1  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 1.73s]
13:59:07.890157 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:08.282136 [debug] [Thread-2  ]: finished collecting timing info
13:59:08.283136 [error] [Thread-2  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.78s]
13:59:08.283752 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:08.285769 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:59:08.286791 [info ] [MainThread]: 
13:59:08.287926 [info ] [MainThread]: Finished running 8 tests in 8.34s.
13:59:08.288778 [debug] [MainThread]: Connection 'master' was properly closed.
13:59:08.289907 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:59:08.289907 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
13:59:08.290806 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:59:08.316765 [info ] [MainThread]: 
13:59:08.318805 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
13:59:08.320784 [info ] [MainThread]: 
13:59:08.321932 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
13:59:08.324764 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
13:59:08.325847 [info ] [MainThread]: 
13:59:08.326763 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
13:59:08.328766 [info ] [MainThread]: 
13:59:08.329763 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
13:59:08.331780 [error] [MainThread]:   Got 504 results, configured to fail if != 0
13:59:08.332765 [info ] [MainThread]: 
13:59:08.333768 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
13:59:08.335764 [info ] [MainThread]: 
13:59:08.336763 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
13:59:08.338891 [error] [MainThread]:   Got 7 results, configured to fail if != 0
13:59:08.339764 [info ] [MainThread]: 
13:59:08.341870 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
13:59:08.343764 [info ] [MainThread]: 
13:59:08.345285 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
13:59:08.346765 [error] [MainThread]:   Got 10 results, configured to fail if != 0
13:59:08.347770 [info ] [MainThread]: 
13:59:08.348768 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
13:59:08.349766 [info ] [MainThread]: 
13:59:08.352074 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
13:59:08.353765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2BF8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2BF8A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D40233D0>]}


============================== 2022-05-09 14:12:55.343393 | 88596dde-4278-4309-bfc7-dda7006a6e95 ==============================
14:12:55.343393 [info ] [MainThread]: Running with dbt=1.0.4
14:12:55.343393 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:12:55.344393 [debug] [MainThread]: Tracking: tracking
14:12:55.358395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5CDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5F4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5F4F70>]}
14:12:55.472395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:12:55.472395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:12:55.479393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D8630D0>]}
14:12:55.493394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D687760>]}
14:12:55.493394 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:12:55.497393 [info ] [MainThread]: 
14:12:55.498393 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:12:55.500543 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:12:55.501316 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:57.436925 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:12:57.437886 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:58.286503 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:12:58.287462 [info ] [MainThread]: 
14:12:58.295461 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.296463 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.297467 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:12:58.298465 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:12:58.299465 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.300465 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.300465 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.301466 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.305484 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:12:58.308498 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:12:58.335943 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.336399 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.337259 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.338246 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:12:58.338673 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.339120 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.341246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:12:58.398777 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.399248 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.399778 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.399778 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.401214 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.401778 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.402775 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:12:58.403375 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:12:58.403799 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.403799 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.405164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.405642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.408802 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:12:58.411801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:12:58.413774 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.413892 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.414777 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.414777 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.415774 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.416789 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:12:58.417441 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.417957 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.418774 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:12:58.418774 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.419775 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.422812 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:12:58.422812 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.427798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:12:58.428832 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.429774 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.429774 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.430773 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.431775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.432404 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:12:58.432966 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.433404 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.433982 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:12:58.433982 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.434776 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.437807 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:12:58.437807 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.440797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:12:58.442135 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.442776 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.443241 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.443552 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.444775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.444775 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:12:58.445908 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.447774 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:58.447774 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:12:58.448799 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.450233 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:12:58.450773 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.450773 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.487810 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:58.488809 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:12:58.525809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:12:58.525809 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.526775 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.542773 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:12:58.543620 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.543775 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.546803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.418125 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:59.419127 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:12:59.420762 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:12:59.426476 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
14:13:02.968670 [debug] [Thread-2  ]: finished collecting timing info
14:13:02.969664 [debug] [Thread-1  ]: finished collecting timing info
14:13:02.969664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D8B84F0>]}
14:13:02.970671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46E982EE0>]}
14:13:02.971669 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.3 MB processed)[0m in 4.52s]
14:13:02.972638 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 4.52s]
14:13:02.974636 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:13:02.975653 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.975653 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:13:02.976653 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:13:02.977635 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.978776 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:13:02.979641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:02.980638 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:02.980638 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.981639 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.982644 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.982644 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.996679 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:03.013667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:03.086085 [debug] [Thread-2  ]: finished collecting timing info
14:13:03.086404 [debug] [Thread-1  ]: finished collecting timing info
14:13:03.086404 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:03.087460 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:03.090077 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:13:03.097044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:03.958342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:03.960288 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:13:03.978090 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:03.980089 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason
    )

select * from final
  );
  
14:13:04.308131 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).')
14:13:05.689316 [debug] [Thread-2  ]: finished collecting timing info
14:13:05.690296 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:13:05.690296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D907460>]}
14:13:05.691296 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.71s]
14:13:05.693297 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:07.443540 [debug] [Thread-1  ]: finished collecting timing info
14:13:07.444536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D953310>]}
14:13:07.444536 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.46s]
14:13:07.446509 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:07.447502 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:13:07.448501 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:13:07.450503 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:13:07.452505 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:13:07.453503 [info ] [MainThread]: 
14:13:07.454504 [info ] [MainThread]: Finished running 5 table models in 11.96s.
14:13:07.455501 [debug] [MainThread]: Connection 'master' was properly closed.
14:13:07.456508 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:13:07.457207 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:13:07.457501 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:13:07.457501 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:13:07.469502 [info ] [MainThread]: 
14:13:07.471502 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:13:07.473502 [info ] [MainThread]: 
14:13:07.474502 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:13:07.476689 [error] [MainThread]:   Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).
14:13:07.478514 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:13:07.480502 [info ] [MainThread]: 
14:13:07.481617 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:13:07.482587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D82ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D82AE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D94C370>]}


============================== 2022-05-09 14:14:19.256284 | a4915d33-e076-441a-8276-9cd37aab37a8 ==============================
14:14:19.256284 [info ] [MainThread]: Running with dbt=1.0.4
14:14:19.257284 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:14:19.258305 [debug] [MainThread]: Tracking: tracking
14:14:19.273285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FBE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FC4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FC43D0>]}
14:14:19.398314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:14:19.398314 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:14:19.410314 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:14:19.439284 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:14:19.474284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201922960D0>]}
14:14:19.487506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201920F3CA0>]}
14:14:19.488158 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:14:19.491286 [info ] [MainThread]: 
14:14:19.492294 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:19.494284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:14:19.494284 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:20.389826 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:14:20.390402 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:21.323827 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:14:21.326828 [info ] [MainThread]: 
14:14:21.336827 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.337624 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:14:21.338826 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:21.338826 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.339826 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.345857 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:21.349827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:21.363863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:21.365747 [debug] [Thread-1  ]: finished collecting timing info
14:14:21.365833 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.382860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:14:22.244487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:22.246118 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSales
    )

select * from final
  );
  
14:14:22.653368 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).')
14:14:24.006570 [debug] [Thread-1  ]: finished collecting timing info
14:14:24.007582 [debug] [Thread-1  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:14:24.008091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201923475B0>]}
14:14:24.008618 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.67s]
14:14:24.010582 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:24.011585 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:24.012618 [info ] [MainThread]: 
14:14:24.013584 [info ] [MainThread]: Finished running 1 table model in 4.52s.
14:14:24.014586 [debug] [MainThread]: Connection 'master' was properly closed.
14:14:24.015582 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:14:24.016859 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:14:24.016859 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:14:24.030009 [info ] [MainThread]: 
14:14:24.030579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:14:24.032582 [info ] [MainThread]: 
14:14:24.034583 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:14:24.036590 [error] [MainThread]:   Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).
14:14:24.038580 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:14:24.039590 [info ] [MainThread]: 
14:14:24.040781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:14:24.042587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019234FBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019234FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020192418970>]}


============================== 2022-05-09 14:15:12.708682 | a4ec5094-3ca4-41be-9f5d-daef8a2fbe50 ==============================
14:15:12.708682 [info ] [MainThread]: Running with dbt=1.0.4
14:15:12.709685 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:12.711076 [debug] [MainThread]: Tracking: tracking
14:15:12.724691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE934EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE945940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE945310>]}
14:15:12.849681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:15:12.849681 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:15:12.861689 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:12.892682 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:12.928682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DEC070D0>]}
14:15:12.940683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE98B490>]}
14:15:12.941951 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:12.944684 [info ] [MainThread]: 
14:15:12.945652 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:12.947665 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:12.947721 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:13.823053 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:13.823671 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:14.651430 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:14.652431 [info ] [MainThread]: 
14:15:14.659436 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.660467 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:15:14.661431 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:14.662793 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.663432 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.669456 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:14.673465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:14.686465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:14.688475 [debug] [Thread-1  ]: finished collecting timing info
14:15:14.688612 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.704483 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:15.532898 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:15.534899 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:15:19.053671 [debug] [Thread-1  ]: finished collecting timing info
14:15:19.054599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DED87640>]}
14:15:19.055310 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (20.0 rows, 340.0 Bytes processed)[0m in 4.39s]
14:15:19.056619 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:19.058600 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:19.059601 [info ] [MainThread]: 
14:15:19.060599 [info ] [MainThread]: Finished running 1 table model in 6.11s.
14:15:19.061670 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:19.062599 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:19.062599 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:19.063927 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:15:19.077624 [info ] [MainThread]: 
14:15:19.078722 [info ] [MainThread]: [32mCompleted successfully[0m
14:15:19.080603 [info ] [MainThread]: 
14:15:19.082602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:15:19.083600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE98B460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE9BC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE9A6B20>]}


============================== 2022-05-09 14:15:29.968377 | 90ff6ed0-b3a1-4b92-bdfa-30007286f758 ==============================
14:15:29.968377 [info ] [MainThread]: Running with dbt=1.0.4
14:15:29.969377 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:15:29.970379 [debug] [MainThread]: Tracking: tracking
14:15:29.985380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9E90E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9EB4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9EB4490>]}
14:15:30.106376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:15:30.107377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:15:30.115377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90ff6ed0-b3a1-4b92-bdfa-30007286f758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AA1220D0>]}
14:15:30.128377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90ff6ed0-b3a1-4b92-bdfa-30007286f758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9FEC820>]}
14:15:30.129378 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:30.132382 [info ] [MainThread]: 
14:15:30.134379 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:30.136379 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:30.137379 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:30.933112 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:30.934394 [info ] [MainThread]: 
14:15:30.942409 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.943408 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.943408 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:15:30.944608 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
14:15:30.946516 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.947457 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.948408 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.948408 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.948408 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.949713 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.960409 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.966409 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.967413 [debug] [Thread-1  ]: finished collecting timing info
14:15:30.968539 [debug] [Thread-2  ]: finished collecting timing info
14:15:30.968539 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.969418 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.991441 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.995548 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.997405 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:30.998537 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:15:31.003442 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
14:15:31.004408 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:15:32.987323 [debug] [Thread-2  ]: finished collecting timing info
14:15:32.987323 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.04s]
14:15:32.989396 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:32.990286 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:32.991301 [info ] [Thread-2  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:15:32.992289 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:32.993308 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:32.993952 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:33.002286 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:33.004152 [debug] [Thread-2  ]: finished collecting timing info
14:15:33.004285 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:33.008286 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:33.010173 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:33.015288 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:15:33.599426 [debug] [Thread-1  ]: finished collecting timing info
14:15:33.599426 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.65s]
14:15:33.601390 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:33.602388 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.602388 [info ] [Thread-1  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:15:33.604408 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.604408 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.605389 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.609387 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.611594 [debug] [Thread-1  ]: finished collecting timing info
14:15:33.612485 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.616426 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.618289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:33.622334 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:15:34.917648 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.918619 [info ] [Thread-2  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.93s]
14:15:34.920617 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:34.920617 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.921627 [info ] [Thread-2  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:15:34.922613 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.922613 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.923614 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.931650 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.933132 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.933610 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.935643 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.937326 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:34.942370 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:35.585393 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.586786 [info ] [Thread-1  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.98s]
14:15:35.588799 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:35.588799 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.589799 [info ] [Thread-1  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
14:15:35.590793 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.591796 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.591796 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.596822 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.598797 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.598797 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.606828 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.607868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:35.613832 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:37.123708 [debug] [Thread-2  ]: finished collecting timing info
14:15:37.123708 [error] [Thread-2  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.20s]
14:15:37.125703 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:37.126753 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.126753 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:15:37.128088 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.128710 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.129544 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.136709 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.137709 [debug] [Thread-2  ]: finished collecting timing info
14:15:37.138707 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.140707 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.142716 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:37.148711 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:37.831617 [debug] [Thread-1  ]: finished collecting timing info
14:15:37.832578 [info ] [Thread-1  ]: 6 of 8 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 2.24s]
14:15:37.834583 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:37.834583 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.835579 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:15:37.836579 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.837578 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.837976 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.842584 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.844677 [debug] [Thread-1  ]: finished collecting timing info
14:15:37.844677 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.848615 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.849618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:37.855613 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:39.457591 [debug] [Thread-2  ]: finished collecting timing info
14:15:39.457591 [error] [Thread-2  ]: 7 of 8 FAIL 10 unique_dim_Reasons_reason_sk..................................... [[31mFAIL 10[0m in 2.33s]
14:15:39.460266 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:40.398329 [debug] [Thread-1  ]: finished collecting timing info
14:15:40.399329 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.56s]
14:15:40.400334 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:40.402334 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:40.403332 [info ] [MainThread]: 
14:15:40.404337 [info ] [MainThread]: Finished running 8 tests in 10.27s.
14:15:40.405332 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:40.406331 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:40.406848 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:15:40.407438 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:15:40.430364 [info ] [MainThread]: 
14:15:40.431340 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:15:40.433330 [info ] [MainThread]: 
14:15:40.434333 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:15:40.435330 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:15:40.436332 [info ] [MainThread]: 
14:15:40.437389 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:15:40.438335 [info ] [MainThread]: 
14:15:40.439447 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
14:15:40.441335 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:15:40.442346 [info ] [MainThread]: 
14:15:40.443331 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
14:15:40.444476 [info ] [MainThread]: 
14:15:40.445331 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:15:40.446332 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:15:40.448344 [info ] [MainThread]: 
14:15:40.449334 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:15:40.450334 [info ] [MainThread]: 
14:15:40.451504 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
14:15:40.453340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266640>]}


============================== 2022-05-09 14:20:05.608089 | 0d9040d5-8a4c-45b6-9216-1c7fe612ea77 ==============================
14:20:05.608089 [info ] [MainThread]: Running with dbt=1.0.4
14:20:05.609059 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:05.610279 [debug] [MainThread]: Tracking: tracking
14:20:05.626068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710EFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710F4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710F4CD0>]}
14:20:05.743087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:20:05.743087 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:20:05.744086 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:20:05.756089 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:20:05.788092 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:20:05.790091 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:20:05.796091 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:20:05.842090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C713D70D0>]}
14:20:05.855059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C7123DCA0>]}
14:20:05.855059 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:05.858302 [info ] [MainThread]: 
14:20:05.859074 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:05.861087 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:05.862155 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:06.971831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:06.972518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:07.947410 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:07.948445 [info ] [MainThread]: 
14:20:07.956425 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.957411 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:07.958431 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:07.959409 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.960528 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.967433 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:07.970433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:07.986442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:07.987907 [debug] [Thread-1  ]: finished collecting timing info
14:20:07.988538 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:08.004442 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:08.909687 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:08.911029 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:20:12.464933 [debug] [Thread-1  ]: finished collecting timing info
14:20:12.465933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C714F8DC0>]}
14:20:12.467459 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (20.0 rows, 340.0 Bytes processed)[0m in 4.51s]
14:20:12.469255 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:12.471086 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:12.472125 [info ] [MainThread]: 
14:20:12.472906 [info ] [MainThread]: Finished running 1 table model in 6.61s.
14:20:12.473940 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:12.474945 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:12.475938 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:12.475938 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:20:12.497956 [info ] [MainThread]: 
14:20:12.498904 [info ] [MainThread]: [32mCompleted successfully[0m
14:20:12.500324 [info ] [MainThread]: 
14:20:12.500921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:20:12.502904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C5E21E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C71452FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C71452CD0>]}


============================== 2022-05-09 14:20:26.205706 | 275787ea-2635-48bb-8def-6dc823cdcecd ==============================
14:20:26.205706 [info ] [MainThread]: Running with dbt=1.0.4
14:20:26.206707 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:20:26.207708 [debug] [MainThread]: Tracking: tracking
14:20:26.222728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D386E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3874B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3874220>]}
14:20:26.348710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:20:26.348710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:20:26.356707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '275787ea-2635-48bb-8def-6dc823cdcecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3AE20D0>]}
14:20:26.369707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '275787ea-2635-48bb-8def-6dc823cdcecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39DC700>]}
14:20:26.370707 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:26.373711 [info ] [MainThread]: 
14:20:26.374711 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:26.377728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:26.377728 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:27.279530 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:27.280529 [info ] [MainThread]: 
14:20:27.288552 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.288552 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.288552 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:20:27.289924 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:20:27.292554 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.292554 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.293651 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.294554 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.294554 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.307560 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.308553 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.316587 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.318106 [debug] [Thread-1  ]: finished collecting timing info
14:20:27.318106 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.319243 [debug] [Thread-2  ]: finished collecting timing info
14:20:27.342786 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.343580 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.346024 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.347024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:27.347986 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:20:27.352985 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:20:27.352985 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:20:29.276470 [debug] [Thread-1  ]: finished collecting timing info
14:20:29.277441 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.99s]
14:20:29.279440 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:29.620402 [debug] [Thread-2  ]: finished collecting timing info
14:20:29.620402 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_Reasons_reason_sk..................................... [[31mFAIL 10[0m in 2.33s]
14:20:29.622375 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:29.624692 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:29.625373 [info ] [MainThread]: 
14:20:29.627372 [info ] [MainThread]: Finished running 2 tests in 3.25s.
14:20:29.628373 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:29.629404 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:29.629404 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
14:20:29.630725 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:20:29.652372 [info ] [MainThread]: 
14:20:29.653450 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:20:29.655376 [info ] [MainThread]: 
14:20:29.656378 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
14:20:29.659378 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:20:29.661378 [info ] [MainThread]: 
14:20:29.662376 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
14:20:29.663541 [info ] [MainThread]: 
14:20:29.665377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:20:29.666374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39C2CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39DC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3B746D0>]}


============================== 2022-05-09 14:20:47.046054 | f8d067fb-cfdc-486f-9298-7deec12a05d4 ==============================
14:20:47.046054 [info ] [MainThread]: Running with dbt=1.0.4
14:20:47.047055 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:47.048057 [debug] [MainThread]: Tracking: tracking
14:20:47.062056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33A95EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33AA5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33AA5730>]}
14:20:47.195093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:20:47.195093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:20:47.205057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8d067fb-cfdc-486f-9298-7deec12a05d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33D020D0>]}
14:20:47.219060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8d067fb-cfdc-486f-9298-7deec12a05d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33BF8790>]}
14:20:47.220059 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:47.224058 [info ] [MainThread]: 
14:20:47.226098 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:47.228404 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:47.229123 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:48.086408 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:48.086408 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:48.903968 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:48.903968 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:48.904997 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.


============================== 2022-05-09 14:20:56.270990 | efd26036-53d7-4466-9abc-0932c66509cd ==============================
14:20:56.270990 [info ] [MainThread]: Running with dbt=1.0.4
14:20:56.272000 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:56.272991 [debug] [MainThread]: Tracking: tracking
14:20:56.286992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300266EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002674730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002674E80>]}
14:20:56.399989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:20:56.400990 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:20:56.411989 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:20:56.440989 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:20:56.475988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230029440D0>]}
14:20:56.488990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230027BCCD0>]}
14:20:56.490147 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:56.492006 [info ] [MainThread]: 
14:20:56.493992 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:56.494990 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:56.495997 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:57.387999 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:57.389453 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:58.240311 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:58.242104 [info ] [MainThread]: 
14:20:58.249115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.250117 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:58.251144 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:58.252553 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.253117 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.259152 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:58.262151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:58.278150 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:58.279230 [debug] [Thread-1  ]: finished collecting timing info
14:20:58.280116 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.299120 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:59.121697 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:59.123019 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:21:02.289083 [debug] [Thread-1  ]: finished collecting timing info
14:21:02.289083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230029C3D00>]}
14:21:02.290317 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 4.04s]
14:21:02.291926 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:02.293955 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:02.294935 [info ] [MainThread]: 
14:21:02.295974 [info ] [MainThread]: Finished running 1 table model in 5.80s.
14:21:02.297007 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:02.297953 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:21:02.297953 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:02.299368 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:21:02.311934 [info ] [MainThread]: 
14:21:02.312936 [info ] [MainThread]: [32mCompleted successfully[0m
14:21:02.315938 [info ] [MainThread]: 
14:21:02.316936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:21:02.318935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002958C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002958910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230028A1B80>]}


============================== 2022-05-09 14:21:08.536513 | b1571ba5-0880-41f5-8b99-486405bf26a3 ==============================
14:21:08.536513 [info ] [MainThread]: Running with dbt=1.0.4
14:21:08.537516 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:21:08.538531 [debug] [MainThread]: Tracking: tracking
14:21:08.552516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E105E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E125670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E125A90>]}
14:21:08.670515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:21:08.671530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:21:08.678513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1571ba5-0880-41f5-8b99-486405bf26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E3920D0>]}
14:21:08.691514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1571ba5-0880-41f5-8b99-486405bf26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E284820>]}
14:21:08.693007 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:21:08.695518 [info ] [MainThread]: 
14:21:08.697594 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:08.699518 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:21:08.699518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:09.546321 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:21:09.547284 [info ] [MainThread]: 
14:21:09.555286 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.555286 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.556286 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:21:09.556286 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:21:09.558288 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.559286 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.559612 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.560284 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.560284 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.573320 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.573320 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.580326 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.581321 [debug] [Thread-1  ]: finished collecting timing info
14:21:09.582284 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.600424 [debug] [Thread-2  ]: finished collecting timing info
14:21:09.605319 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.606336 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.608736 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.609711 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:21:09.611156 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:21:09.616704 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:21:09.616704 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:21:11.625057 [debug] [Thread-1  ]: finished collecting timing info
14:21:11.626058 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.07s]
14:21:11.628031 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:11.771512 [debug] [Thread-2  ]: finished collecting timing info
14:21:11.772511 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 2.21s]
14:21:11.774513 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:11.775514 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:11.777022 [info ] [MainThread]: 
14:21:11.778515 [info ] [MainThread]: Finished running 2 tests in 3.08s.
14:21:11.779514 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:11.780517 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:11.780924 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
14:21:11.781551 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:21:11.798828 [info ] [MainThread]: 
14:21:11.799881 [info ] [MainThread]: [32mCompleted successfully[0m
14:21:11.801836 [info ] [MainThread]: 
14:21:11.802839 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:21:11.803839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E284550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E2844F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E41CC10>]}


============================== 2022-05-09 14:22:21.221981 | 5d19acd7-2173-4f5c-b3af-8166e926838d ==============================
14:22:21.221981 [info ] [MainThread]: Running with dbt=1.0.4
14:22:21.222982 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:22:21.223982 [debug] [MainThread]: Tracking: tracking
14:22:21.236985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F72653A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7265400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7265160>]}
14:22:21.359011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:22:21.360012 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:22:21.371013 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:22:21.399981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:22:21.437012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d19acd7-2173-4f5c-b3af-8166e926838d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F75340D0>]}
14:22:21.448982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d19acd7-2173-4f5c-b3af-8166e926838d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F725F910>]}
14:22:21.449984 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:21.452986 [info ] [MainThread]: 
14:22:21.453999 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:21.457002 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:21.457983 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:22.295850 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:22.297073 [info ] [MainThread]: 
14:22:22.304512 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.304512 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.305228 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:22:22.305541 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:22:22.306760 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.307703 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.307703 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.308512 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.309227 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.323546 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.323546 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.332547 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.333739 [debug] [Thread-1  ]: finished collecting timing info
14:22:22.334512 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.335511 [debug] [Thread-2  ]: finished collecting timing info
14:22:22.357510 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.357510 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.361553 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.361553 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:22.363160 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:22:22.367509 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:22:22.369551 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:22:24.201148 [debug] [Thread-1  ]: finished collecting timing info
14:22:24.202110 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.90s]
14:22:24.203932 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:24.339076 [debug] [Thread-2  ]: finished collecting timing info
14:22:24.340040 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.03s]
14:22:24.341041 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:24.343039 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:24.344077 [info ] [MainThread]: 
14:22:24.345041 [info ] [MainThread]: Finished running 2 tests in 2.89s.
14:22:24.346042 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:24.347375 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:24.347879 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:22:24.348373 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:22:24.360067 [info ] [MainThread]: 
14:22:24.362059 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:22:24.363050 [info ] [MainThread]: 
14:22:24.364263 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:22:24.366040 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:22:24.368039 [info ] [MainThread]: 
14:22:24.369754 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:22:24.371044 [info ] [MainThread]: 
14:22:24.372044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:22:24.373234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F749A040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F749AA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7543850>]}


============================== 2022-05-09 14:22:35.402130 | 5b1c986e-e758-40fa-b2d5-81e1f84ee2c7 ==============================
14:22:35.402130 [info ] [MainThread]: Running with dbt=1.0.4
14:22:35.403130 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:22:35.404131 [debug] [MainThread]: Tracking: tracking
14:22:35.419132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB51C0>]}
14:22:35.549130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:22:35.549130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:22:35.557129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9E220D0>]}
14:22:35.569130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9D14730>]}
14:22:35.570504 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:35.574343 [info ] [MainThread]: 
14:22:35.575132 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:35.577146 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:22:35.577146 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:36.416885 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:36.417883 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:37.670867 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:37.671823 [info ] [MainThread]: 
14:22:37.680824 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.681824 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:22:37.683591 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:37.684385 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.684947 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.719264 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:22:37.723823 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:22:37.747882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:37.749247 [debug] [Thread-1  ]: finished collecting timing info
14:22:37.749247 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.766824 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:39.169258 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:39.171292 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:22:42.419150 [debug] [Thread-1  ]: finished collecting timing info
14:22:42.420151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9F49EE0>]}
14:22:42.421278 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.3 MB processed)[0m in 4.74s]
14:22:42.422156 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:42.424164 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:42.425149 [info ] [MainThread]: 
14:22:42.426147 [info ] [MainThread]: Finished running 1 table model in 6.85s.
14:22:42.427148 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:42.428385 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:22:42.428906 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:42.429149 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:22:42.445183 [info ] [MainThread]: 
14:22:42.446146 [info ] [MainThread]: [32mCompleted successfully[0m
14:22:42.448172 [info ] [MainThread]: 
14:22:42.450166 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:22:42.452161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9DEAAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BC6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9E96B50>]}


============================== 2022-05-09 14:22:51.451485 | 91972192-c86e-4b53-a5f9-7e2315d46b70 ==============================
14:22:51.451485 [info ] [MainThread]: Running with dbt=1.0.4
14:22:51.452455 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:22:51.452923 [debug] [MainThread]: Tracking: tracking
14:22:51.466492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2375EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2385A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2385580>]}
14:22:51.581457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:22:51.581457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:22:51.589490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91972192-c86e-4b53-a5f9-7e2315d46b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A25E20D0>]}
14:22:51.603407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91972192-c86e-4b53-a5f9-7e2315d46b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A24D4790>]}
14:22:51.604051 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:51.606455 [info ] [MainThread]: 
14:22:51.608459 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:51.609457 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:51.610457 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:52.714719 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:52.715717 [info ] [MainThread]: 
14:22:52.722718 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.723715 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.723715 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:22:52.724767 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:22:52.726719 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.728385 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.728722 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.729728 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.729728 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.730960 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.743754 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.750715 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.752529 [debug] [Thread-1  ]: finished collecting timing info
14:22:52.753003 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.753003 [debug] [Thread-2  ]: finished collecting timing info
14:22:52.776575 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.777580 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.780015 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.781280 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:52.781981 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:22:52.785979 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:22:52.788990 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:22:54.753783 [debug] [Thread-1  ]: finished collecting timing info
14:22:54.754744 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.03s]
14:22:54.755779 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:55.006557 [debug] [Thread-2  ]: finished collecting timing info
14:22:55.007589 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.28s]
14:22:55.009564 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:55.012592 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:55.013558 [info ] [MainThread]: 
14:22:55.014558 [info ] [MainThread]: Finished running 2 tests in 3.41s.
14:22:55.015571 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:55.016559 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:55.017331 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:22:55.017558 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:22:55.035558 [info ] [MainThread]: 
14:22:55.037558 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:22:55.039553 [info ] [MainThread]: 
14:22:55.040755 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:22:55.041557 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:22:55.043559 [info ] [MainThread]: 
14:22:55.044561 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:22:55.045779 [info ] [MainThread]: 
14:22:55.046574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:22:55.048558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A25AA880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148F49F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2675A90>]}


============================== 2022-05-09 14:23:18.443630 | 487924d3-cae5-45e1-a544-b1c9c2b40016 ==============================
14:23:18.443630 [info ] [MainThread]: Running with dbt=1.0.4
14:23:18.444631 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:23:18.445601 [debug] [MainThread]: Tracking: tracking
14:23:18.460604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B53D0>]}
14:23:18.577637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:23:18.578639 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:23:18.589629 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:23:18.619601 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:23:18.659636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '487924d3-cae5-45e1-a544-b1c9c2b40016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF5840D0>]}
14:23:18.672602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '487924d3-cae5-45e1-a544-b1c9c2b40016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF4EAD90>]}
14:23:18.673600 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:18.676631 [info ] [MainThread]: 
14:23:18.678484 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:18.679631 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:18.681093 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:19.526660 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:19.528407 [info ] [MainThread]: 
14:23:19.534699 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.535701 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.535701 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:23:19.536707 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:23:19.537697 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.538699 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.539717 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.540419 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.540697 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.541511 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.552701 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.561732 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.563122 [debug] [Thread-1  ]: finished collecting timing info
14:23:19.563987 [debug] [Thread-2  ]: finished collecting timing info
14:23:19.564486 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.564699 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.589700 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.591732 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.593824 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:19.594443 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:23:19.598706 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:23:19.600733 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:23:21.428040 [debug] [Thread-2  ]: finished collecting timing info
14:23:21.429008 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.89s]
14:23:21.430006 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:21.437048 [debug] [Thread-1  ]: finished collecting timing info
14:23:21.438165 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.90s]
14:23:21.439550 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:21.441567 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:21.442566 [info ] [MainThread]: 
14:23:21.442999 [info ] [MainThread]: Finished running 2 tests in 2.76s.
14:23:21.443567 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:21.444568 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:21.444568 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:23:21.445649 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:23:21.457563 [info ] [MainThread]: 
14:23:21.458568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:23:21.460564 [info ] [MainThread]: 
14:23:21.461746 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:23:21.463564 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:23:21.464710 [info ] [MainThread]: 
14:23:21.465561 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:23:21.466582 [info ] [MainThread]: 
14:23:21.467565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:23:21.469563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF6F6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF5845E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF593760>]}


============================== 2022-05-09 14:23:29.911887 | b54c9801-1e0b-41f3-8038-269455516b1b ==============================
14:23:29.911887 [info ] [MainThread]: Running with dbt=1.0.4
14:23:29.912889 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:23:29.913859 [debug] [MainThread]: Tracking: tracking
14:23:29.927858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB5EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB641C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB64E20>]}
14:23:30.050856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:23:30.051858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:23:30.058892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFDD20D0>]}
14:23:30.072858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFCC4730>]}
14:23:30.072858 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:30.075859 [info ] [MainThread]: 
14:23:30.077859 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:30.078859 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:23:30.079858 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:30.938228 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:30.938228 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:31.745530 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:31.746523 [info ] [MainThread]: 
14:23:31.754485 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.755491 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:23:31.756485 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:31.757488 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.757488 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.781482 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:23:31.785491 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:23:31.802218 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:31.804030 [debug] [Thread-1  ]: finished collecting timing info
14:23:31.804219 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.820218 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:32.674302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:32.676278 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:23:35.825666 [debug] [Thread-1  ]: finished collecting timing info
14:23:35.826684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFE69C70>]}
14:23:35.827629 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 4.07s]
14:23:35.829137 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:35.832058 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:35.832580 [info ] [MainThread]: 
14:23:35.833252 [info ] [MainThread]: Finished running 1 table model in 5.76s.
14:23:35.834469 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:35.835161 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:23:35.835993 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:35.836473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:23:35.853030 [info ] [MainThread]: 
14:23:35.854090 [info ] [MainThread]: [32mCompleted successfully[0m
14:23:35.856043 [info ] [MainThread]: 
14:23:35.857287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:23:35.859040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFDD2DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DECC8F280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFE46B80>]}


============================== 2022-05-09 14:23:42.556743 | 5cf3fc77-1c25-4ac7-9071-3b01edc924a8 ==============================
14:23:42.556743 [info ] [MainThread]: Running with dbt=1.0.4
14:23:42.556743 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:23:42.557745 [debug] [MainThread]: Tracking: tracking
14:23:42.572743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC65EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC75490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC75340>]}
14:23:42.688743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:23:42.688743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:23:42.696743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cf3fc77-1c25-4ac7-9071-3b01edc924a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FED20D0>]}
14:23:42.708745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cf3fc77-1c25-4ac7-9071-3b01edc924a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FDC4790>]}
14:23:42.709951 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:42.712741 [info ] [MainThread]: 
14:23:42.714002 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:42.715745 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:42.715745 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:43.536106 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:43.536106 [info ] [MainThread]: 
14:23:43.543105 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.543105 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.544108 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:23:43.545175 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:23:43.547107 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.548109 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.548109 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.549197 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.549443 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.550085 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.562892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.569921 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.572187 [debug] [Thread-1  ]: finished collecting timing info
14:23:43.572187 [debug] [Thread-2  ]: finished collecting timing info
14:23:43.572884 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.573141 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.597923 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.600885 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.601976 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:43.603169 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:23:43.608885 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:23:43.608885 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:23:45.549162 [debug] [Thread-1  ]: finished collecting timing info
14:23:45.549162 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.00s]
14:23:45.551373 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:45.727197 [debug] [Thread-2  ]: finished collecting timing info
14:23:45.728199 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.18s]
14:23:45.729237 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:45.731195 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:45.732195 [info ] [MainThread]: 
14:23:45.733199 [info ] [MainThread]: Finished running 2 tests in 3.02s.
14:23:45.734193 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:45.735195 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:45.735592 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:23:45.736403 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:23:45.756232 [info ] [MainThread]: 
14:23:45.757227 [info ] [MainThread]: [32mCompleted successfully[0m
14:23:45.759234 [info ] [MainThread]: 
14:23:45.760193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:23:45.762206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FE9A880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43CD8F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FF5F910>]}


============================== 2022-05-09 14:24:39.403875 | 19d5157f-8397-455d-be9d-24cd4975ce2a ==============================
14:24:39.403875 [info ] [MainThread]: Running with dbt=1.0.4
14:24:39.404843 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:24:39.404843 [debug] [MainThread]: Tracking: tracking
14:24:39.419842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5983E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59A4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59A4A90>]}
14:24:39.532871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:24:39.533869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:24:39.541871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5C130D0>]}
14:24:39.554838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5B00820>]}
14:24:39.555736 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:39.557840 [info ] [MainThread]: 
14:24:39.558843 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:39.561222 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:24:39.562421 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:40.713863 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:40.714863 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:41.671987 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:24:41.672986 [info ] [MainThread]: 
14:24:41.680983 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.680983 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:24:41.683533 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.683985 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.684986 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.707019 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:41.710019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:41.712474 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:41.715992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:41.736020 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.737872 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.737984 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.753018 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:24:45.850839 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:45.852803 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:24:49.814441 [debug] [Thread-1  ]: finished collecting timing info
14:24:49.815458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5CB6FD0>]}
14:24:49.816405 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 8.13s]
14:24:49.817404 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:49.819405 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:49.820596 [info ] [MainThread]: 
14:24:49.821408 [info ] [MainThread]: Finished running 1 table model in 10.26s.
14:24:49.822405 [debug] [MainThread]: Connection 'master' was properly closed.
14:24:49.822405 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:24:49.823407 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:24:49.823828 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:24:49.836030 [info ] [MainThread]: 
14:24:49.837423 [info ] [MainThread]: [32mCompleted successfully[0m
14:24:49.838426 [info ] [MainThread]: 
14:24:49.840406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:24:49.841647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5BF7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5AD2D90>]}


============================== 2022-05-09 14:24:59.321109 | a2a91a23-d86b-491f-8e15-1ef198c202ba ==============================
14:24:59.321109 [info ] [MainThread]: Running with dbt=1.0.4
14:24:59.321109 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:24:59.322652 [debug] [MainThread]: Tracking: tracking
14:24:59.336099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4190>]}
14:24:59.459099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:24:59.459099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:24:59.467100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a91a23-d86b-491f-8e15-1ef198c202ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC8420D0>]}
14:24:59.481098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a91a23-d86b-491f-8e15-1ef198c202ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC734760>]}
14:24:59.481098 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:59.484105 [info ] [MainThread]: 
14:24:59.486105 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:59.487105 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:59.488136 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:00.317562 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:25:00.318561 [info ] [MainThread]: 
14:25:00.326565 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.327559 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.327559 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:25:00.328562 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:25:00.329627 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.331560 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.331560 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.332569 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.332569 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.333570 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.343589 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.360884 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.361585 [debug] [Thread-1  ]: finished collecting timing info
14:25:00.363000 [debug] [Thread-2  ]: finished collecting timing info
14:25:00.363000 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.364011 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.385589 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.388559 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.390384 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:25:00.391035 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:25:00.396590 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:25:00.399560 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:25:02.314023 [debug] [Thread-1  ]: finished collecting timing info
14:25:02.314023 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.98s]
14:25:02.316996 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:02.495993 [debug] [Thread-2  ]: finished collecting timing info
14:25:02.495993 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.16s]
14:25:02.497998 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:02.499995 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:02.501996 [info ] [MainThread]: 
14:25:02.503156 [info ] [MainThread]: Finished running 2 tests in 3.02s.
14:25:02.504563 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:02.505472 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:25:02.506450 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:25:02.506994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:25:02.527995 [info ] [MainThread]: 
14:25:02.529009 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:02.531001 [info ] [MainThread]: 
14:25:02.531997 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:25:02.533998 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:25:02.534999 [info ] [MainThread]: 
14:25:02.536009 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:25:02.537994 [info ] [MainThread]: 
14:25:02.538998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:25:02.540996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC80A820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFC96FF2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC8DCBB0>]}


============================== 2022-05-09 14:26:20.690193 | 7430c674-7a0b-4d37-ab96-ae1a188a56c0 ==============================
14:26:20.690193 [info ] [MainThread]: Running with dbt=1.0.4
14:26:20.690193 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:20.691193 [debug] [MainThread]: Tracking: tracking
14:26:20.706196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADD5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADE5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADE5940>]}
14:26:20.828196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:20.829196 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:26:20.841195 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:26:20.871193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:26:20.910193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB0A50D0>]}
14:26:20.927194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB031460>]}
14:26:20.928468 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:20.931197 [info ] [MainThread]: 
14:26:20.932195 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:20.934204 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:20.935198 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:22.025181 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:26:22.025181 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:22.800395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:26:22.802396 [info ] [MainThread]: 
14:26:22.810395 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.811396 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:26:22.813399 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:22.813963 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.814398 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.821405 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:26:22.825397 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:26:22.827065 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:26:22.830432 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:26:22.850423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:22.852203 [debug] [Thread-1  ]: finished collecting timing info
14:26:22.852609 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.868424 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:26:23.717570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:23.719562 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:26:24.637962 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name countryRegion_id is ambiguous at [63:32]')
14:26:26.558394 [debug] [Thread-1  ]: finished collecting timing info
14:26:26.559029 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Column name countryRegion_id is ambiguous at [63:32]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:26:26.559607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB15EB80>]}
14:26:26.559607 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 3.75s]
14:26:26.561454 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:26.563390 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:26.563390 [info ] [MainThread]: 
14:26:26.564390 [info ] [MainThread]: Finished running 1 table model in 5.63s.
14:26:26.566400 [debug] [MainThread]: Connection 'master' was properly closed.
14:26:26.567031 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:26:26.567585 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:26:26.568077 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:26:26.580394 [info ] [MainThread]: 
14:26:26.581478 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:26:26.583389 [info ] [MainThread]: 
14:26:26.584392 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:26:26.586410 [error] [MainThread]:   Column name countryRegion_id is ambiguous at [63:32]
14:26:26.587392 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:26:26.589393 [info ] [MainThread]: 
14:26:26.590391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:26:26.591391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB214D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB214D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB2140D0>]}


============================== 2022-05-09 14:26:53.722086 | a4607667-3ec0-4654-b544-7a4853497ce9 ==============================
14:26:53.722086 [info ] [MainThread]: Running with dbt=1.0.4
14:26:53.723086 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:53.724480 [debug] [MainThread]: Tracking: tracking
14:26:53.739092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7444F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7444100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA74443A0>]}
14:26:53.860116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:53.861090 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:26:53.875089 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:26:53.906086 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:26:53.945085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA77150D0>]}
14:26:53.958086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA749C220>]}
14:26:53.959086 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:53.962088 [info ] [MainThread]: 
14:26:53.963087 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:53.965087 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:53.965087 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:54.857628 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:26:54.857628 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:55.665543 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:26:55.718287 [info ] [MainThread]: 
14:26:55.726302 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.727299 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:26:55.729301 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:55.730298 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.731305 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.738323 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:26:55.741323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:26:55.742325 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:26:55.746300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:26:55.769313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:55.770312 [debug] [Thread-1  ]: finished collecting timing info
14:26:55.771402 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.788334 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:26:56.620815 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:56.622297 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:26:59.538207 [debug] [Thread-1  ]: finished collecting timing info
14:26:59.539175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA77B5C10>]}
14:26:59.539175 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.81s]
14:26:59.541335 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:59.543176 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:59.544178 [info ] [MainThread]: 
14:26:59.545855 [info ] [MainThread]: Finished running 1 table model in 5.58s.
14:26:59.547179 [debug] [MainThread]: Connection 'master' was properly closed.
14:26:59.548174 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:26:59.548174 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:26:59.549191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:26:59.562529 [info ] [MainThread]: 
14:26:59.563702 [info ] [MainThread]: [32mCompleted successfully[0m
14:26:59.565178 [info ] [MainThread]: 
14:26:59.567179 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:26:59.568181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7884E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7884DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA78843D0>]}


============================== 2022-05-09 14:27:06.939645 | 48f04524-90bd-4c83-a9e7-0ca52f435169 ==============================
14:27:06.939645 [info ] [MainThread]: Running with dbt=1.0.4
14:27:06.940645 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:27:06.941945 [debug] [MainThread]: Tracking: tracking
14:27:06.956632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5D30>]}
14:27:07.077645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:27:07.078645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:27:07.086649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f04524-90bd-4c83-a9e7-0ca52f435169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166230D0>]}
14:27:07.099645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f04524-90bd-4c83-a9e7-0ca52f435169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD16517790>]}
14:27:07.100786 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:27:07.103616 [info ] [MainThread]: 
14:27:07.104614 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:07.106654 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:07.107646 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:09.698579 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:09.699573 [info ] [MainThread]: 
14:27:09.707554 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.707554 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.708062 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:27:09.709084 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:27:09.710554 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.711963 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.712557 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.713557 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.714748 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.715655 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.726554 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.736595 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.738555 [debug] [Thread-1  ]: finished collecting timing info
14:27:09.738929 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.739757 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.739757 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.763554 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.765588 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.767995 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:27:09.768552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:27:09.773550 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:27:09.774552 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:27:11.696806 [debug] [Thread-1  ]: finished collecting timing info
14:27:11.696806 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.99s]
14:27:11.699416 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:12.267360 [debug] [Thread-2  ]: finished collecting timing info
14:27:12.268323 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.56s]
14:27:12.269321 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:12.271323 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:12.272323 [info ] [MainThread]: 
14:27:12.273326 [info ] [MainThread]: Finished running 2 tests in 5.17s.
14:27:12.275250 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:12.275323 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:12.276417 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:27:12.277334 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:27:12.295353 [info ] [MainThread]: 
14:27:12.296591 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:27:12.298351 [info ] [MainThread]: 
14:27:12.300342 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:27:12.302345 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:27:12.303364 [info ] [MainThread]: 
14:27:12.304356 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:27:12.305356 [info ] [MainThread]: 
14:27:12.306355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:27:12.308354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD034DF2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166AD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166ADD00>]}


============================== 2022-05-09 14:46:46.458134 | 9a41fd36-c96a-47fe-a8ee-de4a3855ef69 ==============================
14:46:46.458134 [info ] [MainThread]: Running with dbt=1.0.4
14:46:46.459135 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:46:46.460151 [debug] [MainThread]: Tracking: tracking
14:46:46.476136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF598E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C53D0>]}
14:46:46.592135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:46:46.593134 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:46:46.594135 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:46:46.594500 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:46:46.595149 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:46:46.595660 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:46:46.596136 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:46:46.596829 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:46:46.597134 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:46:46.598135 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:46:46.598135 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:46:46.599395 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:46:46.611170 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:46:46.642134 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:46:46.644135 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:46:46.651134 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:46:46.653150 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:46:46.657534 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:46:46.667135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:46:46.668135 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:46:46.672239 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:46:46.675135 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:46:46.684169 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:46:46.686259 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:46:46.689169 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:46:46.692169 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:46:46.697164 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:46:46.701078 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:46:46.709136 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:46:46.712137 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:46:46.716135 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:46:46.861135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF9870A0>]}
14:46:46.874138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C53D0>]}
14:46:46.875135 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:46:46.878138 [info ] [MainThread]: 
14:46:46.879138 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:46.881231 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:46:46.882154 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:48.090658 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:46:48.091659 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:48.994363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:46:48.995349 [info ] [MainThread]: 
14:46:49.003335 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.003335 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:46:49.005338 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.006335 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.007412 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.014364 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:49.017365 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:49.018794 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:46:49.022372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:46:49.044346 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.046433 [debug] [Thread-1  ]: finished collecting timing info
14:46:49.046433 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.069363 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:46:49.919624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.921625 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:46:53.278656 [debug] [Thread-1  ]: finished collecting timing info
14:46:53.279658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C5880>]}
14:46:53.280768 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.27s]
14:46:53.283656 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:53.285655 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:53.286658 [info ] [MainThread]: 
14:46:53.287681 [info ] [MainThread]: Finished running 1 table model in 6.41s.
14:46:53.288704 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:53.290139 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:46:53.290655 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:46:53.290655 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:46:53.308430 [info ] [MainThread]: 
14:46:53.309656 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:53.311296 [info ] [MainThread]: 
14:46:53.312655 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:46:53.313656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF77D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5BF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF616880>]}


============================== 2022-05-09 14:47:00.265806 | 4a426cbc-03e6-469e-ba82-4355ea9b1212 ==============================
14:47:00.265806 [info ] [MainThread]: Running with dbt=1.0.4
14:47:00.266802 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:47:00.267769 [debug] [MainThread]: Tracking: tracking
14:47:00.281770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF72EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF734D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF734BE0>]}
14:47:00.401798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:47:00.401798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:47:00.409798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a426cbc-03e6-469e-ba82-4355ea9b1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF9A10D0>]}
14:47:00.422766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a426cbc-03e6-469e-ba82-4355ea9b1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF7C0730>]}
14:47:00.423766 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:47:00.426768 [info ] [MainThread]: 
14:47:00.427782 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:47:00.429768 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:47:00.430956 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:47:01.269754 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:47:01.271147 [info ] [MainThread]: 
14:47:01.278613 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.278613 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.279611 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:47:01.280062 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:47:01.281829 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.282614 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.282614 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.283682 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.284625 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.285068 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.296611 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.304615 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.306210 [debug] [Thread-1  ]: finished collecting timing info
14:47:01.306210 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.306878 [debug] [Thread-2  ]: finished collecting timing info
14:47:01.329911 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.330880 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.333915 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.333915 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:47:01.335880 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:47:01.339876 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:47:01.339876 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:47:03.288451 [debug] [Thread-1  ]: finished collecting timing info
14:47:03.288451 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.01s]
14:47:03.290494 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:03.503301 [debug] [Thread-2  ]: finished collecting timing info
14:47:03.504436 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.22s]
14:47:03.505264 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:03.507264 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:47:03.508605 [info ] [MainThread]: 
14:47:03.509937 [info ] [MainThread]: Finished running 2 tests in 3.08s.
14:47:03.510466 [debug] [MainThread]: Connection 'master' was properly closed.
14:47:03.511368 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:47:03.512398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:47:03.512398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:47:03.531278 [info ] [MainThread]: 
14:47:03.533264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:47:03.535265 [info ] [MainThread]: 
14:47:03.536264 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:47:03.537266 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:47:03.538263 [info ] [MainThread]: 
14:47:03.540263 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:47:03.541264 [info ] [MainThread]: 
14:47:03.542515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:47:03.544266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF969DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF7C02B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFA387F0>]}


============================== 2022-05-09 14:50:08.657845 | 9b3ed4b4-797f-4ce6-a405-69fc204ddec6 ==============================
14:50:08.657845 [info ] [MainThread]: Running with dbt=1.0.4
14:50:08.658846 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:50:08.659858 [debug] [MainThread]: Tracking: tracking
14:50:08.674848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A24E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A45670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A45B20>]}
14:50:08.794846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:08.794846 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:50:08.806881 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:50:08.836845 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:50:08.874846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653D100D0>]}
14:50:08.886846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A453A0>]}
14:50:08.887847 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:08.889850 [info ] [MainThread]: 
14:50:08.891847 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:08.892854 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:50:08.894366 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:09.553391 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:09.554351 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:10.097646 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:10.098504 [info ] [MainThread]: 
14:50:10.106516 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.107170 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:50:10.108517 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.109007 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.109571 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.116547 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:50:10.122554 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:50:10.123517 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:50:10.126550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:50:10.154724 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.155725 [debug] [Thread-1  ]: finished collecting timing info
14:50:10.156724 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.171724 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:10.766130 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.767092 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:50:15.183823 [debug] [Thread-1  ]: finished collecting timing info
14:50:15.184786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653DEDAC0>]}
14:50:15.185314 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 5.08s]
14:50:15.186794 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:15.188803 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:15.189784 [info ] [MainThread]: 
14:50:15.190844 [info ] [MainThread]: Finished running 1 table model in 6.30s.
14:50:15.191810 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:15.192958 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:50:15.193366 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:15.193787 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:50:15.209171 [info ] [MainThread]: 
14:50:15.210076 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:15.211789 [info ] [MainThread]: 
14:50:15.212803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:50:15.214789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88370>]}


============================== 2022-05-09 14:50:22.515754 | 190e50eb-977c-4eb4-a920-918ea3cb313e ==============================
14:50:22.515754 [info ] [MainThread]: Running with dbt=1.0.4
14:50:22.516754 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:50:22.517815 [debug] [MainThread]: Tracking: tracking
14:50:22.532720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A47E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A75130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A75A30>]}
14:50:22.697719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:50:22.697719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:50:22.706880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190e50eb-977c-4eb4-a920-918ea3cb313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674CE10D0>]}
14:50:22.723720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '190e50eb-977c-4eb4-a920-918ea3cb313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AE8760>]}
14:50:22.724717 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:22.726720 [info ] [MainThread]: 
14:50:22.728720 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:22.730720 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:22.730720 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:23.337943 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:23.339205 [info ] [MainThread]: 
14:50:23.346216 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.347255 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.347255 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:50:23.348217 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:50:23.350217 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.351314 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.351314 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.352217 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.352958 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.353520 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.365258 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.372251 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.374218 [debug] [Thread-1  ]: finished collecting timing info
14:50:23.375216 [debug] [Thread-2  ]: finished collecting timing info
14:50:23.375216 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.375216 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.400251 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.402252 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.404312 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:23.404312 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:50:23.410658 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:50:23.413310 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:50:25.152318 [debug] [Thread-1  ]: finished collecting timing info
14:50:25.153321 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.80s]
14:50:25.155283 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:25.329923 [debug] [Thread-2  ]: finished collecting timing info
14:50:25.330897 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.98s]
14:50:25.332896 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:25.333896 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:25.335280 [info ] [MainThread]: 
14:50:25.335920 [info ] [MainThread]: Finished running 2 tests in 2.61s.
14:50:25.337892 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:25.337892 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:25.338893 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:50:25.339559 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:50:25.358783 [info ] [MainThread]: 
14:50:25.358890 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:25.360891 [info ] [MainThread]: 
14:50:25.362905 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:50:25.364893 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:50:25.365891 [info ] [MainThread]: 
14:50:25.366893 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:50:25.368891 [info ] [MainThread]: 
14:50:25.369893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:50:25.371893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AF1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AE8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674D78340>]}


============================== 2022-05-09 14:50:42.113016 | 7d375c24-d00b-4391-a201-b235ff6f13bb ==============================
14:50:42.113016 [info ] [MainThread]: Running with dbt=1.0.4
14:50:42.113731 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:50:42.115037 [debug] [MainThread]: Tracking: tracking
14:50:42.129735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C8FFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C905F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C905220>]}
14:50:42.247761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:42.248761 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:50:42.259760 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:50:42.292760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:50:42.331760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CBCD0D0>]}
14:50:42.343732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C976DC0>]}
14:50:42.344731 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:42.347761 [info ] [MainThread]: 
14:50:42.348733 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:42.349732 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:50:42.350735 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:43.013758 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:43.013758 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:43.748618 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:43.749605 [info ] [MainThread]: 
14:50:43.757601 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.757601 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:50:43.759879 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:43.760610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.761260 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.768636 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:50:43.773604 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:50:43.775610 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:50:43.778601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:50:43.807638 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:43.808604 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.810121 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.825637 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:44.369853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:44.371296 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:50:48.006906 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.007869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CC7DA90>]}
14:50:48.008471 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 4.25s]
14:50:48.009869 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:48.011868 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:48.012868 [info ] [MainThread]: 
14:50:48.013888 [info ] [MainThread]: Finished running 1 table model in 5.66s.
14:50:48.014871 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:48.016249 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:50:48.016868 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:48.017161 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:50:48.032869 [info ] [MainThread]: 
14:50:48.034141 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:48.035150 [info ] [MainThread]: 
14:50:48.036152 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:50:48.038152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021169A2E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CD46D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CD46340>]}


============================== 2022-05-09 14:50:53.894456 | de1f6220-eb0c-45c6-9c74-001ebd126d33 ==============================
14:50:53.894456 [info ] [MainThread]: Running with dbt=1.0.4
14:50:53.894456 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:50:53.895460 [debug] [MainThread]: Tracking: tracking
14:50:53.911457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688BE2E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C05C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C05F70>]}
14:50:54.027455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:50:54.028947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:50:54.036466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1f6220-eb0c-45c6-9c74-001ebd126d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688E710D0>]}
14:50:54.049456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1f6220-eb0c-45c6-9c74-001ebd126d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688D67760>]}
14:50:54.050652 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:54.053458 [info ] [MainThread]: 
14:50:54.055457 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:54.056457 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:54.057457 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:54.728563 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:54.729562 [info ] [MainThread]: 
14:50:54.737561 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.737561 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.738581 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:50:54.738581 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:50:54.740586 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.742565 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.742565 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.743565 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.744670 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.745082 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.755563 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.762595 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.764649 [debug] [Thread-1  ]: finished collecting timing info
14:50:54.764649 [debug] [Thread-2  ]: finished collecting timing info
14:50:54.765561 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.766288 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.790595 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.793563 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.795151 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:54.795560 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:50:54.801562 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:50:54.801562 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:50:56.454208 [debug] [Thread-1  ]: finished collecting timing info
14:50:56.455206 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.71s]
14:50:56.456209 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:56.612760 [debug] [Thread-2  ]: finished collecting timing info
14:50:56.612760 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 1.87s]
14:50:56.614855 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:56.616904 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:56.617904 [info ] [MainThread]: 
14:50:56.618866 [info ] [MainThread]: Finished running 2 tests in 2.56s.
14:50:56.619876 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:56.619876 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:56.620898 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:50:56.621621 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:50:56.641945 [info ] [MainThread]: 
14:50:56.643668 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:56.645866 [info ] [MainThread]: 
14:50:56.646868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:50:56.648874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C87820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F5D2F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688EFDC40>]}


============================== 2022-05-09 14:52:02.356965 | 05dd308c-b91a-4cab-860f-0a65e6cd4b93 ==============================
14:52:02.356965 [info ] [MainThread]: Running with dbt=1.0.4
14:52:02.357966 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:52:02.358969 [debug] [MainThread]: Tracking: tracking
14:52:02.372983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9077EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90784550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90784B50>]}
14:52:02.491002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:52:02.491002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:52:02.498966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D909F20D0>]}
14:52:02.511967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D908116D0>]}
14:52:02.513089 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:52:02.515970 [info ] [MainThread]: 
14:52:02.517970 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:02.519966 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:52:02.519966 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:14.478694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:14.478694 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:15.075953 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:15.076957 [info ] [MainThread]: 
14:52:15.084967 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.085951 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.086956 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:52:15.087963 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:52:15.088953 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.089440 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.090020 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.090020 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.092953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:52:15.096986 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:52:15.098021 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.098734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.098952 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.099132 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.099953 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.100956 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:15.100956 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.102522 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.102955 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:15.103953 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.104110 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.106954 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:15.106954 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.110954 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:15.111704 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.112438 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.113009 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.113092 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.113954 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.114670 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:15.115333 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.115952 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.116954 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:15.116954 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.117960 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.121987 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:15.121987 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.125988 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:15.126660 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.127112 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.128092 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.128092 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.128988 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:15.128988 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.130368 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.130955 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.130955 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.132037 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:15.136992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:15.137987 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.139330 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.139963 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.142055 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:15.142986 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.144165 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.145611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:52:15.145611 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.146196 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.147205 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.147205 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.148206 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.152233 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:52:15.153207 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:52:15.154206 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.155333 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.156205 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.156205 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.157205 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.157692 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.158420 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:52:15.195242 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.197215 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.197215 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.198510 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:15.198674 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.239240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.239240 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.254240 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:15.255661 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.256491 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.258205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:15.818235 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.820630 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.822247 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
14:52:15.822708 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:52:18.870296 [debug] [Thread-1  ]: finished collecting timing info
14:52:18.870296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A57550>]}
14:52:18.871666 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 3.67s]
14:52:18.873291 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:18.874297 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.875301 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:52:18.876297 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:18.877297 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.877297 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.894295 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:18.896176 [debug] [Thread-1  ]: finished collecting timing info
14:52:18.897019 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.900201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:19.475483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:19.476440 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:52:19.980471 [debug] [Thread-2  ]: finished collecting timing info
14:52:19.980471 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A604F0>]}
14:52:19.981467 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 4.83s]
14:52:19.983148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:19.984164 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:19.984164 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:52:19.986160 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:19.986160 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:19.987161 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:20.023195 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:20.024158 [debug] [Thread-2  ]: finished collecting timing info
14:52:20.024727 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:20.026196 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:20.896845 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:20.898429 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:52:22.808685 [debug] [Thread-1  ]: finished collecting timing info
14:52:22.809681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91B58FD0>]}
14:52:22.810645 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 3.93s]
14:52:22.812645 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:24.234135 [debug] [Thread-2  ]: finished collecting timing info
14:52:24.234912 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A608E0>]}
14:52:24.235559 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 4.25s]
14:52:24.237135 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:24.238132 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.238132 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:52:24.240134 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.240134 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.241136 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.287171 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.288172 [debug] [Thread-1  ]: finished collecting timing info
14:52:24.288172 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.293740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:24.834417 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.883934 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:52:25.746119 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: salesOrder_id at [116:14]')
14:52:26.630754 [debug] [Thread-1  ]: finished collecting timing info
14:52:26.631751 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: salesOrder_id at [116:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:52:26.632788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91BC55E0>]}
14:52:26.633749 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 2.39s]
14:52:26.635750 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:26.637761 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:26.638804 [info ] [MainThread]: 
14:52:26.639771 [info ] [MainThread]: Finished running 5 table models in 24.12s.
14:52:26.640771 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:26.641658 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:52:26.642106 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:26.642762 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:52:26.643217 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:52:26.667420 [info ] [MainThread]: 
14:52:26.667811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:52:26.669800 [info ] [MainThread]: 
14:52:26.671578 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:52:26.672750 [error] [MainThread]:   Unrecognized name: salesOrder_id at [116:14]
14:52:26.673750 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:52:26.675298 [info ] [MainThread]: 
14:52:26.675776 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:52:26.677288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D908111C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D909D5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90ACD460>]}


============================== 2022-05-11 02:16:37.973675 | eab84cd1-63de-4b10-9370-c13df492d0b5 ==============================
02:16:37.973675 [info ] [MainThread]: Running with dbt=1.0.4
02:16:37.974648 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:16:37.975644 [debug] [MainThread]: Tracking: tracking
02:16:38.006649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA64820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA64100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA645E0>]}
02:16:39.172149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:16:39.173147 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
02:16:39.192168 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:16:39.240147 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:16:39.260147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDCB90D0>]}
02:16:39.283161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDAE1E50>]}
02:16:39.284148 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:16:39.292157 [info ] [MainThread]: 
02:16:39.293150 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:39.295147 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
02:16:39.296149 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:40.793471 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:16:40.794432 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:41.463215 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:16:41.464249 [info ] [MainThread]: 
02:16:41.684441 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.685440 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.685440 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:16:41.686439 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:16:41.687439 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.687439 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.688440 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.688440 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.692476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:16:41.695476 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:16:41.698010 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.699011 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.699011 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.700048 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.700048 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.702016 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:16:41.702016 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.703010 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.704013 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:16:41.704013 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.705017 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.708009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:16:41.709010 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.712047 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:16:41.713009 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.713009 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.714010 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.715013 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.716012 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.716012 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.718013 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:16:41.718013 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:16:41.719049 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.719666 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.719666 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.720677 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.723232 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:16:41.727246 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:16:41.729250 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.730233 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.730233 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.731237 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.731237 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.732262 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:16:41.733236 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.734234 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.735232 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:16:41.735232 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.736234 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.739231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:16:41.740231 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.743232 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:16:41.744232 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.745245 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.745245 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.746238 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.747237 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.748233 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:16:41.748233 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.749270 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.750235 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:16:41.751236 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.755231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:16:41.755231 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:41.756234 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.757232 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.776268 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:41.776268 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.778236 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.778236 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.778236 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.779235 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:16:41.780238 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.781234 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:16:41.798235 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:16:41.798235 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.799234 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:16:41.837265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:16:41.857235 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.858232 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.860234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:42.521335 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:42.523386 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:16:42.524323 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:16:42.549715 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:16:45.408120 [debug] [Thread-1  ]: finished collecting timing info
02:16:45.411122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDD90910>]}
02:16:45.412152 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 3.63s]
02:16:45.415121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:16:45.415121 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.416121 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
02:16:45.418121 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:45.418121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.419121 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.435120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:45.451490 [debug] [Thread-1  ]: finished collecting timing info
02:16:45.451490 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.454490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:45.684095 [debug] [Thread-2  ]: finished collecting timing info
02:16:45.685128 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDE41910>]}
02:16:45.686101 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 3.93s]
02:16:45.688094 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:45.688094 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.689089 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
02:16:45.690089 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:45.691091 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.693090 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.730125 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:45.765197 [debug] [Thread-2  ]: finished collecting timing info
02:16:45.765197 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.769195 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:16:46.093984 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:46.095986 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
02:16:46.436829 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:46.438075 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
02:16:48.780006 [debug] [Thread-1  ]: finished collecting timing info
02:16:48.781003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEE726A0>]}
02:16:48.781003 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 3.36s]
02:16:48.782967 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:49.439877 [debug] [Thread-2  ]: finished collecting timing info
02:16:49.439877 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDE3B1C0>]}
02:16:49.440827 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 3.75s]
02:16:49.442828 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:49.443831 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.443831 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
02:16:49.445829 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:49.445829 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.446828 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.485850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:49.486850 [debug] [Thread-1  ]: finished collecting timing info
02:16:49.487846 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.489852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:50.101507 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:50.102505 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
02:17:01.183481 [debug] [Thread-1  ]: finished collecting timing info
02:17:01.184482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2FD0>]}
02:17:01.184482 [info ] [Thread-1  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (785.5k rows, 29.4 MB processed)[0m in 11.74s]
02:17:01.186487 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:17:01.188495 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:01.189479 [info ] [MainThread]: 
02:17:01.190479 [info ] [MainThread]: Finished running 5 table models in 21.90s.
02:17:01.192480 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:01.192480 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
02:17:01.193481 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:17:01.194480 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:17:01.194480 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:17:01.219517 [info ] [MainThread]: 
02:17:01.220481 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:01.222481 [info ] [MainThread]: 
02:17:01.223484 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
02:17:01.224481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDCB9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2E50>]}


============================== 2022-05-11 02:17:25.025140 | e284098a-f769-4d8c-bec3-a5753f3a01f6 ==============================
02:17:25.025140 [info ] [MainThread]: Running with dbt=1.0.4
02:17:25.026139 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:17:25.027143 [debug] [MainThread]: Tracking: tracking
02:17:25.039153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EEDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EF3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EF3220>]}
02:17:25.168175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:17:25.168175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:17:25.179143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e284098a-f769-4d8c-bec3-a5753f3a01f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE581610D0>]}
02:17:25.194161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e284098a-f769-4d8c-bec3-a5753f3a01f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57F8B730>]}
02:17:25.195144 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:25.198141 [info ] [MainThread]: 
02:17:25.199141 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:25.200140 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:17:25.201141 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:25.912838 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:17:25.913829 [info ] [MainThread]: 
02:17:25.921688 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.921688 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.921688 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:17:25.922725 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
02:17:25.923692 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.925691 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.925691 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.926693 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.926693 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.927694 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.939726 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.943728 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.945725 [debug] [Thread-2  ]: finished collecting timing info
02:17:25.945725 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.969690 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.970695 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:17:25.974689 [debug] [Thread-1  ]: finished collecting timing info
02:17:25.975694 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.978723 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.978723 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
02:17:25.980717 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:25.985722 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:17:27.761647 [debug] [Thread-1  ]: finished collecting timing info
02:17:27.762647 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.84s]
02:17:27.764652 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:27.764652 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.765652 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
02:17:27.766647 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.766647 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.767647 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.774647 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.775646 [debug] [Thread-1  ]: finished collecting timing info
02:17:27.776646 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.779646 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.780646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:27.787646 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
02:17:27.822985 [debug] [Thread-2  ]: finished collecting timing info
02:17:27.823986 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.90s]
02:17:27.824963 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:27.825963 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.826961 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
02:17:27.827961 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.827961 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.828961 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.833961 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.834975 [debug] [Thread-2  ]: finished collecting timing info
02:17:27.835961 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.837994 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.838961 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:27.843964 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
02:17:29.565304 [debug] [Thread-1  ]: finished collecting timing info
02:17:29.566298 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.80s]
02:17:29.568300 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:29.568300 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.569313 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:17:29.570298 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.571301 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.571301 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.580298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.581298 [debug] [Thread-1  ]: finished collecting timing info
02:17:29.582297 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.585311 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.586299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:29.591308 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:29.642332 [debug] [Thread-2  ]: finished collecting timing info
02:17:29.643333 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.82s]
02:17:29.644299 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:29.645299 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.645299 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
02:17:29.647303 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.647303 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.648307 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.652336 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.653301 [debug] [Thread-2  ]: finished collecting timing info
02:17:29.653301 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.657300 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.659321 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:29.664299 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:31.496266 [debug] [Thread-1  ]: finished collecting timing info
02:17:31.497265 [info ] [Thread-1  ]: 5 of 8 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 1.93s]
02:17:31.498267 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:31.499271 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.499271 [info ] [Thread-1  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
02:17:31.500268 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.501267 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.501267 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.508269 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.539276 [debug] [Thread-1  ]: finished collecting timing info
02:17:31.540274 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.545270 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.547268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:31.554266 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:31.631269 [debug] [Thread-2  ]: finished collecting timing info
02:17:31.632269 [info ] [Thread-2  ]: 6 of 8 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 1.99s]
02:17:31.633269 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:31.634267 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.635267 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
02:17:31.636267 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.637269 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.637269 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.644267 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.645267 [debug] [Thread-2  ]: finished collecting timing info
02:17:31.646268 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.649267 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.650267 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:31.655265 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:33.332509 [debug] [Thread-1  ]: finished collecting timing info
02:17:33.333506 [info ] [Thread-1  ]: 7 of 8 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 1.83s]
02:17:33.335507 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:33.545987 [debug] [Thread-2  ]: finished collecting timing info
02:17:33.546989 [info ] [Thread-2  ]: 8 of 8 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 1.91s]
02:17:33.547990 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:33.548990 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:33.549989 [info ] [MainThread]: 
02:17:33.549989 [info ] [MainThread]: Finished running 8 tests in 8.35s.
02:17:33.550991 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:17:33.567989 [info ] [MainThread]: 
02:17:33.568987 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:33.569990 [info ] [MainThread]: 
02:17:33.570990 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
02:17:33.571991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE581C56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE592C7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE592C7FD0>]}


============================== 2022-05-11 02:18:21.286726 | d9034a29-b811-4f59-8c06-610aab53dcf9 ==============================
02:18:21.286726 [info ] [MainThread]: Running with dbt=1.0.4
02:18:21.287727 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:18:21.288727 [debug] [MainThread]: Tracking: tracking
02:18:21.304729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7D3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7F1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7F1F70>]}
02:18:21.599563 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:18:21.600555 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:18:21.602556 [info ] [MainThread]: 
02:18:21.603571 [info ] [MainThread]: 
02:18:21.604555 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-11 02:18:41.919832 | 789f4fe5-f659-45d9-a96b-960862181a7b ==============================
02:18:41.919832 [info ] [MainThread]: Running with dbt=1.0.4
02:18:41.920833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
02:18:41.921833 [debug] [MainThread]: Tracking: tracking
02:18:41.935837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C33E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51AC0>]}
02:18:42.060868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:18:42.060868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:18:42.069833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '789f4fe5-f659-45d9-a96b-960862181a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08EC20D0>]}
02:18:42.084849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '789f4fe5-f659-45d9-a96b-960862181a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08CDF850>]}
02:18:42.085833 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:18:42.089833 [info ] [MainThread]: 
02:18:42.090863 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:42.092834 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:18:42.093833 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:42.780179 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:18:42.781180 [info ] [MainThread]: 
02:18:42.787183 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.787183 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.788181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:42.789183 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:18:42.790182 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.791184 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.791184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.792186 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.797182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:42.800181 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:18:42.802181 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.802181 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.803182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.804182 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.805182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.806185 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.808188 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:18:42.809183 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:18:42.810183 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.810183 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.811183 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.812181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.817184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:18:42.823196 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:18:42.825198 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.826183 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.827185 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.828183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.829181 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.830182 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.831181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:18:42.832182 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:18:42.832182 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.833182 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.834181 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.834181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.841184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:18:42.847183 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:18:42.848182 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.849184 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.850182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.851183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.852182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.852182 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.853182 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:18:42.854181 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:18:42.855190 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.856183 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.857184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.858188 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.865182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:18:42.871181 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:18:42.873187 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.873187 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.874181 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.875184 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.876181 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.877183 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.878181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:42.879184 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:18:42.879184 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.880182 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.880182 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.881182 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.887183 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:42.943180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:18:42.944180 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.945182 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.946182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.946182 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.947190 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:18:42.947190 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.948181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:18:42.949182 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.950181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:18:42.950181 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:42.951180 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:18:42.951180 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:18:42.995179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:18:42.995179 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:42.996179 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.010178 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.012178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:18:43.012178 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:18:43.013180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.013180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.014183 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:18:43.014183 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.015182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.015182 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.016181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:43.017181 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.017181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.017181 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.018182 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.018182 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:18:43.047179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:43.047179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.048179 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.057181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.059181 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:18:43.059181 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.060180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.060180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.061179 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.061179 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.061179 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.062184 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.063183 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:18:43.063183 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.064182 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.064182 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.065180 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.065180 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:18:43.072179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:18:43.072179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.073179 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.077180 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:18:43.077180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.078180 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.078180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.078180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.079180 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.079180 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.080188 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.080188 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.081180 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:18:43.081180 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.082179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.082179 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.082179 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.083179 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:18:43.087179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:18:43.088180 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.088180 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.093179 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:18:43.094181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.094181 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.095181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.095181 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.095181 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.096181 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.096181 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.097180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.097180 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:18:43.098179 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.098179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.098179 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.099179 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.099179 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:18:43.103179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:18:43.104179 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.105181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.105181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.138178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:18:43.138178 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.139179 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.140179 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.140179 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.141192 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.141192 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.142188 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:18:43.142188 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.143179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.143179 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.144194 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.144194 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.149178 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:18:43.149178 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:18:43.150179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.151180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.151180 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.152198 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.156179 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:18:43.156179 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.157179 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.158179 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.158179 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.159194 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.159194 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.160193 [debug] [MainThread]: Connection 'master' was properly closed.
02:18:43.161179 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:18:43.161179 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:18:43.162181 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:18:43.177185 [info ] [MainThread]: Done.
02:18:43.181183 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
02:18:43.182181 [info ] [MainThread]: Building catalog
02:18:43.185182 [debug] [MainThread]: Opening a new connection, currently in state init
02:18:43.836893 [debug] [ThreadPool]: Acquiring new bigquery connection "valid-sol-346522.information_schema"
02:18:43.837886 [debug] [ThreadPool]: Acquiring new bigquery connection "valid-sol-346522.information_schema"
02:18:43.853879 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:43.856852 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:43.862891 [debug] [ThreadPool]: On valid-sol-346522.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "connection_name": "valid-sol-346522.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `valid-sol-346522`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `valid-sol-346522`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `valid-sol-346522`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:18:43.863852 [debug] [ThreadPool]: On valid-sol-346522.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "connection_name": "valid-sol-346522.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `valid-sol-346522`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `valid-sol-346522`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `valid-sol-346522`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:18:48.094412 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\dbt_IA_AdventureWorks\target\catalog.json
02:18:48.095413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08FBBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08FBBEE0>]}
02:18:49.257210 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:18:49.257210 [debug] [MainThread]: Connection 'valid-sol-346522.information_schema' was properly closed.
02:18:49.258230 [debug] [MainThread]: Connection 'valid-sol-346522.information_schema' was properly closed.


============================== 2022-05-11 02:18:56.243388 | 59f0a4a5-416b-4083-b455-e63b36a56242 ==============================
02:18:56.243388 [info ] [MainThread]: Running with dbt=1.0.4
02:18:56.244364 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:18:56.245359 [debug] [MainThread]: Tracking: tracking
02:18:56.260353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71B1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71BC70>]}
02:18:56.263354 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:18:56.265352 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:18:56.266352 [info ] [MainThread]: 
02:18:56.267354 [info ] [MainThread]: 
02:18:56.268354 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-13 00:14:49.709272 | e4c67b0b-b156-424e-a647-8c5a2a160fdd ==============================
00:14:49.709272 [info ] [MainThread]: Running with dbt=1.0.4
00:14:49.710272 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
00:14:49.710272 [debug] [MainThread]: Tracking: tracking
00:14:49.740272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B46D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B471D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B471280>]}
00:14:53.548854 [debug] [MainThread]: Executing "git --help"
00:14:53.602852 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
00:14:53.602852 [debug] [MainThread]: STDERR: "b''"
00:14:53.609852 [debug] [MainThread]: Acquiring new bigquery connection "debug"
00:14:53.609852 [debug] [MainThread]: Opening a new connection, currently in state init
00:14:53.621947 [debug] [MainThread]: On debug: select 1 as id
00:14:55.575406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3992AF280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AC195640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AC195130>]}
00:14:56.467499 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-13 00:32:31.848847 | a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e ==============================
00:32:31.848847 [info ] [MainThread]: Running with dbt=1.0.4
00:32:31.849847 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:32:31.850848 [debug] [MainThread]: Tracking: tracking
00:32:31.879849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C0410DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04112BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04112D90>]}
00:32:31.947846 [info ] [MainThread]: Unable to do partial parsing because profile has changed
00:32:31.948847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04167FD0>]}
00:32:33.095413 [debug] [MainThread]: Parsing macros\adapters.sql
00:32:33.142414 [debug] [MainThread]: Parsing macros\catalog.sql
00:32:33.155412 [debug] [MainThread]: Parsing macros\etc.sql
00:32:33.159413 [debug] [MainThread]: Parsing macros\materializations\copy.sql
00:32:33.165414 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
00:32:33.196415 [debug] [MainThread]: Parsing macros\materializations\seed.sql
00:32:33.200414 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
00:32:33.203413 [debug] [MainThread]: Parsing macros\materializations\table.sql
00:32:33.211412 [debug] [MainThread]: Parsing macros\materializations\view.sql
00:32:33.218415 [debug] [MainThread]: Parsing macros\adapters\columns.sql
00:32:33.242414 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
00:32:33.250412 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
00:32:33.257417 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
00:32:33.275416 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
00:32:33.284413 [debug] [MainThread]: Parsing macros\adapters\relation.sql
00:32:33.299413 [debug] [MainThread]: Parsing macros\adapters\schema.sql
00:32:33.302412 [debug] [MainThread]: Parsing macros\etc\datetime.sql
00:32:33.316412 [debug] [MainThread]: Parsing macros\etc\statement.sql
00:32:33.325413 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
00:32:33.328413 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
00:32:33.330414 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
00:32:33.331412 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
00:32:33.332412 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
00:32:33.334410 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
00:32:33.337412 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
00:32:33.341413 [debug] [MainThread]: Parsing macros\materializations\configs.sql
00:32:33.345413 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
00:32:33.349414 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
00:32:33.357411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
00:32:33.369410 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
00:32:33.371411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
00:32:33.386411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
00:32:33.404411 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
00:32:33.409415 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
00:32:33.421417 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
00:32:33.426423 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
00:32:33.431414 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
00:32:33.433412 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
00:32:33.442415 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
00:32:33.460411 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
00:32:33.467411 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
00:32:33.479411 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
00:32:33.492411 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
00:32:33.494410 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
00:32:33.511410 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
00:32:33.513412 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
00:32:33.518411 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
00:32:33.520412 [debug] [MainThread]: Parsing tests\generic\builtin.sql
00:32:33.525412 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
00:32:33.527412 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
00:32:33.529412 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
00:32:33.531412 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
00:32:33.533412 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
00:32:33.536412 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
00:32:33.544420 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
00:32:33.548411 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
00:32:33.559410 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
00:32:33.561411 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
00:32:33.564411 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
00:32:33.565411 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
00:32:33.567412 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
00:32:33.569412 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
00:32:33.571412 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
00:32:33.575411 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
00:32:33.577412 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
00:32:33.587412 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
00:32:33.589411 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
00:32:33.590411 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
00:32:33.593413 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
00:32:33.595412 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
00:32:33.598411 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
00:32:33.600412 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
00:32:33.606411 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
00:32:33.608412 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
00:32:33.610412 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
00:32:33.613412 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
00:32:33.615411 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
00:32:33.617411 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
00:32:33.632412 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
00:32:33.635413 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
00:32:33.637413 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
00:32:33.639413 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
00:32:33.650412 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
00:32:33.653414 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
00:32:33.655412 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
00:32:33.658412 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
00:32:33.661412 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
00:32:33.664412 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
00:32:33.667411 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
00:32:33.669412 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
00:32:33.671412 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
00:32:33.675412 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
00:32:33.677412 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
00:32:33.678412 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
00:32:33.680412 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
00:32:33.682412 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
00:32:33.708411 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
00:32:33.713412 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
00:32:33.716410 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
00:32:33.721411 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
00:32:33.728411 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
00:32:33.732427 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
00:32:33.734412 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
00:32:33.738411 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
00:32:33.743412 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
00:32:33.749412 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
00:32:33.752414 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
00:32:33.754411 [debug] [MainThread]: Parsing macros\sql\groupby.sql
00:32:33.756412 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
00:32:33.763413 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
00:32:33.765411 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
00:32:33.767412 [debug] [MainThread]: Parsing macros\sql\pivot.sql
00:32:33.772412 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
00:32:33.774412 [debug] [MainThread]: Parsing macros\sql\star.sql
00:32:33.779411 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
00:32:33.784412 [debug] [MainThread]: Parsing macros\sql\union.sql
00:32:33.795411 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
00:32:33.804411 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
00:32:33.807412 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
00:32:33.809411 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
00:32:34.252530 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
00:32:34.291528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
00:32:34.293526 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:32:34.300526 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:32:34.302529 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
00:32:34.309528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
00:32:34.311527 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
00:32:34.320528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
00:32:34.322527 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
00:32:34.330527 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
00:32:34.334526 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
00:32:34.337525 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
00:32:34.340555 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
00:32:34.344556 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:32:34.347548 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
00:32:34.350557 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
00:32:34.353527 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
00:32:34.356526 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
00:32:34.359527 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
00:32:34.527528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C044090D0>]}
00:32:34.542527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C0438F550>]}
00:32:34.543527 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:32:34.546527 [info ] [MainThread]: 
00:32:34.589526 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:32:34.591527 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
00:32:34.592529 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:35.858706 [debug] [ThreadPool]: Acquiring new bigquery connection "create_snappy-meridian-350123_AdventureWorks_marts"
00:32:35.858706 [debug] [ThreadPool]: Acquiring new bigquery connection "create_snappy-meridian-350123_AdventureWorks_marts"
00:32:35.859702 [debug] [ThreadPool]: BigQuery adapter: Creating schema "snappy-meridian-350123.AdventureWorks_marts".
00:32:35.859702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:32:36.650304 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
00:32:36.651305 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:37.257314 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
00:32:37.259308 [info ] [MainThread]: 
00:32:37.292307 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.292307 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.293307 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:32:37.294306 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:32:37.295309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.296307 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.297308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.297308 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.307305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:32:37.311310 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:32:37.313306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.314306 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.314306 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.315326 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.316310 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.317306 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:32:37.318310 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.318310 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.319305 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:32:37.320305 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.320305 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.326305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:32:37.326305 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.332307 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:32:37.333304 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.334308 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.335305 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.335305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.336305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:32:37.337307 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.338308 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.339318 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.339318 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.341307 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:32:37.346307 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:32:37.347309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.348308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.348308 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.352306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:32:37.353309 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.355306 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.356321 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:32:37.356321 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.357311 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.358309 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.358309 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.359311 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.363308 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:32:37.365309 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:32:37.365309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.366308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.367309 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.371306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:32:37.373307 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.374306 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.375305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:32:37.375305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.376309 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.377310 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.377310 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.378310 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.383305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:32:37.384305 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
00:32:37.385306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.386306 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.387309 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.388312 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.388312 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.389309 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.390307 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:32:37.416306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.417305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.418305 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.418305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.419307 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:32:37.419307 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.463306 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.506308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.508310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:32:37.514307 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
00:32:37.561306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.562306 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.566307 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.568335 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:37.574309 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
00:32:41.661864 [debug] [Thread-2  ]: finished collecting timing info
00:32:41.663865 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04566B80>]}
00:32:41.663865 [info ] [Thread-2  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.25s]
00:32:41.665866 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:32:41.666867 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.666867 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
00:32:41.667866 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.668868 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.668868 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.732866 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.759865 [debug] [Thread-2  ]: finished collecting timing info
00:32:41.759865 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.764885 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.766865 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:41.772866 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
00:32:41.848870 [debug] [Thread-1  ]: finished collecting timing info
00:32:41.848870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045580D0>]}
00:32:41.849870 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.46s]
00:32:41.850868 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:41.851868 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.852880 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:32:41.854867 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.854867 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.855869 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.926871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.965870 [debug] [Thread-1  ]: finished collecting timing info
00:32:41.966867 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.973868 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.978868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:32:41.987867 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
00:32:45.647699 [debug] [Thread-2  ]: finished collecting timing info
00:32:45.648694 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045DF760>]}
00:32:45.649696 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.98s]
00:32:45.651696 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:45.846713 [debug] [Thread-1  ]: finished collecting timing info
00:32:45.847697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041FFAC0>]}
00:32:45.848717 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.99s]
00:32:45.850721 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:45.852698 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.853698 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
00:32:45.854695 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.854695 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.855695 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.916696 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.918698 [debug] [Thread-2  ]: finished collecting timing info
00:32:45.918698 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.924696 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.926700 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:45.933696 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
00:32:51.146608 [debug] [Thread-2  ]: finished collecting timing info
00:32:51.147640 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041FF9A0>]}
00:32:51.148640 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 5.29s]
00:32:51.150610 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:51.152611 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:32:51.152611 [info ] [MainThread]: 
00:32:51.154610 [info ] [MainThread]: Finished running 5 table models in 16.61s.
00:32:51.155611 [debug] [MainThread]: Connection 'master' was properly closed.
00:32:51.155611 [debug] [MainThread]: Connection 'create_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:32:51.156627 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:32:51.157624 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:32:51.157624 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
00:32:51.174612 [info ] [MainThread]: 
00:32:51.175610 [info ] [MainThread]: [32mCompleted successfully[0m
00:32:51.177616 [info ] [MainThread]: 
00:32:51.178610 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
00:32:51.180610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C044740D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045ADB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041D8310>]}


============================== 2022-05-13 00:52:49.629588 | 637889ba-6ce8-4aa4-888f-34061c8bd85b ==============================
00:52:49.629588 [info ] [MainThread]: Running with dbt=1.0.4
00:52:49.630588 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:52:49.631590 [debug] [MainThread]: Tracking: tracking
00:52:49.645588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4CE711F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4CE71700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DB82F10>]}
00:52:49.924152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:52:49.924152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:52:49.942151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DDE40D0>]}
00:52:49.964151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DCFF850>]}
00:52:49.965150 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:52:49.970154 [info ] [MainThread]: 
00:52:49.972155 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:52:49.974153 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
00:52:49.975154 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:52:51.122786 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
00:52:51.123786 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:52:51.691785 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
00:52:51.692785 [info ] [MainThread]: 
00:52:51.699786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.699786 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.700786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:52:51.701787 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:52:51.702786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.702786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.703786 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.703786 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.709786 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:52:51.714786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:52:51.716785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.717786 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.717786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.718785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.719785 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.720785 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.721785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:52:51.722784 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:52:51.722784 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.723785 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.723785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.724787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.728785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:52:51.731785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:52:51.733785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.733785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.734786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.735785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.736785 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.736785 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.737787 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:52:51.738786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:52:51.738786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.738786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.739785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.740787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.744783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:52:51.747786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:52:51.749785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.749785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.750786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.751786 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.751786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.752784 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.753785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:52:51.754786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:52:51.754786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.755787 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.756787 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.756787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.761783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:52:51.766785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:52:51.768785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.768785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.769788 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.770785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.771786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.771786 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.772787 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:52:51.773785 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
00:52:51.773785 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.774785 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:51.775785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.775785 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.780785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:52:51.780785 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.830786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:51.830786 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.831786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.832786 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.832786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.833785 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.834787 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:52:51.853784 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:52:51.854786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:52:51.855787 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.856786 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:52:51.909785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:52:51.911784 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.913785 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.919783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:52:52.498783 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:52.501786 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:52:52.503788 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
00:52:52.504786 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
00:52:55.805471 [debug] [Thread-2  ]: finished collecting timing info
00:52:55.806471 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DEE4760>]}
00:52:55.807472 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 4.03s]
00:52:55.808472 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:55.809472 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.809472 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
00:52:55.810472 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:55.811472 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.811472 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.827470 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:55.828471 [debug] [Thread-2  ]: finished collecting timing info
00:52:55.828471 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.831472 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:52:55.887475 [debug] [Thread-1  ]: finished collecting timing info
00:52:55.888475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DE6A100>]}
00:52:55.888475 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 77.3 KB processed)[0m in 4.03s]
00:52:55.890472 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:52:55.890472 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.891474 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:52:55.892474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:55.893476 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.893476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.936472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:55.938472 [debug] [Thread-1  ]: finished collecting timing info
00:52:55.938472 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.945472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:52:56.396026 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:56.397024 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
00:52:56.528025 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:56.529027 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
00:52:59.413025 [debug] [Thread-2  ]: finished collecting timing info
00:52:59.414024 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DF0FC70>]}
00:52:59.414024 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 170.0 Bytes processed)[0m in 3.60s]
00:52:59.416025 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
00:53:00.501210 [debug] [Thread-1  ]: finished collecting timing info
00:53:00.502209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DF0FF40>]}
00:53:00.503209 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 1.7 KB processed)[0m in 4.61s]
00:53:00.505210 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:53:00.506208 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.506208 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
00:53:00.508209 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:00.509213 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.509213 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.564208 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:00.566210 [debug] [Thread-2  ]: finished collecting timing info
00:53:00.567210 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.569209 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:53:01.134209 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:01.136209 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
00:53:07.996810 [debug] [Thread-2  ]: finished collecting timing info
00:53:07.997817 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF3AF40>]}
00:53:07.997817 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (131.9k rows, 15.1 MB processed)[0m in 7.49s]
00:53:07.999809 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:08.001810 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:53:08.002812 [info ] [MainThread]: 
00:53:08.003809 [info ] [MainThread]: Finished running 5 table models in 18.03s.
00:53:08.004813 [debug] [MainThread]: Connection 'master' was properly closed.
00:53:08.005810 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
00:53:08.005810 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:53:08.006809 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:53:08.006809 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
00:53:08.024808 [info ] [MainThread]: 
00:53:08.025809 [info ] [MainThread]: [32mCompleted successfully[0m
00:53:08.026813 [info ] [MainThread]: 
00:53:08.027810 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
00:53:08.028810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96D00>]}


============================== 2022-05-13 02:13:22.999785 | 29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb ==============================
02:13:22.999785 [info ] [MainThread]: Running with dbt=1.0.4
02:13:23.000784 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:13:23.001801 [debug] [MainThread]: Tracking: tracking
02:13:23.018803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A17319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A1731700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14749D0>]}
02:13:23.840784 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
02:13:23.841784 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:13:23.842785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:13:23.842785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:13:23.843784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:13:23.843784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:13:23.844784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:13:23.844784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:13:23.845784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:13:23.845784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:13:23.846784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:13:23.847784 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:13:23.858786 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:13:23.892784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:13:23.893784 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:13:23.902784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:13:23.903784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:13:23.906784 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:13:23.914785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:13:23.915784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:13:23.918784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
02:13:23.922785 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:13:23.929785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:13:23.931787 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:13:23.933784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:13:23.936783 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:13:23.939784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:13:23.942784 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:13:23.948784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:13:23.950783 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:13:23.952786 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:13:24.080785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B183B0D0>]}
02:13:24.094785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B1474880>]}
02:13:24.094785 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:13:24.097783 [info ] [MainThread]: 
02:13:24.099788 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:24.101788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:13:24.101788 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:25.224370 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:13:25.225370 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:25.837387 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:13:25.838370 [info ] [MainThread]: 
02:13:25.847373 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.848370 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:13:25.851389 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:25.852370 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.853371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.863372 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:13:25.867371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:13:25.884382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:25.885369 [debug] [Thread-1  ]: finished collecting timing info
02:13:25.886369 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.905368 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:13:26.509967 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:26.511984 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:13:29.573967 [debug] [Thread-1  ]: finished collecting timing info
02:13:29.574969 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B17EA850>]}
02:13:29.574969 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 3.72s]
02:13:29.576977 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:29.579970 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:29.580981 [info ] [MainThread]: 
02:13:29.581970 [info ] [MainThread]: Finished running 1 table model in 5.48s.
02:13:29.582969 [debug] [MainThread]: Connection 'master' was properly closed.
02:13:29.583970 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:13:29.584969 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:13:29.584969 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:13:29.598970 [info ] [MainThread]: 
02:13:29.600969 [info ] [MainThread]: [32mCompleted successfully[0m
02:13:29.602972 [info ] [MainThread]: 
02:13:29.603970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:13:29.604970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B1563BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14CBA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14C6430>]}


============================== 2022-05-13 02:13:40.863457 | 18eaa0af-e744-4243-9101-b3993efa9dd9 ==============================
02:13:40.863457 [info ] [MainThread]: Running with dbt=1.0.4
02:13:40.864457 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:13:40.865467 [debug] [MainThread]: Tracking: tracking
02:13:40.882459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309BDC4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001308B0D1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001308B0D1940>]}
02:13:41.015008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:13:41.016007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:13:41.028008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eaa0af-e744-4243-9101-b3993efa9dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0460D0>]}
02:13:41.042011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eaa0af-e744-4243-9101-b3993efa9dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309BE6E850>]}
02:13:41.042011 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:13:41.046009 [info ] [MainThread]: 
02:13:41.048013 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:41.050011 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:13:41.050011 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:41.640009 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:13:41.641011 [info ] [MainThread]: 
02:13:41.649009 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.649009 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.649009 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:13:41.650031 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:13:41.652009 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.654011 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.654011 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.655009 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.655009 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.655009 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.669007 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.676011 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.719008 [debug] [Thread-1  ]: finished collecting timing info
02:13:41.719008 [debug] [Thread-2  ]: finished collecting timing info
02:13:41.720009 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.720009 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.743007 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.746008 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.748024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:13:41.749012 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:13:41.757009 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:13:41.757009 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:13:43.483007 [debug] [Thread-1  ]: finished collecting timing info
02:13:43.485009 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.83s]
02:13:43.488022 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:43.870008 [debug] [Thread-2  ]: finished collecting timing info
02:13:43.870008 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.22s]
02:13:43.872015 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:43.874009 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:43.875021 [info ] [MainThread]: 
02:13:43.877023 [info ] [MainThread]: Finished running 2 tests in 2.83s.
02:13:43.878020 [debug] [MainThread]: Connection 'master' was properly closed.
02:13:43.879009 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:13:43.879009 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:13:43.880009 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:13:43.899017 [info ] [MainThread]: 
02:13:43.901009 [info ] [MainThread]: [32mCompleted successfully[0m
02:13:43.903010 [info ] [MainThread]: 
02:13:43.904010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:13:43.905009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013088F0D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0D3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0D3940>]}


============================== 2022-05-13 02:14:03.451556 | e616d884-da4e-4025-9d7d-e7e3376f7592 ==============================
02:14:03.451556 [info ] [MainThread]: Running with dbt=1.0.4
02:14:03.452560 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:14:03.453559 [debug] [MainThread]: Tracking: tracking
02:14:03.468556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9DE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9E4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9E4C10>]}
02:14:03.630556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:14:03.631556 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:14:03.643556 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:14:03.674556 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:14:03.713556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDD2B0D0>]}
02:14:03.726556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA66B20>]}
02:14:03.727556 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:03.730569 [info ] [MainThread]: 
02:14:03.731556 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:03.733558 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:14:03.733558 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:04.353557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:04.354556 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:04.957146 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:04.958146 [info ] [MainThread]: 
02:14:04.965166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.966148 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:14:04.968148 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:04.969150 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.970147 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.976147 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:14:04.979147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:14:04.995147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:04.996146 [debug] [Thread-1  ]: finished collecting timing info
02:14:04.996146 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:05.014146 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:05.609146 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:05.611152 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:14:09.355878 [debug] [Thread-1  ]: finished collecting timing info
02:14:09.356879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDD51220>]}
02:14:09.357878 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 4.39s]
02:14:09.358895 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:09.360880 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:09.361881 [info ] [MainThread]: 
02:14:09.362884 [info ] [MainThread]: Finished running 1 table model in 5.63s.
02:14:09.363880 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:09.364881 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:14:09.365879 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:09.365879 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:14:09.375879 [info ] [MainThread]: 
02:14:09.376879 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:09.379884 [info ] [MainThread]: 
02:14:09.380883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:14:09.381880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA3A820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA3A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA90D30>]}


============================== 2022-05-13 02:14:16.101532 | 844e6562-c223-4832-85ba-7cc23145e3c6 ==============================
02:14:16.101532 [info ] [MainThread]: Running with dbt=1.0.4
02:14:16.101532 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:14:16.102534 [debug] [MainThread]: Tracking: tracking
02:14:16.117536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493DC0>]}
02:14:16.299532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:14:16.299532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:14:16.308534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844e6562-c223-4832-85ba-7cc23145e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB6F70D0>]}
02:14:16.324533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844e6562-c223-4832-85ba-7cc23145e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB5F2760>]}
02:14:16.324533 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:16.328534 [info ] [MainThread]: 
02:14:16.330535 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:16.332534 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:16.333540 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:16.929532 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:16.930539 [info ] [MainThread]: 
02:14:16.937536 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.937536 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.938534 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:14:16.938534 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:14:16.940535 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.941534 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.941534 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.941534 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.942534 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.942534 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.953533 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.961533 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.963535 [debug] [Thread-1  ]: finished collecting timing info
02:14:16.963535 [debug] [Thread-2  ]: finished collecting timing info
02:14:16.964536 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.964536 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.992533 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.995533 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.997533 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:16.997533 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:14:17.004532 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:14:17.006540 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:14:18.693532 [debug] [Thread-1  ]: finished collecting timing info
02:14:18.694533 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.75s]
02:14:18.696534 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:19.087532 [debug] [Thread-2  ]: finished collecting timing info
02:14:19.087532 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.15s]
02:14:19.089561 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:19.091534 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:19.092545 [info ] [MainThread]: 
02:14:19.093534 [info ] [MainThread]: Finished running 2 tests in 2.76s.
02:14:19.094536 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:19.095534 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:19.096535 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:14:19.097544 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:14:19.116543 [info ] [MainThread]: 
02:14:19.117534 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:19.119537 [info ] [MainThread]: 
02:14:19.121542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:14:19.122534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB6C0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB5DED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB79B310>]}


============================== 2022-05-13 02:14:35.791284 | e184579e-f3d7-4293-bf80-9580894b1614 ==============================
02:14:35.791284 [info ] [MainThread]: Running with dbt=1.0.4
02:14:35.792284 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:14:35.792284 [debug] [MainThread]: Tracking: tracking
02:14:35.806284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C092DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9AFC41640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9AFC419A0>]}
02:14:35.924285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:14:35.925285 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:14:35.941284 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:14:35.974283 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:14:36.013893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0C9A0D0>]}
02:14:36.029893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C09AC430>]}
02:14:36.030896 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:36.034895 [info ] [MainThread]: 
02:14:36.035896 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:36.037894 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:14:36.038893 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:36.612892 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:36.613893 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:37.215893 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:37.216894 [info ] [MainThread]: 
02:14:37.222896 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.223895 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:14:37.224896 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.225894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.225894 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.231895 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:14:37.234896 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:14:37.249894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.251895 [debug] [Thread-1  ]: finished collecting timing info
02:14:37.252894 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.273893 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:37.863893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.864894 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:14:41.266087 [debug] [Thread-1  ]: finished collecting timing info
02:14:41.267087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0CF4CD0>]}
02:14:41.268089 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 4.04s]
02:14:41.269090 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:41.272103 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:41.273089 [info ] [MainThread]: 
02:14:41.274091 [info ] [MainThread]: Finished running 1 table model in 5.24s.
02:14:41.275090 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:41.275090 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:14:41.276090 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:41.276090 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:14:41.289087 [info ] [MainThread]: 
02:14:41.290089 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:41.291089 [info ] [MainThread]: 
02:14:41.293110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:14:41.294089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0A001F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0A00130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0B80BE0>]}


============================== 2022-05-13 02:14:47.749276 | dd691c19-3603-47e3-89e1-306667da73a5 ==============================
02:14:47.749276 [info ] [MainThread]: Running with dbt=1.0.4
02:14:47.750277 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:14:47.751277 [debug] [MainThread]: Tracking: tracking
02:14:47.766276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E06E94E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E761A1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E761A11F0>]}
02:14:47.884276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:14:47.885282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:14:47.893276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd691c19-3603-47e3-89e1-306667da73a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E071160D0>]}
02:14:47.908279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd691c19-3603-47e3-89e1-306667da73a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E06F60850>]}
02:14:47.909277 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:47.912276 [info ] [MainThread]: 
02:14:47.914278 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:47.916276 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:47.917277 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:48.495277 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:48.496276 [info ] [MainThread]: 
02:14:48.503278 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.503278 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.504281 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:14:48.504281 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:14:48.506278 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.507277 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.508280 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.508280 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.509278 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.509278 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.522276 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.530277 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.532277 [debug] [Thread-1  ]: finished collecting timing info
02:14:48.532277 [debug] [Thread-2  ]: finished collecting timing info
02:14:48.533297 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.534292 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.560279 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.563277 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.565282 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:48.566280 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:14:48.571276 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:14:48.572276 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:14:50.376837 [debug] [Thread-1  ]: finished collecting timing info
02:14:50.377839 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.87s]
02:14:50.378839 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:50.730838 [debug] [Thread-2  ]: finished collecting timing info
02:14:50.731838 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.22s]
02:14:50.733839 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:50.735839 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:50.736838 [info ] [MainThread]: 
02:14:50.736838 [info ] [MainThread]: Finished running 2 tests in 2.82s.
02:14:50.738848 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:50.738848 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:50.739840 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:14:50.740840 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:14:50.761841 [info ] [MainThread]: 
02:14:50.762840 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:50.763841 [info ] [MainThread]: 
02:14:50.764840 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:14:50.766839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E070E1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E070FAD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E071A0EE0>]}


============================== 2022-05-13 02:15:40.632135 | 3bb22b8f-5215-412f-9c84-0941606c0a85 ==============================
02:15:40.632135 [info ] [MainThread]: Running with dbt=1.0.4
02:15:40.633137 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:15:40.634137 [debug] [MainThread]: Tracking: tracking
02:15:40.649136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433763670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433774A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433774280>]}
02:15:40.766134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:15:40.766134 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:15:40.767136 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:15:40.779134 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:15:40.813135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:15:40.816136 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:15:40.824137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:15:40.887134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433AB2AF0>]}
02:15:40.902135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A43381A970>]}
02:15:40.903136 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:15:40.906144 [info ] [MainThread]: 
02:15:40.907135 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:40.909137 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:15:40.910136 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:41.496709 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:15:41.496709 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:42.091707 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:15:42.092711 [info ] [MainThread]: 
02:15:42.100710 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.101709 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:15:42.102713 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.102713 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.103709 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:15:42.109708 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:15:42.112709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:15:42.150710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.151707 [debug] [Thread-1  ]: finished collecting timing info
02:15:42.152710 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.168710 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:15:42.778707 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.780708 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:15:46.175933 [debug] [Thread-1  ]: finished collecting timing info
02:15:46.175933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433B0BDF0>]}
02:15:46.176934 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 58.6 KB processed)[0m in 4.07s]
02:15:46.178945 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:15:46.180949 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:46.181933 [info ] [MainThread]: 
02:15:46.182935 [info ] [MainThread]: Finished running 1 table model in 5.27s.
02:15:46.183935 [debug] [MainThread]: Connection 'master' was properly closed.
02:15:46.184934 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:15:46.185937 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:15:46.185937 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
02:15:46.204934 [info ] [MainThread]: 
02:15:46.205934 [info ] [MainThread]: [32mCompleted successfully[0m
02:15:46.207937 [info ] [MainThread]: 
02:15:46.208936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:15:46.210935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42087E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4337C3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433BA4E50>]}


============================== 2022-05-13 02:15:55.558679 | 3280bdd9-7503-450a-a5e8-5e09105e3125 ==============================
02:15:55.558679 [info ] [MainThread]: Running with dbt=1.0.4
02:15:55.559678 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:15:55.560680 [debug] [MainThread]: Tracking: tracking
02:15:55.574680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF0649D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064EB0>]}
02:15:55.694678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:15:55.695678 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:15:55.707677 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:15:55.742680 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:15:55.790678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF3990D0>]}
02:15:55.803679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064880>]}
02:15:55.804679 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:15:55.807678 [info ] [MainThread]: 
02:15:55.809680 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:55.811686 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:15:55.811686 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:56.417277 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:15:56.418292 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:56.980277 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:15:56.981280 [info ] [MainThread]: 
02:15:56.989279 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:15:56.989279 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:15:56.991279 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:15:56.991279 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:15:56.992277 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:15:57.000277 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:15:57.005277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:15:57.055277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:57.057278 [debug] [Thread-1  ]: finished collecting timing info
02:15:57.057278 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:15:57.080277 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:15:57.702278 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:57.704277 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:16:00.570898 [debug] [Thread-1  ]: finished collecting timing info
02:16:00.570898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF4A0BE0>]}
02:16:00.571897 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 58.6 KB processed)[0m in 3.58s]
02:16:00.573913 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:16:00.575903 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:00.576906 [info ] [MainThread]: 
02:16:00.577898 [info ] [MainThread]: Finished running 1 table model in 4.77s.
02:16:00.578898 [debug] [MainThread]: Connection 'master' was properly closed.
02:16:00.579900 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:16:00.579900 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:16:00.580898 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
02:16:00.592901 [info ] [MainThread]: 
02:16:00.593901 [info ] [MainThread]: [32mCompleted successfully[0m
02:16:00.595909 [info ] [MainThread]: 
02:16:00.597897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:16:00.598899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF3990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF0C89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF4A0C10>]}


============================== 2022-05-13 02:16:22.454738 | 04898bc5-6fec-4ea7-8454-7a9fcdd20228 ==============================
02:16:22.454738 [info ] [MainThread]: Running with dbt=1.0.4
02:16:22.454738 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:16:22.455739 [debug] [MainThread]: Tracking: tracking
02:16:22.469743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E73D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E84940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E84340>]}
02:16:22.606740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:16:22.607740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:16:22.621741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04898bc5-6fec-4ea7-8454-7a9fcdd20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D50D60D0>]}
02:16:22.636740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04898bc5-6fec-4ea7-8454-7a9fcdd20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4F0D7C0>]}
02:16:22.637740 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:16:22.641740 [info ] [MainThread]: 
02:16:22.643741 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:22.645739 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:16:22.646740 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:23.265738 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:16:23.266739 [info ] [MainThread]: 
02:16:23.273741 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.273741 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.274746 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Products_product_sk.............................. [RUN]
02:16:23.274746 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Products_product_sk................................ [RUN]
02:16:23.276741 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.278743 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.278743 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.279739 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.280741 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.280741 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.298740 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.307741 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.309743 [debug] [Thread-1  ]: finished collecting timing info
02:16:23.309743 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.334738 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.335738 [debug] [Thread-2  ]: finished collecting timing info
02:16:23.336740 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.337741 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:16:23.340749 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.343740 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:16:23.346739 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
02:16:23.349739 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:16:24.949346 [debug] [Thread-1  ]: finished collecting timing info
02:16:24.949346 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.67s]
02:16:24.951347 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:25.313348 [debug] [Thread-2  ]: finished collecting timing info
02:16:25.314345 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 2.04s]
02:16:25.316362 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:25.318347 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:25.319348 [info ] [MainThread]: 
02:16:25.321361 [info ] [MainThread]: Finished running 2 tests in 2.68s.
02:16:25.322351 [debug] [MainThread]: Connection 'master' was properly closed.
02:16:25.323356 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:16:25.324350 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f' was properly closed.
02:16:25.324350 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5' was properly closed.
02:16:25.341346 [info ] [MainThread]: 
02:16:25.342346 [info ] [MainThread]: [32mCompleted successfully[0m
02:16:25.343347 [info ] [MainThread]: 
02:16:25.345356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:16:25.347349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4EE7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4F0D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D515FD60>]}


============================== 2022-05-13 02:17:06.975441 | cb4a2537-b01c-47f9-8bb5-9da26713e10b ==============================
02:17:06.975441 [info ] [MainThread]: Running with dbt=1.0.4
02:17:06.975441 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:17:06.976443 [debug] [MainThread]: Tracking: tracking
02:17:06.990443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCF9FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFA4BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFA4D90>]}
02:17:07.107441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:17:07.107441 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
02:17:07.108442 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:17:07.121441 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:17:07.152441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:17:07.154441 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:17:07.161441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:17:07.217441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD2ED0D0>]}
02:17:07.230443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFB5790>]}
02:17:07.231445 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:07.234442 [info ] [MainThread]: 
02:17:07.235442 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:07.237443 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:17:07.237443 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:07.827442 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:17:07.827442 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:08.468441 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:17:08.469443 [info ] [MainThread]: 
02:17:08.477443 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.477443 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
02:17:08.479442 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:08.480445 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.481446 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.488442 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:17:08.491441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:17:08.505441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:08.506441 [debug] [Thread-1  ]: finished collecting timing info
02:17:08.507458 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.523441 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:09.092441 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:09.093443 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
02:17:12.102675 [debug] [Thread-1  ]: finished collecting timing info
02:17:12.103676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD333FA0>]}
02:17:12.103676 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 170.0 Bytes processed)[0m in 3.62s]
02:17:12.105676 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:12.107677 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:12.108676 [info ] [MainThread]: 
02:17:12.109676 [info ] [MainThread]: Finished running 1 table model in 4.87s.
02:17:12.111679 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:12.111679 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:17:12.112678 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:17:12.112678 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
02:17:12.126689 [info ] [MainThread]: 
02:17:12.127697 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:12.128686 [info ] [MainThread]: 
02:17:12.130677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:17:12.131678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFF2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD1D0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD02DB80>]}


============================== 2022-05-13 02:17:23.309989 | 1471e4ea-13fd-4e38-8aff-05747f4a5bf7 ==============================
02:17:23.309989 [info ] [MainThread]: Running with dbt=1.0.4
02:17:23.310991 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:17:23.311992 [debug] [MainThread]: Tracking: tracking
02:17:23.326992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AE3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AF4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AF40A0>]}
02:17:23.450989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:17:23.451989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:17:23.459990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1471e4ea-13fd-4e38-8aff-05747f4a5bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0D460D0>]}
02:17:23.473991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1471e4ea-13fd-4e38-8aff-05747f4a5bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0B637C0>]}
02:17:23.474992 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:23.477991 [info ] [MainThread]: 
02:17:23.478992 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:23.480991 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:17:23.480991 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:24.078990 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:17:24.078990 [info ] [MainThread]: 
02:17:24.085992 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.085992 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.086992 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
02:17:24.087992 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
02:17:24.088994 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.089994 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.090992 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.090992 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.091991 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.091991 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.103989 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.113990 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.114990 [debug] [Thread-1  ]: finished collecting timing info
02:17:24.115992 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.137989 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.138991 [debug] [Thread-2  ]: finished collecting timing info
02:17:24.139991 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.144990 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.145990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:24.146991 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:17:24.151991 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:24.153007 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
02:17:25.810571 [debug] [Thread-1  ]: finished collecting timing info
02:17:25.811578 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.72s]
02:17:25.813571 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:26.278165 [debug] [Thread-2  ]: finished collecting timing info
02:17:26.279165 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 2.19s]
02:17:26.280164 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:26.282165 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:26.283166 [info ] [MainThread]: 
02:17:26.284168 [info ] [MainThread]: Finished running 2 tests in 2.80s.
02:17:26.285167 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:26.286170 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:17:26.287166 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
02:17:26.287166 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
02:17:26.306167 [info ] [MainThread]: 
02:17:26.307165 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:26.309164 [info ] [MainThread]: 
02:17:26.310164 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:17:26.311166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DDC0E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0B571F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0DDFF10>]}


============================== 2022-05-13 02:18:49.734742 | 9a5b8fa3-7609-4781-b958-c21a22931d77 ==============================
02:18:49.734742 [info ] [MainThread]: Running with dbt=1.0.4
02:18:49.735735 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:18:49.736736 [debug] [MainThread]: Tracking: tracking
02:18:49.748735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C43E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C443BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C443B50>]}
02:18:49.780348 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:18:49.781349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C4997F0>]}
02:18:49.884348 [debug] [MainThread]: Parsing macros\adapters.sql
02:18:49.909349 [debug] [MainThread]: Parsing macros\catalog.sql
02:18:49.915349 [debug] [MainThread]: Parsing macros\etc.sql
02:18:49.918349 [debug] [MainThread]: Parsing macros\materializations\copy.sql
02:18:49.921349 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
02:18:49.937349 [debug] [MainThread]: Parsing macros\materializations\seed.sql
02:18:49.941350 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
02:18:49.944350 [debug] [MainThread]: Parsing macros\materializations\table.sql
02:18:49.949350 [debug] [MainThread]: Parsing macros\materializations\view.sql
02:18:49.952350 [debug] [MainThread]: Parsing macros\adapters\columns.sql
02:18:49.963349 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
02:18:49.966350 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
02:18:49.969350 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
02:18:49.977348 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
02:18:49.983357 [debug] [MainThread]: Parsing macros\adapters\relation.sql
02:18:49.993349 [debug] [MainThread]: Parsing macros\adapters\schema.sql
02:18:49.996349 [debug] [MainThread]: Parsing macros\etc\datetime.sql
02:18:50.005349 [debug] [MainThread]: Parsing macros\etc\statement.sql
02:18:50.011362 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
02:18:50.014351 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
02:18:50.015350 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
02:18:50.016350 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
02:18:50.017349 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
02:18:50.020349 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
02:18:50.022351 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
02:18:50.025350 [debug] [MainThread]: Parsing macros\materializations\configs.sql
02:18:50.028348 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
02:18:50.033349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
02:18:50.040349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
02:18:50.051349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
02:18:50.053350 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
02:18:50.066350 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
02:18:50.083349 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
02:18:50.088350 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
02:18:50.098349 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
02:18:50.102350 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
02:18:50.105350 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
02:18:50.108354 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
02:18:50.116349 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
02:18:50.133349 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
02:18:50.140350 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
02:18:50.151349 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
02:18:50.164350 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
02:18:50.166349 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
02:18:50.184348 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
02:18:50.187348 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
02:18:50.192349 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
02:18:50.194349 [debug] [MainThread]: Parsing tests\generic\builtin.sql
02:18:50.197349 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
02:18:50.199349 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
02:18:50.202351 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
02:18:50.204349 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
02:18:50.205349 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
02:18:50.209349 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
02:18:50.216349 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
02:18:50.219349 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
02:18:50.229350 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
02:18:50.231349 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
02:18:50.234349 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
02:18:50.235350 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
02:18:50.237351 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
02:18:50.239351 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
02:18:50.241351 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
02:18:50.245348 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
02:18:50.247350 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
02:18:50.256351 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
02:18:50.257348 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
02:18:50.259349 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
02:18:50.261351 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
02:18:50.264348 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
02:18:50.268350 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
02:18:50.271351 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
02:18:50.282350 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
02:18:50.285349 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
02:18:50.286349 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
02:18:50.289349 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
02:18:50.290350 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
02:18:50.293351 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
02:18:50.298350 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
02:18:50.300349 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
02:18:50.302349 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
02:18:50.304349 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
02:18:50.313348 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
02:18:50.316349 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
02:18:50.318348 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
02:18:50.320349 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
02:18:50.322350 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
02:18:50.325349 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
02:18:50.328349 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
02:18:50.330349 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
02:18:50.332349 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
02:18:50.335348 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
02:18:50.337349 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
02:18:50.338350 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
02:18:50.340349 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
02:18:50.341349 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
02:18:50.368350 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
02:18:50.372349 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
02:18:50.376349 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
02:18:50.381349 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
02:18:50.387349 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
02:18:50.390348 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
02:18:50.393349 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
02:18:50.396348 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
02:18:50.400348 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
02:18:50.407349 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
02:18:50.410350 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
02:18:50.412348 [debug] [MainThread]: Parsing macros\sql\groupby.sql
02:18:50.414350 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
02:18:50.421350 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
02:18:50.423348 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
02:18:50.425349 [debug] [MainThread]: Parsing macros\sql\pivot.sql
02:18:50.430349 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
02:18:50.433350 [debug] [MainThread]: Parsing macros\sql\star.sql
02:18:50.438349 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
02:18:50.443349 [debug] [MainThread]: Parsing macros\sql\union.sql
02:18:50.453348 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
02:18:50.462349 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
02:18:50.464349 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
02:18:50.466349 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
02:18:51.039945 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:18:51.086950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:18:51.088946 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:18:51.097944 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:18:51.098945 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:18:51.107946 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:18:51.109946 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:18:51.118945 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:18:51.120945 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:18:51.130947 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:18:51.133945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:18:51.139947 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:18:51.143946 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
02:18:51.148945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:18:51.153945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:18:51.156944 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:18:51.160945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:18:51.163946 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:18:51.168945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:18:51.446946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C7B6FA0>]}
02:18:51.470945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C4E4BB0>]}
02:18:51.471946 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:18:51.474945 [info ] [MainThread]: 
02:18:51.476948 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:51.477947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:18:51.478946 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:52.587947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:18:52.588947 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:53.207945 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:18:53.208946 [info ] [MainThread]: 
02:18:53.214945 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.215945 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
02:18:53.217946 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:53.218948 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.219948 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.227945 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:53.230944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:53.231943 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:53.236950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:53.258946 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:53.259946 [debug] [Thread-1  ]: finished collecting timing info
02:18:53.259946 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.283945 [debug] [Thread-1  ]: finished collecting timing info
02:18:53.284944 [debug] [Thread-1  ]: Compilation Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
  > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
02:18:53.285945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C8793D0>]}
02:18:53.285945 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 0.07s]
02:18:53.287947 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.289945 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:53.289945 [info ] [MainThread]: 
02:18:53.290944 [info ] [MainThread]: Finished running 1 view model in 1.81s.
02:18:53.292948 [debug] [MainThread]: Connection 'master' was properly closed.
02:18:53.293949 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:18:53.293949 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:18:53.294947 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:18:53.316952 [info ] [MainThread]: 
02:18:53.323946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:18:53.325948 [info ] [MainThread]: 
02:18:53.327946 [error] [MainThread]: [33mCompilation Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
02:18:53.328948 [error] [MainThread]:   Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
02:18:53.329945 [error] [MainThread]:   
02:18:53.330944 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
02:18:53.331945 [error] [MainThread]:   > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
02:18:53.332945 [error] [MainThread]:   > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
02:18:53.334945 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
02:18:53.335948 [error] [MainThread]:   > called by model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
02:18:53.337947 [info ] [MainThread]: 
02:18:53.338946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
02:18:53.339946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C72BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C81F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C81F220>]}


============================== 2022-05-13 02:20:02.715816 | 37c5bf65-a242-4cc0-9215-5d7d1a52c0f6 ==============================
02:20:02.715816 [info ] [MainThread]: Running with dbt=1.0.4
02:20:02.715816 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:20:02.716816 [debug] [MainThread]: Tracking: tracking
02:20:02.730817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4E20>]}
02:20:02.885821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:20:02.886819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:20:02.896816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133040D0>]}
02:20:02.915816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD13227730>]}
02:20:02.916817 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:20:02.918821 [info ] [MainThread]: 
02:20:02.919818 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:02.920818 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:20:02.921817 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:03.505817 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:20:03.505817 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:04.090331 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:20:04.092330 [info ] [MainThread]: 
02:20:04.101330 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.102330 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
02:20:04.103330 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.104333 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.105330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.150330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:20:04.154329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:20:04.155329 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:20:04.160926 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:20:04.191929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.192928 [debug] [Thread-1  ]: finished collecting timing info
02:20:04.192928 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.237928 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.239928 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:20:04.248930 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


02:20:05.448173 [debug] [Thread-1  ]: finished collecting timing info
02:20:05.449174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133B6FD0>]}
02:20:05.450174 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.35s]
02:20:05.452175 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:05.454175 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:05.455174 [info ] [MainThread]: 
02:20:05.457174 [info ] [MainThread]: Finished running 1 view model in 2.54s.
02:20:05.458173 [debug] [MainThread]: Connection 'master' was properly closed.
02:20:05.459172 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:20:05.459172 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:20:05.460174 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:20:05.487172 [info ] [MainThread]: 
02:20:05.488175 [info ] [MainThread]: [32mCompleted successfully[0m
02:20:05.490174 [info ] [MainThread]: 
02:20:05.491172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:20:05.493177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD132E8D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD13211C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133B6E80>]}


============================== 2022-05-13 02:20:16.288947 | 451f689d-919f-4712-8cac-2609f9eac89f ==============================
02:20:16.288947 [info ] [MainThread]: Running with dbt=1.0.4
02:20:16.289946 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:20:16.290949 [debug] [MainThread]: Tracking: tracking
02:20:16.304947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A83460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A83BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A830A0>]}
02:20:16.422947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:20:16.422947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:20:16.431946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '451f689d-919f-4712-8cac-2609f9eac89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12CE40D0>]}
02:20:16.446949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '451f689d-919f-4712-8cac-2609f9eac89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12C04730>]}
02:20:16.447953 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:20:16.450946 [info ] [MainThread]: 
02:20:16.451948 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:16.454949 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:20:16.454949 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:17.010947 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:20:17.011949 [info ] [MainThread]: 
02:20:17.019948 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.019948 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.020952 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
02:20:17.020952 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
02:20:17.022949 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.024965 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.024965 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.025948 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.025948 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.026947 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.041947 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.049951 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.050948 [debug] [Thread-1  ]: finished collecting timing info
02:20:17.051949 [debug] [Thread-2  ]: finished collecting timing info
02:20:17.051949 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.052949 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.080947 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.084949 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.086951 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:20:17.087948 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:20:17.092946 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
02:20:17.092946 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:20:19.158057 [debug] [Thread-1  ]: finished collecting timing info
02:20:19.159055 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.14s]
02:20:19.161057 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:19.314058 [debug] [Thread-2  ]: finished collecting timing info
02:20:19.315072 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 2.29s]
02:20:19.316059 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:19.318074 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:19.319057 [info ] [MainThread]: 
02:20:19.320066 [info ] [MainThread]: Finished running 2 tests in 2.87s.
02:20:19.321059 [debug] [MainThread]: Connection 'master' was properly closed.
02:20:19.322058 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:20:19.322058 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:20:19.323057 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:20:19.341057 [info ] [MainThread]: 
02:20:19.342057 [info ] [MainThread]: [32mCompleted successfully[0m
02:20:19.344081 [info ] [MainThread]: 
02:20:19.345058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:20:19.347058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12BF0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12BF0DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12D7BE80>]}


============================== 2022-05-16 12:00:41.021938 | 5eb82c54-9e3d-456b-80fa-b57d21505dd9 ==============================
12:00:41.021938 [info ] [MainThread]: Running with dbt=1.0.4
12:00:41.022946 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:00:41.022946 [debug] [MainThread]: Tracking: tracking
12:00:41.037944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9ACA610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9AEDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9AEDDC0>]}
12:00:41.758567 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
12:00:41.759567 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:00:41.759567 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Customers.sql
12:00:41.759567 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Customer.sql
12:00:41.773568 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:00:41.825566 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_AdventureWorks_SalesReasons' in the 'models' section of file 'models\staging\stg_AdventureWorks.yml'
12:00:41.853605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9DC40A0>]}
12:00:41.880978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9B69A60>]}
12:00:41.881991 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:00:41.885992 [info ] [MainThread]: 
12:00:41.886990 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:00:41.888993 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:00:41.888993 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:00:42.696378 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:00:42.696378 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:00:43.295595 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:00:43.296595 [info ] [MainThread]: 
12:00:43.307652 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:00:43.307652 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:00:43.308663 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:00:43.309990 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:00:43.309990 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:00:43.309990 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:00:43.310989 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:00:43.310989 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:00:43.313865 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:00:43.317869 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:00:43.319866 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.319866 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:00:43.320865 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.320865 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:00:43.321868 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:00:43.321868 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:00:43.322892 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:00:43.323867 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:00:43.323867 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:00:43.323867 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:00:43.324990 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:00:43.328035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:00:43.328035 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:00:43.332000 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:00:43.332000 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.334002 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:00:43.334002 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:00:43.335011 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.335011 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:00:43.336002 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:00:43.336002 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:00:43.337000 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:00:43.338000 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:00:43.339001 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:00:43.343035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:00:43.343035 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:00:43.343838 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:00:43.344847 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.346846 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:00:43.348851 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:00:43.349855 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:00:43.350865 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:00:43.350865 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.351854 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:00:43.352848 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:00:43.353850 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:00:43.353850 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:00:43.357847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:00:43.358120 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:00:43.358867 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:00:43.359876 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:00:43.359876 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.363911 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:00:43.364877 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:00:43.365878 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:00:43.366877 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:00:43.366877 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.367879 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:00:43.368879 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:00:43.369906 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:00:43.369906 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:00:43.373914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:00:43.374878 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:00:43.375876 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.376896 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:00:43.377877 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:00:43.377877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:00:43.377877 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:00:43.378876 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:00:43.379877 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:00:43.416880 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:00:43.418882 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:00:43.419888 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:00:43.420912 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.420912 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:00:43.421877 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:00:43.444913 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:00:43.467888 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.468887 [debug] [Thread-2  ]: Compilation Error in model dim_CreditCards (models\marts\dim_CreditCards.sql)
  Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
  > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_CreditCards (models\marts\dim_CreditCards.sql)
12:00:43.469923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9F00790>]}
12:00:43.470901 [error] [Thread-2  ]: 1 of 5 ERROR creating view model AdventureWorks_marts.dim_CreditCards........... [[31mERROR[0m in 0.09s]
12:00:43.472897 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:00:43.472897 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:00:43.473879 [info ] [Thread-2  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:00:43.474876 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:00:43.475881 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:00:43.476897 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:00:43.488877 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:00:43.489877 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.490877 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:00:43.493882 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.494880 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.494880 [debug] [Thread-1  ]: Compilation Error in model dim_Products (models\marts\dim_Products.sql)
  Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
  > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_Products (models\marts\dim_Products.sql)
12:00:43.495879 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:00:43.495879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9E91AF0>]}
12:00:43.498883 [debug] [Thread-2  ]: finished collecting timing info
12:00:43.499880 [error] [Thread-1  ]: 2 of 5 ERROR creating view model AdventureWorks_marts.dim_Products.............. [[31mERROR[0m in 0.08s]
12:00:43.500878 [debug] [Thread-2  ]: Compilation Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
  > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_Reasons (models\marts\dim_Reasons.sql)
12:00:43.501878 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9EDCF70>]}
12:00:43.502880 [error] [Thread-2  ]: 3 of 5 ERROR creating view model AdventureWorks_marts.dim_Reasons............... [[31mERROR[0m in 0.03s]
12:00:43.502880 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:00:43.503881 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:00:43.504878 [info ] [Thread-1  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:00:43.505880 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:00:43.506892 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:00:43.507881 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:00:43.508880 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:00:43.526914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:00:43.528855 [debug] [Thread-1  ]: finished collecting timing info
12:00:43.529871 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:00:43.548866 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:00:43.550873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:00:43.556865 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:00:44.791973 [debug] [Thread-1  ]: finished collecting timing info
12:00:44.792974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb82c54-9e3d-456b-80fa-b57d21505dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9E147F0>]}
12:00:44.792974 [info ] [Thread-1  ]: 4 of 5 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.29s]
12:00:44.794974 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:00:44.795976 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:00:44.796977 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
12:00:44.798981 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:00:44.800974 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:00:44.801987 [info ] [MainThread]: 
12:00:44.802976 [info ] [MainThread]: Finished running 5 view models in 2.91s.
12:00:44.804984 [debug] [MainThread]: Connection 'master' was properly closed.
12:00:44.804984 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:00:44.805992 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:00:44.806978 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:00:44.806978 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
12:00:44.872249 [info ] [MainThread]: 
12:00:44.873266 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
12:00:44.875249 [info ] [MainThread]: 
12:00:44.876248 [error] [MainThread]: [33mCompilation Error in model dim_CreditCards (models\marts\dim_CreditCards.sql)[0m
12:00:44.878258 [error] [MainThread]:   Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
12:00:44.879251 [error] [MainThread]:   
12:00:44.880249 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
12:00:44.882250 [error] [MainThread]:   > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
12:00:44.883248 [error] [MainThread]:   > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
12:00:44.884258 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
12:00:44.886248 [error] [MainThread]:   > called by model dim_CreditCards (models\marts\dim_CreditCards.sql)
12:00:44.887249 [info ] [MainThread]: 
12:00:44.888252 [error] [MainThread]: [33mCompilation Error in model dim_Products (models\marts\dim_Products.sql)[0m
12:00:44.891247 [error] [MainThread]:   Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
12:00:44.892252 [error] [MainThread]:   
12:00:44.894261 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
12:00:44.895252 [error] [MainThread]:   > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
12:00:44.897258 [error] [MainThread]:   > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
12:00:44.898252 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
12:00:44.899250 [error] [MainThread]:   > called by model dim_Products (models\marts\dim_Products.sql)
12:00:44.901251 [info ] [MainThread]: 
12:00:44.902249 [error] [MainThread]: [33mCompilation Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
12:00:44.905251 [error] [MainThread]:   Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
12:00:44.907266 [error] [MainThread]:   
12:00:44.909249 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
12:00:44.911250 [error] [MainThread]:   > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
12:00:44.912267 [error] [MainThread]:   > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
12:00:44.914249 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
12:00:44.916260 [error] [MainThread]:   > called by model dim_Reasons (models\marts\dim_Reasons.sql)
12:00:44.918247 [info ] [MainThread]: 
12:00:44.919251 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
12:00:44.921255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9B78D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9DF7E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D9F19370>]}


============================== 2022-05-16 12:02:05.089957 | 78e64811-8450-4d6d-a214-e9992f2bb83f ==============================
12:02:05.089957 [info ] [MainThread]: Running with dbt=1.0.4
12:02:05.090958 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:02:05.090958 [debug] [MainThread]: Tracking: tracking
12:02:05.103960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBA7A5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBA7B6C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBA7B64F0>]}
12:02:05.214988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:02:05.214988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:02:05.223994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA280D0>]}
12:02:05.236988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBA8D60A0>]}
12:02:05.237958 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:02:05.240991 [info ] [MainThread]: 
12:02:05.241959 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:02:05.243960 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:02:05.244958 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:02:05.924957 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:02:05.925996 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:02:06.526167 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:02:06.527193 [info ] [MainThread]: 
12:02:06.535166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:02:06.535166 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:02:06.536166 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:02:06.537181 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:02:06.537181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:02:06.538165 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:02:06.539176 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:02:06.539176 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:02:06.543202 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:02:06.546166 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:02:06.547169 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.548169 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:02:06.549166 [debug] [Thread-2  ]: finished collecting timing info
12:02:06.549166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:02:06.550169 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:02:06.551167 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:02:06.551167 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:02:06.552169 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:02:06.553167 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:02:06.553167 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:02:06.554166 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:02:06.557202 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:02:06.557202 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:02:06.560270 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:02:06.561271 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.562236 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:02:06.563238 [debug] [Thread-2  ]: finished collecting timing info
12:02:06.563238 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:02:06.564238 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:02:06.565239 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:02:06.565239 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:02:06.566237 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:02:06.567236 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:02:06.567236 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:02:06.568236 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:02:06.571234 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:02:06.572236 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:02:06.575270 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:02:06.576237 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.577234 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:02:06.577234 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:02:06.577234 [debug] [Thread-2  ]: finished collecting timing info
12:02:06.578238 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:02:06.579236 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:02:06.579236 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:02:06.580253 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:02:06.581237 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:02:06.582237 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:02:06.586235 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:02:06.587245 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:02:06.587853 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:02:06.590898 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:02:06.590898 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.592201 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:02:06.593217 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:02:06.593217 [debug] [Thread-2  ]: finished collecting timing info
12:02:06.594210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:02:06.595210 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:02:06.595210 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:02:06.596233 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:02:06.596233 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:02:06.597212 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:02:06.599950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:02:06.601952 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:02:06.602951 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:02:06.602951 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.602951 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:02:06.603952 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:02:06.641949 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:02:06.642330 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:02:06.643092 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:02:06.644119 [debug] [Thread-2  ]: finished collecting timing info
12:02:06.645122 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:02:06.645122 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:02:06.646124 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:02:06.680120 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:02:06.680120 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:02:06.708119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:02:06.709120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:02:06.710120 [debug] [Thread-1  ]: finished collecting timing info
12:02:06.710120 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:02:06.714151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:02:06.718156 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


12:02:06.728219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:02:06.733252 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


12:02:07.900269 [debug] [Thread-2  ]: finished collecting timing info
12:02:07.900269 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA8C4F0>]}
12:02:07.901274 [info ] [Thread-2  ]: 1 of 5 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.30s]
12:02:07.903280 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:02:07.903280 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:02:07.904272 [info ] [Thread-2  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:02:07.905274 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:02:07.906286 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:02:07.906286 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:02:07.925282 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:02:07.929275 [debug] [Thread-1  ]: finished collecting timing info
12:02:07.930288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA74160>]}
12:02:07.931282 [info ] [Thread-1  ]: 2 of 5 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.29s]
12:02:07.932271 [debug] [Thread-2  ]: finished collecting timing info
12:02:07.933275 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:02:07.934279 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:02:07.939279 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:02:07.940274 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:02:07.941270 [info ] [Thread-1  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:02:07.942269 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:02:07.942269 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:02:07.943272 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:02:07.944273 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:02:07.966277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:02:07.967272 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


12:02:07.969270 [debug] [Thread-1  ]: finished collecting timing info
12:02:07.970279 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:02:07.985307 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:02:07.986271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:02:07.992291 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:02:09.330139 [debug] [Thread-2  ]: finished collecting timing info
12:02:09.331103 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA52910>]}
12:02:09.332103 [info ] [Thread-2  ]: 3 of 5 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.43s]
12:02:09.336139 [debug] [Thread-1  ]: finished collecting timing info
12:02:09.337101 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:02:09.337101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA52B50>]}
12:02:09.339100 [info ] [Thread-1  ]: 4 of 5 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.39s]
12:02:09.341103 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:02:09.342101 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:02:09.343106 [info ] [Thread-2  ]: 5 of 5 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
12:02:09.345108 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:02:09.346103 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:02:09.346103 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:02:09.388136 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:02:09.389100 [debug] [Thread-2  ]: finished collecting timing info
12:02:09.390102 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:02:09.393138 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:02:09.442109 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:02:09.447138 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final;


12:02:10.741077 [debug] [Thread-2  ]: finished collecting timing info
12:02:10.742037 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e64811-8450-4d6d-a214-e9992f2bb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAAA05E0>]}
12:02:10.743038 [info ] [Thread-2  ]: 5 of 5 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.40s]
12:02:10.744038 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:02:10.746041 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:02:10.747039 [info ] [MainThread]: 
12:02:10.748037 [info ] [MainThread]: Finished running 5 view models in 5.51s.
12:02:10.749037 [debug] [MainThread]: Connection 'master' was properly closed.
12:02:10.750040 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:02:10.750040 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:02:10.751044 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:02:10.751044 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
12:02:10.768038 [info ] [MainThread]: 
12:02:10.769037 [info ] [MainThread]: [32mCompleted successfully[0m
12:02:10.772036 [info ] [MainThread]: 
12:02:10.773049 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
12:02:10.774061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA87850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA876D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CBAA87580>]}


============================== 2022-05-16 12:03:31.119114 | 6a0df394-ef2b-4d9f-95c1-97da54e11af4 ==============================
12:03:31.119114 [info ] [MainThread]: Running with dbt=1.0.4
12:03:31.120087 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:03:31.120087 [debug] [MainThread]: Tracking: tracking
12:03:31.134115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C553D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C553DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C553DEE0>]}
12:03:31.236115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:03:31.237114 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:03:31.250104 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:03:31.302122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C57F5F40>]}
12:03:31.316083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C559C2B0>]}
12:03:31.317086 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:03:31.321085 [info ] [MainThread]: 
12:03:31.323088 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:03:31.325123 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:03:31.326086 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:03:33.357948 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:03:33.357948 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:03:33.985896 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:03:33.986851 [info ] [MainThread]: 
12:03:33.994849 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:03:33.995888 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:03:33.995888 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:03:33.996852 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:03:33.997808 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:03:33.998312 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:03:33.998312 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:03:33.999323 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:03:34.002361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:03:34.005323 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:03:34.007322 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.008324 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:03:34.008324 [debug] [Thread-2  ]: finished collecting timing info
12:03:34.008324 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:03:34.009324 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:03:34.010324 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:03:34.010324 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:03:34.011327 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:03:34.012328 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:03:34.012328 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:03:34.013325 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:03:34.016361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:03:34.017359 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:03:34.021884 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:03:34.022847 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.023853 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:03:34.024851 [debug] [Thread-2  ]: finished collecting timing info
12:03:34.024851 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:03:34.025853 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:03:34.026854 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:03:34.027848 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:03:34.028846 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:03:34.028846 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:03:34.029852 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:03:34.030848 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:03:34.034847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:03:34.034847 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:03:34.037883 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:03:34.038883 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.039848 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:03:34.039848 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:03:34.040856 [debug] [Thread-2  ]: finished collecting timing info
12:03:34.041849 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:03:34.042853 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:03:34.043852 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:03:34.044869 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:03:34.045848 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:03:34.045848 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:03:34.049845 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:03:34.049845 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:03:34.050853 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:03:34.050853 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.053849 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:03:34.054847 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:03:34.055472 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:03:34.056488 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:03:34.056488 [debug] [Thread-2  ]: finished collecting timing info
12:03:34.057481 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:03:34.058483 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:03:34.059481 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:03:34.060482 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:03:34.063516 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:03:34.064481 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:03:34.065966 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.065966 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:03:34.066969 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:03:34.066969 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:03:34.067968 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:03:34.068970 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:03:34.068970 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:03:34.105002 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:03:34.105748 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:03:34.106770 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:03:34.107764 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:03:34.107764 [debug] [Thread-2  ]: finished collecting timing info
12:03:34.131793 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:03:34.132794 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:03:34.164794 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:03:34.165794 [debug] [Thread-1  ]: finished collecting timing info
12:03:34.166758 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:03:34.169787 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:03:34.169787 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:03:34.171769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:03:34.176787 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


12:03:34.176787 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


12:03:35.285151 [debug] [Thread-2  ]: finished collecting timing info
12:03:35.286151 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C5924C70>]}
12:03:35.287151 [info ] [Thread-2  ]: 1 of 5 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.22s]
12:03:35.288152 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:03:35.289154 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:03:35.290153 [info ] [Thread-2  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:03:35.291155 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:03:35.291155 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:03:35.292154 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:03:35.304151 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:03:35.305151 [debug] [Thread-2  ]: finished collecting timing info
12:03:35.306151 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:03:35.318152 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:03:35.321151 [debug] [Thread-1  ]: finished collecting timing info
12:03:35.322164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C58DEFD0>]}
12:03:35.323152 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:03:35.324152 [info ] [Thread-1  ]: 2 of 5 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.22s]
12:03:35.326154 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:03:35.327155 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:03:35.328154 [info ] [Thread-1  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:03:35.329155 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:03:35.330153 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:03:35.331153 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


12:03:35.331153 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:03:35.355152 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:03:35.358154 [debug] [Thread-1  ]: finished collecting timing info
12:03:35.358154 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:03:35.364154 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:03:35.365152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:03:35.371151 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,'name' as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:03:36.391067 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:03:37.168804 [debug] [Thread-2  ]: finished collecting timing info
12:03:37.169768 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C586BE20>]}
12:03:37.169768 [info ] [Thread-2  ]: 3 of 5 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.88s]
12:03:37.171771 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:03:37.777059 [debug] [Thread-1  ]: finished collecting timing info
12:03:37.778060 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:03:37.778060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0df394-ef2b-4d9f-95c1-97da54e11af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C697B4F0>]}
12:03:37.779059 [error] [Thread-1  ]: 4 of 5 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 2.45s]
12:03:37.781076 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:03:37.782060 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:03:37.783059 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
12:03:37.784060 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:03:37.786079 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:03:37.788061 [info ] [MainThread]: 
12:03:37.790065 [info ] [MainThread]: Finished running 5 view models in 6.47s.
12:03:37.791061 [debug] [MainThread]: Connection 'master' was properly closed.
12:03:37.792064 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:03:37.792064 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:03:37.793061 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:03:37.793061 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
12:03:37.815064 [info ] [MainThread]: 
12:03:37.816060 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:03:37.818062 [info ] [MainThread]: 
12:03:37.820079 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:03:37.822059 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:03:37.823061 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:03:37.825061 [info ] [MainThread]: 
12:03:37.826063 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
12:03:37.828062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C59415B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C5941640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C697BB80>]}


============================== 2022-05-16 12:04:02.589944 | 3c8d8289-0dc5-4ded-897e-262fbed4c99c ==============================
12:04:02.589944 [info ] [MainThread]: Running with dbt=1.0.4
12:04:02.590945 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:04:02.591927 [debug] [MainThread]: Tracking: tracking
12:04:02.605925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4A9DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4AAD670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4AAD580>]}
12:04:02.712149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:04:02.713149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:04:02.721149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4D370D0>]}
12:04:02.735151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4C369D0>]}
12:04:02.735151 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:04:02.739124 [info ] [MainThread]: 
12:04:02.740138 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:04:02.742121 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:04:02.742121 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:04:03.696192 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:04:03.696192 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:04:04.539626 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:04:04.540636 [info ] [MainThread]: 
12:04:04.548591 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:04.549582 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:04.550585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:04:04.551598 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:04:04.552586 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:04.553583 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:04.554589 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:04.555585 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:04.559583 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:04:04.562580 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:04:04.564590 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.564590 [debug] [Thread-2  ]: finished collecting timing info
12:04:04.565592 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:04.566589 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:04.566589 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:04.567585 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:04.568585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:04:04.569584 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:04:04.569584 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:04.570584 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:04.570584 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:04.571623 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:04.575589 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:04:04.578618 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:04:04.579586 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.580586 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:04.580586 [debug] [Thread-2  ]: finished collecting timing info
12:04:04.581591 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:04.581591 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:04.582603 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:04:04.583583 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:04.583583 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:04.584585 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:04:04.585583 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:04.586587 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:04.589587 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:04:04.590586 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:04.593618 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:04:04.594619 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.595602 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:04.595602 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:04.595602 [debug] [Thread-2  ]: finished collecting timing info
12:04:04.596597 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:04:04.597583 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:04.597583 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:04.598636 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:04.598636 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:04.599585 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:04:04.605587 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:04:04.606766 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:04.607091 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:04.608100 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.610104 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:04:04.611136 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:04.612103 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:04.613131 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:04:04.613131 [debug] [Thread-2  ]: finished collecting timing info
12:04:04.614141 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:04.614141 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:04.615156 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:04.615156 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:04.620195 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:04:04.620195 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:04:04.622243 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.622243 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:04.623254 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:04.624271 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:04.624271 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:04:04.625271 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:04.626253 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:04:04.662288 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:04.663256 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:04:04.664253 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:04:04.665255 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:04:04.665255 [debug] [Thread-2  ]: finished collecting timing info
12:04:04.693289 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:04:04.694308 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:04.727679 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:04.727679 [debug] [Thread-1  ]: finished collecting timing info
12:04:04.728680 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:04:04.732680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:04:04.732680 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:04:04.734681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:04:04.738707 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


12:04:04.739676 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


12:04:06.291657 [debug] [Thread-2  ]: finished collecting timing info
12:04:06.292657 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4D97730>]}
12:04:06.293622 [info ] [Thread-2  ]: 1 of 5 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.67s]
12:04:06.295003 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:06.295003 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:06.296020 [info ] [Thread-2  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:04:06.297017 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:06.298014 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:06.298014 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:04:06.311013 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:06.313013 [debug] [Thread-2  ]: finished collecting timing info
12:04:06.313013 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:06.317014 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:06.318018 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:04:06.324014 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


12:04:06.338926 [debug] [Thread-1  ]: finished collecting timing info
12:04:06.339890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4DDEBB0>]}
12:04:06.339890 [info ] [Thread-1  ]: 2 of 5 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.68s]
12:04:06.341890 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:04:06.342890 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:06.343890 [info ] [Thread-1  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:04:06.344891 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:06.344891 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:06.345926 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:06.363923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:06.364899 [debug] [Thread-1  ]: finished collecting timing info
12:04:06.365890 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:06.376925 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:06.377924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:04:06.382924 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,'name' as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:04:07.332931 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:04:07.897960 [debug] [Thread-2  ]: finished collecting timing info
12:04:07.898923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C5E96A00>]}
12:04:07.898923 [info ] [Thread-2  ]: 3 of 5 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.60s]
12:04:07.900980 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:08.616211 [debug] [Thread-1  ]: finished collecting timing info
12:04:08.617208 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:04:08.618207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8d8289-0dc5-4ded-897e-262fbed4c99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4DA0970>]}
12:04:08.618207 [error] [Thread-1  ]: 4 of 5 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 2.27s]
12:04:08.620201 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:08.621226 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:08.622248 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
12:04:08.624201 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:08.626202 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:04:08.627202 [info ] [MainThread]: 
12:04:08.628202 [info ] [MainThread]: Finished running 5 view models in 5.89s.
12:04:08.629199 [debug] [MainThread]: Connection 'master' was properly closed.
12:04:08.630198 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:04:08.630198 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:04:08.630198 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:04:08.631198 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
12:04:08.645235 [info ] [MainThread]: 
12:04:08.646201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:04:08.648201 [info ] [MainThread]: 
12:04:08.649272 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:04:08.650202 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:04:08.652199 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:04:08.653200 [info ] [MainThread]: 
12:04:08.654222 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
12:04:08.655202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4E5B280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4D1EA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C4E0C550>]}


============================== 2022-05-16 12:04:20.616376 | 49c6e074-cd8f-4e78-a485-0c3ab78fd350 ==============================
12:04:20.616376 [info ] [MainThread]: Running with dbt=1.0.4
12:04:20.617395 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:04:20.617395 [debug] [MainThread]: Tracking: tracking
12:04:20.632390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE82EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE841700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE841430>]}
12:04:20.734412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:04:20.734412 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:04:20.747412 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:04:20.785413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEAF6F40>]}
12:04:20.799407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEA01970>]}
12:04:20.800381 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:04:20.804376 [info ] [MainThread]: 
12:04:20.805377 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:04:20.807377 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:04:20.808377 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:04:21.664158 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:04:21.664158 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:04:22.562225 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:04:22.563223 [info ] [MainThread]: 
12:04:22.571222 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:22.571222 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:22.572225 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:04:22.573223 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:04:22.574222 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:22.575226 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:22.575226 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:22.576222 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:22.579252 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:04:22.583222 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:04:22.584221 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.585225 [debug] [Thread-2  ]: finished collecting timing info
12:04:22.586229 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:04:22.587244 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:04:22.588228 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:22.589227 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:22.590226 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:04:22.591223 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:04:22.591223 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:22.592223 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:22.592223 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:22.593222 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:22.596257 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:04:22.600227 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:04:22.601222 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.602224 [debug] [Thread-2  ]: finished collecting timing info
12:04:22.602224 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:04:22.603226 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:04:22.603226 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:22.604225 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:22.604225 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:04:22.605257 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:04:22.606225 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:22.606225 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:22.606225 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:22.607221 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:22.610246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:04:22.613240 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:04:22.615227 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.615227 [debug] [Thread-2  ]: finished collecting timing info
12:04:22.616222 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:04:22.617224 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:04:22.618261 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:22.619224 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:22.619224 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:04:22.620258 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:04:22.621223 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:22.621223 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:22.622224 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:22.623224 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:22.626246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:04:22.629258 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:04:22.631236 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.632230 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:04:22.632230 [debug] [Thread-2  ]: finished collecting timing info
12:04:22.632230 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:22.633237 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:04:22.634236 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:04:22.634236 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:22.635243 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:22.635243 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:04:22.636231 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:22.637247 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:22.640241 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:04:22.641243 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:22.642241 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:22.654280 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.678277 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:22.679241 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:04:22.680243 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:04:22.681245 [debug] [Thread-2  ]: finished collecting timing info
12:04:22.682276 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:04:22.683250 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:22.684244 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:04:22.718282 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:04:22.718282 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:04:22.719241 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:04:22.734240 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:04:22.751246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:04:22.752242 [debug] [Thread-1  ]: finished collecting timing info
12:04:22.753242 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:04:22.758242 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:04:22.759241 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


12:04:22.760244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:04:22.766243 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


12:04:24.122988 [debug] [Thread-2  ]: finished collecting timing info
12:04:24.122988 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEC08D00>]}
12:04:24.123982 [info ] [Thread-2  ]: 1 of 5 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.49s]
12:04:24.125973 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:04:24.126966 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:24.126966 [info ] [Thread-2  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:04:24.128957 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:24.128957 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:24.129957 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:04:24.139991 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:24.140989 [debug] [Thread-2  ]: finished collecting timing info
12:04:24.141954 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:24.148988 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:04:24.149977 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:04:24.154988 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


12:04:24.228665 [debug] [Thread-1  ]: finished collecting timing info
12:04:24.229629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEBE1F40>]}
12:04:24.230627 [info ] [Thread-1  ]: 2 of 5 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.55s]
12:04:24.231629 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:04:24.232628 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:24.233627 [info ] [Thread-1  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:04:24.234655 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:24.235628 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:24.235628 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:24.258627 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:24.260629 [debug] [Thread-1  ]: finished collecting timing info
12:04:24.260629 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:24.265659 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:04:24.266658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:04:24.271686 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,'name' as territoryName
        ,'group' as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:04:26.023099 [debug] [Thread-2  ]: finished collecting timing info
12:04:26.024008 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDFC6CE50>]}
12:04:26.024008 [info ] [Thread-2  ]: 3 of 5 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.90s]
12:04:26.026597 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:04:26.085197 [debug] [Thread-1  ]: finished collecting timing info
12:04:26.086200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEB9B490>]}
12:04:26.086200 [info ] [Thread-1  ]: 4 of 5 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.85s]
12:04:26.088159 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:04:26.089161 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:26.090161 [info ] [Thread-2  ]: 5 of 5 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
12:04:26.091161 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:04:26.091161 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:26.092188 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:26.128157 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:04:26.130194 [debug] [Thread-2  ]: finished collecting timing info
12:04:26.131170 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:26.135191 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:04:26.136630 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:04:26.141637 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final;


12:04:27.634287 [debug] [Thread-2  ]: finished collecting timing info
12:04:27.635286 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c6e074-cd8f-4e78-a485-0c3ab78fd350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDFC8FB20>]}
12:04:27.635286 [info ] [Thread-2  ]: 5 of 5 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.54s]
12:04:27.637297 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:04:27.639287 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:04:27.640289 [info ] [MainThread]: 
12:04:27.640289 [info ] [MainThread]: Finished running 5 view models in 6.83s.
12:04:27.642312 [debug] [MainThread]: Connection 'master' was properly closed.
12:04:27.642312 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:04:27.642312 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:04:27.643287 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:04:27.643287 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
12:04:27.657289 [info ] [MainThread]: 
12:04:27.658287 [info ] [MainThread]: [32mCompleted successfully[0m
12:04:27.660301 [info ] [MainThread]: 
12:04:27.661289 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
12:04:27.663291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEAC1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEAC1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE9C7A30>]}


============================== 2022-05-16 12:09:28.323580 | 54441d89-659d-48be-88af-ad597e54a8b7 ==============================
12:09:28.323580 [info ] [MainThread]: Running with dbt=1.0.4
12:09:28.324593 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:09:28.324593 [debug] [MainThread]: Tracking: tracking
12:09:28.337608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D1A1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D1A1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D1A1160>]}
12:09:28.462607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
12:09:28.463607 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:09:28.463607 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:09:28.476613 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:09:28.516617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54441d89-659d-48be-88af-ad597e54a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D47B0D0>]}
12:09:28.529608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54441d89-659d-48be-88af-ad597e54a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D22F2E0>]}
12:09:28.530580 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:09:28.533577 [info ] [MainThread]: 
12:09:28.534583 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:09:28.535580 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:09:28.536609 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:09:29.513303 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:09:29.513303 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:09:30.114640 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:09:30.115634 [info ] [MainThread]: 
12:09:30.123622 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:09:30.124601 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:09:30.125599 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:09:30.126603 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:09:30.127609 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:09:30.152599 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:09:30.156619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:09:30.158629 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:09:30.162633 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:09:30.182598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:09:30.184568 [debug] [Thread-1  ]: finished collecting timing info
12:09:30.184568 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:09:30.214612 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:09:30.215576 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:09:30.220609 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:09:30.865085 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:09:31.256945 [debug] [Thread-1  ]: finished collecting timing info
12:09:31.257942 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:09:31.258942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54441d89-659d-48be-88af-ad597e54a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D561A60>]}
12:09:31.259943 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 1.13s]
12:09:31.261943 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:09:31.263943 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:09:31.264943 [info ] [MainThread]: 
12:09:31.266942 [info ] [MainThread]: Finished running 1 view model in 2.73s.
12:09:31.267943 [debug] [MainThread]: Connection 'master' was properly closed.
12:09:31.268942 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:09:31.269943 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:09:31.270942 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:09:31.287943 [info ] [MainThread]: 
12:09:31.288946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:09:31.290945 [info ] [MainThread]: 
12:09:31.292941 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:09:31.294948 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:09:31.295942 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:09:31.296946 [info ] [MainThread]: 
12:09:31.297944 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:09:31.299964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D1A1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D1B57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB0D4A2BB0>]}


============================== 2022-05-16 12:10:45.025908 | 9bf2e88a-63b0-40f2-9438-4b6a3d48b277 ==============================
12:10:45.025908 [info ] [MainThread]: Running with dbt=1.0.4
12:10:45.026928 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:10:45.026928 [debug] [MainThread]: Tracking: tracking
12:10:45.042914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022870E353A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022870E204F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022870E20580>]}
12:10:45.155911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:10:45.156926 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:10:45.168917 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:10:45.207939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf2e88a-63b0-40f2-9438-4b6a3d48b277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228710F80D0>]}
12:10:45.221913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf2e88a-63b0-40f2-9438-4b6a3d48b277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022870EAE310>]}
12:10:45.222910 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:10:45.225914 [info ] [MainThread]: 
12:10:45.226932 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:10:45.228913 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:10:45.228913 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:10:47.065941 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:10:47.065941 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:10:47.631282 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:10:47.633285 [info ] [MainThread]: 
12:10:47.641285 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:10:47.642284 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:10:47.644282 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:10:47.644282 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:10:47.645290 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:10:47.667315 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:10:47.673318 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:10:47.675303 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:10:47.678296 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:10:47.696316 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:10:47.698304 [debug] [Thread-1  ]: finished collecting timing info
12:10:47.698304 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:10:47.731311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:10:47.732282 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:10:47.737314 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:10:48.388355 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:10:49.489575 [debug] [Thread-1  ]: finished collecting timing info
12:10:49.490569 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:10:49.490569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2e88a-63b0-40f2-9438-4b6a3d48b277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228711D1460>]}
12:10:49.491569 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 1.85s]
12:10:49.492567 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:10:49.495565 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:10:49.496565 [info ] [MainThread]: 
12:10:49.497567 [info ] [MainThread]: Finished running 1 view model in 4.27s.
12:10:49.498571 [debug] [MainThread]: Connection 'master' was properly closed.
12:10:49.499566 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:10:49.499566 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:10:49.500566 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:10:49.514991 [info ] [MainThread]: 
12:10:49.514991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:10:49.517016 [info ] [MainThread]: 
12:10:49.518001 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:10:49.520000 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:10:49.521005 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:10:49.522005 [info ] [MainThread]: 
12:10:49.523015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:10:49.525016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228711E1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022870E25E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287115DD30>]}


============================== 2022-05-16 12:11:42.438987 | 53c8e1f3-fbe0-4cf4-b26d-081f03e0492e ==============================
12:11:42.438987 [info ] [MainThread]: Running with dbt=1.0.4
12:11:42.439987 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:11:42.440989 [debug] [MainThread]: Tracking: tracking
12:11:42.454988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F37610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F51F40>]}
12:11:42.569987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:11:42.570988 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
12:11:42.570988 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
12:11:42.571987 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
12:11:42.572986 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
12:11:42.572986 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
12:11:42.573987 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
12:11:42.573987 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
12:11:42.574999 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
12:11:42.576000 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
12:11:42.576000 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
12:11:42.586986 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
12:11:42.617987 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
12:11:42.619987 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
12:11:42.626987 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
12:11:42.628986 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
12:11:42.631986 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
12:11:42.637986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
12:11:42.639987 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
12:11:42.643987 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:11:42.646986 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
12:11:42.652987 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
12:11:42.654987 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
12:11:42.657999 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
12:11:42.659986 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
12:11:42.662986 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
12:11:42.665986 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
12:11:42.670986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
12:11:42.672988 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
12:11:42.675990 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:11:42.836986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53c8e1f3-fbe0-4cf4-b26d-081f03e0492e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E83530D0>]}
12:11:42.850987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53c8e1f3-fbe0-4cf4-b26d-081f03e0492e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F50340>]}
12:11:42.852000 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:11:42.855023 [info ] [MainThread]: 
12:11:42.856989 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:11:42.857989 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:11:42.858988 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:11:43.527048 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:11:43.528047 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:11:44.086155 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:11:44.087191 [info ] [MainThread]: 
12:11:44.095153 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:11:44.095153 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:11:44.097153 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:11:44.098154 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:11:44.098154 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:11:44.105151 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:11:44.109182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:11:44.110184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:11:44.114157 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:11:44.132984 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:11:44.134987 [debug] [Thread-1  ]: finished collecting timing info
12:11:44.134987 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:11:44.166984 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:11:44.167984 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:11:44.172983 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`GROUP`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:11:45.123986 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:11:46.407519 [debug] [Thread-1  ]: finished collecting timing info
12:11:46.408520 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:11:46.408520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53c8e1f3-fbe0-4cf4-b26d-081f03e0492e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E8433F10>]}
12:11:46.409521 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 2.31s]
12:11:46.412520 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:11:46.414518 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:11:46.415522 [info ] [MainThread]: 
12:11:46.416520 [info ] [MainThread]: Finished running 1 view model in 3.56s.
12:11:46.417519 [debug] [MainThread]: Connection 'master' was properly closed.
12:11:46.418521 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:11:46.418521 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:11:46.419520 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:11:46.439518 [info ] [MainThread]: 
12:11:46.440519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:11:46.442523 [info ] [MainThread]: 
12:11:46.444525 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:11:46.446535 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:11:46.447521 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:11:46.449518 [info ] [MainThread]: 
12:11:46.450519 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:11:46.452520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F505E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7F506A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E840CDC0>]}


============================== 2022-05-16 12:12:03.138125 | 3cb49999-c565-43bf-8402-c3b5609476a8 ==============================
12:12:03.138125 [info ] [MainThread]: Running with dbt=1.0.4
12:12:03.139123 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:12:03.139123 [debug] [MainThread]: Tracking: tracking
12:12:03.154128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C739489610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7394A6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7394A6C70>]}
12:12:03.275152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:12:03.277152 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
12:12:03.277152 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
12:12:03.278152 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
12:12:03.279122 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
12:12:03.279122 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
12:12:03.280127 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
12:12:03.280127 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
12:12:03.281122 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
12:12:03.281122 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
12:12:03.282123 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
12:12:03.294121 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
12:12:03.330153 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
12:12:03.331155 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
12:12:03.338152 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
12:12:03.340122 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
12:12:03.343151 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
12:12:03.349153 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
12:12:03.351152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
12:12:03.354153 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:12:03.357151 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
12:12:03.363152 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
12:12:03.365151 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
12:12:03.367152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
12:12:03.371152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
12:12:03.373152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
12:12:03.376151 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
12:12:03.382154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
12:12:03.383152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
12:12:03.386123 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:12:03.546124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb49999-c565-43bf-8402-c3b5609476a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7398A50D0>]}
12:12:03.560124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb49999-c565-43bf-8402-c3b5609476a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7394A1C10>]}
12:12:03.561127 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:12:03.564122 [info ] [MainThread]: 
12:12:03.565125 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:12:03.567143 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:12:03.567143 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:12:04.188591 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:12:04.188591 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:12:04.737689 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:12:04.738690 [info ] [MainThread]: 
12:12:04.746652 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:12:04.747648 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:12:04.749659 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:12:04.750673 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:12:04.751650 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:12:04.758654 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:12:04.761658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:12:04.763652 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:12:04.766648 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:12:04.789649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:12:04.790656 [debug] [Thread-1  ]: finished collecting timing info
12:12:04.791654 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:12:04.826652 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:12:04.828653 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:12:04.832650 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:12:05.452497 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:12:05.843677 [debug] [Thread-1  ]: finished collecting timing info
12:12:05.844675 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:12:05.844675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb49999-c565-43bf-8402-c3b5609476a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C739853070>]}
12:12:05.845677 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 1.10s]
12:12:05.847677 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:12:05.848674 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:12:05.849710 [info ] [MainThread]: 
12:12:05.850712 [info ] [MainThread]: Finished running 1 view model in 2.28s.
12:12:05.852674 [debug] [MainThread]: Connection 'master' was properly closed.
12:12:05.852674 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:12:05.853679 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:12:05.854676 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:12:05.868702 [info ] [MainThread]: 
12:12:05.870679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:12:05.871688 [info ] [MainThread]: 
12:12:05.873673 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:12:05.874674 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:12:05.876678 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:12:05.877686 [info ] [MainThread]: 
12:12:05.878673 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:12:05.879674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C73974A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7394A16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C739851670>]}


============================== 2022-05-16 12:15:32.723567 | 83151a21-6bc8-4abd-a69b-99e9bd4bd7e6 ==============================
12:15:32.723567 [info ] [MainThread]: Running with dbt=1.0.4
12:15:32.724569 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:15:32.725540 [debug] [MainThread]: Tracking: tracking
12:15:32.741539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261507315E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026150745160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026150745220>]}
12:15:32.912542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:15:32.914538 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:15:32.927577 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:15:32.969544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83151a21-6bc8-4abd-a69b-99e9bd4bd7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261509FFAF0>]}
12:15:32.983545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83151a21-6bc8-4abd-a69b-99e9bd4bd7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261507B70A0>]}
12:15:32.984542 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:15:32.987543 [info ] [MainThread]: 
12:15:32.989543 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:15:32.990557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:15:32.991539 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:15:35.809620 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:15:35.810656 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:15:37.236203 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:15:37.237176 [info ] [MainThread]: 
12:15:37.244189 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:15:37.245181 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:15:37.247194 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:15:37.248181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:15:37.248181 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:15:37.270212 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:15:37.274212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:15:37.275851 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:15:37.278860 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:15:37.296860 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:15:37.297860 [debug] [Thread-1  ]: finished collecting timing info
12:15:37.298861 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:15:37.326860 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:15:37.328877 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:15:37.332858 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:15:38.385318 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:15:39.826841 [debug] [Thread-1  ]: finished collecting timing info
12:15:39.827845 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:15:39.827845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83151a21-6bc8-4abd-a69b-99e9bd4bd7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026150AE0550>]}
12:15:39.828819 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 2.58s]
12:15:39.829819 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:15:39.831818 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:15:39.832822 [info ] [MainThread]: 
12:15:39.833822 [info ] [MainThread]: Finished running 1 view model in 6.84s.
12:15:39.835817 [debug] [MainThread]: Connection 'master' was properly closed.
12:15:39.835817 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:15:39.836823 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:15:39.837819 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:15:39.851817 [info ] [MainThread]: 
12:15:39.852823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:15:39.854823 [info ] [MainThread]: 
12:15:39.855827 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:15:39.857820 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:15:39.858818 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:15:39.859823 [info ] [MainThread]: 
12:15:39.860821 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:15:39.862840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261509AB460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261507B76D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026150B94970>]}


============================== 2022-05-16 12:16:09.673452 | 97c7bc85-d79c-4f86-85a2-c8808d4537d5 ==============================
12:16:09.673452 [info ] [MainThread]: Running with dbt=1.0.4
12:16:09.674453 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:16:09.675438 [debug] [MainThread]: Tracking: tracking
12:16:09.688447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0861670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B08751F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0875850>]}
12:16:09.806452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:16:09.808453 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:16:09.820434 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:16:09.861454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97c7bc85-d79c-4f86-85a2-c8808d4537d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0B2FAC0>]}
12:16:09.874424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97c7bc85-d79c-4f86-85a2-c8808d4537d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0A24910>]}
12:16:09.875422 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:16:09.879459 [info ] [MainThread]: 
12:16:09.880424 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:16:09.882454 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:16:09.882454 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:16:10.979060 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:16:10.979060 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:16:12.012895 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:16:12.013892 [info ] [MainThread]: 
12:16:12.020895 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:12.021921 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:16:12.022894 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:12.022894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:12.023896 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:12.047897 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:16:12.050914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:16:12.053898 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:16:12.057931 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:16:12.076895 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:12.078897 [debug] [Thread-1  ]: finished collecting timing info
12:16:12.078897 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:12.107935 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:12.108931 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:16:12.114931 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:16:13.015150 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got keyword AS at [20:16]')
12:16:14.366535 [debug] [Thread-1  ]: finished collecting timing info
12:16:14.366535 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got keyword AS at [20:16]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:16:14.367533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97c7bc85-d79c-4f86-85a2-c8808d4537d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0C1FEE0>]}
12:16:14.368497 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 2.34s]
12:16:14.369499 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:14.371499 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:16:14.372500 [info ] [MainThread]: 
12:16:14.373502 [info ] [MainThread]: Finished running 1 view model in 4.49s.
12:16:14.374495 [debug] [MainThread]: Connection 'master' was properly closed.
12:16:14.375498 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:16:14.376497 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:16:14.376497 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:16:14.389532 [info ] [MainThread]: 
12:16:14.390494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:16:14.392494 [info ] [MainThread]: 
12:16:14.393502 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:16:14.395498 [error] [MainThread]:   Syntax error: Expected keyword BY but got keyword AS at [20:16]
12:16:14.396499 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:16:14.397499 [info ] [MainThread]: 
12:16:14.398495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:16:14.400499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0ABB670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0ABB730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3B0CC3AF0>]}


============================== 2022-05-16 12:16:41.606981 | 5fae80c2-0199-4d05-9006-1c27de6901b3 ==============================
12:16:41.606981 [info ] [MainThread]: Running with dbt=1.0.4
12:16:41.607982 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:16:41.608985 [debug] [MainThread]: Tracking: tracking
12:16:41.623983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6BF2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6C06280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6C06A90>]}
12:16:41.739980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:16:41.740981 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:16:41.751981 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:16:41.789981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fae80c2-0199-4d05-9006-1c27de6901b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6EBA0A0>]}
12:16:41.802982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fae80c2-0199-4d05-9006-1c27de6901b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6DB3910>]}
12:16:41.803990 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:16:41.806982 [info ] [MainThread]: 
12:16:41.808984 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:16:41.810983 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:16:41.810983 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:16:42.767822 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:16:42.768821 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:16:43.436831 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:16:43.437829 [info ] [MainThread]: 
12:16:43.444830 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:43.445828 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:16:43.447834 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:43.447834 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:43.448860 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:43.471832 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:16:43.475835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:16:43.477831 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:16:43.480865 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:16:43.500864 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:43.502831 [debug] [Thread-1  ]: finished collecting timing info
12:16:43.502831 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:43.533862 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:16:43.534849 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:16:43.539864 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:16:44.177813 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:16:44.177813 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US

Location: US
Job ID: 4078f641-c9e4-4305-bb29-85d646bc3013

12:16:44.178814 [debug] [Thread-1  ]: finished collecting timing info
12:16:44.179814 [debug] [Thread-1  ]: Runtime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
  
  Location: US
  Job ID: 4078f641-c9e4-4305-bb29-85d646bc3013
  
12:16:44.179814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fae80c2-0199-4d05-9006-1c27de6901b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F6FADE80>]}
12:16:44.180814 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 0.73s]
12:16:44.181813 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:16:44.183814 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:16:44.184841 [info ] [MainThread]: 
12:16:44.185815 [info ] [MainThread]: Finished running 1 view model in 2.38s.
12:16:44.186816 [debug] [MainThread]: Connection 'master' was properly closed.
12:16:44.187815 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:16:44.187815 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:16:44.188814 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:16:44.199838 [info ] [MainThread]: 
12:16:44.200812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:16:44.202812 [info ] [MainThread]: 
12:16:44.203815 [error] [MainThread]: [33mRuntime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:16:44.205812 [error] [MainThread]:   404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
12:16:44.206814 [error] [MainThread]:   
12:16:44.207812 [error] [MainThread]:   Location: US
12:16:44.208817 [error] [MainThread]:   Job ID: 4078f641-c9e4-4305-bb29-85d646bc3013
12:16:44.209813 [error] [MainThread]:   
12:16:44.210814 [info ] [MainThread]: 
12:16:44.211812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:16:44.212833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F70519A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F7051E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171F7051670>]}


============================== 2022-05-16 12:20:38.870057 | 8e205a3c-50b7-4fd6-b0d9-db566802a820 ==============================
12:20:38.870057 [info ] [MainThread]: Running with dbt=1.0.4
12:20:38.871076 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:20:38.872030 [debug] [MainThread]: Tracking: tracking
12:20:38.886029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD5646EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD56481700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD56481A30>]}
12:20:39.008026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
12:20:39.009026 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:20:39.009026 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:20:39.021026 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:20:39.062036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e205a3c-50b7-4fd6-b0d9-db566802a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD5674D0D0>]}
12:20:39.077028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e205a3c-50b7-4fd6-b0d9-db566802a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD56643970>]}
12:20:39.077028 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:20:39.081028 [info ] [MainThread]: 
12:20:39.082028 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:20:39.084032 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:20:39.085029 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:20:40.133877 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:20:40.133877 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:20:40.720849 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:20:40.721849 [info ] [MainThread]: 
12:20:40.728885 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:20:40.729847 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:20:40.730849 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:20:40.731852 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:20:40.732849 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:20:40.755882 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:20:40.758885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:20:40.759935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:20:40.762923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:20:40.782920 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:20:40.784930 [debug] [Thread-1  ]: finished collecting timing info
12:20:40.784930 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:20:40.814950 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:20:40.815922 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:20:40.820950 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,`group` as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:20:41.522861 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,name as territoryName
        ,`group` as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:20:41.522861 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US

Location: US
Job ID: 53bd874e-638b-473e-98b3-a8480e3e1b8d

12:20:41.523866 [debug] [Thread-1  ]: finished collecting timing info
12:20:41.523866 [debug] [Thread-1  ]: Runtime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
  
  Location: US
  Job ID: 53bd874e-638b-473e-98b3-a8480e3e1b8d
  
12:20:41.524855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e205a3c-50b7-4fd6-b0d9-db566802a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD5683F6A0>]}
12:20:41.525819 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 0.79s]
12:20:41.527153 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:20:41.529166 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:20:41.530165 [info ] [MainThread]: 
12:20:41.531183 [info ] [MainThread]: Finished running 1 view model in 2.45s.
12:20:41.532172 [debug] [MainThread]: Connection 'master' was properly closed.
12:20:41.532172 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:20:41.533164 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:20:41.533164 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:20:41.546165 [info ] [MainThread]: 
12:20:41.547168 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:20:41.549178 [info ] [MainThread]: 
12:20:41.550167 [error] [MainThread]: [33mRuntime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:20:41.552166 [error] [MainThread]:   404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
12:20:41.553166 [error] [MainThread]:   
12:20:41.555179 [error] [MainThread]:   Location: US
12:20:41.556168 [error] [MainThread]:   Job ID: 53bd874e-638b-473e-98b3-a8480e3e1b8d
12:20:41.558168 [error] [MainThread]:   
12:20:41.559183 [info ] [MainThread]: 
12:20:41.560165 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:20:41.561169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD56738A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD56738A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD568E4760>]}


============================== 2022-05-16 12:21:37.810559 | 7c9711be-cbef-4b11-824b-87a6ef6db401 ==============================
12:21:37.810559 [info ] [MainThread]: Running with dbt=1.0.4
12:21:37.811524 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:21:37.811524 [debug] [MainThread]: Tracking: tracking
12:21:37.823525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3185B2D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3185C54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3185C5CA0>]}
12:21:37.945559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:21:37.945559 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:21:37.958522 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:21:37.998561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c9711be-cbef-4b11-824b-87a6ef6db401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31887A0D0>]}
12:21:38.011521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c9711be-cbef-4b11-824b-87a6ef6db401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F318774940>]}
12:21:38.012523 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:21:38.015532 [info ] [MainThread]: 
12:21:38.016525 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:21:38.018523 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:21:38.018523 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:21:38.723945 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:21:38.723945 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:21:39.332215 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:21:39.333491 [info ] [MainThread]: 
12:21:39.340503 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:21:39.341505 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:21:39.343502 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:21:39.344511 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:21:39.345506 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:21:39.369533 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:21:39.373541 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:21:39.374502 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:21:39.377540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:21:39.395537 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:21:39.397506 [debug] [Thread-1  ]: finished collecting timing info
12:21:39.397506 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:21:39.434532 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:21:39.436504 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:21:39.440538 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:21:40.067138 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`group`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:21:40.068098 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US

Location: US
Job ID: 41d8e13e-bb28-4a3b-8cff-01e9ae895627

12:21:40.069095 [debug] [Thread-1  ]: finished collecting timing info
12:21:40.069095 [debug] [Thread-1  ]: Runtime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
  
  Location: US
  Job ID: 41d8e13e-bb28-4a3b-8cff-01e9ae895627
  
12:21:40.070133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9711be-cbef-4b11-824b-87a6ef6db401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F318962280>]}
12:21:40.070133 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 0.73s]
12:21:40.072100 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:21:40.074100 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:21:40.075100 [info ] [MainThread]: 
12:21:40.075100 [info ] [MainThread]: Finished running 1 view model in 2.06s.
12:21:40.077109 [debug] [MainThread]: Connection 'master' was properly closed.
12:21:40.077109 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:21:40.078100 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:21:40.078100 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:21:40.092114 [info ] [MainThread]: 
12:21:40.093117 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:21:40.095109 [info ] [MainThread]: 
12:21:40.096119 [error] [MainThread]: [33mRuntime Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:21:40.097122 [error] [MainThread]:   404 Not found: Table snappy-meridian-350123:AdventureWorks.group was not found in location US
12:21:40.098133 [error] [MainThread]:   
12:21:40.100119 [error] [MainThread]:   Location: US
12:21:40.101120 [error] [MainThread]:   Job ID: 41d8e13e-bb28-4a3b-8cff-01e9ae895627
12:21:40.102119 [error] [MainThread]:   
12:21:40.103120 [info ] [MainThread]: 
12:21:40.105128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:21:40.106123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F318942FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F318A10DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F318A10700>]}


============================== 2022-05-16 12:22:53.620740 | d9b6e7af-2bb6-465e-bb3d-675d502518b9 ==============================
12:22:53.620740 [info ] [MainThread]: Running with dbt=1.0.4
12:22:53.621724 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:22:53.621724 [debug] [MainThread]: Tracking: tracking
12:22:53.636746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E79F7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7A11DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7A11730>]}
12:22:53.753713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
12:22:53.754714 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:22:53.756741 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
12:22:53.756741 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
12:22:53.757740 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
12:22:53.758740 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
12:22:53.758740 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
12:22:53.759740 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
12:22:53.760712 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
12:22:53.760712 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
12:22:53.760712 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
12:22:53.761711 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
12:22:53.773728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:22:53.786746 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
12:22:53.807746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
12:22:53.809746 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
12:22:53.815741 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
12:22:53.817740 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
12:22:53.819740 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
12:22:53.825746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
12:22:53.827749 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
12:22:53.830765 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:22:53.833747 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
12:22:53.839742 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
12:22:53.840747 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
12:22:53.843746 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
12:22:53.846746 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
12:22:53.848748 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
12:22:53.851746 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
12:22:53.857746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
12:22:53.859749 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
12:22:54.018740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b6e7af-2bb6-465e-bb3d-675d502518b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7E120D0>]}
12:22:54.031741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9b6e7af-2bb6-465e-bb3d-675d502518b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7A10490>]}
12:22:54.032712 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:22:54.034729 [info ] [MainThread]: 
12:22:54.036725 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:22:54.037714 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:22:54.038711 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:22:54.642538 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:22:54.642538 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:22:55.319651 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:22:55.320666 [info ] [MainThread]: 
12:22:55.327668 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:22:55.328668 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:22:55.330671 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:22:55.331670 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:22:55.332661 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:22:55.338700 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:22:55.341664 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:22:55.342665 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:22:55.346698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:22:55.365696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:22:55.367665 [debug] [Thread-1  ]: finished collecting timing info
12:22:55.367665 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:22:55.399704 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:22:55.401693 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:22:55.406697 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:22:56.723928 [debug] [Thread-1  ]: finished collecting timing info
12:22:56.724941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b6e7af-2bb6-465e-bb3d-675d502518b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7D97430>]}
12:22:56.724941 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.40s]
12:22:56.726925 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:22:56.728924 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:22:56.729925 [info ] [MainThread]: 
12:22:56.731928 [info ] [MainThread]: Finished running 1 view model in 2.69s.
12:22:56.732930 [debug] [MainThread]: Connection 'master' was properly closed.
12:22:56.733926 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:22:56.733926 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:22:56.734928 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:22:56.748928 [info ] [MainThread]: 
12:22:56.749930 [info ] [MainThread]: [32mCompleted successfully[0m
12:22:56.751931 [info ] [MainThread]: 
12:22:56.752926 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
12:22:56.753927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7C6B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7A109D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E7A253A0>]}


============================== 2022-05-16 12:23:48.993775 | 2a7c453d-851e-44d5-aafb-fc0ce7929826 ==============================
12:23:48.993775 [info ] [MainThread]: Running with dbt=1.0.4
12:23:48.994776 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:23:48.995777 [debug] [MainThread]: Tracking: tracking
12:23:49.008778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217368C2CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217368D5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217368D54C0>]}
12:23:49.125774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
12:23:49.127776 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
12:23:49.127776 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
12:23:49.128775 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
12:23:49.129776 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
12:23:49.129776 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
12:23:49.130783 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
12:23:49.131777 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
12:23:49.132806 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
12:23:49.132806 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
12:23:49.133806 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
12:23:49.134780 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:23:49.145812 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
12:23:49.177776 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
12:23:49.178775 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
12:23:49.185775 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
12:23:49.187778 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
12:23:49.190775 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
12:23:49.196776 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
12:23:49.197776 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
12:23:49.200775 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:23:49.203775 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
12:23:49.209783 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
12:23:49.211776 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
12:23:49.214775 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
12:23:49.217780 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
12:23:49.220776 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
12:23:49.223775 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
12:23:49.229775 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
12:23:49.231776 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
12:23:49.233776 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:23:49.403775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a7c453d-851e-44d5-aafb-fc0ce7929826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021736CC30D0>]}
12:23:49.416776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a7c453d-851e-44d5-aafb-fc0ce7929826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217368AEE20>]}
12:23:49.417776 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:23:49.420780 [info ] [MainThread]: 
12:23:49.421775 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:23:49.423780 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:23:49.423780 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:23:50.037228 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:23:50.038197 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:23:50.584109 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:23:50.585137 [info ] [MainThread]: 
12:23:50.593110 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:23:50.594115 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:23:50.596110 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:23:50.597107 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:23:50.598108 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:23:50.604108 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:23:50.608144 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:23:50.609113 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:23:50.612143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:23:50.632138 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:23:50.633110 [debug] [Thread-1  ]: finished collecting timing info
12:23:50.634109 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:23:50.674111 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:23:50.675111 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:23:50.680137 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:23:51.804828 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: territoryGroup at [20:10]')
12:23:53.609550 [debug] [Thread-1  ]: finished collecting timing info
12:23:53.609550 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Unrecognized name: territoryGroup at [20:10]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:23:53.610550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a7c453d-851e-44d5-aafb-fc0ce7929826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021736C9DD90>]}
12:23:53.611515 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 3.01s]
12:23:53.612518 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:23:53.614516 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:23:53.615519 [info ] [MainThread]: 
12:23:53.616522 [info ] [MainThread]: Finished running 1 view model in 4.19s.
12:23:53.617515 [debug] [MainThread]: Connection 'master' was properly closed.
12:23:53.618517 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:23:53.619538 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:23:53.619538 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:23:53.630515 [info ] [MainThread]: 
12:23:53.631517 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:23:53.633514 [info ] [MainThread]: 
12:23:53.634533 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
12:23:53.636515 [error] [MainThread]:   Unrecognized name: territoryGroup at [20:10]
12:23:53.638517 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
12:23:53.639527 [info ] [MainThread]: 
12:23:53.640523 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:23:53.642515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173691FD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217368D5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173691A2E0>]}


============================== 2022-05-16 12:26:03.952303 | 65c9a547-66c4-48ea-b895-db3b80934292 ==============================
12:26:03.952303 [info ] [MainThread]: Running with dbt=1.0.4
12:26:03.952303 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:26:03.953296 [debug] [MainThread]: Tracking: tracking
12:26:03.967295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EB53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EA0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EA0070>]}
12:26:04.087296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
12:26:04.088296 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
12:26:04.089301 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
12:26:04.089301 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
12:26:04.090294 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
12:26:04.091295 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
12:26:04.092295 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
12:26:04.092295 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
12:26:04.093313 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
12:26:04.093313 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
12:26:04.094295 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
12:26:04.095295 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
12:26:04.095295 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
12:26:04.096295 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
12:26:04.096295 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesReason.sql
12:26:04.097295 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
12:26:04.097295 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
12:26:04.115294 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
12:26:04.146294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
12:26:04.148295 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
12:26:04.155293 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
12:26:04.157294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
12:26:04.160294 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
12:26:04.166294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
12:26:04.167304 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
12:26:04.170294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
12:26:04.173294 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
12:26:04.180294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
12:26:04.181295 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
12:26:04.184294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
12:26:04.187294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
12:26:04.190293 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
12:26:04.193296 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
12:26:04.199331 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
12:26:04.201331 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
12:26:04.204332 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
12:26:04.327295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65c9a547-66c4-48ea-b895-db3b80934292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4525DEE0>]}
12:26:04.339295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65c9a547-66c4-48ea-b895-db3b80934292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EA06D0>]}
12:26:04.340295 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:26:04.343297 [info ] [MainThread]: 
12:26:04.344295 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:26:04.346316 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:26:04.347304 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:26:05.273169 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:26:05.274153 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:26:05.872151 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:26:05.873157 [info ] [MainThread]: 
12:26:05.881153 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:05.881153 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:26:05.883161 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:05.884153 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:05.885153 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:05.892188 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:26:05.895188 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:26:05.896184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:26:05.899187 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:26:05.924150 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:05.925150 [debug] [Thread-1  ]: finished collecting timing info
12:26:05.926151 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:05.958187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:05.959151 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:26:05.965182 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:26:07.245489 [debug] [Thread-1  ]: finished collecting timing info
12:26:07.246487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c9a547-66c4-48ea-b895-db3b80934292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE451B9430>]}
12:26:07.247487 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.36s]
12:26:07.248489 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:07.250491 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:26:07.251489 [info ] [MainThread]: 
12:26:07.253487 [info ] [MainThread]: Finished running 1 view model in 2.91s.
12:26:07.254485 [debug] [MainThread]: Connection 'master' was properly closed.
12:26:07.255494 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:26:07.256486 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:26:07.256486 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:26:07.281485 [info ] [MainThread]: 
12:26:07.282487 [info ] [MainThread]: [32mCompleted successfully[0m
12:26:07.285489 [info ] [MainThread]: 
12:26:07.286486 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
12:26:07.287490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EFBDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE44EA0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4525D5E0>]}


============================== 2022-05-16 12:26:14.294366 | 1141447c-b103-4741-afb9-ed8843ce1fbc ==============================
12:26:14.294366 [info ] [MainThread]: Running with dbt=1.0.4
12:26:14.295367 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:26:14.296367 [debug] [MainThread]: Tracking: tracking
12:26:14.310368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC183F0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC183F1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC183F1E80>]}
12:26:14.429366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:26:14.429366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:26:14.437365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC18671EE0>]}
12:26:14.450366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC18635E20>]}
12:26:14.451382 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
12:26:14.454368 [info ] [MainThread]: 
12:26:14.456369 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:26:14.457368 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
12:26:14.458368 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:26:15.080970 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
12:26:15.081931 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:26:15.690994 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
12:26:15.692003 [info ] [MainThread]: 
12:26:15.699799 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:26:15.699799 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:26:15.700799 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:26:15.701799 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:26:15.701799 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:26:15.702800 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:26:15.702800 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:26:15.703798 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:26:15.707806 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
12:26:15.710833 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
12:26:15.712813 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.712813 [debug] [Thread-2  ]: finished collecting timing info
12:26:15.713799 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
12:26:15.713799 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
12:26:15.714796 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:26:15.714796 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:26:15.715799 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:26:15.716800 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:26:15.717798 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:26:15.717798 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:26:15.718798 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:26:15.718798 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:26:15.721798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
12:26:15.724836 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
12:26:15.726577 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.726577 [debug] [Thread-2  ]: finished collecting timing info
12:26:15.727566 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
12:26:15.727566 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
12:26:15.728612 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:26:15.728612 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:26:15.729576 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:26:15.730575 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:26:15.730575 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:26:15.731576 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:26:15.731576 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:26:15.731576 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:26:15.735582 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
12:26:15.740603 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
12:26:15.741579 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.742576 [debug] [Thread-2  ]: finished collecting timing info
12:26:15.742576 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
12:26:15.743576 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
12:26:15.743576 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:26:15.744575 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:26:15.745585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:26:15.746575 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:26:15.746575 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:26:15.746575 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:26:15.747577 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:26:15.747577 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:26:15.752576 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
12:26:15.755575 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
12:26:15.757184 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.757184 [debug] [Thread-2  ]: finished collecting timing info
12:26:15.758170 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
12:26:15.758170 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
12:26:15.759199 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:26:15.760165 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:26:15.761167 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:26:15.761167 [info ] [Thread-2  ]: 1 of 5 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
12:26:15.762165 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:26:15.763152 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:26:15.763152 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:26:15.764168 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
12:26:15.768168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
12:26:15.768168 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
12:26:15.806196 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:26:15.807199 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.808161 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
12:26:15.808161 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
12:26:15.809161 [debug] [Thread-2  ]: finished collecting timing info
12:26:15.810164 [info ] [Thread-1  ]: 2 of 5 START view model AdventureWorks_marts.dim_Products....................... [RUN]
12:26:15.810164 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
12:26:15.812162 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
12:26:15.846198 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
12:26:15.847201 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
12:26:15.847485 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
12:26:15.865530 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:26:15.872531 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:26:15.873509 [debug] [Thread-1  ]: finished collecting timing info
12:26:15.874494 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
12:26:15.877494 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
12:26:15.878494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:26:15.880495 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


12:26:15.885531 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


12:26:17.149293 [debug] [Thread-1  ]: finished collecting timing info
12:26:17.150330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1879A6D0>]}
12:26:17.150330 [info ] [Thread-1  ]: 2 of 5 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.34s]
12:26:17.152293 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
12:26:17.153292 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
12:26:17.153292 [info ] [Thread-1  ]: 3 of 5 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
12:26:17.155293 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
12:26:17.155293 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
12:26:17.156296 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
12:26:17.170331 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:26:17.171293 [debug] [Thread-1  ]: finished collecting timing info
12:26:17.172298 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
12:26:17.176292 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
12:26:17.177479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:26:17.182489 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


12:26:17.357533 [debug] [Thread-2  ]: finished collecting timing info
12:26:17.357533 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC197850D0>]}
12:26:17.358533 [info ] [Thread-2  ]: 1 of 5 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.59s]
12:26:17.360497 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
12:26:17.360497 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:17.361497 [info ] [Thread-2  ]: 4 of 5 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
12:26:17.362497 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:17.363495 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:17.363495 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:17.390493 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:17.393498 [debug] [Thread-2  ]: finished collecting timing info
12:26:17.394600 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:17.397493 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
12:26:17.398496 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:26:17.404530 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


12:26:18.455260 [debug] [Thread-1  ]: finished collecting timing info
12:26:18.456257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC197DCD60>]}
12:26:18.457237 [info ] [Thread-1  ]: 3 of 5 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.30s]
12:26:18.458221 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
12:26:18.554507 [debug] [Thread-2  ]: finished collecting timing info
12:26:18.554507 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC186AFB50>]}
12:26:18.555508 [info ] [Thread-2  ]: 4 of 5 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.19s]
12:26:18.557487 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
12:26:18.558471 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:26:18.559471 [info ] [Thread-1  ]: 5 of 5 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
12:26:18.561469 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:26:18.562476 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:26:18.562476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:26:18.602471 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:26:18.603541 [debug] [Thread-1  ]: finished collecting timing info
12:26:18.604473 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:26:18.607498 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
12:26:18.608492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:26:18.613504 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final;


12:26:21.065325 [debug] [Thread-1  ]: finished collecting timing info
12:26:21.066286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1141447c-b103-4741-afb9-ed8843ce1fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC186D77C0>]}
12:26:21.067287 [info ] [Thread-1  ]: 5 of 5 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 2.50s]
12:26:21.068287 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
12:26:21.070288 [debug] [MainThread]: Acquiring new bigquery connection "master"
12:26:21.071287 [info ] [MainThread]: 
12:26:21.072290 [info ] [MainThread]: Finished running 5 view models in 6.62s.
12:26:21.073289 [debug] [MainThread]: Connection 'master' was properly closed.
12:26:21.074290 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
12:26:21.074290 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
12:26:21.075292 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
12:26:21.075292 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
12:26:21.094286 [info ] [MainThread]: 
12:26:21.096291 [info ] [MainThread]: [32mCompleted successfully[0m
12:26:21.098288 [info ] [MainThread]: 
12:26:21.099290 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
12:26:21.100289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC184458E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC184459A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC197E81C0>]}


============================== 2022-05-16 13:05:13.652801 | e6e1aea4-1598-4f25-980b-26d1dd4b957c ==============================
13:05:13.652801 [info ] [MainThread]: Running with dbt=1.0.4
13:05:13.718978 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:05:13.718978 [debug] [MainThread]: Tracking: tracking
13:05:13.829746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894CA59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894CA5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894CA5160>]}
13:05:14.573146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:05:14.573146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:05:14.652386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e1aea4-1598-4f25-980b-26d1dd4b957c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894F10F70>]}
13:05:14.668770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e1aea4-1598-4f25-980b-26d1dd4b957c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894ED4F40>]}
13:05:14.668770 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:05:14.672770 [info ] [MainThread]: 
13:05:14.674774 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:05:14.676771 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:05:14.676771 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:15.799683 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:05:15.801683 [info ] [MainThread]: 
13:05:15.811685 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:05:15.812690 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:05:15.813685 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:05:15.814687 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:05:15.815695 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:05:15.815695 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:05:15.816685 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:05:15.817685 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:05:15.822684 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:05:15.825688 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:05:15.827685 [debug] [Thread-1  ]: finished collecting timing info
13:05:15.828687 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.829689 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:05:15.831689 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:05:15.831689 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:05:15.833689 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:05:15.834687 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:05:15.835691 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:05:15.835691 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:05:15.836687 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:05:15.837685 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:05:15.837685 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:05:15.843687 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:05:15.848685 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:05:15.850686 [debug] [Thread-1  ]: finished collecting timing info
13:05:15.851686 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.852688 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:05:15.853693 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:05:15.854699 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:05:15.854699 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:05:15.855683 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:05:15.856684 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:05:15.857684 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:05:15.857684 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:05:15.858683 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:05:15.859687 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:05:15.862686 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:05:15.869690 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:05:15.871685 [debug] [Thread-1  ]: finished collecting timing info
13:05:15.872685 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:05:15.872685 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.872685 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:05:15.873686 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:05:15.874689 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:05:15.875685 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:05:15.875685 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:05:15.876684 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:05:15.877684 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:05:15.877684 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:05:15.882696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:05:15.883684 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:05:15.886722 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:05:15.887715 [debug] [Thread-1  ]: finished collecting timing info
13:05:15.888687 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:05:15.888687 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.889687 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:05:15.890684 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:05:15.890684 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:05:15.891685 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:05:15.892686 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:05:15.893685 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:05:15.893685 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:05:15.894693 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:05:15.898719 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:05:15.898719 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:05:15.950290 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:05:15.950290 [debug] [Thread-1  ]: finished collecting timing info
13:05:15.951289 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:05:15.952291 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:05:15.952291 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.953293 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:05:15.954292 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:05:15.954292 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:05:15.955291 [debug] [Thread-2  ]: finished collecting timing info
13:05:15.955291 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:05:15.956290 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:05:15.990838 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:05:15.991868 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:05:15.992841 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:05:15.993839 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:05:15.993839 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:05:16.005922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:05:16.006923 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.006923 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:05:16.007918 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.008918 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:05:16.008918 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:05:16.010021 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:05:16.010021 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:05:16.011022 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:05:16.031291 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:05:16.049929 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.050868 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:05:16.051867 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.051867 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.052865 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:05:16.052865 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:05:16.053906 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:05:16.054865 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.054865 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:05:16.055903 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:05:16.056869 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:05:16.056869 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:05:16.057864 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:05:16.057864 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:05:16.071266 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:05:16.071266 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:05:16.072233 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:05:16.079457 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:05:16.079457 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.080426 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.080426 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:05:16.080426 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:05:16.081423 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.081423 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.082424 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:05:16.083422 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:05:16.084425 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:05:16.084425 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:05:16.085424 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:05:16.086423 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:05:16.087422 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:05:16.087422 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:05:16.088423 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:05:16.088423 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:05:16.096420 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:05:16.103420 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:05:16.105422 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.106421 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.106421 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:05:16.106421 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:05:16.107424 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.108429 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.109421 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:05:16.110420 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:05:16.110420 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:05:16.111422 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:05:16.112433 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:05:16.115423 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:05:16.115423 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:05:16.116424 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:05:16.116424 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:05:16.117441 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:05:16.121424 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:05:16.125420 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:05:16.126420 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.127421 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:05:16.127421 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.128421 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.128421 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:05:16.129422 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:05:16.130436 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.130436 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:05:16.131435 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:05:16.132422 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:05:16.132422 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:05:16.133438 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:05:16.133438 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:05:16.134433 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:05:16.134433 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:05:16.172012 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:05:16.172012 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:05:16.176977 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:05:16.179112 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.179186 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.179186 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:05:16.180190 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:05:16.181200 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.181200 [debug] [Thread-1  ]: finished collecting timing info
13:05:16.182198 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:05:16.183187 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:05:16.184203 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:05:16.185190 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:05:16.185190 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:05:16.186190 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:05:16.189392 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:05:16.204824 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.204824 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:05:16.205822 [debug] [Thread-2  ]: finished collecting timing info
13:05:16.206818 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:05:16.207851 [debug] [MainThread]: Connection 'master' was properly closed.
13:05:16.208984 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:05:16.209096 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
13:05:16.209096 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:05:16.222481 [info ] [MainThread]: Done.
13:05:16.392073 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:05:16.393033 [info ] [MainThread]: Building catalog
13:05:16.396070 [debug] [MainThread]: Opening a new connection, currently in state init
13:05:17.005557 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:05:17.020251 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:05:17.021216 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:17.023215 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:17.028089 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:05:17.029090 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:05:22.247225 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:05:22.249419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020894CA59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020895043610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020881DC0250>]}
13:05:26.778811 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:05:26.779820 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:05:26.779820 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-16 13:05:38.154531 | 594f7170-1114-4ae5-a2a2-5ac0dac0ea61 ==============================
13:05:38.154531 [info ] [MainThread]: Running with dbt=1.0.4
13:05:38.156497 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:05:38.156497 [debug] [MainThread]: Tracking: tracking
13:05:38.170497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029730E0D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297210E2A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297210E2760>]}
13:05:38.173529 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:05:38.174523 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:05:38.176497 [info ] [MainThread]: 
13:05:38.177495 [info ] [MainThread]: 
13:05:38.178497 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-16 13:14:23.622582 | c852cf01-3d93-4c7b-813a-94df92c87793 ==============================
13:14:23.622582 [info ] [MainThread]: Running with dbt=1.0.4
13:14:23.623582 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:14:23.624553 [debug] [MainThread]: Tracking: tracking
13:14:23.638554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC2A6A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC2A6B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC2A6CA0>]}
13:14:23.747429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
13:14:23.747429 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
13:14:23.748621 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:14:23.759635 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
13:14:23.790438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
13:14:23.791438 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:14:23.799742 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:14:23.813915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC5B90D0>]}
13:14:23.827136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC54DAF0>]}
13:14:23.828136 [info ] [MainThread]: Found 15 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:14:23.832362 [info ] [MainThread]: 
13:14:23.834312 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:14:23.836313 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
13:14:23.836313 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:14:24.747448 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:14:24.748448 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:14:25.383113 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:14:25.384101 [info ] [MainThread]: 
13:14:25.393084 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:14:25.394084 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:14:25.394084 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:14:25.395069 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:14:25.396134 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:14:25.396710 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:14:25.396710 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:14:25.397740 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:14:25.401721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:14:25.405757 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:14:25.406718 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.407719 [debug] [Thread-2  ]: finished collecting timing info
13:14:25.407719 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:14:25.408720 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:14:25.408720 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:14:25.409720 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:14:25.410719 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:14:25.411720 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:14:25.411720 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:14:25.412721 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:14:25.412921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:14:25.413385 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:14:25.416802 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:14:25.419839 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:14:25.421803 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.422807 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:14:25.422807 [debug] [Thread-2  ]: finished collecting timing info
13:14:25.422807 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:14:25.423804 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:14:25.424805 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:14:25.424805 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:14:25.425804 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:14:25.426482 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:14:25.426482 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:14:25.427492 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:14:25.429517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:14:25.430518 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:14:25.434492 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:14:25.435493 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.437492 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:14:25.438491 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:14:25.438491 [debug] [Thread-2  ]: finished collecting timing info
13:14:25.439492 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:14:25.440491 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:14:25.440491 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:14:25.441498 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:14:25.441498 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:14:25.442506 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:14:25.444980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:14:25.445947 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:14:25.446944 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:14:25.446944 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.450965 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:14:25.451946 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:14:25.453944 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:14:25.453944 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:14:25.454945 [debug] [Thread-2  ]: finished collecting timing info
13:14:25.454945 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:14:25.455946 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:14:25.455946 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:14:25.456944 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:14:25.459943 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:14:25.460729 [info ] [Thread-2  ]: 1 of 6 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
13:14:25.462353 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.462353 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:14:25.463360 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:14:25.464370 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:14:25.464370 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:14:25.465371 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:14:25.466355 [info ] [Thread-1  ]: 2 of 6 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
13:14:25.486374 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:14:25.488354 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:14:25.489354 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:14:25.489354 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:14:25.490353 [debug] [Thread-2  ]: finished collecting timing info
13:14:25.505386 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:14:25.506353 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:14:25.540388 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:14:25.540388 [debug] [Thread-1  ]: finished collecting timing info
13:14:25.541353 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:14:25.545355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:14:25.545355 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:14:25.546353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:14:25.552353 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,person_id
            ,territory_id
            /* Columms */
            ,rowguid
            ,modifiedDate
        from CreditCards
    )

select * from final;


13:14:25.554354 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


13:14:26.173878 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "CreditCards" must be qualified with a dataset (e.g. dataset.table).')
13:14:26.772690 [debug] [Thread-2  ]: finished collecting timing info
13:14:26.773667 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC66C0D0>]}
13:14:26.773667 [info ] [Thread-2  ]: 1 of 6 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.31s]
13:14:26.775652 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:14:26.777661 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:14:26.778653 [debug] [Thread-1  ]: finished collecting timing info
13:14:26.779653 [info ] [Thread-2  ]: 3 of 6 START view model AdventureWorks_marts.dim_Products....................... [RUN]
13:14:26.780653 [debug] [Thread-1  ]: Database Error in model dim_Customers (models\marts\dim_Customers.sql)
  Table "CreditCards" must be qualified with a dataset (e.g. dataset.table).
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Customers.sql
13:14:26.781654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC69AEB0>]}
13:14:26.782656 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:14:26.782656 [error] [Thread-1  ]: 2 of 6 ERROR creating view model AdventureWorks_marts.dim_Customers............. [[31mERROR[0m in 1.29s]
13:14:26.783653 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:14:26.784653 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:14:26.800651 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:14:26.809690 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:14:26.809690 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:14:26.811733 [info ] [Thread-1  ]: 4 of 6 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
13:14:26.811733 [debug] [Thread-2  ]: finished collecting timing info
13:14:26.812731 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:14:26.813719 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:14:26.817718 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:14:26.822717 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:14:26.823718 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:14:26.835748 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:14:26.836723 [debug] [Thread-1  ]: finished collecting timing info
13:14:26.837716 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:14:26.841752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:14:26.842739 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:14:26.843725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:14:26.847754 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


13:14:26.848727 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


13:14:28.006641 [debug] [Thread-1  ]: finished collecting timing info
13:14:28.009632 [debug] [Thread-2  ]: finished collecting timing info
13:14:28.121089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC5FC1C0>]}
13:14:28.122089 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC5FC070>]}
13:14:28.123089 [info ] [Thread-1  ]: 4 of 6 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.31s]
13:14:28.124090 [info ] [Thread-2  ]: 3 of 6 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.34s]
13:14:28.126089 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:14:28.127090 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:14:28.128092 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:14:28.129089 [info ] [Thread-1  ]: 5 of 6 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
13:14:28.131088 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:14:28.131088 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:14:28.132088 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:14:28.160090 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:14:28.161092 [debug] [Thread-1  ]: finished collecting timing info
13:14:28.162090 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:14:28.166108 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:14:28.168092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:14:28.174096 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


13:14:29.325208 [debug] [Thread-1  ]: finished collecting timing info
13:14:29.326173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c852cf01-3d93-4c7b-813a-94df92c87793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC6CD580>]}
13:14:29.326173 [info ] [Thread-1  ]: 5 of 6 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.20s]
13:14:29.328439 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:14:29.329441 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:14:29.329441 [info ] [Thread-2  ]: 6 of 6 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
13:14:29.331465 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:14:29.333481 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:14:29.334483 [info ] [MainThread]: 
13:14:29.335478 [info ] [MainThread]: Finished running 6 view models in 5.50s.
13:14:29.336480 [debug] [MainThread]: Connection 'master' was properly closed.
13:14:29.337479 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
13:14:29.337479 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:14:29.338481 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:14:29.338481 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
13:14:29.359694 [info ] [MainThread]: 
13:14:29.360646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:14:29.361664 [info ] [MainThread]: 
13:14:29.362657 [error] [MainThread]: [33mDatabase Error in model dim_Customers (models\marts\dim_Customers.sql)[0m
13:14:29.364659 [error] [MainThread]:   Table "CreditCards" must be qualified with a dataset (e.g. dataset.table).
13:14:29.365662 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Customers.sql
13:14:29.366661 [info ] [MainThread]: 
13:14:29.368659 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
13:14:29.369656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAC55CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAD7136A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AAD6FD880>]}


============================== 2022-05-16 13:16:40.700235 | 0fc05fc1-87c5-42d7-b020-98bcc40e4228 ==============================
13:16:40.700235 [info ] [MainThread]: Running with dbt=1.0.4
13:16:40.701234 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:16:40.702227 [debug] [MainThread]: Tracking: tracking
13:16:40.715205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A3159610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A3171580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A3171460>]}
13:16:40.826880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
13:16:40.827879 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Customers.yml
13:16:40.829045 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
13:16:40.840288 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
13:16:40.868906 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
13:16:40.880159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A33DBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A33D24C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A33D5A60>]}


============================== 2022-05-16 13:17:40.200214 | b8af9ed4-6971-412c-84b5-721ce679e3df ==============================
13:17:40.200214 [info ] [MainThread]: Running with dbt=1.0.4
13:17:40.201215 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:17:40.201215 [debug] [MainThread]: Tracking: tracking
13:17:40.214219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CAE5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CAE5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CAE50D0>]}
13:17:40.324737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
13:17:40.325733 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Customers.yml
13:17:40.325733 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
13:17:40.338006 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
13:17:40.368771 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
13:17:40.406059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CDB40D0>]}
13:17:40.418573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CD19490>]}
13:17:40.419573 [info ] [MainThread]: Found 15 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:17:40.422605 [info ] [MainThread]: 
13:17:40.423574 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:17:40.425574 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
13:17:40.426573 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:17:41.107185 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:17:41.107185 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:17:41.692047 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:17:41.693077 [info ] [MainThread]: 
13:17:41.700064 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:17:41.700064 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:17:41.701064 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:17:41.702061 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:17:41.703058 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:17:41.704058 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:17:41.704058 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:17:41.705065 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:17:41.710059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:17:41.712453 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:17:41.714255 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.715264 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:17:41.715264 [debug] [Thread-2  ]: finished collecting timing info
13:17:41.715264 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:17:41.716260 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:17:41.717256 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:17:41.717256 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:17:41.718255 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:17:41.718255 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:17:41.719258 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:17:41.720297 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:17:41.723293 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:17:41.724261 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:17:41.727291 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:17:41.728258 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.729260 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:17:41.729260 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:17:41.729260 [debug] [Thread-2  ]: finished collecting timing info
13:17:41.730260 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:17:41.731311 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:17:41.731311 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:17:41.732255 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:17:41.733255 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:17:41.733503 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:17:41.737515 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:17:41.738515 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:17:41.739523 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:17:41.740516 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.742552 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:17:41.743548 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:17:41.744512 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:17:41.745516 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:17:41.745516 [debug] [Thread-2  ]: finished collecting timing info
13:17:41.746513 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:17:41.746513 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:17:41.747511 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:17:41.747511 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:17:41.750548 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:17:41.751522 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:17:41.752533 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:17:41.753540 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.754518 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:17:41.755519 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:17:41.759517 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:17:41.760382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:17:41.760928 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:17:41.761938 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:17:41.761938 [debug] [Thread-2  ]: finished collecting timing info
13:17:41.762938 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:17:41.762938 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:17:41.766972 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:17:41.767937 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:17:41.769942 [info ] [Thread-2  ]: 1 of 6 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
13:17:41.770955 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.771940 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:17:41.772938 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:17:41.772938 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:17:41.773939 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:17:41.774936 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:17:41.775204 [info ] [Thread-1  ]: 2 of 6 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
13:17:41.793255 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:17:41.794898 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:17:41.795908 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:17:41.795908 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:17:41.795908 [debug] [Thread-2  ]: finished collecting timing info
13:17:41.808910 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:17:41.809947 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:17:41.842974 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:17:41.843936 [debug] [Thread-1  ]: finished collecting timing info
13:17:41.844938 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:17:41.847937 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:17:41.847937 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:17:41.849937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:17:41.854935 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,person_id
            ,territory_id
            /* Columms */
            ,rowguid
            ,modifiedDate
        from Customers
    )

select * from final;


13:17:41.855936 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


13:17:43.059378 [debug] [Thread-2  ]: finished collecting timing info
13:17:43.061489 [debug] [Thread-1  ]: finished collecting timing info
13:17:43.061489 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CEEBCD0>]}
13:17:43.062490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CEA2EB0>]}
13:17:43.063508 [info ] [Thread-2  ]: 1 of 6 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.29s]
13:17:43.063508 [info ] [Thread-1  ]: 2 of 6 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.27s]
13:17:43.065487 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:17:43.066487 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:17:43.067489 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:17:43.068487 [info ] [Thread-2  ]: 3 of 6 START view model AdventureWorks_marts.dim_Products....................... [RUN]
13:17:43.069510 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:17:43.070492 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:17:43.071491 [info ] [Thread-1  ]: 4 of 6 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
13:17:43.071491 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:17:43.073489 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:17:43.073489 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:17:43.074502 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:17:43.108491 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:17:43.109490 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:17:43.134487 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:17:43.135487 [debug] [Thread-2  ]: finished collecting timing info
13:17:43.136488 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:17:43.142505 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:17:43.142505 [debug] [Thread-1  ]: finished collecting timing info
13:17:43.143487 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:17:43.148486 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:17:43.148486 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:17:43.150493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:17:43.155487 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


13:17:43.157507 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


13:17:44.394504 [debug] [Thread-1  ]: finished collecting timing info
13:17:44.395502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CEA5D30>]}
13:17:44.396506 [info ] [Thread-1  ]: 4 of 6 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.32s]
13:17:44.397469 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:17:44.398658 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:17:44.399660 [info ] [Thread-1  ]: 5 of 6 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
13:17:44.401661 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:17:44.401661 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:17:44.403658 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:17:44.425696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:17:44.426675 [debug] [Thread-1  ]: finished collecting timing info
13:17:44.427676 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:17:44.431692 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:17:44.433346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:17:44.438393 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


13:17:44.643108 [debug] [Thread-2  ]: finished collecting timing info
13:17:44.644107 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13DEFED90>]}
13:17:44.644107 [info ] [Thread-2  ]: 3 of 6 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.57s]
13:17:44.646107 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:17:45.701493 [debug] [Thread-1  ]: finished collecting timing info
13:17:45.702478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CE7C3A0>]}
13:17:45.703459 [info ] [Thread-1  ]: 5 of 6 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.30s]
13:17:45.704471 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:17:45.706457 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:17:45.707459 [info ] [Thread-2  ]: 6 of 6 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
13:17:45.708458 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:17:45.709456 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:17:45.709456 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:17:45.748491 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:17:45.749504 [debug] [Thread-2  ]: finished collecting timing info
13:17:45.750459 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:17:45.754461 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:17:45.789944 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:17:45.794942 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrderSalesReason.customer_id = dim_Customers.customer_id
    )

select * from final;


13:17:47.017732 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name customer_id not found inside SalesOrderSalesReason at [182:58]')
13:17:48.970879 [debug] [Thread-2  ]: finished collecting timing info
13:17:48.971915 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Name customer_id not found inside SalesOrderSalesReason at [182:58]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
13:17:48.971915 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8af9ed4-6971-412c-84b5-721ce679e3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13DF765E0>]}
13:17:48.972876 [error] [Thread-2  ]: 6 of 6 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 3.26s]
13:17:48.974876 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:17:48.975877 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:17:48.976905 [info ] [MainThread]: 
13:17:48.977885 [info ] [MainThread]: Finished running 6 view models in 8.55s.
13:17:48.979877 [debug] [MainThread]: Connection 'master' was properly closed.
13:17:48.979877 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
13:17:48.980877 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:17:48.980877 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:17:48.980877 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:17:48.996914 [info ] [MainThread]: 
13:17:48.997874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:17:48.999876 [info ] [MainThread]: 
13:17:49.000878 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
13:17:49.002877 [error] [MainThread]:   Name customer_id not found inside SalesOrderSalesReason at [182:58]
13:17:49.003877 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
13:17:49.005875 [info ] [MainThread]: 
13:17:49.006874 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
13:17:49.008889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CE3AE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13CE3AC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B13DF1A9D0>]}


============================== 2022-05-16 13:18:58.999492 | 64d41f75-f9ca-4af6-921d-de705cd940cc ==============================
13:18:58.999492 [info ] [MainThread]: Running with dbt=1.0.4
13:18:59.000537 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:18:59.001492 [debug] [MainThread]: Tracking: tracking
13:18:59.014493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FD22CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FD36220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FD36970>]}
13:18:59.128469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:18:59.129471 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:18:59.141739 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:18:59.172974 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:18:59.188041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FF88EE0>]}
13:18:59.201663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FF6FB50>]}
13:18:59.202628 [info ] [MainThread]: Found 15 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:18:59.205626 [info ] [MainThread]: 
13:18:59.207627 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:18:59.209627 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
13:18:59.209627 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:19:00.012136 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:19:00.012136 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:19:00.602556 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:19:00.603514 [info ] [MainThread]: 
13:19:00.611512 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:19:00.611512 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:19:00.612518 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:19:00.613515 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:19:00.614514 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:19:00.614514 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:19:00.615512 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:19:00.616513 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:19:00.619518 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:19:00.623512 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:19:00.625192 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.625192 [debug] [Thread-2  ]: finished collecting timing info
13:19:00.625192 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:19:00.626192 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:19:00.627191 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:19:00.628193 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:19:00.629192 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:19:00.630232 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:19:00.630232 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:19:00.630921 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:19:00.631381 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:19:00.631381 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:19:00.635400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:19:00.639395 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:19:00.640393 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.641393 [debug] [Thread-2  ]: finished collecting timing info
13:19:00.642396 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:19:00.643413 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:19:00.643413 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:19:00.644401 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:19:00.645400 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:19:00.645400 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:19:00.646430 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:19:00.646430 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:19:00.647391 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:19:00.647391 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:19:00.651400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:19:00.654431 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:19:00.656398 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.657392 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:19:00.657392 [debug] [Thread-2  ]: finished collecting timing info
13:19:00.657392 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:19:00.658395 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:19:00.659395 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:19:00.659395 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:19:00.660393 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:19:00.661393 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:19:00.661393 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:19:00.662086 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:19:00.664560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:19:00.665561 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:19:00.669600 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:19:00.670596 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.672566 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:19:00.672566 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:19:00.673562 [debug] [Thread-2  ]: finished collecting timing info
13:19:00.674564 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:19:00.675563 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:19:00.675563 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:19:00.676562 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:19:00.676562 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:19:00.677570 [info ] [Thread-2  ]: 1 of 6 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
13:19:00.680558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:19:00.681478 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:19:00.682486 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:19:00.683514 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:19:00.683514 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.702513 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:19:00.703509 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:19:00.704491 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:19:00.705516 [info ] [Thread-1  ]: 2 of 6 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
13:19:00.706506 [debug] [Thread-2  ]: finished collecting timing info
13:19:00.707487 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:19:00.707487 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:19:00.708487 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:19:00.743523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:19:00.744525 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:19:00.759490 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:19:00.760488 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:19:00.761487 [debug] [Thread-1  ]: finished collecting timing info
13:19:00.761487 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:19:00.764487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:19:00.766488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:00.766488 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


13:19:00.772486 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,person_id
            ,territory_id
            /* Columms */
            ,rowguid
            ,modifiedDate
        from Customers
    )

select * from final;


13:19:01.980194 [debug] [Thread-2  ]: finished collecting timing info
13:19:01.981192 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E5007A550>]}
13:19:01.982192 [info ] [Thread-2  ]: 1 of 6 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.30s]
13:19:01.984193 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:19:01.984193 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:19:01.985192 [info ] [Thread-2  ]: 3 of 6 START view model AdventureWorks_marts.dim_Products....................... [RUN]
13:19:01.986191 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:19:01.987194 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:19:01.987194 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:19:02.010198 [debug] [Thread-1  ]: finished collecting timing info
13:19:02.022195 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:19:02.023193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E50115220>]}
13:19:02.024192 [info ] [Thread-1  ]: 2 of 6 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.32s]
13:19:02.025193 [debug] [Thread-2  ]: finished collecting timing info
13:19:02.026193 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:19:02.027194 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:19:02.032194 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:19:02.035197 [info ] [Thread-1  ]: 4 of 6 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
13:19:02.039193 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:19:02.040194 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:19:02.041195 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:19:02.042192 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:19:02.042192 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:19:02.064192 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:19:02.065192 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final;


13:19:02.066194 [debug] [Thread-1  ]: finished collecting timing info
13:19:02.068193 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:19:02.075211 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:19:02.078220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:02.087210 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


13:19:03.247915 [debug] [Thread-1  ]: finished collecting timing info
13:19:03.248915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E500CF5B0>]}
13:19:03.250108 [info ] [Thread-1  ]: 4 of 6 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.21s]
13:19:03.251107 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:19:03.252110 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:19:03.252110 [info ] [Thread-1  ]: 5 of 6 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
13:19:03.254109 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:19:03.254109 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:19:03.255137 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:19:03.277142 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:19:03.279070 [debug] [Thread-1  ]: finished collecting timing info
13:19:03.279070 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:19:03.283080 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:19:03.284096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:19:03.289095 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


13:19:03.456828 [debug] [Thread-2  ]: finished collecting timing info
13:19:03.457825 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E500EFD60>]}
13:19:03.458970 [info ] [Thread-2  ]: 3 of 6 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.47s]
13:19:03.460969 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:19:04.514967 [debug] [Thread-1  ]: finished collecting timing info
13:19:04.514967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E51141EE0>]}
13:19:04.515967 [info ] [Thread-1  ]: 5 of 6 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.26s]
13:19:04.517968 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:19:04.518973 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:19:04.519967 [info ] [Thread-2  ]: 6 of 6 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
13:19:04.520968 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:19:04.521968 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:19:04.522967 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:19:04.607970 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:19:04.608968 [debug] [Thread-2  ]: finished collecting timing info
13:19:04.609968 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:19:04.613967 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:19:04.614966 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:19:04.619965 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


13:19:05.880654 [debug] [Thread-2  ]: finished collecting timing info
13:19:05.881655 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d41f75-f9ca-4af6-921d-de705cd940cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E500CEFD0>]}
13:19:05.882655 [info ] [Thread-2  ]: 6 of 6 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.36s]
13:19:05.883655 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:19:05.885655 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:19:05.886658 [info ] [MainThread]: 
13:19:05.887656 [info ] [MainThread]: Finished running 6 view models in 6.68s.
13:19:05.889659 [debug] [MainThread]: Connection 'master' was properly closed.
13:19:05.889659 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
13:19:05.890656 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:19:05.891656 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:19:05.891656 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:19:05.911654 [info ] [MainThread]: 
13:19:05.912655 [info ] [MainThread]: [32mCompleted successfully[0m
13:19:05.914657 [info ] [MainThread]: 
13:19:05.916660 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
13:19:05.917657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FFAF4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FF6A7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E4FF6FAC0>]}


============================== 2022-05-17 02:48:05.120494 | 187f797f-0271-4656-883d-eb2be6b70de5 ==============================
02:48:05.120494 [info ] [MainThread]: Running with dbt=1.0.4
02:48:05.121494 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
02:48:05.122496 [debug] [MainThread]: Tracking: tracking
02:48:05.146497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202551C2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202551D59A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202551D5400>]}
02:48:05.887567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
02:48:05.888536 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Persons.sql
02:48:05.889533 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:48:05.889533 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
02:48:05.890535 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_StateProvinces.sql
02:48:05.891534 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Adrresses.sql
02:48:05.892532 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:48:05.893568 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:48:05.893568 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:48:05.894583 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:48:05.894583 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:48:05.895568 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:48:05.895568 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:48:05.896543 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:48:05.896543 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:48:05.897537 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:48:05.897537 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:48:05.898532 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
02:48:05.898532 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:48:05.899588 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
02:48:05.913555 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:48:05.980594 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:48:06.003555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:48:06.005555 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:48:06.008559 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Adrresses.sql
02:48:06.011558 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:48:06.020555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:48:06.022559 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:48:06.028568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:48:06.030559 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:48:06.033558 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:48:06.039559 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:48:06.041592 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:48:06.044558 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:48:06.051640 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:48:06.052637 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:48:06.055636 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:48:06.062636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:48:06.063603 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:48:06.066636 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:48:06.069603 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:48:06.073636 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:48:06.076636 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:48:06.082442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:48:06.084443 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:48:06.087441 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:48:06.115440 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_AdventureWorks_Addresses' in the 'models' section of file 'models\staging\stg_AdventureWorks.yml'
02:48:06.154408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025540F130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020255516850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020255516700>]}


============================== 2022-05-17 02:49:20.183709 | 4e128cc1-78ef-450d-bee0-68eee1c545f4 ==============================
02:49:20.183709 [info ] [MainThread]: Running with dbt=1.0.4
02:49:20.183709 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
02:49:20.185673 [debug] [MainThread]: Tracking: tracking
02:49:20.206264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB916B1CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB916C5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB916C5D00>]}
02:49:20.423766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
02:49:20.424763 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Persons.sql
02:49:20.425732 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Addresses.sql
02:49:20.425732 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:49:20.426739 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_StateProvinces.sql
02:49:20.427732 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
02:49:20.429728 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:49:20.430729 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:49:20.431728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:49:20.431728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:49:20.432728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:49:20.432728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:49:20.433731 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:49:20.433731 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:49:20.434728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:49:20.434728 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:49:20.434728 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:49:20.435728 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
02:49:20.435728 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:49:20.436729 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
02:49:20.451727 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:49:20.466764 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
02:49:20.469769 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:49:20.472764 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:49:20.498729 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:49:20.499764 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:49:20.507764 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:49:20.509729 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:49:20.517732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:49:20.519769 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:49:20.521764 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:49:20.529789 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:49:20.531763 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:49:20.534732 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:49:20.540728 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:49:20.542728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:49:20.546729 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:49:20.554748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:49:20.555728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:49:20.558728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:49:20.562728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:49:20.566728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:49:20.569728 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:49:20.575727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:49:20.577728 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:49:20.581731 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:49:20.636766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB918FF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB919EC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB919EC040>]}


============================== 2022-05-17 02:51:22.239904 | 882bf412-05f7-4232-a7c3-59e991d86c9b ==============================
02:51:22.239904 [info ] [MainThread]: Running with dbt=1.0.4
02:51:22.240895 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
02:51:22.240895 [debug] [MainThread]: Tracking: tracking
02:51:22.254895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F231D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F2451F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F245220>]}
02:51:22.383922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
02:51:22.384895 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_StateProvinces.sql
02:51:22.384895 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
02:51:22.385926 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:51:22.385926 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Addresses.sql
02:51:22.386922 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Persons.sql
02:51:22.387922 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:51:22.389886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:51:22.389886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:51:22.390886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:51:22.390886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:51:22.391886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:51:22.392886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:51:22.392886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:51:22.393886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:51:22.393886 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:51:22.394890 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:51:22.394890 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:51:22.395899 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
02:51:22.395899 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
02:51:22.408888 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:51:22.422925 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:51:22.443926 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:51:22.445887 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
02:51:22.448886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:51:22.452886 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:51:22.460886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:51:22.462885 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:51:22.469886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:51:22.470886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:51:22.473886 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:51:22.479886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:51:22.480886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:51:22.483886 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:51:22.490888 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:51:22.491886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:51:22.494886 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:51:22.501885 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:51:22.502887 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:51:22.505886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:51:22.508886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:51:22.512886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:51:22.515886 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:51:22.521885 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:51:22.522886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:51:22.525886 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:51:22.677889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F47F130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F542D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F5421C0>]}


============================== 2022-05-17 02:53:30.092472 | e623f188-2bd0-4b76-aa50-a8f64dd74519 ==============================
02:53:30.092472 [info ] [MainThread]: Running with dbt=1.0.4
02:53:30.093473 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
02:53:30.094436 [debug] [MainThread]: Tracking: tracking
02:53:30.106484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BA963A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BA81700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BA81BB0>]}
02:53:30.231472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
02:53:30.232436 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:53:30.232436 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Persons.sql
02:53:30.233436 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Addresses.sql
02:53:30.233436 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
02:53:30.234436 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_StateProvinces.sql
02:53:30.235436 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:53:30.236443 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:53:30.237444 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:53:30.238436 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:53:30.238436 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:53:30.239455 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:53:30.239455 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:53:30.240447 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:53:30.240447 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:53:30.241436 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:53:30.241436 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:53:30.242436 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
02:53:30.243352 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:53:30.243352 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
02:53:30.256367 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:53:30.272362 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
02:53:30.275362 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:53:30.298361 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:53:30.300361 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:53:30.303360 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:53:30.310361 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:53:30.312362 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:53:30.319361 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:53:30.320361 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:53:30.323361 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:53:30.331435 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:53:30.332361 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:53:30.336360 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:53:30.342361 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:53:30.343361 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:53:30.346363 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:53:30.353361 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:53:30.355395 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:53:30.358362 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:53:30.361399 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:53:30.365360 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:53:30.368361 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:53:30.374365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:53:30.375361 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:53:30.378360 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:53:30.539364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BD064C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BDA6A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4BDA6100>]}


============================== 2022-05-17 02:54:15.533032 | 692c4108-df26-4aa3-9abb-adc71e3a829f ==============================
02:54:15.533032 [info ] [MainThread]: Running with dbt=1.0.4
02:54:15.534031 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
02:54:15.534995 [debug] [MainThread]: Tracking: tracking
02:54:15.548999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215619F53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215619E0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215619E06D0>]}
02:54:15.683031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
02:54:15.684029 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
02:54:15.684996 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:54:15.684996 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_StateProvinces.sql
02:54:15.686024 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Persons.sql
02:54:15.686024 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Addresses.sql
02:54:15.688013 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:54:15.688013 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:54:15.689025 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:54:15.689995 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:54:15.690996 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:54:15.690996 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:54:15.692004 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:54:15.692004 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:54:15.692995 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:54:15.692995 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:54:15.693994 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:54:15.694995 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
02:54:15.694995 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Customers.sql
02:54:15.694995 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:54:15.708995 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:54:15.743995 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:54:15.745996 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:54:15.749996 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:54:15.753010 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
02:54:15.756996 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:54:15.765996 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:54:15.767997 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:54:15.775998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:54:15.777999 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:54:15.781025 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:54:15.787031 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:54:15.789995 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:54:15.792995 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:54:15.799998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:54:15.801999 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:54:15.803997 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:54:15.810997 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:54:15.812998 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:54:15.815998 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:54:15.818998 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:54:15.823004 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:54:15.826031 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:54:15.832033 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:54:15.834033 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:54:15.837025 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:54:16.059121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '692c4108-df26-4aa3-9abb-adc71e3a829f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021561E3C0D0>]}
02:54:16.075119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '692c4108-df26-4aa3-9abb-adc71e3a829f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021561BAA250>]}
02:54:16.076122 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:54:16.080122 [info ] [MainThread]: 
02:54:16.082123 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:54:16.084766 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:54:16.084766 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:54:17.280585 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:54:17.281607 [info ] [MainThread]: 
02:54:17.339584 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:17.339584 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:17.340587 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:54:17.341597 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:54:17.342599 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:17.342599 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:17.343583 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:17.344618 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:17.347616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:54:17.350619 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:54:17.352581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.353581 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:17.353581 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:17.354583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.354583 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:54:17.355584 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:17.356582 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:17.357581 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:17.358591 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:17.359585 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:54:17.362589 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:54:17.362589 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:17.363604 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:17.364581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.367580 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:54:17.368584 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:17.369583 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:17.370583 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:54:17.370583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.371582 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:17.371582 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:17.372583 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:17.373606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:17.376607 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:54:17.377581 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:54:17.378584 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:17.379581 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:17.379581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.384619 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:54:17.385617 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:17.386581 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:17.387581 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:54:17.388584 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.388584 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:17.389582 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:17.390584 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:17.390584 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:17.393580 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:54:17.394580 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:54:17.395587 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:17.396582 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.396582 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:17.397582 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:17.402617 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:54:17.402617 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:17.404597 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:54:17.404597 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.404597 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:17.405580 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:17.405580 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:17.406582 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:17.409618 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:54:17.410598 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:54:17.411580 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:17.411580 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:17.411580 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.414581 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:54:17.415580 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:17.416581 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:17.416581 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:54:17.417582 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.417582 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:17.418585 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:17.419584 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:17.419584 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:17.422584 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:54:17.423583 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:54:17.424581 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:17.425581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.425581 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:17.426581 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:17.430586 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:54:17.431580 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:17.432585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:54:17.433583 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:17.433583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.433583 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:17.434583 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:17.453611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:54:17.453611 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
02:54:17.454582 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
02:54:17.455629 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
02:54:17.455629 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.455629 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
02:54:17.456582 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:17.473582 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
02:54:17.473582 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.474584 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:17.475593 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:54:17.511583 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:54:17.511583 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:54:17.511583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.512583 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:54:17.512583 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
02:54:17.536610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:54:17.537616 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.538599 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
02:54:17.539581 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:17.540613 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:54:17.540613 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:17.540613 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:54:17.551612 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:54:17.608584 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.609582 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:54:17.609582 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.610583 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.611584 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:17.612583 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:54:17.613581 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.613581 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:17.614580 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:17.615609 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:54:17.615609 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:17.616582 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:17.617585 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
02:54:17.618581 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:17.618581 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:17.636620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:54:17.636620 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
02:54:17.656585 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
02:54:17.656585 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.657580 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:17.658582 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.658582 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.659583 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:17.660582 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:17.660582 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:17.661630 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.662615 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:54:17.663582 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:17.663582 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:17.664582 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:17.664582 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:17.665586 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:54:17.678596 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:54:17.678596 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:17.679584 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:17.680584 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.686586 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:54:17.687584 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:17.688581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.689595 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:17.689595 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.690585 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:17.690585 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:17.691584 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
02:54:17.691584 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.692585 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:17.693588 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:17.693588 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:17.694583 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:17.698592 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
02:54:17.699603 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
02:54:17.700583 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:17.700583 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:17.705584 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
02:54:17.705584 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.706584 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:17.706584 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.707583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.707583 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:17.708603 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:17.709585 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:17.709585 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.710585 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:54:17.711600 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:17.711600 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:17.712584 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:17.713583 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:17.713583 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:54:17.718580 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:54:17.719592 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:17.720581 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:17.720581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.724581 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:54:17.725582 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:17.725582 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.726581 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.727583 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:17.727583 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:17.728584 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:17.729583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.729583 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:54:17.730612 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:17.730612 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:17.731582 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:17.732600 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:17.732600 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:54:17.737606 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:54:17.737606 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:17.738592 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:17.739596 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.743580 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:54:17.743580 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:17.744582 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.745585 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.745585 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:17.746617 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:17.747582 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:17.747582 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.748582 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:54:17.748582 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:17.749581 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:17.749581 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:17.750596 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:17.751582 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:54:17.792583 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:54:17.792583 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:17.793583 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:17.797611 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:54:17.801617 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.802584 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.802584 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:17.803584 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:17.803584 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.804583 [debug] [Thread-2  ]: finished collecting timing info
02:54:17.805582 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:17.805582 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:17.806625 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:17.807586 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:54:17.808582 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:17.808582 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:17.812581 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:54:17.813581 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.814583 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:17.814583 [debug] [Thread-1  ]: finished collecting timing info
02:54:17.815581 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:17.817581 [debug] [MainThread]: Connection 'master' was properly closed.
02:54:17.817581 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:54:17.818594 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:54:17.818594 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:54:17.832612 [info ] [MainThread]: Done.
02:54:17.833580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021561C39100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021561EC6CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021561EC6CA0>]}


============================== 2022-05-17 02:54:29.686590 | e0c28ca7-b28f-4b3b-a268-aec84e994573 ==============================
02:54:29.686590 [info ] [MainThread]: Running with dbt=1.0.4
02:54:29.687589 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:54:29.687589 [debug] [MainThread]: Tracking: tracking
02:54:29.703588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E101E2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E101F60D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E101F69A0>]}
02:54:30.042839 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:54:30.043799 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:54:30.044800 [info ] [MainThread]: 
02:54:30.045805 [info ] [MainThread]: 
02:54:30.047803 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-17 02:54:45.126786 | 3907cd1b-2c6c-43a5-b483-be1fa575c220 ==============================
02:54:45.126786 [info ] [MainThread]: Running with dbt=1.0.4
02:54:45.127787 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
02:54:45.127787 [debug] [MainThread]: Tracking: tracking
02:54:45.143793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA5753A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA560880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA560100>]}
02:54:45.276823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:54:45.276823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:54:45.285823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3907cd1b-2c6c-43a5-b483-be1fa575c220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA8180D0>]}
02:54:45.302786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3907cd1b-2c6c-43a5-b483-be1fa575c220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA6E18E0>]}
02:54:45.304787 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:54:45.307810 [info ] [MainThread]: 
02:54:45.309789 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:54:45.311815 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:54:45.312788 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:54:45.910418 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:54:45.911417 [info ] [MainThread]: 
02:54:45.919418 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:45.919418 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:45.920417 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:54:45.921420 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:54:45.921420 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:45.922420 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:45.923419 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:45.923419 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:45.927451 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:54:45.930419 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:54:45.930990 [debug] [Thread-1  ]: finished collecting timing info
02:54:45.932001 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:54:45.932001 [debug] [Thread-2  ]: finished collecting timing info
02:54:45.933003 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:45.935012 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:54:45.935012 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:54:45.936007 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:45.937001 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:45.937001 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:54:45.938001 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:45.938001 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:45.941039 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:54:45.942060 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:45.944678 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:54:45.945679 [debug] [Thread-1  ]: finished collecting timing info
02:54:45.946650 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:54:45.946650 [debug] [Thread-2  ]: finished collecting timing info
02:54:45.947646 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:45.948644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:54:45.949647 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:54:45.950658 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:45.951646 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:45.952646 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:54:45.953658 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:45.954515 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:45.957562 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:54:45.958556 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:45.961525 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:54:45.962525 [debug] [Thread-1  ]: finished collecting timing info
02:54:45.963529 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:54:45.963529 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:45.964530 [debug] [Thread-2  ]: finished collecting timing info
02:54:45.964530 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:54:45.965528 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:54:45.966529 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:45.967528 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:45.969527 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:45.970528 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:54:45.973561 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:54:45.973561 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:45.974529 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:45.975528 [debug] [Thread-1  ]: finished collecting timing info
02:54:45.978530 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:54:45.979563 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:54:45.980541 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:45.981544 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:54:45.981544 [debug] [Thread-2  ]: finished collecting timing info
02:54:45.982527 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:45.983525 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:54:45.984526 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:45.985525 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:45.988529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:54:45.989525 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:54:45.990134 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:45.991144 [debug] [Thread-1  ]: finished collecting timing info
02:54:45.991144 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:45.992145 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:54:45.996180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:54:45.996180 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:45.998148 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:54:45.998148 [debug] [Thread-2  ]: finished collecting timing info
02:54:45.999145 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:46.000148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:54:46.001145 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:46.001145 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:46.004182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:54:46.005145 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:54:46.006144 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:46.006144 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.007160 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:46.008183 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:54:46.011186 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:54:46.012144 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:46.013149 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:54:46.014148 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.014148 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:46.015148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:54:46.015148 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:46.016147 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
02:54:46.050775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:54:46.051526 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
02:54:46.052094 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
02:54:46.053113 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.053113 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
02:54:46.054102 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:46.071105 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
02:54:46.072068 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.072457 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:54:46.073468 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:54:46.073468 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.074466 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:54:46.075496 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
02:54:46.076481 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:54:46.076481 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.077446 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:54:46.078409 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
02:54:46.102433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:54:46.102433 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:46.104404 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:54:46.104404 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:46.105406 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.105406 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:54:46.106453 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:54:46.117440 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:54:46.117440 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.119405 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:54:46.119405 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.120405 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:46.120405 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:46.121406 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:54:46.122404 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.122404 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:46.123404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:54:46.123404 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:46.124405 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:46.142403 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:54:46.142403 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
02:54:46.143427 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:46.144405 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.144405 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
02:54:46.145407 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:46.164442 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
02:54:46.164442 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.165435 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:54:46.166405 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.166405 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:46.167404 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:46.168403 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:54:46.169405 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.169405 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:46.170405 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
02:54:46.170405 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:46.171419 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:46.181440 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:54:46.182418 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:54:46.183405 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:46.184423 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.184423 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:46.184423 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:46.192429 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:54:46.193429 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.194407 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:54:46.195404 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.195404 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:46.196404 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:46.197405 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
02:54:46.197405 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.198405 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:46.199418 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:54:46.199418 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:46.200404 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:46.204404 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
02:54:46.205404 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
02:54:46.206405 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:46.206405 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:46.207403 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.211429 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
02:54:46.211429 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:46.212404 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.213406 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.213406 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
02:54:46.214404 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:46.214404 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:46.215407 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.215407 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:54:46.216407 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
02:54:46.217418 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:46.217418 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:46.218408 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:46.218408 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:54:46.223403 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:54:46.223403 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:46.224238 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:46.225247 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.229248 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:54:46.230250 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:46.230250 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.231248 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.231248 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:54:46.232282 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:46.232282 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:46.233248 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.234258 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:54:46.234258 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:54:46.235253 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:46.235253 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:46.236257 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:46.236257 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:54:46.241264 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:54:46.242249 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:46.243254 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:46.247248 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:54:46.247248 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.248261 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:46.249247 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.249247 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.249247 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:54:46.250288 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:46.250288 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:46.251249 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.252263 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:54:46.253261 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:54:46.253261 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:46.254249 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:46.255249 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:46.255249 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:54:46.293283 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:54:46.294284 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:46.295247 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:46.296256 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.300248 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:54:46.301248 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:46.302248 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.303250 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:54:46.303250 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.304263 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:46.305261 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:46.305261 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:54:46.306252 [debug] [Thread-2  ]: finished collecting timing info
02:54:46.307268 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:46.307268 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:54:46.308266 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:46.312251 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:54:46.313251 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.314250 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:46.315251 [debug] [Thread-1  ]: finished collecting timing info
02:54:46.315251 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:54:46.317260 [debug] [MainThread]: Connection 'master' was properly closed.
02:54:46.318252 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:54:46.318252 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:54:46.318252 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:54:46.331284 [info ] [MainThread]: Done.
02:54:46.335252 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
02:54:46.335252 [info ] [MainThread]: Building catalog
02:54:46.338252 [debug] [MainThread]: Opening a new connection, currently in state init
02:54:46.959874 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
02:54:46.974902 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:54:46.975877 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
02:54:46.979897 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:54:46.980898 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:54:46.984876 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:54:51.205224 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
02:54:51.207211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA560880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA8BAD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFA8BAC70>]}
02:54:51.971980 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:54:51.972980 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
02:54:51.972980 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-17 02:54:57.579590 | 9a1d11d4-4176-411e-aa47-aaaf33ef457c ==============================
02:54:57.579590 [info ] [MainThread]: Running with dbt=1.0.4
02:54:57.580580 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:54:57.580580 [debug] [MainThread]: Tracking: tracking
02:54:57.596592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184066F1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184067059A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018406705880>]}
02:54:57.599580 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:54:57.601578 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:54:57.602579 [info ] [MainThread]: 
02:54:57.603578 [info ] [MainThread]: 
02:54:57.604579 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-17 03:04:29.840991 | bc659605-cb3f-46c8-9325-50c00576dbfa ==============================
03:04:29.840991 [info ] [MainThread]: Running with dbt=1.0.4
03:04:29.840991 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:04:29.841992 [debug] [MainThread]: Tracking: tracking
03:04:29.856996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBCA1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBCA1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBCA1AF0>]}
03:04:29.982992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
03:04:29.984995 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:04:29.984995 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
03:04:29.996991 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:04:30.030991 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:04:30.034006 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
03:04:30.051992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBFA00D0>]}
03:04:30.067993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBCFCF70>]}
03:04:30.069001 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:04:30.071992 [info ] [MainThread]: 
03:04:30.072992 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:30.074992 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:04:30.075992 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:31.236716 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:04:31.236716 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:31.828425 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:04:31.830431 [info ] [MainThread]: 
03:04:31.837426 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:04:31.838426 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:04:31.838426 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:04:31.839469 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:04:31.840426 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:04:31.840426 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:04:31.841261 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:04:31.841261 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:04:31.845271 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:04:31.849291 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:04:31.851294 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.852272 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.852272 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:04:31.853311 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:04:31.854275 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:04:31.855274 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:04:31.855274 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:04:31.856273 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:04:31.857273 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:04:31.857273 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:04:31.858270 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:04:31.858270 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:04:31.862308 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:04:31.865293 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:04:31.867273 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.868281 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.869275 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:04:31.870308 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:04:31.870308 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:04:31.871274 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:04:31.872274 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:04:31.872274 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:04:31.873271 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:04:31.873271 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:04:31.874273 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:04:31.874273 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:04:31.878272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:04:31.882311 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:04:31.884271 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.884271 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.885276 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:04:31.886271 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:04:31.886271 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:04:31.887272 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:04:31.888279 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:04:31.889274 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:04:31.889274 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:04:31.890272 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:04:31.890272 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:04:31.891273 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:04:31.895303 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:04:31.899276 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:04:31.900275 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.901272 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.901272 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:04:31.902276 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:04:31.903279 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:04:31.904274 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:04:31.904274 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:04:31.905274 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:04:31.906275 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:04:31.906275 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:04:31.907285 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:04:31.907285 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:04:31.912275 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:04:31.914308 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:04:31.916271 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.916271 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.917272 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:04:31.918274 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:04:31.918274 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:04:31.919272 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:04:31.920271 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:04:31.920271 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:04:31.921273 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:04:31.921273 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:04:31.922273 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:04:31.923273 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:04:31.926272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:04:31.929321 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:04:31.931272 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.931272 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.932274 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:04:31.933271 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:04:31.933271 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:04:31.934271 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
03:04:31.935271 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
03:04:31.935271 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
03:04:31.936271 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:04:31.938274 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
03:04:31.938274 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
03:04:31.939272 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
03:04:31.939272 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
03:04:31.940274 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
03:04:31.959288 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:04:31.977307 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:04:31.978273 [debug] [Thread-1  ]: finished collecting timing info
03:04:31.979274 [debug] [Thread-2  ]: finished collecting timing info
03:04:31.980273 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
03:04:31.980273 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
03:04:32.015274 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:04:32.019274 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:04:32.020271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:04:32.021272 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:04:32.027270 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


03:04:32.027270 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


03:04:33.250070 [debug] [Thread-1  ]: finished collecting timing info
03:04:33.250070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EC0BB220>]}
03:04:33.251073 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.31s]
03:04:33.253034 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:04:33.254034 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
03:04:33.254034 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
03:04:33.256035 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
03:04:33.257037 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
03:04:33.257037 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
03:04:33.284073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:04:33.285072 [debug] [Thread-1  ]: finished collecting timing info
03:04:33.286036 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
03:04:33.290072 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:04:33.293039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:04:33.299073 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


03:04:33.469905 [debug] [Thread-2  ]: finished collecting timing info
03:04:33.470904 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247D8DD02E0>]}
03:04:33.471907 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.53s]
03:04:33.473244 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
03:04:33.474300 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:04:33.474300 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:04:33.476256 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:04:33.476256 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:04:33.477263 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:04:33.495259 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:04:33.499257 [debug] [Thread-2  ]: finished collecting timing info
03:04:33.500258 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:04:33.506295 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:04:33.518082 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:04:33.523082 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


03:04:34.481367 [debug] [Thread-1  ]: finished collecting timing info
03:04:34.482365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBFDDEB0>]}
03:04:34.483339 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.23s]
03:04:34.484337 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
03:04:34.485339 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:04:34.486337 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
03:04:34.487345 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:04:34.487345 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:04:34.488351 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:04:34.511340 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:04:34.513337 [debug] [Thread-1  ]: finished collecting timing info
03:04:34.514338 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:04:34.519337 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:04:34.520370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:04:34.526340 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


03:04:34.680340 [debug] [Thread-2  ]: finished collecting timing info
03:04:34.681342 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EC097F70>]}
03:04:34.683339 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.21s]
03:04:34.697339 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:04:34.703340 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
03:04:34.704342 [info ] [Thread-2  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
03:04:34.705354 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
03:04:34.706340 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
03:04:34.706340 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
03:04:34.733343 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:04:34.735339 [debug] [Thread-2  ]: finished collecting timing info
03:04:34.735339 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
03:04:34.739368 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:04:34.741336 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:04:34.748337 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,countryRegionCode
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


03:04:35.710780 [debug] [Thread-1  ]: finished collecting timing info
03:04:35.711781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBFD5250>]}
03:04:35.712753 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.22s]
03:04:35.714744 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:04:35.932238 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: countryRegionCode; Did you mean countryRegion_id? at [100:14]')
03:04:37.532129 [debug] [Thread-2  ]: finished collecting timing info
03:04:37.532943 [debug] [Thread-2  ]: Database Error in model dim_Addresses (models\marts\dim_Addresses.sql)
  Unrecognized name: countryRegionCode; Did you mean countryRegion_id? at [100:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Addresses.sql
03:04:37.533941 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc659605-cb3f-46c8-9325-50c00576dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBFD57C0>]}
03:04:37.533941 [error] [Thread-2  ]: 6 of 7 ERROR creating view model AdventureWorks_marts.dim_Addresses............. [[31mERROR[0m in 2.83s]
03:04:37.535948 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
03:04:37.536944 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:37.537943 [info ] [Thread-1  ]: 7 of 7 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
03:04:37.538947 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:37.540947 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:37.542956 [info ] [MainThread]: 
03:04:37.543948 [info ] [MainThread]: Finished running 7 view models in 7.47s.
03:04:37.544943 [debug] [MainThread]: Connection 'master' was properly closed.
03:04:37.545942 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:04:37.546942 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:04:37.546942 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
03:04:37.547946 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
03:04:37.560944 [info ] [MainThread]: 
03:04:37.562942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:04:37.563947 [info ] [MainThread]: 
03:04:37.564941 [error] [MainThread]: [33mDatabase Error in model dim_Addresses (models\marts\dim_Addresses.sql)[0m
03:04:37.566944 [error] [MainThread]:   Unrecognized name: countryRegionCode; Did you mean countryRegion_id? at [100:14]
03:04:37.568943 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Addresses.sql
03:04:37.569957 [info ] [MainThread]: 
03:04:37.571941 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
03:04:37.572942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247ED1ABE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EBCFCD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247ED16A0D0>]}


============================== 2022-05-17 03:07:08.050628 | 02c0d953-e57a-45f8-a9a6-aa92ff5bf477 ==============================
03:07:08.050628 [info ] [MainThread]: Running with dbt=1.0.4
03:07:08.051612 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:07:08.052627 [debug] [MainThread]: Tracking: tracking
03:07:08.066612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B90553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B9040100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B90404F0>]}
03:07:08.229608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:07:08.230613 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.sql
03:07:08.247607 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
03:07:08.294610 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
03:07:08.326607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B93A60A0>]}
03:07:08.344611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B92BAC70>]}
03:07:08.345609 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:07:08.350611 [info ] [MainThread]: 
03:07:08.351609 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:07:08.353608 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:07:08.354611 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:07:08.966614 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:07:08.967610 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:07:09.558613 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:07:09.559614 [info ] [MainThread]: 
03:07:09.568611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:07:09.568611 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:07:09.569609 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:07:09.570610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:07:09.571611 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:07:09.571611 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:07:09.572613 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:07:09.573609 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:07:09.579609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:07:09.584613 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:07:09.586612 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.586612 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.587609 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:07:09.589609 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:07:09.590610 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:07:09.591610 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:07:09.592611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:07:09.593613 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:07:09.593613 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:07:09.594614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:07:09.595613 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:07:09.595613 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:07:09.602622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:07:09.609612 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:07:09.611610 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.611610 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.612614 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:07:09.613612 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:07:09.614613 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:07:09.615626 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:07:09.616618 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:07:09.616618 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:07:09.617612 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:07:09.617612 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:07:09.618612 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:07:09.618612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:07:09.622611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:07:09.627608 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:07:09.628610 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.629612 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.629612 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:07:09.630614 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:07:09.630614 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:07:09.631613 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:07:09.632612 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:07:09.632612 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:07:09.633612 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:07:09.633612 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:07:09.633612 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:07:09.634611 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:07:09.637610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:07:09.640610 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:07:09.641611 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.642610 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.642610 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:07:09.643612 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:07:09.644611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:07:09.644611 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:07:09.645612 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:07:09.645612 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:07:09.646611 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:07:09.646611 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:07:09.646611 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:07:09.647612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:07:09.650609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:07:09.653609 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:07:09.654614 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.654614 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.655610 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:07:09.656611 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:07:09.656611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:07:09.657613 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:07:09.658611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:07:09.658611 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:07:09.659614 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:07:09.659614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:07:09.659614 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:07:09.660611 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:07:09.663609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:07:09.666609 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:07:09.667613 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.668611 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:07:09.668611 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.669611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:07:09.669611 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:07:09.670611 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
03:07:09.671609 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
03:07:09.672611 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
03:07:09.672611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:07:09.673611 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
03:07:09.674614 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
03:07:09.674614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
03:07:09.674614 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
03:07:09.675613 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
03:07:09.697610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:07:09.715643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:07:09.717615 [debug] [Thread-1  ]: finished collecting timing info
03:07:09.717615 [debug] [Thread-2  ]: finished collecting timing info
03:07:09.717615 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
03:07:09.718613 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
03:07:09.752610 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:07:09.756637 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:07:09.757613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:07:09.758609 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:07:09.763639 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


03:07:09.763639 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


03:07:11.009382 [debug] [Thread-2  ]: finished collecting timing info
03:07:11.011380 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B9442190>]}
03:07:11.011380 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.34s]
03:07:11.013384 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
03:07:11.014381 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
03:07:11.015381 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
03:07:11.017387 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
03:07:11.017387 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
03:07:11.018392 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
03:07:11.067203 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:07:11.069208 [debug] [Thread-2  ]: finished collecting timing info
03:07:11.070204 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
03:07:11.078809 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:07:11.079806 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:07:11.087806 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


03:07:11.207808 [debug] [Thread-1  ]: finished collecting timing info
03:07:11.208840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B94E8C70>]}
03:07:11.208840 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.54s]
03:07:11.210806 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:07:11.210806 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:07:11.211805 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:07:11.211805 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:07:11.212804 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:07:11.212804 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:07:11.225805 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:07:11.226804 [debug] [Thread-1  ]: finished collecting timing info
03:07:11.226804 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:07:11.231804 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:07:11.233804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:07:11.238806 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


03:07:12.256861 [debug] [Thread-2  ]: finished collecting timing info
03:07:12.258845 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B93B5700>]}
03:07:12.259846 [info ] [Thread-2  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.24s]
03:07:12.261842 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
03:07:12.262842 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:07:12.262842 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
03:07:12.264846 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:07:12.264846 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:07:12.265845 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:07:12.288842 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:07:12.290845 [debug] [Thread-2  ]: finished collecting timing info
03:07:12.290845 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:07:12.298843 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:07:12.300842 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:07:12.306870 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


03:07:12.673919 [debug] [Thread-1  ]: finished collecting timing info
03:07:12.674919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B940D250>]}
03:07:12.675921 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.46s]
03:07:12.676920 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:07:12.677919 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
03:07:12.678918 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
03:07:12.679922 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
03:07:12.680922 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
03:07:12.681921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
03:07:12.714921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:07:12.715921 [debug] [Thread-1  ]: finished collecting timing info
03:07:12.716924 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
03:07:12.719939 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:07:12.721923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:07:12.727922 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


03:07:13.516750 [debug] [Thread-2  ]: finished collecting timing info
03:07:13.517752 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B93B5880>]}
03:07:13.517752 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.25s]
03:07:13.519753 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:07:13.899162 [debug] [Thread-1  ]: finished collecting timing info
03:07:13.899162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9BA52A430>]}
03:07:13.900191 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.22s]
03:07:13.901163 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
03:07:13.903165 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:07:13.903165 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:07:13.904165 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:07:13.905168 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:07:13.906165 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:07:13.959183 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:07:13.960208 [debug] [Thread-2  ]: finished collecting timing info
03:07:13.961167 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:07:13.964160 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:07:13.966161 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:07:13.972165 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,address_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
        left join dim_Addresses on
    )

select * from final;


03:07:14.563014 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [194:5]')
03:07:15.880384 [debug] [Thread-2  ]: finished collecting timing info
03:07:15.880384 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Syntax error: Unexpected ")" at [194:5]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:07:15.881384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c0d953-e57a-45f8-a9a6-aa92ff5bf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9BA562400>]}
03:07:15.882379 [error] [Thread-2  ]: 7 of 7 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 1.98s]
03:07:15.883383 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:07:15.885385 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:07:15.886385 [info ] [MainThread]: 
03:07:15.887384 [info ] [MainThread]: Finished running 7 view models in 7.53s.
03:07:15.889360 [debug] [MainThread]: Connection 'master' was properly closed.
03:07:15.890358 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:07:15.890358 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:07:15.891361 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
03:07:15.891361 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:07:15.965393 [info ] [MainThread]: 
03:07:15.966357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:07:15.968356 [info ] [MainThread]: 
03:07:15.969364 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
03:07:15.971361 [error] [MainThread]:   Syntax error: Unexpected ")" at [194:5]
03:07:15.972378 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:07:15.973360 [info ] [MainThread]: 
03:07:15.975358 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
03:07:15.976372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B93441F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B8F84640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B8F44E50>]}


============================== 2022-05-17 03:08:33.972876 | 7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a ==============================
03:08:33.972876 [info ] [MainThread]: Running with dbt=1.0.4
03:08:33.973876 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:08:33.974879 [debug] [MainThread]: Tracking: tracking
03:08:33.988878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B51CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B65220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B65CA0>]}
03:08:34.142910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
03:08:34.144891 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
03:08:34.144891 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
03:08:34.145877 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
03:08:34.146876 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
03:08:34.146876 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
03:08:34.146876 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
03:08:34.147879 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
03:08:34.147879 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
03:08:34.148913 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
03:08:34.148913 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_person
03:08:34.149875 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_address
03:08:34.149875 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_stateprovince
03:08:34.150874 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
03:08:34.150874 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:08:34.163902 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:08:34.200910 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:08:34.202876 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
03:08:34.210910 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
03:08:34.212875 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
03:08:34.219910 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
03:08:34.221874 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
03:08:34.225878 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
03:08:34.231878 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
03:08:34.233878 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
03:08:34.236873 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
03:08:34.243911 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
03:08:34.245874 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
03:08:34.248874 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
03:08:34.256910 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
03:08:34.258887 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
03:08:34.261911 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
03:08:34.263911 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
03:08:34.266911 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
03:08:34.269912 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
03:08:34.275910 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
03:08:34.277883 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
03:08:34.280875 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
03:08:34.282874 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
03:08:34.285880 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
03:08:34.288879 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
03:08:34.487875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265F9B0D0>]}
03:08:34.503874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B65CD0>]}
03:08:34.504874 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:08:34.510893 [info ] [MainThread]: 
03:08:34.512876 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:34.514876 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:08:34.515889 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:35.125728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:08:35.125728 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:35.727707 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:08:35.728707 [info ] [MainThread]: 
03:08:35.738715 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:08:35.738715 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:08:35.739752 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:08:35.740711 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:08:35.740711 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:08:35.741872 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:08:35.742303 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:08:35.742678 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:08:35.745724 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:08:35.748691 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:08:35.749688 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.750692 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.750692 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:08:35.752692 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:08:35.753690 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:08:35.753690 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:08:35.754689 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:08:35.754689 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:08:35.755689 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:08:35.755689 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:08:35.756689 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:08:35.756689 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:08:35.759687 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:08:35.762725 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:08:35.764690 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.764690 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.765688 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:08:35.765688 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:08:35.766687 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:08:35.766687 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:08:35.767687 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:08:35.768696 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:08:35.769714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:08:35.770697 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:08:35.771688 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:08:35.771927 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:08:35.774976 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:08:35.777941 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:08:35.779938 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.780940 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:08:35.780940 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.780940 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:08:35.781937 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:08:35.782937 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:08:35.782937 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:08:35.783936 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:08:35.784939 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:08:35.785951 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:08:35.786977 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:08:35.790977 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:08:35.790977 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:08:35.795936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:08:35.796939 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.796939 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:08:35.797976 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.797976 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:08:35.798939 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:08:35.799943 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:08:35.800942 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:08:35.801940 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:08:35.802939 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:08:35.803347 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:08:35.804260 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:08:35.806852 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:08:35.807824 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:08:35.811850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:08:35.812820 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.813815 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:08:35.813815 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:08:35.813815 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.814834 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:08:35.815814 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:08:35.816826 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:08:35.816826 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:08:35.817816 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:08:35.818822 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:08:35.821814 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:08:35.821814 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:08:35.822845 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:08:35.825851 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:08:35.826851 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.827825 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:08:35.828815 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:08:35.828815 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.829824 [info ] [Thread-2  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
03:08:35.830821 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:08:35.831815 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:08:35.831815 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
03:08:35.832835 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
03:08:35.833815 [info ] [Thread-1  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
03:08:35.833815 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
03:08:35.839851 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
03:08:35.854818 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:08:35.855834 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
03:08:35.856815 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
03:08:35.870853 [debug] [Thread-2  ]: finished collecting timing info
03:08:35.875816 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:08:35.876858 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
03:08:35.912813 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:08:35.912813 [debug] [Thread-1  ]: finished collecting timing info
03:08:35.913814 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
03:08:35.916845 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:08:35.917825 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:08:35.918829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:08:35.923813 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


03:08:35.924814 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


03:08:37.331893 [debug] [Thread-1  ]: finished collecting timing info
03:08:37.332894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265F4E610>]}
03:08:37.333894 [info ] [Thread-1  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.49s]
03:08:37.335898 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
03:08:37.336896 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
03:08:37.336896 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
03:08:37.338897 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
03:08:37.339910 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
03:08:37.339910 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
03:08:37.363928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:08:37.365900 [debug] [Thread-1  ]: finished collecting timing info
03:08:37.365900 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
03:08:37.370896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:08:37.372895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:08:37.378894 [debug] [Thread-2  ]: finished collecting timing info
03:08:37.379895 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020266065760>]}
03:08:37.379895 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


03:08:37.380895 [info ] [Thread-2  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.55s]
03:08:37.383895 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:08:37.384900 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:08:37.386899 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:08:37.387896 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:08:37.388932 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:08:37.389898 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:08:37.409894 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:08:37.411895 [debug] [Thread-2  ]: finished collecting timing info
03:08:37.412895 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:08:37.465928 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:08:37.467899 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:08:37.473895 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


03:08:38.590904 [debug] [Thread-1  ]: finished collecting timing info
03:08:38.590904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265F9B250>]}
03:08:38.591905 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.25s]
03:08:38.593915 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
03:08:38.594913 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:08:38.594913 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
03:08:38.596909 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:08:38.596909 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:08:38.597907 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:08:38.620910 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:08:38.622902 [debug] [Thread-1  ]: finished collecting timing info
03:08:38.622902 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:08:38.626903 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:08:38.627903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:08:38.632904 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


03:08:38.692065 [debug] [Thread-2  ]: finished collecting timing info
03:08:38.693063 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B31F40>]}
03:08:38.694063 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.31s]
03:08:38.695027 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:08:38.696027 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
03:08:38.697027 [info ] [Thread-2  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
03:08:38.698029 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
03:08:38.698029 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
03:08:38.699028 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
03:08:38.716026 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:08:38.717027 [debug] [Thread-2  ]: finished collecting timing info
03:08:38.718028 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
03:08:38.721028 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:08:38.723030 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:08:38.728063 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


03:08:39.941375 [debug] [Thread-2  ]: finished collecting timing info
03:08:39.942336 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265ED0400>]}
03:08:39.942336 [info ] [Thread-2  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.24s]
03:08:39.944336 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
03:08:40.051375 [debug] [Thread-1  ]: finished collecting timing info
03:08:40.052374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265F9B1C0>]}
03:08:40.053338 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.46s]
03:08:40.054340 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:08:40.055339 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:40.056364 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:08:40.057338 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:40.058335 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:40.059343 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:40.105375 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:40.106343 [debug] [Thread-2  ]: finished collecting timing info
03:08:40.106343 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:40.110377 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:40.112383 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:08:40.117378 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,address_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:08:41.348269 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: address_id at [160:14]')
03:08:43.011447 [debug] [Thread-2  ]: finished collecting timing info
03:08:43.011447 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: address_id at [160:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:08:43.012447 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2e265-0ba0-4f12-9f5b-2c8d0422ed1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265FD2970>]}
03:08:43.013451 [error] [Thread-2  ]: 7 of 7 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 2.96s]
03:08:43.014448 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:43.017449 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:43.018450 [info ] [MainThread]: 
03:08:43.019449 [info ] [MainThread]: Finished running 7 view models in 8.51s.
03:08:43.020452 [debug] [MainThread]: Connection 'master' was properly closed.
03:08:43.021452 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:08:43.022455 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:08:43.022455 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
03:08:43.023464 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:08:43.038451 [info ] [MainThread]: 
03:08:43.039451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:08:43.041466 [info ] [MainThread]: 
03:08:43.042451 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
03:08:43.044450 [error] [MainThread]:   Unrecognized name: address_id at [160:14]
03:08:43.046453 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:08:43.047449 [info ] [MainThread]: 
03:08:43.048449 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
03:08:43.050462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265CDD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265B3E100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020265E0BBE0>]}


============================== 2022-05-17 03:09:27.347865 | 3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad ==============================
03:09:27.347865 [info ] [MainThread]: Running with dbt=1.0.4
03:09:27.348866 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:09:27.349866 [debug] [MainThread]: Tracking: tracking
03:09:27.362868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732AC2A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732AC2F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732AC23D0>]}
03:09:27.514869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:09:27.515869 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:09:27.532866 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:09:27.572870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:09:27.592867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732DEF0D0>]}
03:09:27.610872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732D39C40>]}
03:09:27.610872 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:09:27.614872 [info ] [MainThread]: 
03:09:27.616868 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:09:27.618867 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:09:27.619871 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:09:28.256904 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:09:28.257904 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:09:28.825509 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:09:28.826502 [info ] [MainThread]: 
03:09:28.834701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:09:28.834701 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:09:28.835708 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:09:28.836701 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:09:28.836701 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:09:28.837701 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:09:28.837701 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:09:28.838727 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:09:28.843702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:09:28.846739 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:09:28.848703 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.848703 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.849702 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:09:28.849702 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:09:28.850703 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:09:28.851705 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:09:28.851705 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:09:28.852758 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:09:28.853701 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:09:28.853701 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:09:28.854702 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:09:28.855710 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:09:28.859703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:09:28.863721 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:09:28.865706 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.866702 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.867704 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:09:28.868702 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:09:28.869701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:09:28.870701 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:09:28.870701 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:09:28.872707 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:09:28.873719 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:09:28.874704 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:09:28.874704 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:09:28.875703 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:09:28.880702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:09:28.884712 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:09:28.885701 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.886701 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:09:28.886701 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.887702 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:09:28.888705 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:09:28.890704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:09:28.891707 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:09:28.892719 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:09:28.893716 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:09:28.894702 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:09:28.894702 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:09:28.898702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:09:28.899700 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:09:28.904725 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:09:28.905705 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.906707 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:09:28.907707 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.908702 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:09:28.909702 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:09:28.910702 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:09:28.910702 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:09:28.911731 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:09:28.912703 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:09:28.912703 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:09:28.913701 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:09:28.918700 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:09:28.919701 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:09:28.923703 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
03:09:28.924707 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.925702 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:09:28.926701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:09:28.926701 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.927700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:09:28.928715 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
03:09:28.929701 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:09:28.929701 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:09:28.930711 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:09:28.931719 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:09:28.934737 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:09:28.935717 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:09:28.935717 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:09:28.936701 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.941704 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:09:28.942713 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:09:28.943701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:09:28.944701 [debug] [Thread-2  ]: finished collecting timing info
03:09:28.944701 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
03:09:28.945700 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:09:28.946700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:09:28.947702 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
03:09:28.948701 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
03:09:28.948701 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
03:09:28.949701 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
03:09:28.950703 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
03:09:28.970701 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:09:28.970701 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
03:09:28.972703 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
03:09:28.981711 [debug] [Thread-1  ]: finished collecting timing info
03:09:28.991736 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:09:28.992702 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
03:09:29.027701 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:09:29.028701 [debug] [Thread-2  ]: finished collecting timing info
03:09:29.029704 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
03:09:29.029704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:09:29.033701 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:09:29.035713 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:09:29.039702 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


03:09:29.041703 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


03:09:30.280735 [debug] [Thread-2  ]: finished collecting timing info
03:09:30.281735 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732F3DDC0>]}
03:09:30.281735 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.33s]
03:09:30.283745 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
03:09:30.284736 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
03:09:30.284736 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
03:09:30.286750 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
03:09:30.286750 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
03:09:30.287735 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
03:09:30.330737 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:09:30.332735 [debug] [Thread-2  ]: finished collecting timing info
03:09:30.332735 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
03:09:30.338737 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:09:30.340736 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:09:30.348737 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


03:09:30.388735 [debug] [Thread-1  ]: finished collecting timing info
03:09:30.389736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732E8C580>]}
03:09:30.390736 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.44s]
03:09:30.392734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:09:30.393735 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:09:30.394735 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:09:30.395733 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:09:30.396737 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:09:30.396737 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:09:30.420734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:09:30.421735 [debug] [Thread-1  ]: finished collecting timing info
03:09:30.422734 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:09:30.428734 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:09:30.429734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:09:30.434735 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final;


03:09:31.719777 [debug] [Thread-1  ]: finished collecting timing info
03:09:31.719777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732E8FCD0>]}
03:09:31.720777 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.32s]
03:09:31.722741 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:09:31.722741 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:09:31.723769 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
03:09:31.724739 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:09:31.725740 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:09:31.725740 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:09:31.747735 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:09:31.749220 [debug] [Thread-1  ]: finished collecting timing info
03:09:31.749220 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:09:31.752229 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:09:31.753229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:09:31.759233 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


03:09:31.817061 [debug] [Thread-2  ]: finished collecting timing info
03:09:31.818059 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732EABB20>]}
03:09:31.819059 [info ] [Thread-2  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.53s]
03:09:31.821060 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
03:09:31.821060 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
03:09:31.822063 [info ] [Thread-2  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
03:09:31.823060 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
03:09:31.824062 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
03:09:31.824062 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
03:09:31.842063 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:09:31.843060 [debug] [Thread-2  ]: finished collecting timing info
03:09:31.843060 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
03:09:31.847095 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:09:31.848072 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:09:31.853097 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


03:09:33.032504 [debug] [Thread-2  ]: finished collecting timing info
03:09:33.032504 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022733FB4F70>]}
03:09:33.033504 [info ] [Thread-2  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.21s]
03:09:33.035469 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
03:09:33.247776 [debug] [Thread-1  ]: finished collecting timing info
03:09:33.248736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022733FC82B0>]}
03:09:33.249773 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.52s]
03:09:33.251734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:09:33.252735 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:09:33.252735 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:09:33.254735 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:09:33.254735 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:09:33.254735 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:09:33.299769 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:09:33.300770 [debug] [Thread-2  ]: finished collecting timing info
03:09:33.301734 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:09:33.304735 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:09:33.306749 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:09:33.311768 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:09:34.837785 [debug] [Thread-2  ]: finished collecting timing info
03:09:34.838746 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f336eb9-5cf4-4a3c-bc2a-e3cc8f224bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022733F9B490>]}
03:09:34.839753 [info ] [Thread-2  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.58s]
03:09:34.841748 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:09:34.842752 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:09:34.843786 [info ] [MainThread]: 
03:09:34.844747 [info ] [MainThread]: Finished running 7 view models in 7.23s.
03:09:34.845749 [debug] [MainThread]: Connection 'master' was properly closed.
03:09:34.846747 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:09:34.846747 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:09:34.847753 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
03:09:34.848762 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:09:34.865751 [info ] [MainThread]: 
03:09:34.866753 [info ] [MainThread]: [32mCompleted successfully[0m
03:09:34.867761 [info ] [MainThread]: 
03:09:34.868766 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
03:09:34.869761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732EFBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732EFB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022732EFBD00>]}


============================== 2022-05-18 13:10:53.480102 | cef3de33-35c6-4652-9fdc-53bda81056eb ==============================
13:10:53.480102 [info ] [MainThread]: Running with dbt=1.0.4
13:10:53.481103 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:10:53.482104 [debug] [MainThread]: Tracking: tracking
13:10:53.498104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF542E940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF54424C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF5442850>]}
13:10:53.547102 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:10:53.548105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cef3de33-35c6-4652-9fdc-53bda81056eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF54427F0>]}
13:10:54.254170 [debug] [MainThread]: Parsing macros\adapters.sql
13:10:54.278171 [debug] [MainThread]: Parsing macros\catalog.sql
13:10:54.284201 [debug] [MainThread]: Parsing macros\etc.sql
13:10:54.286201 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:10:54.289201 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:10:54.303200 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:10:54.306201 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:10:54.308201 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:10:54.312207 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:10:54.315349 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:10:54.324539 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:10:54.327540 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:10:54.330539 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:10:54.337533 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:10:54.342540 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:10:54.352539 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:10:54.354539 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:10:54.363506 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:10:54.368539 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:10:54.369541 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:10:54.370551 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:10:54.371503 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:10:54.372557 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:10:54.374540 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:10:54.376543 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:10:54.379539 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:10:54.381539 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:10:54.385541 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:10:54.390540 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:10:54.400540 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:10:54.402539 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:10:54.412533 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:10:54.426748 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:10:54.430748 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:10:54.438732 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:10:54.442757 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:10:54.444756 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:10:54.446755 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:10:54.453753 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:10:54.468748 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:10:54.475754 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:10:54.486749 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:10:54.498754 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:10:54.500754 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:10:54.517748 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:10:54.519748 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:10:54.523753 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:10:54.526721 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:10:54.529725 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
13:10:54.531720 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
13:10:54.533718 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
13:10:54.535719 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
13:10:54.536719 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
13:10:54.540718 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
13:10:54.546748 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
13:10:54.549748 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
13:10:54.559748 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
13:10:54.560748 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
13:10:54.563747 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
13:10:54.564748 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
13:10:54.566748 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
13:10:54.568722 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
13:10:54.569720 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
13:10:54.573754 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
13:10:54.575753 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
13:10:54.583747 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
13:10:54.585747 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
13:10:54.587748 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
13:10:54.588748 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
13:10:54.591754 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
13:10:54.593754 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
13:10:54.595754 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
13:10:54.600756 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
13:10:54.602754 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
13:10:54.604756 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
13:10:54.606754 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
13:10:54.608755 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
13:10:54.610754 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
13:10:54.625180 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
13:10:54.627181 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
13:10:54.630172 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
13:10:54.633146 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
13:10:54.647164 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
13:10:54.649144 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
13:10:54.651164 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
13:10:54.653162 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
13:10:54.656169 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
13:10:54.659142 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
13:10:54.663143 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
13:10:54.667164 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
13:10:54.669143 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
13:10:54.677169 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
13:10:54.679168 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
13:10:54.682170 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
13:10:54.684143 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
13:10:54.686178 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
13:10:54.717352 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
13:10:54.724326 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
13:10:54.729321 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
13:10:54.735323 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
13:10:54.741358 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
13:10:54.745322 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
13:10:54.748323 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
13:10:54.755322 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
13:10:54.764358 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
13:10:54.773326 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
13:10:54.777328 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
13:10:54.779360 [debug] [MainThread]: Parsing macros\sql\groupby.sql
13:10:54.782326 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
13:10:54.789347 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
13:10:54.791349 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
13:10:54.793357 [debug] [MainThread]: Parsing macros\sql\pivot.sql
13:10:54.799334 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
13:10:54.801348 [debug] [MainThread]: Parsing macros\sql\star.sql
13:10:54.809347 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
13:10:54.813323 [debug] [MainThread]: Parsing macros\sql\union.sql
13:10:54.828542 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
13:10:54.842535 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
13:10:54.844535 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
13:10:54.846536 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
13:10:55.251950 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
13:10:55.280955 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
13:10:55.282956 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
13:10:55.288959 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
13:10:55.290956 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
13:10:55.296955 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
13:10:55.297956 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:10:55.304958 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:10:55.306955 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:10:55.311958 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:10:55.312922 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
13:10:55.319295 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
13:10:55.321293 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:10:55.329293 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:10:55.331258 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
13:10:55.334292 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
13:10:55.337292 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
13:10:55.339294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
13:10:55.342294 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
13:10:55.345293 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:10:55.347295 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:10:55.350292 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:10:55.353293 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:10:55.356298 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:10:55.358293 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
13:10:55.361295 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
13:10:55.546634 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_AdventureWorks_SalesReasons' in the 'models' section of file 'models\staging\stg_AdventureWorks.yml'
13:10:55.604631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef3de33-35c6-4652-9fdc-53bda81056eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF58600A0>]}
13:10:55.620595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef3de33-35c6-4652-9fdc-53bda81056eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF5551FA0>]}
13:10:55.621596 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:10:55.625630 [info ] [MainThread]: 
13:10:55.626596 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:10:55.627632 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:10:55.628598 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:10:56.982324 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:10:56.983345 [info ] [MainThread]: 
13:10:57.042724 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:10:57.042724 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:10:57.043750 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:10:57.043750 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:10:57.044748 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:10:57.044748 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:10:57.045723 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:10:57.045723 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:10:57.049733 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:10:57.052758 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:10:57.054723 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.055727 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:10:57.055727 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.056722 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:10:57.056722 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:10:57.057722 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:10:57.057722 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:10:57.058722 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:10:57.058722 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:10:57.058722 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:10:57.059851 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:10:57.062212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:10:57.062212 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:10:57.066249 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:10:57.066249 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.067210 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:10:57.068210 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:10:57.068210 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.069210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:10:57.069210 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:10:57.070245 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:10:57.070245 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:10:57.071211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:10:57.071826 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:10:57.074579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:10:57.075580 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:10:57.076579 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:10:57.079614 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:10:57.080583 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.081581 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:10:57.082581 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.082581 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:10:57.083592 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:10:57.084584 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:10:57.084584 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:10:57.085581 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:10:57.086580 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:10:57.086580 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:10:57.087601 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:10:57.090579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:10:57.090799 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:10:57.094380 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:10:57.095345 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.096351 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:10:57.096351 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.096351 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:10:57.097346 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:10:57.098346 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:10:57.099348 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:10:57.099348 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:10:57.100345 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:10:57.100345 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:10:57.101280 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:10:57.141394 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:10:57.143398 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:10:57.146360 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:10:57.147358 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.148364 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:10:57.148364 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.149361 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:10:57.149361 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:10:57.150363 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:10:57.151366 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:10:57.151366 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:10:57.152360 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:10:57.152360 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:10:57.153361 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:10:57.156396 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:10:57.156396 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:10:57.160395 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:10:57.161374 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.161374 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:10:57.162367 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:10:57.162367 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:10:57.163363 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:10:57.163363 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:10:57.180361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:10:57.180361 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.181405 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:10:57.182361 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:10:57.182361 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.183370 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:10:57.184365 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:10:57.184365 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:10:57.185376 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.185376 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:10:57.186361 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:10:57.202136 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:10:57.202947 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:10:57.204975 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:10:57.204975 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:10:57.205957 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.205957 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:10:57.206960 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:10:57.226957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:10:57.227722 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.229067 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:10:57.229067 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:10:57.230073 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.230073 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:10:57.231083 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:10:57.232086 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:10:57.232086 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.233075 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:10:57.234077 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:10:57.244104 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:10:57.244104 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:10:57.246068 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:10:57.246068 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:10:57.247068 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.247068 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:10:57.247068 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:10:57.263067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:10:57.263067 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.265092 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:10:57.266068 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.266068 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:10:57.267074 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:10:57.268069 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:10:57.268069 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.268968 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:10:57.269536 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:10:57.270225 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:10:57.270759 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:10:57.287769 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:10:57.287769 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:10:57.288803 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:10:57.289781 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:10:57.298769 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.300769 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:10:57.301769 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:10:57.302769 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.302769 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.303769 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:10:57.303769 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:10:57.304769 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:10:57.305768 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.306769 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:10:57.306769 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:10:57.307769 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:10:57.307769 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:10:57.308779 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:10:57.308779 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:10:57.316031 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:10:57.316031 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:10:57.316995 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:10:57.320996 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:10:57.320996 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.322007 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:10:57.322007 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.322995 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:10:57.322995 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.323996 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:10:57.323996 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:10:57.324996 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:10:57.324996 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.326007 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:10:57.326007 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:10:57.326996 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:10:57.326996 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:10:57.331029 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:10:57.331995 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:10:57.333006 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:10:57.333006 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:10:57.336996 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:10:57.337996 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.337996 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:10:57.338996 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.338996 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.339995 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:10:57.339995 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:10:57.340997 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.340997 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:10:57.341995 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:10:57.342996 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:10:57.342996 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:10:57.343996 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:10:57.343996 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:10:57.344994 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:10:57.344994 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:10:57.349031 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:10:57.349996 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:10:57.353995 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:10:57.353995 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.354996 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:10:57.354996 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.355996 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.355996 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:10:57.356994 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:10:57.356994 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.357996 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:10:57.358996 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:10:57.358996 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:10:57.360005 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:10:57.360005 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:10:57.361011 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:10:57.361011 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:10:57.361995 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:10:57.366180 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:10:57.366180 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:10:57.372147 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:10:57.372147 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.373147 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:10:57.373147 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.373147 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.374165 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:10:57.375147 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:10:57.375147 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:10:57.376151 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.376151 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:10:57.377147 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:10:57.377147 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:10:57.378147 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:10:57.378147 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:10:57.379147 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:10:57.383181 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:10:57.383181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:10:57.384148 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:10:57.408146 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.420147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:10:57.420147 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:10:57.421147 [debug] [Thread-2  ]: finished collecting timing info
13:10:57.422148 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:10:57.429147 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.429147 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:10:57.429147 [debug] [Thread-1  ]: finished collecting timing info
13:10:57.430149 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:10:57.431148 [debug] [MainThread]: Connection 'master' was properly closed.
13:10:57.432149 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:10:57.432149 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:10:57.432149 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:10:57.444148 [info ] [MainThread]: Done.
13:10:57.605149 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:10:57.605149 [info ] [MainThread]: Building catalog
13:10:57.608147 [debug] [MainThread]: Opening a new connection, currently in state init
13:10:58.184071 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:10:58.195027 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:10:58.200062 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:10:58.202027 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:10:58.206726 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:10:58.206726 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:11:05.022487 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:11:05.024518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF5442B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF59D0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EF54D05B0>]}
13:11:05.836491 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:11:05.837455 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:11:05.837455 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-18 13:13:09.407247 | 7cba90eb-991b-4211-afea-7b119d2b2e7a ==============================
13:13:09.407247 [info ] [MainThread]: Running with dbt=1.0.4
13:13:09.408247 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:13:09.409251 [debug] [MainThread]: Tracking: tracking
13:13:09.424248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8E63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8E63BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8E63490>]}
13:13:09.530444 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
13:13:09.531443 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesReasons.sql
13:13:09.532421 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesReason.sql
13:13:09.533414 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
13:13:09.544444 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReasons.sql
13:13:09.559414 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:13:09.580414 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:13:09.581415 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:13:09.587414 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:13:09.623414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cba90eb-991b-4211-afea-7b119d2b2e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC91EA0D0>]}
13:13:09.638414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cba90eb-991b-4211-afea-7b119d2b2e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC902C790>]}
13:13:09.639433 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:13:09.642443 [info ] [MainThread]: 
13:13:09.643414 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:13:09.645416 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:13:09.646430 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:10.305142 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:13:10.306142 [info ] [MainThread]: 
13:13:10.312142 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:10.312142 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:10.313143 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:13:10.313143 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:13:10.314144 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:10.314144 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:10.315145 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:10.315145 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:10.319142 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:13:10.323140 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:13:10.324144 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.325144 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:10.325144 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.325144 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:10.326162 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:10.327143 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:13:10.328180 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:10.328180 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:10.329143 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:13:10.330143 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:10.330143 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:10.335143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:13:10.336146 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:10.340153 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:13:10.340153 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.341165 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:10.342146 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.342146 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:10.343143 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:10.343143 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:13:10.344144 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:10.344144 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:10.345143 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:13:10.346142 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:10.346142 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:10.350142 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:13:10.351150 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:10.355178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:13:10.355178 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.356143 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:10.357163 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:10.357163 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.358145 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:13:10.358145 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:10.359170 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:10.359170 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:10.360143 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:10.361144 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:13:10.363165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:13:10.364160 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:10.365143 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:10.368176 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:13:10.368176 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.369198 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:10.370142 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.370142 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:10.371170 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:10.372144 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:13:10.372144 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:10.373178 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:10.374142 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:13:10.374142 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:10.374142 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:10.377170 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:13:10.378165 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:10.382170 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:13:10.383143 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.384141 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:10.384141 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:10.385144 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.385144 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:13:10.386146 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:10.386146 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:10.387142 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:10.388144 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:10.388144 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:13:10.391165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:13:10.392166 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:10.393150 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:10.393150 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.397166 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:13:10.398139 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:10.399141 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:10.399141 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.400160 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:13:10.401143 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:10.401143 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:10.402163 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:13:10.402163 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:10.403191 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:13:10.419833 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:13:10.420609 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:13:10.420937 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:13:10.421947 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.436982 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:13:10.436982 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:10.437536 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.438558 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:10.438558 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.439557 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:13:10.440546 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:13:10.440887 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:13:10.440887 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.441898 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:13:10.441898 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:13:10.442931 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:13:10.442931 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:10.463895 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:13:10.464908 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:13:10.465895 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:10.466896 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.466896 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:13:10.466896 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:13:10.477983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:13:10.477983 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.478982 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:13:10.479986 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.479986 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:10.480984 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:10.481984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:13:10.481984 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.482712 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:10.483077 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:10.483661 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:10.483661 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:10.500709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:13:10.501671 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:13:10.502674 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:10.502674 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:13:10.502674 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.518706 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:13:10.518706 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:10.519639 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.520649 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.520649 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:10.521684 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:10.521684 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:10.522650 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.523588 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:13:10.524599 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:10.524599 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:10.525608 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:10.525608 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:10.526598 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:13:10.536597 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:13:10.536597 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:10.537597 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:10.544633 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:13:10.544633 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.545598 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:10.545598 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.545598 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.546600 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:10.547064 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:10.547515 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:10.547515 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.548527 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:13:10.549534 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:10.549534 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:10.550530 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:10.550530 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:10.551507 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:13:10.555131 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:13:10.556133 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:10.557141 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:10.561169 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:13:10.561169 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.562131 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:10.562131 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.562131 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.563131 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:10.564131 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:10.564131 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.565131 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:10.565131 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:10.566280 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:13:10.566280 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:10.567280 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:10.567280 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:13:10.568282 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:10.568282 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:10.574280 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:13:10.574280 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:10.578320 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:13:10.579280 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.579280 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:10.580284 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.580284 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.581289 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:10.581289 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:10.582282 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.582282 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:10.583102 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:10.584114 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:13:10.584114 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:10.585116 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:10.585116 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:13:10.586112 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:10.586112 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:10.590137 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:13:10.591118 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:10.595137 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:13:10.595137 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.596130 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:10.596130 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.596130 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.597121 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:10.598112 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:10.598112 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:10.599113 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.599113 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:13:10.600112 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:10.600112 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:10.601113 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:10.601686 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:10.602253 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:13:10.605940 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:13:10.606825 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:10.607837 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:10.611859 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:13:10.611859 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.612848 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:10.612848 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.612848 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.613835 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:10.613835 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:10.614834 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:10.615835 [debug] [Thread-2  ]: finished collecting timing info
13:13:10.616064 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:13:10.617063 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:10.617063 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:10.618063 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:10.690067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:13:10.691066 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.692067 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:10.692067 [debug] [Thread-1  ]: finished collecting timing info
13:13:10.692067 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:10.694075 [debug] [MainThread]: Connection 'master' was properly closed.
13:13:10.694075 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:13:10.695090 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:13:10.695090 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:13:10.707101 [info ] [MainThread]: Done.
13:13:10.708069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8D8C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8D8C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AC8D80E80>]}


============================== 2022-05-18 13:13:18.039283 | 8a9fec2c-37c6-436a-bc03-9e79fcbb81ca ==============================
13:13:18.039283 [info ] [MainThread]: Running with dbt=1.0.4
13:13:18.040300 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:13:18.040300 [debug] [MainThread]: Tracking: tracking
13:13:18.055283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23983340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23983BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23983940>]}
13:13:18.159284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:13:18.159284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:13:18.167284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a9fec2c-37c6-436a-bc03-9e79fcbb81ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23C2B0D0>]}
13:13:18.183284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a9fec2c-37c6-436a-bc03-9e79fcbb81ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23B1D0A0>]}
13:13:18.183284 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:13:18.187283 [info ] [MainThread]: 
13:13:18.188302 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:13:18.191286 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:13:18.191286 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:18.736391 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:13:18.737389 [info ] [MainThread]: 
13:13:18.744349 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:18.744349 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:18.745348 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:13:18.746347 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:13:18.747348 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:18.748394 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:18.749367 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:18.749367 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:18.753384 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:13:18.756383 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:13:18.757361 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.758348 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.759347 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:13:18.759347 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:13:18.760367 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:18.760367 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:18.761347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:13:18.762348 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:13:18.762348 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:18.763346 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:18.763346 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:18.763346 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:18.768351 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:13:18.772380 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:13:18.773367 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.774349 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:13:18.774349 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.774349 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:18.775348 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:13:18.776347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:13:18.777363 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:18.777363 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:18.778357 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:13:18.778357 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:18.779347 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:18.782383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:13:18.783349 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:18.787347 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:13:18.788347 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.788347 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:13:18.789348 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:18.789348 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.790394 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:13:18.791351 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:13:18.791351 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:18.792347 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:18.792347 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:18.793346 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:13:18.796372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:13:18.796372 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:18.797350 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:18.800372 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:13:18.800372 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.801347 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:13:18.802347 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.802347 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:18.803350 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:13:18.803350 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:13:18.804383 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:18.804383 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:18.805374 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:13:18.805374 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:18.806347 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:18.809373 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:13:18.809373 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:18.812378 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:13:18.813371 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.814346 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:13:18.815364 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:18.815364 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.816347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:13:18.816347 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:13:18.817346 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:18.817346 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:18.818346 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:18.819364 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:13:18.821372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:13:18.822375 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:18.823348 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:18.823348 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.827347 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:13:18.827347 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:13:18.828385 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:18.829355 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.829355 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:13:18.830369 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:13:18.831347 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:18.831347 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:13:18.832351 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:18.833348 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:13:18.863376 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:13:18.863376 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:13:18.865376 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:13:18.878376 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.882346 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:13:18.882346 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:18.883363 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.884349 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:13:18.884349 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.884349 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:13:18.885346 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:13:18.886346 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:13:18.886346 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.887349 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:13:18.888348 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:13:18.888348 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:13:18.889346 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:18.910383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:13:18.911369 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:13:18.912363 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:18.912363 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:13:18.913348 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.924346 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:13:18.924346 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:13:18.925380 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.926355 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:13:18.927350 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.927350 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:18.928349 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:18.929350 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:13:18.929350 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.930345 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:18.930345 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:13:18.930345 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:18.931346 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:18.947381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:13:18.947381 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:13:18.948357 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:18.949387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:13:18.949387 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.965603 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:13:18.965603 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:18.966331 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.967379 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:13:18.967379 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.968588 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:18.968946 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:18.969683 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:13:18.969683 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.970694 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:18.971693 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:13:18.971693 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:18.972693 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:18.982727 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:13:18.983693 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:13:18.984692 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:18.984692 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:18.984692 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.990871 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:13:18.991917 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:18.992503 [debug] [Thread-1  ]: finished collecting timing info
13:13:18.993527 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.993527 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:13:18.994530 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:18.994530 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:18.995538 [debug] [Thread-2  ]: finished collecting timing info
13:13:18.995538 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:13:18.996552 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:13:18.997514 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:18.997699 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:18.997699 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:18.998709 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:13:19.003733 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:13:19.004712 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:19.004712 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:19.005709 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.009708 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:13:19.009708 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:19.010710 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.011709 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:13:19.011709 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.012710 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:19.012710 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:19.013723 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:13:19.013723 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.014709 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:19.015709 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:13:19.015709 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:19.016708 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:19.020919 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:13:19.021168 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:13:19.021833 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:19.022851 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:19.022851 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.026879 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:13:19.026879 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:19.027624 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.028642 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.028642 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:13:19.028642 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:19.029634 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:19.030636 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.030636 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:13:19.031634 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:13:19.031634 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:19.032633 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:19.032633 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:19.033634 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:13:19.037672 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:13:19.037672 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:19.038636 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:19.039637 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.042675 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:13:19.043652 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:19.044634 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.045634 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:13:19.045634 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.045634 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:19.046636 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:19.047635 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:13:19.047635 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.048526 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:19.048929 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:13:19.049522 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:19.049522 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:19.053531 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:13:19.054531 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:13:19.055533 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:19.055533 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:19.056536 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.059933 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:13:19.060936 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:19.060936 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.061932 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.061932 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:13:19.062933 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:19.062933 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:19.063933 [debug] [Thread-2  ]: finished collecting timing info
13:13:19.064934 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:13:19.064934 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:13:19.065938 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:19.066935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:19.101962 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:13:19.103938 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.103938 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:19.104937 [debug] [Thread-1  ]: finished collecting timing info
13:13:19.104937 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:13:19.106935 [debug] [MainThread]: Connection 'master' was properly closed.
13:13:19.106935 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:13:19.107950 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:13:19.107950 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:13:19.119969 [info ] [MainThread]: Done.
13:13:19.123954 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:13:19.123954 [info ] [MainThread]: Building catalog
13:13:19.127937 [debug] [MainThread]: Opening a new connection, currently in state init
13:13:19.999481 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:13:20.013472 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:20.014438 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:13:20.017440 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:20.019441 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:13:20.022439 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:13:26.377140 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:13:26.379144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23983340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23D63790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C23D4A790>]}
13:13:27.008975 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:13:27.008975 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:13:27.009929 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-18 13:13:35.713498 | 55c89e1b-a61d-48b4-b3cb-345c76793b03 ==============================
13:13:35.713498 [info ] [MainThread]: Running with dbt=1.0.4
13:13:35.714504 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:13:35.714504 [debug] [MainThread]: Tracking: tracking
13:13:35.728502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38CB3E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38CB51D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38CB511C0>]}
13:13:35.731501 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:13:35.732500 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:13:35.733500 [info ] [MainThread]: 
13:13:35.734517 [info ] [MainThread]: 
13:13:35.735500 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-18 13:15:30.652596 | c8c933c5-9cf4-4336-a904-d9cff1e77b46 ==============================
13:15:30.652596 [info ] [MainThread]: Running with dbt=1.0.4
13:15:30.653568 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:15:30.653568 [debug] [MainThread]: Tracking: tracking
13:15:30.668575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDBEEED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDBF02730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDBF02880>]}
13:15:30.776566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:15:30.776566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:15:30.785593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC1AB0D0>]}
13:15:30.800598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC09E0A0>]}
13:15:30.801569 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:15:30.806570 [info ] [MainThread]: 
13:15:30.807569 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:15:30.809568 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
13:15:30.809568 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:31.534290 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:15:31.534290 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:32.148002 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:15:32.149003 [info ] [MainThread]: 
13:15:32.156005 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:32.156005 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:32.157003 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:15:32.158001 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:15:32.159001 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:32.159001 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:32.160002 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:32.160519 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:32.164054 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:15:32.168105 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:15:32.170059 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.170059 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.171059 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:32.172054 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:32.172054 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:32.173059 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:32.174058 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:15:32.175056 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:15:32.175056 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:32.175056 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:32.176055 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:32.176644 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:32.179681 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:15:32.183663 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:15:32.185657 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.186658 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:32.186658 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.186658 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:32.187659 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:32.188657 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:15:32.189658 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:32.189658 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:32.190658 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:15:32.190658 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:32.191656 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:32.194691 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:15:32.195656 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:32.199656 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:15:32.200666 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.201659 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:32.202673 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:32.202673 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.203667 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:15:32.204659 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:32.205658 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:32.206656 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:32.207558 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:32.207866 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:15:32.210911 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:15:32.211877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:32.211877 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:32.214917 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:15:32.215913 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.216878 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:32.217881 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.217881 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:32.218878 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:32.219893 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:15:32.220879 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:32.221880 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:32.221880 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:15:32.222876 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:32.222876 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:32.225911 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:15:32.226876 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:32.229911 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:15:32.229911 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.230893 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:32.231876 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:32.231876 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.232879 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:15:32.233877 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:32.233877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:32.234878 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:32.235876 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:32.235876 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:15:32.239911 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:15:32.240876 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:32.241877 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:32.241877 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.244878 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:15:32.245877 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:32.246875 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:32.247877 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
13:15:32.247877 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.248876 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:15:32.249877 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:32.249877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:32.250881 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:15:32.251892 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:32.251892 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
13:15:32.288877 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:15:32.289879 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:15:32.290876 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:15:32.290876 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:15:32.291882 [debug] [Thread-1  ]: finished collecting timing info
13:15:32.308916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:15:32.309876 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:32.341911 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:15:32.342933 [debug] [Thread-2  ]: finished collecting timing info
13:15:32.343880 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:15:32.343880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:15:32.348912 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:15:32.353911 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


13:15:32.376877 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:15:32.381912 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


13:15:33.676582 [debug] [Thread-2  ]: finished collecting timing info
13:15:33.676582 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC1F6520>]}
13:15:33.677583 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.39s]
13:15:33.679590 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:15:33.679590 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:15:33.680582 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
13:15:33.681579 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:15:33.682581 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:15:33.682581 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:15:33.723771 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:15:33.725771 [debug] [Thread-2  ]: finished collecting timing info
13:15:33.725771 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:15:33.730792 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:15:33.749770 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:15:33.755769 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


13:15:33.761770 [debug] [Thread-1  ]: finished collecting timing info
13:15:33.762770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC2B9CA0>]}
13:15:33.763770 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.51s]
13:15:33.765773 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:33.766774 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:33.767771 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
13:15:33.768770 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:15:33.769770 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:33.769770 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:15:33.784770 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:15:33.785770 [debug] [Thread-1  ]: finished collecting timing info
13:15:33.786770 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:33.790773 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:15:33.792770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:15:33.797769 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons
    )

select * from final;


13:15:35.019345 [debug] [Thread-2  ]: finished collecting timing info
13:15:35.020348 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD376F70>]}
13:15:35.021311 [info ] [Thread-2  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.34s]
13:15:35.022310 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:15:35.023312 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:35.024357 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
13:15:35.025310 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:15:35.025310 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:35.027313 [debug] [Thread-1  ]: finished collecting timing info
13:15:35.028312 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:35.028312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD33D220>]}
13:15:35.048345 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:15:35.048345 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.26s]
13:15:35.050312 [debug] [Thread-2  ]: finished collecting timing info
13:15:35.051314 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:35.052310 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:35.052310 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:35.057358 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:15:35.058311 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
13:15:35.060310 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:15:35.060310 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:15:35.060310 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:35.061310 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:15:35.078308 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:15:35.079309 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


13:15:35.080310 [debug] [Thread-1  ]: finished collecting timing info
13:15:35.081324 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:35.085311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:15:35.088313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:15:35.093344 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


13:15:36.265175 [debug] [Thread-1  ]: finished collecting timing info
13:15:36.266162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD354E80>]}
13:15:36.266162 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.21s]
13:15:36.268180 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:36.343830 [debug] [Thread-2  ]: finished collecting timing info
13:15:36.344824 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD352610>]}
13:15:36.344824 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.32s]
13:15:36.346827 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:36.347828 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:36.348827 [info ] [Thread-1  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
13:15:36.349848 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:15:36.350825 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:36.350825 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:36.395859 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:15:36.396825 [debug] [Thread-1  ]: finished collecting timing info
13:15:36.396825 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:36.401827 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:15:36.455590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:15:36.461602 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


13:15:37.711565 [debug] [Thread-1  ]: finished collecting timing info
13:15:37.713568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8c933c5-9cf4-4336-a904-d9cff1e77b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD301910>]}
13:15:37.714564 [info ] [Thread-1  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.36s]
13:15:37.716588 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:37.718565 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:15:37.718565 [info ] [MainThread]: 
13:15:37.719567 [info ] [MainThread]: Finished running 7 view models in 6.91s.
13:15:37.720567 [debug] [MainThread]: Connection 'master' was properly closed.
13:15:37.721570 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
13:15:37.722567 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:15:37.722567 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:15:37.722567 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:15:37.735572 [info ] [MainThread]: 
13:15:37.736566 [info ] [MainThread]: [32mCompleted successfully[0m
13:15:37.738584 [info ] [MainThread]: 
13:15:37.739564 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
13:15:37.740569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC1972B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC197760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC0A7B20>]}


============================== 2022-05-18 13:15:50.138324 | c7d91b39-c2c1-40b2-aa44-c2fb01ddfbc2 ==============================
13:15:50.138324 [info ] [MainThread]: Running with dbt=1.0.4
13:15:50.139322 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:15:50.139322 [debug] [MainThread]: Tracking: tracking
13:15:50.152328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED52A19790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED637421F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED63742D60>]}
13:15:50.268331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:15:50.269328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:15:50.278322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d91b39-c2c1-40b2-aa44-c2fb01ddfbc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED639EC0D0>]}
13:15:50.293323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d91b39-c2c1-40b2-aa44-c2fb01ddfbc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED638DE0A0>]}
13:15:50.294324 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:15:50.298324 [info ] [MainThread]: 
13:15:50.299323 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:15:50.301331 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:15:50.301331 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:50.937088 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:15:50.938083 [info ] [MainThread]: 
13:15:50.945084 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:50.946088 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:50.946088 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:15:50.948090 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:15:50.948090 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:50.949086 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:50.949086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:50.950085 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:50.954120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:15:50.957122 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:15:50.958087 [debug] [Thread-1  ]: finished collecting timing info
13:15:50.959087 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:15:50.959087 [debug] [Thread-2  ]: finished collecting timing info
13:15:50.959087 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:50.960087 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:15:50.961088 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:15:50.962085 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:50.963094 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:50.964089 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:15:50.965090 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:50.965090 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:50.969086 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:15:50.969493 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:50.973107 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:15:50.974072 [debug] [Thread-1  ]: finished collecting timing info
13:15:50.975072 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:15:50.975072 [debug] [Thread-2  ]: finished collecting timing info
13:15:50.975072 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:50.976072 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:15:50.977075 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:15:50.977075 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:50.978073 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:50.979076 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:15:50.979076 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:50.980075 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:50.984114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:15:50.984114 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:50.988110 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:15:50.988110 [debug] [Thread-1  ]: finished collecting timing info
13:15:50.989073 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:15:50.990074 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:50.990074 [debug] [Thread-2  ]: finished collecting timing info
13:15:50.991077 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:15:50.991077 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:15:50.992074 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:50.992074 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:50.993073 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:50.993073 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:15:50.998084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:15:50.998084 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:50.999091 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:51.002110 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:15:51.003108 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.003598 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:15:51.004608 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.004608 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:51.005613 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:15:51.006609 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:15:51.006609 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:51.007288 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:51.007288 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:15:51.008300 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:51.008300 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:51.012299 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:15:51.013300 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:51.017334 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:15:51.017334 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.018303 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:15:51.018303 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.019301 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:51.019301 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:15:51.020301 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:15:51.021298 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:51.021298 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:51.022298 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:15:51.022298 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:51.023299 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:51.026325 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:15:51.026325 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:51.031334 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:15:51.032300 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.032300 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:15:51.033304 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:51.033304 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.034298 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:15:51.034298 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:15:51.035335 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:51.035335 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:15:51.036317 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:51.036317 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:15:51.068297 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:15:51.069299 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:15:51.070299 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:15:51.085325 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:15:51.085325 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.086301 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:51.086301 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.087307 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.087307 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:15:51.088318 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:15:51.088318 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:15:51.089299 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.090300 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:15:51.091299 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:15:51.091299 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:15:51.092311 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:51.092311 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:15:51.093348 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:15:51.115297 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:15:51.115297 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:51.116298 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:15:51.129297 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:15:51.129297 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.130298 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:15:51.131309 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.131309 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.132301 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:15:51.132301 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:51.133298 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:51.134298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.134298 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:15:51.135298 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:15:51.135298 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:51.136299 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:51.137298 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:51.137298 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:15:51.154299 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:15:51.155298 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:51.156299 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:15:51.156299 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.172296 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:15:51.172296 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:51.173298 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.173298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.174305 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:15:51.174305 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:51.175298 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:15:51.176306 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.176306 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:15:51.177298 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:15:51.177298 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:15:51.178314 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:15:51.178314 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:15:51.179298 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:15:51.190298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:15:51.190298 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:15:51.191308 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:15:51.197296 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:15:51.197296 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.198298 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:15:51.199298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.199298 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.200299 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:15:51.200299 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:15:51.202298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.202298 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:15:51.203298 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:15:51.203298 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:15:51.204298 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:15:51.204298 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:15:51.205300 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:15:51.205300 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:15:51.206298 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:15:51.211299 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:15:51.211299 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:15:51.215297 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:15:51.216298 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.216298 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:15:51.217309 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.217309 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.218299 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:15:51.218299 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:15:51.218299 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:15:51.219299 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.219299 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:15:51.220299 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:15:51.220299 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:15:51.221298 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:15:51.221298 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:15:51.222298 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:15:51.226297 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:15:51.226297 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:15:51.227304 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:15:51.228299 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.231297 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:15:51.232298 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:15:51.233305 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.233305 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:15:51.233305 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.234299 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:15:51.234299 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:15:51.235298 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:15:51.235298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.236298 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:15:51.236298 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:15:51.236298 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:15:51.237299 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:15:51.241299 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:15:51.241299 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:15:51.242299 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:15:51.242299 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:15:51.243298 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.246298 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:15:51.247298 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:15:51.248299 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.248299 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.249299 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:15:51.249299 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:15:51.250298 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:15:51.250298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.251298 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:15:51.251298 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:15:51.252299 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:15:51.252299 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:15:51.253306 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:15:51.253306 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:15:51.257298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:15:51.258315 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:15:51.259300 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:15:51.263298 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:15:51.263298 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.264298 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:15:51.264298 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.265300 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.265300 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:15:51.266301 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:15:51.267300 [debug] [Thread-2  ]: finished collecting timing info
13:15:51.267300 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:51.268298 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:15:51.268298 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:15:51.269302 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:51.269302 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:51.313299 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:15:51.315300 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.315300 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:51.316301 [debug] [Thread-1  ]: finished collecting timing info
13:15:51.317301 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:15:51.318300 [debug] [MainThread]: Connection 'master' was properly closed.
13:15:51.319300 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:15:51.319300 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:15:51.320300 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:15:51.337302 [info ] [MainThread]: Done.
13:15:51.341297 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:15:51.342303 [info ] [MainThread]: Building catalog
13:15:51.346299 [debug] [MainThread]: Opening a new connection, currently in state init
13:15:52.082900 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:15:52.096896 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:52.097875 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:15:52.101648 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:52.102649 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:15:52.106649 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:15:58.346474 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:15:58.348474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED64D93DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED64D93250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED64D8F820>]}
13:15:59.087297 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:15:59.087297 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:15:59.088260 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-18 13:16:06.390117 | 6f108852-a8d9-4e03-baf5-50ffeec2f2f1 ==============================
13:16:06.390117 [info ] [MainThread]: Running with dbt=1.0.4
13:16:06.390117 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:16:06.391118 [debug] [MainThread]: Tracking: tracking
13:16:06.405117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6ECBCD700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6ECBE2DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6ECBE2940>]}
13:16:06.408117 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:16:06.409129 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:16:06.411120 [info ] [MainThread]: 
13:16:06.412118 [info ] [MainThread]: 
13:16:06.413122 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-18 13:22:46.382678 | 21c53c34-ce6d-4dd7-bb70-de81c50debad ==============================
13:22:46.382678 [info ] [MainThread]: Running with dbt=1.0.4
13:22:46.383687 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:22:46.384679 [debug] [MainThread]: Tracking: tracking
13:22:46.397683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B669FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B66B22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B66B2A00>]}
13:22:46.503864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:22:46.504864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:22:46.512861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c53c34-ce6d-4dd7-bb70-de81c50debad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B69690D0>]}
13:22:46.527868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c53c34-ce6d-4dd7-bb70-de81c50debad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B673D0A0>]}
13:22:46.528861 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:22:46.533877 [info ] [MainThread]: 
13:22:46.535862 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:22:46.537862 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:22:46.538877 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:22:47.399233 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:22:47.400231 [info ] [MainThread]: 
13:22:47.407207 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:22:47.408207 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:22:47.408207 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:22:47.409210 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:22:47.410209 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:22:47.410209 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:22:47.411208 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:22:47.411208 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:22:47.415211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:22:47.419233 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:22:47.420208 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.420208 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.421207 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:22:47.422207 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:22:47.422207 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:22:47.423235 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:22:47.424217 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:22:47.424217 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:22:47.425208 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:22:47.425208 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:22:47.425208 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:22:47.426208 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:22:47.429700 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:22:47.433737 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:22:47.434698 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.435698 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.435698 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:22:47.436700 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:22:47.437698 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:22:47.438699 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:22:47.438699 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:22:47.439699 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:22:47.439699 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:22:47.439699 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:22:47.440698 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:22:47.441226 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:22:47.443656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:22:47.447701 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:22:47.449666 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.450663 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.451659 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:22:47.451659 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:22:47.452656 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:22:47.453661 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:22:47.453661 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:22:47.454694 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:22:47.455657 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:22:47.455913 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:22:47.455913 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:22:47.456922 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:22:47.459959 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:22:47.462925 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:22:47.464930 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.464930 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.465929 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:22:47.466931 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:22:47.467962 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:22:47.467962 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:22:47.468924 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:22:47.469923 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:22:47.469923 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:22:47.470925 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:22:47.470925 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:22:47.471924 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:22:47.475459 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:22:47.478709 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:22:47.480712 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.481732 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:22:47.481732 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.482713 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:22:47.483711 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:22:47.483711 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:22:47.484713 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:22:47.485712 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:22:47.485712 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:22:47.486714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:22:47.486714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:22:47.489718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:22:47.490655 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:22:47.493700 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:22:47.493700 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.494682 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:22:47.496703 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:22:47.495665 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.497665 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:22:47.497665 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:22:47.498670 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:22:47.499681 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:22:47.499681 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:22:47.500664 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:22:47.531693 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:22:47.532693 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:22:47.533228 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:22:47.534237 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.549504 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:22:47.550488 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:22:47.551469 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.552481 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:22:47.552481 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.552481 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:22:47.553489 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:22:47.554468 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:22:47.554468 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.555486 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:22:47.556469 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:22:47.556469 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:22:47.557478 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:22:47.582469 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:22:47.583469 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:22:47.584469 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:22:47.585468 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:22:47.585468 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.598469 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:22:47.598469 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:22:47.599472 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.600482 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:22:47.600482 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.601489 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:22:47.601489 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:22:47.602470 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:22:47.602470 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.603469 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:22:47.604469 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:22:47.604469 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:22:47.605469 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:22:47.626468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:22:47.626468 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:22:47.627469 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:22:47.628486 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.628486 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:22:47.628486 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:22:47.650493 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:22:47.651469 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.652468 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:22:47.653471 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:22:47.653471 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.654470 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:22:47.654470 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:22:47.655469 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:22:47.655469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.656468 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:22:47.656468 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:22:47.667468 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:22:47.667468 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:22:47.669470 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:22:47.669470 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.669470 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:22:47.670469 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:22:47.670469 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:22:47.671488 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.678502 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:22:47.679502 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:22:47.680471 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:22:47.681469 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:22:47.681469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.681469 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:22:47.682469 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:22:47.682469 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:22:47.683469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.687468 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:22:47.688470 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:22:47.689486 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:22:47.690470 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.691478 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:22:47.692479 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:22:47.692479 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:22:47.693469 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.693469 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:22:47.694482 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:22:47.702471 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:22:47.703471 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:22:47.704484 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:22:47.704484 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.705470 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:22:47.706470 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:22:47.706470 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:22:47.707469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.712468 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:22:47.712468 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:22:47.713468 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:22:47.714469 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:22:47.714469 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.715468 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:22:47.715468 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:22:47.715468 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:22:47.716468 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.721471 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:22:47.722471 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:22:47.722471 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:22:47.723475 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:22:47.724471 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.724471 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:22:47.724471 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:22:47.725468 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:22:47.726469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.731486 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:22:47.732469 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:22:47.733470 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:22:47.734470 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:22:47.735478 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.735478 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:22:47.736471 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:22:47.737469 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:22:47.737469 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.742469 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:22:47.742469 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:22:47.743469 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:22:47.744469 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:22:47.745469 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.745631 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:22:47.746634 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:22:47.746634 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:22:47.747646 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.753634 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:22:47.754633 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:22:47.755644 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:22:47.756645 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:22:47.756645 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.757645 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:22:47.757645 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:22:47.758631 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:22:47.758631 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.764632 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:22:47.766633 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:22:47.767632 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:22:47.768632 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:22:47.768632 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.768632 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:22:47.769631 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:22:47.769631 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:22:47.770633 [debug] [Thread-2  ]: finished collecting timing info
13:22:47.829631 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:22:47.830631 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:22:47.832643 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.832643 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:22:47.833636 [debug] [Thread-1  ]: finished collecting timing info
13:22:47.834633 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:22:47.836632 [debug] [MainThread]: Connection 'master' was properly closed.
13:22:47.836632 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:22:47.837637 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:22:47.837637 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:22:47.857652 [info ] [MainThread]: Done.
13:22:47.861636 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:22:47.862648 [info ] [MainThread]: Building catalog
13:22:47.866632 [debug] [MainThread]: Opening a new connection, currently in state init
13:22:48.471146 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:22:48.472146 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:22:48.487181 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:22:48.489182 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:22:48.495175 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:22:48.496163 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:22:55.068587 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:22:55.070556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B66B22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B6B37B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B6B10BE0>]}
13:22:57.157884 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:22:57.157884 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:22:57.158841 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-18 13:23:36.105266 | db149e5f-6ec3-4e59-900b-caccc2f7abbc ==============================
13:23:36.105266 [info ] [MainThread]: Running with dbt=1.0.4
13:23:36.105266 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:23:36.106270 [debug] [MainThread]: Tracking: tracking
13:23:36.121288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA55F700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA572370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205DA572130>]}
13:23:36.124268 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:23:36.126265 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:23:36.127269 [info ] [MainThread]: 
13:23:36.128276 [info ] [MainThread]: 
13:23:36.129280 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-18 13:24:29.017062 | a28748dc-4a33-4080-a368-cd062687d091 ==============================
13:24:29.017062 [info ] [MainThread]: Running with dbt=1.0.4
13:24:29.018062 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:24:29.018062 [debug] [MainThread]: Tracking: tracking
13:24:29.033063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8C899D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8CA32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8CA34F0>]}
13:24:29.036062 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:24:29.037061 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:24:29.038064 [info ] [MainThread]: 
13:24:29.040082 [info ] [MainThread]: 
13:24:29.041065 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-18 13:32:46.242094 | f0db6ecd-dda2-43c9-b7b1-4669ed24786e ==============================
13:32:46.242094 [info ] [MainThread]: Running with dbt=1.0.4
13:32:46.243123 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:32:46.244092 [debug] [MainThread]: Tracking: tracking
13:32:46.258094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029538114B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029538122BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295381222E0>]}
13:32:46.366121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:32:46.367121 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:32:46.379121 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:32:46.411324 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:32:46.427322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0db6ecd-dda2-43c9-b7b1-4669ed24786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295384CA0D0>]}
13:32:46.444329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0db6ecd-dda2-43c9-b7b1-4669ed24786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295383F8E80>]}
13:32:46.444329 [info ] [MainThread]: Found 19 models, 10 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:32:46.448317 [info ] [MainThread]: 
13:32:46.449287 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:32:46.451290 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
13:32:46.452297 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:32:47.610880 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:32:47.610880 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:32:48.377124 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:32:48.378123 [info ] [MainThread]: 
13:32:48.385179 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:32:48.386121 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
13:32:48.388129 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:32:48.388129 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:32:48.389129 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:32:48.397156 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:32:48.400157 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:32:48.401121 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:32:48.405152 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:32:48.407123 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:32:48.410128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:32:48.449156 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:32:48.450156 [debug] [Thread-1  ]: finished collecting timing info
13:32:48.451126 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:32:48.481157 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:32:48.482150 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:32:48.488155 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


13:32:50.250478 [debug] [Thread-1  ]: finished collecting timing info
13:32:50.251449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0db6ecd-dda2-43c9-b7b1-4669ed24786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029538442490>]}
13:32:50.252451 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.86s]
13:32:50.254450 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:32:50.256470 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:32:50.257452 [info ] [MainThread]: 
13:32:50.258449 [info ] [MainThread]: Finished running 1 view model in 3.81s.
13:32:50.259453 [debug] [MainThread]: Connection 'master' was properly closed.
13:32:50.260450 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
13:32:50.261453 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:32:50.261453 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:32:50.282450 [info ] [MainThread]: 
13:32:50.283452 [info ] [MainThread]: [32mCompleted successfully[0m
13:32:50.284451 [info ] [MainThread]: 
13:32:50.286454 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
13:32:50.287450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002953839CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295384BB400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295384BB970>]}


============================== 2022-05-24 02:32:10.272585 | ddcba3ae-a425-46d4-a8ca-2289f89725ab ==============================
02:32:10.272585 [info ] [MainThread]: Running with dbt=1.0.4
02:32:10.273586 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:32:10.274588 [debug] [MainThread]: Tracking: tracking
02:32:10.293588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F309D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F30B2C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F30B2CD0>]}
02:32:10.358591 [info ] [MainThread]: Unable to do partial parsing because profile has changed
02:32:10.359587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddcba3ae-a425-46d4-a8ca-2289f89725ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F30B22B0>]}
02:32:11.215585 [debug] [MainThread]: Parsing macros\adapters.sql
02:32:11.241585 [debug] [MainThread]: Parsing macros\catalog.sql
02:32:11.247585 [debug] [MainThread]: Parsing macros\etc.sql
02:32:11.250586 [debug] [MainThread]: Parsing macros\materializations\copy.sql
02:32:11.253585 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
02:32:11.269585 [debug] [MainThread]: Parsing macros\materializations\seed.sql
02:32:11.272585 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
02:32:11.275586 [debug] [MainThread]: Parsing macros\materializations\table.sql
02:32:11.279585 [debug] [MainThread]: Parsing macros\materializations\view.sql
02:32:11.282585 [debug] [MainThread]: Parsing macros\adapters\columns.sql
02:32:11.300586 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
02:32:11.305586 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
02:32:11.309586 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
02:32:11.317584 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
02:32:11.322584 [debug] [MainThread]: Parsing macros\adapters\relation.sql
02:32:11.332584 [debug] [MainThread]: Parsing macros\adapters\schema.sql
02:32:11.335584 [debug] [MainThread]: Parsing macros\etc\datetime.sql
02:32:11.344585 [debug] [MainThread]: Parsing macros\etc\statement.sql
02:32:11.349584 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
02:32:11.351586 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
02:32:11.352586 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
02:32:11.354587 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
02:32:11.355587 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
02:32:11.357585 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
02:32:11.359585 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
02:32:11.361585 [debug] [MainThread]: Parsing macros\materializations\configs.sql
02:32:11.364585 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
02:32:11.369585 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
02:32:11.374623 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
02:32:11.385623 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
02:32:11.387623 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
02:32:11.400623 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
02:32:11.416622 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
02:32:11.419633 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
02:32:11.427622 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
02:32:11.431587 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
02:32:11.436588 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
02:32:11.438586 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
02:32:11.448590 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
02:32:11.470589 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
02:32:11.478585 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
02:32:11.490588 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
02:32:11.503586 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
02:32:11.506585 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
02:32:11.529586 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
02:32:11.532587 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
02:32:11.538585 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
02:32:11.540586 [debug] [MainThread]: Parsing tests\generic\builtin.sql
02:32:11.548590 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
02:32:11.550587 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
02:32:11.552586 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
02:32:11.554601 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
02:32:11.556586 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
02:32:11.561586 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
02:32:11.573586 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
02:32:11.578587 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
02:32:11.590587 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
02:32:11.593586 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
02:32:11.597588 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
02:32:11.600599 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
02:32:11.603589 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
02:32:11.606588 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
02:32:11.607587 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
02:32:11.612586 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
02:32:11.614585 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
02:32:11.628587 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
02:32:11.630588 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
02:32:11.633587 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
02:32:11.636589 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
02:32:11.639587 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
02:32:11.642598 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
02:32:11.645588 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
02:32:11.652588 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
02:32:11.657586 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
02:32:11.659587 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
02:32:11.666588 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
02:32:11.669588 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
02:32:11.672589 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
02:32:11.680588 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
02:32:11.683586 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
02:32:11.686605 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
02:32:11.689588 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
02:32:11.700586 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
02:32:11.703586 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
02:32:11.705586 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
02:32:11.708589 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
02:32:11.712586 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
02:32:11.715587 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
02:32:11.718585 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
02:32:11.720586 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
02:32:11.723586 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
02:32:11.726585 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
02:32:11.728586 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
02:32:11.729586 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
02:32:11.731586 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
02:32:11.732586 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
02:32:11.762585 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
02:32:11.767587 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
02:32:11.771587 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
02:32:11.777585 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
02:32:11.782584 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
02:32:11.786587 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
02:32:11.789585 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
02:32:11.793585 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
02:32:11.798586 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
02:32:11.806586 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
02:32:11.809588 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
02:32:11.811590 [debug] [MainThread]: Parsing macros\sql\groupby.sql
02:32:11.813589 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
02:32:11.822590 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
02:32:11.825620 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
02:32:11.827620 [debug] [MainThread]: Parsing macros\sql\pivot.sql
02:32:11.831622 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
02:32:11.833593 [debug] [MainThread]: Parsing macros\sql\star.sql
02:32:11.837620 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
02:32:11.841621 [debug] [MainThread]: Parsing macros\sql\union.sql
02:32:11.852607 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
02:32:11.860624 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
02:32:11.862621 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
02:32:11.864596 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
02:32:12.324282 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:32:12.359320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:32:12.360291 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:32:12.367317 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:32:12.369299 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
02:32:12.376321 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
02:32:12.377282 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:32:12.384282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:32:12.386317 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:32:12.393319 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:32:12.394282 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:32:12.401318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:32:12.402281 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:32:12.411318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:32:12.414298 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
02:32:12.418318 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:32:12.420316 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:32:12.423320 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
02:32:12.426317 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
02:32:12.429317 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:32:12.432280 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:32:12.435280 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:32:12.438281 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:32:12.440316 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReasons.sql
02:32:12.445307 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:32:12.448316 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
02:32:12.757316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddcba3ae-a425-46d4-a8ca-2289f89725ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F31B8E50>]}
02:32:12.774280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddcba3ae-a425-46d4-a8ca-2289f89725ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F31B8D90>]}
02:32:12.774280 [info ] [MainThread]: Found 19 models, 13 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:32:12.778279 [info ] [MainThread]: 
02:32:12.779311 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:32:12.782301 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:32:12.783281 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:32:13.883331 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:32:13.884378 [info ] [MainThread]: 
02:32:13.931235 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:32:13.931235 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:32:13.932242 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
02:32:13.932242 [info ] [Thread-2  ]: 2 of 3 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
02:32:13.934237 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:32:13.935235 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:32:13.936240 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:32:13.937244 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:32:13.938234 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:32:13.938234 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:32:13.946232 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:32:13.952233 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:32:13.954235 [debug] [Thread-2  ]: finished collecting timing info
02:32:13.954235 [debug] [Thread-1  ]: finished collecting timing info
02:32:13.955251 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:32:13.955251 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:32:13.986248 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:32:13.989235 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:32:13.992269 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:32:13.993244 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:32:13.998291 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
02:32:14.001234 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
02:32:14.862334 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [18:12]')
02:32:15.598254 [debug] [Thread-2  ]: finished collecting timing info
02:32:15.598254 [debug] [Thread-2  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: id at [18:12]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:32:15.599288 [error] [Thread-2  ]: 2 of 3 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 1.66s]
02:32:15.601255 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:32:15.602253 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:32:15.602253 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
02:32:15.604255 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:32:15.605257 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:32:15.605257 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:32:15.612288 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:32:15.613252 [debug] [Thread-2  ]: finished collecting timing info
02:32:15.614254 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:32:15.618253 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:32:15.619252 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:32:15.625254 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:32:16.917095 [debug] [Thread-1  ]: finished collecting timing info
02:32:16.919046 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.99s]
02:32:16.921060 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:32:18.826684 [debug] [Thread-2  ]: finished collecting timing info
02:32:18.827661 [error] [Thread-2  ]: 3 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [[31mFAIL 10078[0m in 3.22s]
02:32:18.828660 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:32:18.830660 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:32:18.831661 [info ] [MainThread]: 
02:32:18.832667 [info ] [MainThread]: Finished running 3 tests in 6.05s.
02:32:18.833660 [debug] [MainThread]: Connection 'master' was properly closed.
02:32:18.833660 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:32:18.834662 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
02:32:18.834662 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
02:32:18.854662 [info ] [MainThread]: 
02:32:18.855664 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
02:32:18.857662 [info ] [MainThread]: 
02:32:18.859663 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
02:32:18.860660 [error] [MainThread]:   Unrecognized name: id at [18:12]
02:32:18.862661 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:32:18.863663 [info ] [MainThread]: 
02:32:18.865661 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk (models\marts\fact_SalesOrdersDetails.yml)[0m
02:32:18.867662 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
02:32:18.868663 [info ] [MainThread]: 
02:32:18.870680 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.sql
02:32:18.871663 [info ] [MainThread]: 
02:32:18.873666 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
02:32:18.874661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3532A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3532D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3532970>]}


============================== 2022-05-24 02:33:18.933691 | cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12 ==============================
02:33:18.933691 [info ] [MainThread]: Running with dbt=1.0.4
02:33:18.934693 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:33:18.935708 [debug] [MainThread]: Tracking: tracking
02:33:18.950695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D732B2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D732B2DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D732B2880>]}
02:33:19.069722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:33:19.070694 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
02:33:19.082728 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:33:19.114694 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:33:19.178728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D735C90D0>]}
02:33:19.194697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7349DCD0>]}
02:33:19.195696 [info ] [MainThread]: Found 19 models, 13 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:33:19.198722 [info ] [MainThread]: 
02:33:19.199694 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:19.201694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:33:19.202702 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:33:19.826288 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:33:19.826288 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:33:20.390205 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:33:20.391241 [info ] [MainThread]: 
02:33:20.400209 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:33:20.401211 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:33:20.402206 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:33:20.403205 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:33:20.404205 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:33:20.404205 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:33:20.405205 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:33:20.405205 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:33:20.409240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
02:33:20.412242 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:33:20.873742 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.874763 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
02:33:20.875759 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:33:20.876758 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:33:20.876758 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:33:20.877929 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:33:20.881941 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:33:20.914345 [debug] [Thread-2  ]: finished collecting timing info
02:33:20.915352 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:33:20.915352 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.915352 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:33:20.916350 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:33:20.917351 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:33:20.917351 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:33:20.918350 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:33:20.919349 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:33:20.919349 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:33:20.920348 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:33:20.923380 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
02:33:20.924371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:33:20.927843 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
02:33:20.928824 [debug] [Thread-2  ]: finished collecting timing info
02:33:20.929808 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
02:33:20.929808 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:33:20.930808 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:33:20.930808 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.931811 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:33:20.931811 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
02:33:20.932812 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:33:20.933809 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:33:20.936843 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:33:20.937821 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:33:20.938808 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:33:20.938808 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:33:20.941844 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:33:20.941844 [debug] [Thread-2  ]: finished collecting timing info
02:33:20.942808 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:33:20.942808 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.943808 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:33:20.944812 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:33:20.944812 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:33:20.945812 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:33:20.945812 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:33:20.946811 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:33:20.946811 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:33:20.947823 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:33:20.950861 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:33:20.950861 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:33:20.954519 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:33:20.955518 [debug] [Thread-2  ]: finished collecting timing info
02:33:20.955518 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:33:20.956521 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
02:33:20.956521 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.957520 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
02:33:20.958518 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:33:20.958518 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
02:33:20.959534 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:33:20.959534 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
02:33:20.960520 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:33:20.963517 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
02:33:20.964524 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:33:20.964524 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:33:20.968519 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:33:20.969519 [debug] [Thread-2  ]: finished collecting timing info
02:33:20.970528 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
02:33:20.970528 [debug] [Thread-1  ]: finished collecting timing info
02:33:20.971518 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:33:20.972520 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:33:20.972520 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:33:20.973519 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:33:20.974521 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:33:20.974521 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
02:33:20.975537 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:33:20.976531 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:33:20.979554 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
02:33:20.980553 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:33:20.981520 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:33:20.982518 [debug] [Thread-2  ]: finished collecting timing info
02:33:21.002517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:33:21.003519 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
02:33:21.005519 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
02:33:21.006519 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
02:33:21.007518 [debug] [Thread-1  ]: finished collecting timing info
02:33:21.008525 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
02:33:21.008525 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:33:21.009529 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
02:33:21.044553 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:33:21.045556 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
02:33:21.062517 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
02:33:21.063536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:33:21.064519 [debug] [Thread-2  ]: finished collecting timing info
02:33:21.064519 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
02:33:21.070522 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
02:33:21.072518 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


02:33:21.080641 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:21.086517 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


02:33:22.232641 [debug] [Thread-1  ]: finished collecting timing info
02:33:22.232641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D736ED250>]}
02:33:22.233641 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.26s]
02:33:22.235663 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:33:22.236643 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:33:22.236643 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
02:33:22.238641 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:33:22.238641 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:33:22.239642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:33:22.266641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:33:22.268682 [debug] [Thread-2  ]: finished collecting timing info
02:33:22.269653 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D736A9370>]}
02:33:22.270642 [debug] [Thread-1  ]: finished collecting timing info
02:33:22.270642 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.26s]
02:33:22.271674 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:33:22.277642 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:33:22.278644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
02:33:22.279643 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:33:22.280650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:33:22.280650 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
02:33:22.282644 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:33:22.283645 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:33:22.283645 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:33:22.302644 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:33:22.302644 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


02:33:22.305643 [debug] [Thread-2  ]: finished collecting timing info
02:33:22.305643 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:33:22.311644 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:33:22.314653 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:22.319643 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons
    )

select * from final;


02:33:23.522767 [debug] [Thread-2  ]: finished collecting timing info
02:33:23.523770 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7375CB50>]}
02:33:23.524732 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.24s]
02:33:23.526731 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:33:23.526731 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:33:23.527729 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
02:33:23.528732 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:33:23.529733 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:33:23.530732 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:33:23.551767 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:33:23.564095 [debug] [Thread-2  ]: finished collecting timing info
02:33:23.565114 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:33:23.569106 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:33:23.571125 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:23.577104 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


02:33:23.929267 [debug] [Thread-1  ]: finished collecting timing info
02:33:23.930264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D73716100>]}
02:33:23.931264 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.69s]
02:33:23.933295 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:33:23.933295 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
02:33:23.934265 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
02:33:23.935265 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
02:33:23.936268 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
02:33:23.936268 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
02:33:23.953266 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
02:33:23.979142 [debug] [Thread-1  ]: finished collecting timing info
02:33:23.980106 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
02:33:23.983136 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
02:33:23.993860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:33:23.998896 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


02:33:24.854754 [debug] [Thread-2  ]: finished collecting timing info
02:33:24.855754 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D737291F0>]}
02:33:24.855754 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.33s]
02:33:24.857753 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:33:25.214523 [debug] [Thread-1  ]: finished collecting timing info
02:33:25.215559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D74797430>]}
02:33:25.216558 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.28s]
02:33:25.218526 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
02:33:25.219526 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:33:25.219526 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
02:33:25.221527 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:33:25.222527 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:33:25.222527 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:33:25.317115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:33:25.319083 [debug] [Thread-2  ]: finished collecting timing info
02:33:25.319083 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:33:25.322117 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:33:25.324083 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:25.328114 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


02:33:26.606482 [debug] [Thread-2  ]: finished collecting timing info
02:33:26.607481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdce0c75-0ba1-4fdc-a533-c1ce3f9dbc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D732875E0>]}
02:33:26.608484 [info ] [Thread-2  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.39s]
02:33:26.609512 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:33:26.611489 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:26.612481 [info ] [MainThread]: 
02:33:26.613522 [info ] [MainThread]: Finished running 7 view models in 7.41s.
02:33:26.614488 [debug] [MainThread]: Connection 'master' was properly closed.
02:33:26.615484 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:33:26.616486 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:33:26.616486 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
02:33:26.616486 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:33:26.639484 [info ] [MainThread]: 
02:33:26.640484 [info ] [MainThread]: [32mCompleted successfully[0m
02:33:26.642486 [info ] [MainThread]: 
02:33:26.643489 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
02:33:26.645488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7330C4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D735B09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D736D1670>]}


============================== 2022-05-24 02:33:35.599039 | 71024f0f-5934-472f-8bb8-9b63607c68ef ==============================
02:33:35.599039 [info ] [MainThread]: Running with dbt=1.0.4
02:33:35.600037 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:33:35.601025 [debug] [MainThread]: Tracking: tracking
02:33:35.614024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2F72B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2F72F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2F72550>]}
02:33:35.738024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:33:35.739038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:33:35.748024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71024f0f-5934-472f-8bb8-9b63607c68ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF32300D0>]}
02:33:35.765026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71024f0f-5934-472f-8bb8-9b63607c68ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2FC54F0>]}
02:33:35.766025 [info ] [MainThread]: Found 19 models, 13 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:33:35.769027 [info ] [MainThread]: 
02:33:35.770026 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:35.772026 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:33:35.773026 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:33:36.365360 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:33:36.366398 [info ] [MainThread]: 
02:33:36.374362 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:33:36.375377 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:33:36.375377 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
02:33:36.376359 [info ] [Thread-2  ]: 2 of 3 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
02:33:36.378364 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:33:36.379367 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:33:36.380359 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:33:36.380359 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:33:36.380359 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:33:36.381361 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:33:36.396397 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:33:36.407419 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:33:36.409361 [debug] [Thread-1  ]: finished collecting timing info
02:33:36.409361 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:33:36.410384 [debug] [Thread-2  ]: finished collecting timing info
02:33:36.434369 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
02:33:36.435361 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:33:36.438359 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:33:36.439396 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:33:36.440389 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:33:36.445362 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
02:33:36.447362 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
02:33:37.351168 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [18:12]')
02:33:38.965673 [debug] [Thread-2  ]: finished collecting timing info
02:33:38.966634 [debug] [Thread-2  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: id at [18:12]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:33:38.966634 [error] [Thread-2  ]: 2 of 3 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.59s]
02:33:38.968414 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:33:38.969429 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:33:38.969429 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
02:33:38.970465 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:33:38.971429 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:33:38.971429 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:33:38.980454 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:33:38.982430 [debug] [Thread-2  ]: finished collecting timing info
02:33:38.982430 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:33:38.985429 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
02:33:38.987427 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:38.992428 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:33:39.250682 [debug] [Thread-1  ]: finished collecting timing info
02:33:39.251646 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.87s]
02:33:39.252645 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
02:33:42.146396 [debug] [Thread-2  ]: finished collecting timing info
02:33:42.147397 [error] [Thread-2  ]: 3 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [[31mFAIL 10078[0m in 3.18s]
02:33:42.148392 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
02:33:42.150393 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:42.151391 [info ] [MainThread]: 
02:33:42.152394 [info ] [MainThread]: Finished running 3 tests in 6.38s.
02:33:42.153395 [debug] [MainThread]: Connection 'master' was properly closed.
02:33:42.154394 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:33:42.155398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
02:33:42.155398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
02:33:42.175396 [info ] [MainThread]: 
02:33:42.176393 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
02:33:42.178401 [info ] [MainThread]: 
02:33:42.180391 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
02:33:42.182392 [error] [MainThread]:   Unrecognized name: id at [18:12]
02:33:42.183392 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:33:42.185394 [info ] [MainThread]: 
02:33:42.186392 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk (models\marts\fact_SalesOrdersDetails.yml)[0m
02:33:42.188412 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
02:33:42.190410 [info ] [MainThread]: 
02:33:42.191393 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.sql
02:33:42.193398 [info ] [MainThread]: 
02:33:42.194394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
02:33:42.196392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2FD87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2FD8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF330A0A0>]}


============================== 2022-05-24 02:46:45.878814 | 0558290e-8065-4114-bec9-1984fdb42775 ==============================
02:46:45.878814 [info ] [MainThread]: Running with dbt=1.0.4
02:46:45.879816 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Addresses'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:46:45.880814 [debug] [MainThread]: Tracking: tracking
02:46:45.897815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F4F33A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F5036D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F503370>]}
02:46:46.041814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:46:46.041814 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Addresses.yml
02:46:46.055816 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
02:46:46.089815 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
02:46:46.150817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0558290e-8065-4114-bec9-1984fdb42775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F8090D0>]}
02:46:46.169816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0558290e-8065-4114-bec9-1984fdb42775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F558BE0>]}
02:46:46.170815 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:46:46.173816 [info ] [MainThread]: 
02:46:46.174816 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:46:46.177816 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:46:46.177816 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:46:47.156831 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:46:47.157820 [info ] [MainThread]: 
02:46:47.165818 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
02:46:47.165818 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
02:46:47.167833 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Addresses_address_sk............................. [RUN]
02:46:47.167833 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Addresses_address_sk............................... [RUN]
02:46:47.169816 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
02:46:47.170815 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
02:46:47.170815 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
02:46:47.171816 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
02:46:47.171816 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
02:46:47.172816 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
02:46:47.186815 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
02:46:47.193854 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
02:46:47.196817 [debug] [Thread-1  ]: finished collecting timing info
02:46:47.196817 [debug] [Thread-2  ]: finished collecting timing info
02:46:47.197820 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
02:46:47.198818 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
02:46:47.228823 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
02:46:47.234820 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
02:46:47.237821 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:46:47.237821 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:46:47.242815 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
where address_sk is null



      
    ) dbt_internal_test
02:46:47.243848 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select address_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  where address_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:46:49.264293 [debug] [Thread-1  ]: finished collecting timing info
02:46:49.265293 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Addresses_address_sk................................... [[32mPASS[0m in 2.10s]
02:46:49.266294 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
02:46:49.434330 [debug] [Thread-2  ]: finished collecting timing info
02:46:49.435294 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Addresses_address_sk..................................... [[32mPASS[0m in 2.26s]
02:46:49.437295 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
02:46:49.439310 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:46:49.440299 [info ] [MainThread]: 
02:46:49.441294 [info ] [MainThread]: Finished running 2 tests in 3.27s.
02:46:49.443295 [debug] [MainThread]: Connection 'master' was properly closed.
02:46:49.443295 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:46:49.444296 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f' was properly closed.
02:46:49.445298 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a' was properly closed.
02:46:49.463295 [info ] [MainThread]: 
02:46:49.464306 [info ] [MainThread]: [32mCompleted successfully[0m
02:46:49.466309 [info ] [MainThread]: 
02:46:49.467303 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:46:49.468296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F5039A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F4C2F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158F813820>]}


============================== 2022-05-24 02:50:26.077252 | f37ccc4e-b498-4a90-a346-50c516efe79a ==============================
02:50:26.077252 [info ] [MainThread]: Running with dbt=1.0.4
02:50:26.078261 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_AdventureWorks_SalesOrderDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:50:26.079252 [debug] [MainThread]: Tracking: tracking
02:50:26.093260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F6FF2B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F6FF2A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F6FF28E0>]}
02:50:26.261249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:50:26.262249 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:50:26.275261 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:50:26.327249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f37ccc4e-b498-4a90-a346-50c516efe79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F73380D0>]}
02:50:26.343250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f37ccc4e-b498-4a90-a346-50c516efe79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F707B970>]}
02:50:26.344252 [info ] [MainThread]: Found 19 models, 16 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:50:26.347252 [info ] [MainThread]: 
02:50:26.349250 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:50:26.351262 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:50:26.351262 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:50:26.967706 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:50:26.968948 [info ] [MainThread]: 
02:50:26.975962 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534
02:50:26.976960 [info ] [Thread-1  ]: 1 of 1 START test unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id [RUN]
02:50:26.978980 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534"
02:50:26.978980 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534
02:50:26.979977 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534
02:50:26.990995 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:50:26.994960 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:50:27.005960 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534"
02:50:27.007969 [debug] [Thread-1  ]: finished collecting timing info
02:50:27.008960 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534
02:50:27.031995 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534"
02:50:27.034961 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:50:27.039995 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:50:29.028004 [debug] [Thread-1  ]: finished collecting timing info
02:50:29.029002 [info ] [Thread-1  ]: 1 of 1 PASS unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id..... [[32mPASS[0m in 2.05s]
02:50:29.030965 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534
02:50:29.032966 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:50:29.032966 [info ] [MainThread]: 
02:50:29.034002 [info ] [MainThread]: Finished running 1 test in 2.68s.
02:50:29.035971 [debug] [MainThread]: Connection 'master' was properly closed.
02:50:29.035971 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:50:29.036970 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_stg_AdventureWorks_SalesOrderDetails_salesOrderDetail_id.ee2b10c534' was properly closed.
02:50:29.057995 [info ] [MainThread]: 
02:50:29.058965 [info ] [MainThread]: [32mCompleted successfully[0m
02:50:29.060996 [info ] [MainThread]: 
02:50:29.062967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:50:29.063999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F6FDF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F72A2A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3F74B0EB0>]}


============================== 2022-05-24 02:51:22.431065 | 63c77b6d-11f9-455a-be55-b6b81f0ad082 ==============================
02:51:22.431065 [info ] [MainThread]: Running with dbt=1.0.4
02:51:22.432071 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:51:22.433067 [debug] [MainThread]: Tracking: tracking
02:51:22.449070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A693B5DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A693B72B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A693B72370>]}
02:51:22.601076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:51:22.602066 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
02:51:22.603066 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
02:51:22.616066 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:51:22.651065 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:51:22.654067 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:51:22.732065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c77b6d-11f9-455a-be55-b6b81f0ad082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A693F330D0>]}
02:51:22.750065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c77b6d-11f9-455a-be55-b6b81f0ad082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A693D61250>]}
02:51:22.751067 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:51:22.755069 [info ] [MainThread]: 
02:51:22.757069 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:51:22.759066 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:51:22.759066 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:51:23.343019 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:51:23.344018 [info ] [MainThread]: 
02:51:23.352019 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:51:23.353019 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:51:23.353019 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
02:51:23.354025 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
02:51:23.356024 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:51:23.357024 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:51:23.357024 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:51:23.358018 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:51:23.358018 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:51:23.358018 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:51:23.366215 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:51:23.374252 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:51:23.376218 [debug] [Thread-1  ]: finished collecting timing info
02:51:23.377215 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:51:23.377215 [debug] [Thread-2  ]: finished collecting timing info
02:51:23.404217 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:51:23.405217 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:51:23.408249 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:51:23.408249 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:51:23.410213 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:51:23.414215 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
02:51:23.418226 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:51:24.303966 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [18:12]')
02:51:24.997940 [debug] [Thread-1  ]: finished collecting timing info
02:51:24.998938 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: id at [18:12]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:51:24.998938 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 1.64s]
02:51:25.000938 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:51:26.416537 [debug] [Thread-2  ]: finished collecting timing info
02:51:26.417522 [error] [Thread-2  ]: 2 of 2 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [[31mFAIL 10078[0m in 3.06s]
02:51:26.418504 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:51:26.421502 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:51:26.422503 [info ] [MainThread]: 
02:51:26.423503 [info ] [MainThread]: Finished running 2 tests in 3.67s.
02:51:26.425508 [debug] [MainThread]: Connection 'master' was properly closed.
02:51:26.425508 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:51:26.426506 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
02:51:26.426506 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
02:51:26.448509 [info ] [MainThread]: 
02:51:26.449504 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
02:51:26.451503 [info ] [MainThread]: 
02:51:26.452534 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
02:51:26.454558 [error] [MainThread]:   Unrecognized name: id at [18:12]
02:51:26.455506 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:51:26.457520 [info ] [MainThread]: 
02:51:26.458507 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrderDetail_id (models\marts\fact_SalesOrdersDetails.yml)[0m
02:51:26.460502 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
02:51:26.461505 [info ] [MainThread]: 
02:51:26.463508 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrderDetail_id.sql
02:51:26.464506 [info ] [MainThread]: 
02:51:26.466507 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
02:51:26.467505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6940DA5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6940DA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6940DAC40>]}


============================== 2022-05-24 02:58:08.315999 | 9ad3c305-2c73-4c16-ae2a-48960f56eb0a ==============================
02:58:08.315999 [info ] [MainThread]: Running with dbt=1.0.4
02:58:08.316999 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:58:08.318007 [debug] [MainThread]: Tracking: tracking
02:58:08.333003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AA9DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AAB2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AAB2D30>]}
02:58:08.518999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:58:08.520031 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
02:58:08.520031 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
02:58:08.534030 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:58:08.568030 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:58:08.570000 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:58:08.662030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad3c305-2c73-4c16-ae2a-48960f56eb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AED1F40>]}
02:58:08.679000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad3c305-2c73-4c16-ae2a-48960f56eb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AC9D850>]}
02:58:08.679000 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:58:08.682005 [info ] [MainThread]: 
02:58:08.684002 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:58:08.685002 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:58:08.686005 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:58:09.893757 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:58:09.894740 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:58:10.461087 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:58:10.462086 [info ] [MainThread]: 
02:58:10.470046 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:10.471048 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
02:58:10.472045 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:10.473054 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:10.473054 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:10.483052 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:58:10.487050 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:58:10.489046 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:58:10.492080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:58:10.493045 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:58:10.497082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:58:10.537081 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:10.537081 [debug] [Thread-1  ]: finished collecting timing info
02:58:10.538074 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:10.570047 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:10.571048 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:58:10.576046 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        ,salesorderdetailid as salesOrderDetail_id
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        -- left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        -- left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        -- left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


02:58:11.159505 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "," at [51:9]')
02:58:12.461278 [debug] [Thread-1  ]: finished collecting timing info
02:58:12.462278 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Syntax error: Unexpected "," at [51:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
02:58:12.462278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad3c305-2c73-4c16-ae2a-48960f56eb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AE26EB0>]}
02:58:12.463278 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 1.99s]
02:58:12.464280 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:12.466279 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:58:12.467316 [info ] [MainThread]: 
02:58:12.468286 [info ] [MainThread]: Finished running 1 view model in 3.78s.
02:58:12.469278 [debug] [MainThread]: Connection 'master' was properly closed.
02:58:12.470285 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:58:12.471280 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:58:12.471280 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:58:12.484277 [info ] [MainThread]: 
02:58:12.486298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:58:12.488278 [info ] [MainThread]: 
02:58:12.489282 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
02:58:12.491278 [error] [MainThread]:   Syntax error: Unexpected "," at [51:9]
02:58:12.492283 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
02:58:12.494298 [info ] [MainThread]: 
02:58:12.495331 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
02:58:12.496280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AED1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AED1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08AF3F5E0>]}


============================== 2022-05-24 02:58:56.720933 | 31dd9be6-d3fa-4fcb-b0de-638577cfb6e4 ==============================
02:58:56.720933 [info ] [MainThread]: Running with dbt=1.0.4
02:58:56.721932 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:58:56.721932 [debug] [MainThread]: Tracking: tracking
02:58:56.735944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBA43FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBA439A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBA431C0>]}
02:58:56.863984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:58:56.864956 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
02:58:56.876986 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:58:56.917948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31dd9be6-d3fa-4fcb-b0de-638577cfb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBD4BF40>]}
02:58:56.933949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31dd9be6-d3fa-4fcb-b0de-638577cfb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBC2D850>]}
02:58:56.934948 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:58:56.937951 [info ] [MainThread]: 
02:58:56.939951 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:58:56.940951 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:58:56.941951 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:58:57.563727 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:58:57.563727 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:58:58.257153 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:58:58.258153 [info ] [MainThread]: 
02:58:58.266153 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:58.267152 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
02:58:58.267955 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:58.268969 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:58.268969 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:58.293982 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:58:58.298001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:58:58.299001 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:58:58.303002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:58:58.304970 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:58:58.307977 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:58:58.345019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:58.345965 [debug] [Thread-1  ]: finished collecting timing info
02:58:58.346977 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:58:58.378001 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:58:58.379001 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:58:58.383995 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        -- left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        -- left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        -- left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


02:58:59.663352 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk; Did you mean creditCard_id? at [155:14]')
02:59:01.174512 [debug] [Thread-1  ]: finished collecting timing info
02:59:01.175514 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: creditCard_sk; Did you mean creditCard_id? at [155:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
02:59:01.175514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31dd9be6-d3fa-4fcb-b0de-638577cfb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBE2FF70>]}
02:59:01.176519 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 2.91s]
02:59:01.178870 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:01.180890 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:59:01.180890 [info ] [MainThread]: 
02:59:01.181862 [info ] [MainThread]: Finished running 1 view model in 4.24s.
02:59:01.182862 [debug] [MainThread]: Connection 'master' was properly closed.
02:59:01.183862 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:59:01.184873 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:59:01.184873 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:59:01.201419 [info ] [MainThread]: 
02:59:01.202417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:59:01.204392 [info ] [MainThread]: 
02:59:01.205393 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
02:59:01.207395 [error] [MainThread]:   Unrecognized name: creditCard_sk; Did you mean creditCard_id? at [155:14]
02:59:01.208394 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
02:59:01.210406 [info ] [MainThread]: 
02:59:01.211395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
02:59:01.212393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBA8C970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBD5AEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DBDC8850>]}


============================== 2022-05-24 02:59:28.008046 | 87fb3664-df97-4c73-8e42-56e1cb2854ab ==============================
02:59:28.008046 [info ] [MainThread]: Running with dbt=1.0.4
02:59:28.009077 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:59:28.010049 [debug] [MainThread]: Tracking: tracking
02:59:28.023803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026061DAF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026061DC2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026061DC2CD0>]}
02:59:28.151316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:59:28.152324 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
02:59:28.167320 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:59:28.201316 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:59:28.261347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87fb3664-df97-4c73-8e42-56e1cb2854ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260620CE0D0>]}
02:59:28.278318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87fb3664-df97-4c73-8e42-56e1cb2854ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026061FAD880>]}
02:59:28.278318 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:59:28.281347 [info ] [MainThread]: 
02:59:28.282318 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:59:28.284319 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:59:28.285317 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:28.937981 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:59:28.937981 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:29.522279 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:59:29.523315 [info ] [MainThread]: 
02:59:29.531283 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:29.531283 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
02:59:29.533284 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:59:29.533284 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:29.534282 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:29.542313 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:59:29.545283 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:59:29.547281 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:59:29.551281 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:59:29.553282 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:59:29.557313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:59:29.593172 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:59:29.594135 [debug] [Thread-1  ]: finished collecting timing info
02:59:29.595149 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:29.630171 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:59:29.631171 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:59:29.636134 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            -- ,product_sk
            -- ,reason_sk
            -- ,territory_sk
            -- ,customer_sk
            -- ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        -- left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        -- left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        -- left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


02:59:30.990491 [debug] [Thread-1  ]: finished collecting timing info
02:59:30.991498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb3664-df97-4c73-8e42-56e1cb2854ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260621EEE50>]}
02:59:30.992511 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.46s]
02:59:30.994489 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:59:30.996487 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:59:30.997524 [info ] [MainThread]: 
02:59:30.999492 [info ] [MainThread]: Finished running 1 view model in 2.72s.
02:59:31.000489 [debug] [MainThread]: Connection 'master' was properly closed.
02:59:31.001500 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:59:31.001500 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:59:31.002493 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:59:31.020493 [info ] [MainThread]: 
02:59:31.022493 [info ] [MainThread]: [32mCompleted successfully[0m
02:59:31.024524 [info ] [MainThread]: 
02:59:31.026491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:59:31.027491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260620CEC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260620CE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026061E5C0A0>]}


============================== 2022-05-24 02:59:38.806137 | 0eef63c9-f58b-4244-b8c8-71ff9edc7c22 ==============================
02:59:38.806137 [info ] [MainThread]: Running with dbt=1.0.4
02:59:38.807137 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:59:38.808142 [debug] [MainThread]: Tracking: tracking
02:59:38.821139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93E4E3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93E62E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93E62940>]}
02:59:38.949218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:59:38.950218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:59:38.959186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eef63c9-f58b-4244-b8c8-71ff9edc7c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC941300D0>]}
02:59:38.976214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eef63c9-f58b-4244-b8c8-71ff9edc7c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93EB74C0>]}
02:59:38.977189 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
02:59:38.980213 [info ] [MainThread]: 
02:59:38.981185 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:59:38.984216 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:59:38.985184 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:39.612978 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:59:39.614977 [info ] [MainThread]: 
02:59:39.620978 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:59:39.621995 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:59:39.621995 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
02:59:39.622976 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
02:59:39.624997 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:59:39.625981 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:59:39.625981 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:59:39.626978 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:59:39.627979 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:59:39.627979 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:59:39.645979 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:59:39.654012 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:59:39.655975 [debug] [Thread-1  ]: finished collecting timing info
02:59:39.656981 [debug] [Thread-2  ]: finished collecting timing info
02:59:39.656981 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:59:39.657983 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:59:39.688013 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
02:59:39.691018 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
02:59:39.691977 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:59:39.692977 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:59:39.697974 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:59:39.699030 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
02:59:40.599707 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk at [14:11]')
02:59:41.947761 [debug] [Thread-2  ]: finished collecting timing info
02:59:41.948762 [info ] [Thread-2  ]: 2 of 2 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 2.32s]
02:59:41.953761 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
02:59:42.144764 [debug] [Thread-1  ]: finished collecting timing info
02:59:42.145765 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: creditCard_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:59:42.146761 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.52s]
02:59:42.147762 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
02:59:42.149764 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:59:42.150763 [info ] [MainThread]: 
02:59:42.151763 [info ] [MainThread]: Finished running 2 tests in 3.17s.
02:59:42.152760 [debug] [MainThread]: Connection 'master' was properly closed.
02:59:42.153763 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:59:42.153763 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
02:59:42.154764 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
02:59:42.175762 [info ] [MainThread]: 
02:59:42.176762 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:59:42.177768 [info ] [MainThread]: 
02:59:42.179766 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
02:59:42.180766 [error] [MainThread]:   Unrecognized name: creditCard_sk at [14:11]
02:59:42.182766 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
02:59:42.183782 [info ] [MainThread]: 
02:59:42.184762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
02:59:42.186763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93EB77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC93EB73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC941BE130>]}


============================== 2022-05-24 03:00:34.732717 | 1d043140-efd0-4415-b562-25bc0a2ce1de ==============================
03:00:34.732717 [info ] [MainThread]: Running with dbt=1.0.4
03:00:34.733718 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:00:34.734715 [debug] [MainThread]: Tracking: tracking
03:00:34.749732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018475452FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018475452DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018475452940>]}
03:00:34.882715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:00:34.883715 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:00:34.897714 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:00:34.931716 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:00:35.004715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d043140-efd0-4415-b562-25bc0a2ce1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184757590D0>]}
03:00:35.021715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d043140-efd0-4415-b562-25bc0a2ce1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847563DC10>]}
03:00:35.022716 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:00:35.025715 [info ] [MainThread]: 
03:00:35.026716 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:00:35.029714 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:00:35.029714 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:00:35.631155 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:00:35.632153 [info ] [MainThread]: 
03:00:35.639160 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:00:35.640157 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:00:35.640157 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:00:35.640157 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:00:35.642155 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:00:35.644156 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:00:35.644156 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:00:35.645154 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:00:35.645154 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:00:35.645154 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:00:35.652158 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:00:35.660190 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:00:35.662156 [debug] [Thread-1  ]: finished collecting timing info
03:00:35.663153 [debug] [Thread-2  ]: finished collecting timing info
03:00:35.663153 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:00:35.663153 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:00:35.688188 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:00:35.691191 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:00:35.692168 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:00:35.693155 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:00:35.699158 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:00:35.700154 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:00:36.601034 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk at [14:11]')
03:00:37.320667 [debug] [Thread-2  ]: finished collecting timing info
03:00:37.321667 [info ] [Thread-2  ]: 2 of 2 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.68s]
03:00:37.323668 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:00:38.129985 [debug] [Thread-1  ]: finished collecting timing info
03:00:38.129985 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: creditCard_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:00:38.130986 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.49s]
03:00:38.132222 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:00:38.134236 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:00:38.135234 [info ] [MainThread]: 
03:00:38.136238 [info ] [MainThread]: Finished running 2 tests in 3.11s.
03:00:38.137236 [debug] [MainThread]: Connection 'master' was properly closed.
03:00:38.138235 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:00:38.138235 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:00:38.139238 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:00:38.157382 [info ] [MainThread]: 
03:00:38.158391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:00:38.159393 [info ] [MainThread]: 
03:00:38.160408 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:00:38.162394 [error] [MainThread]:   Unrecognized name: creditCard_sk at [14:11]
03:00:38.163393 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:00:38.165392 [info ] [MainThread]: 
03:00:38.166395 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
03:00:38.168397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847543F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018475759400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847597A340>]}


============================== 2022-05-24 03:03:47.801967 | 49e0579b-4195-45b0-a92b-d67a50ac5347 ==============================
03:03:47.801967 [info ] [MainThread]: Running with dbt=1.0.4
03:03:47.802968 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:03:47.802968 [debug] [MainThread]: Tracking: tracking
03:03:47.823968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661CD3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661CE3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661CE3D30>]}
03:03:47.972969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:03:47.973969 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:03:47.989970 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:03:48.023003 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:03:48.081847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e0579b-4195-45b0-a92b-d67a50ac5347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661FED0D0>]}
03:03:48.097842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e0579b-4195-45b0-a92b-d67a50ac5347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661ECDC10>]}
03:03:48.098814 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:03:48.100813 [info ] [MainThread]: 
03:03:48.102814 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:03:48.105814 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:03:48.106814 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:03:49.150098 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:03:49.151097 [info ] [MainThread]: 
03:03:49.159097 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:03:49.159097 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:03:49.160098 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:03:49.160098 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:03:49.161550 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:03:49.162589 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:03:49.163563 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:03:49.163563 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:03:49.164562 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:03:49.172588 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:03:49.172588 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:03:49.181561 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:03:49.181561 [debug] [Thread-1  ]: finished collecting timing info
03:03:49.182565 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:03:49.183564 [debug] [Thread-2  ]: finished collecting timing info
03:03:49.209600 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:03:49.209600 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:03:49.212501 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:03:49.213466 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:03:49.214469 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:03:49.218463 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:03:49.220478 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:03:50.094709 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk at [14:11]')
03:03:50.952591 [debug] [Thread-2  ]: finished collecting timing info
03:03:50.953593 [info ] [Thread-2  ]: 2 of 2 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.79s]
03:03:50.955558 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:03:51.217038 [debug] [Thread-1  ]: finished collecting timing info
03:03:51.218050 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: creditCard_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:03:51.218050 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.06s]
03:03:51.220331 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:03:51.221326 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:03:51.222351 [info ] [MainThread]: 
03:03:51.223323 [info ] [MainThread]: Finished running 2 tests in 3.12s.
03:03:51.225330 [debug] [MainThread]: Connection 'master' was properly closed.
03:03:51.225330 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:03:51.226329 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:03:51.227332 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:03:51.245342 [info ] [MainThread]: 
03:03:51.246326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:03:51.247327 [info ] [MainThread]: 
03:03:51.249324 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:03:51.250326 [error] [MainThread]:   Unrecognized name: creditCard_sk at [14:11]
03:03:51.252326 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:03:51.253339 [info ] [MainThread]: 
03:03:51.255323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
03:03:51.256330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661FED460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B661FED4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6621DAE50>]}


============================== 2022-05-24 03:04:12.653969 | dd5da4f2-5199-48c6-b194-9735bdb63d0e ==============================
03:04:12.653969 [info ] [MainThread]: Running with dbt=1.0.4
03:04:12.654969 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:04:12.655971 [debug] [MainThread]: Tracking: tracking
03:04:12.671970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD08F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD0A2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD0A2CD0>]}
03:04:12.829972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:04:12.830972 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:04:12.844969 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:04:12.888972 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:04:12.968005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd5da4f2-5199-48c6-b194-9735bdb63d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD3AA0D0>]}
03:04:12.989006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd5da4f2-5199-48c6-b194-9735bdb63d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD28DBE0>]}
03:04:12.989969 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:04:12.992977 [info ] [MainThread]: 
03:04:12.993968 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:12.996970 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:04:12.997971 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:13.578102 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:04:13.579097 [info ] [MainThread]: 
03:04:13.586096 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:13.586096 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:13.587099 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:04:13.587099 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:04:13.588098 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:13.589097 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:13.589097 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:13.589097 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:13.590099 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:13.596098 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:13.597101 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:13.605127 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:13.605127 [debug] [Thread-1  ]: finished collecting timing info
03:04:13.606285 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:13.606285 [debug] [Thread-2  ]: finished collecting timing info
03:04:13.629096 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:13.629096 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:13.634098 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:13.635097 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:04:13.636100 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:04:13.640095 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:04:13.641097 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:04:14.675854 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk at [14:11]')
03:04:15.283093 [debug] [Thread-2  ]: finished collecting timing info
03:04:15.284056 [info ] [Thread-2  ]: 2 of 2 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.69s]
03:04:15.285053 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:16.341220 [debug] [Thread-1  ]: finished collecting timing info
03:04:16.341220 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: creditCard_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:04:16.342220 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.75s]
03:04:16.343219 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:16.345223 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:16.346220 [info ] [MainThread]: 
03:04:16.347226 [info ] [MainThread]: Finished running 2 tests in 3.35s.
03:04:16.349221 [debug] [MainThread]: Connection 'master' was properly closed.
03:04:16.349221 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:04:16.350225 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:04:16.350225 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:04:16.368783 [info ] [MainThread]: 
03:04:16.370763 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:04:16.372760 [info ] [MainThread]: 
03:04:16.373759 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:04:16.375785 [error] [MainThread]:   Unrecognized name: creditCard_sk at [14:11]
03:04:16.376781 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:04:16.377761 [info ] [MainThread]: 
03:04:16.379765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
03:04:16.380789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD3AA3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD5B6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215BD5C0370>]}


============================== 2022-05-24 03:04:43.050982 | e0f90d08-1d36-41bd-9e54-def0307fcadd ==============================
03:04:43.050982 [info ] [MainThread]: Running with dbt=1.0.4
03:04:43.050982 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:04:43.051998 [debug] [MainThread]: Tracking: tracking
03:04:43.064984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8890CF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8890E2C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8890E2CA0>]}
03:04:43.195013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:04:43.195983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:04:43.203982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f90d08-1d36-41bd-9e54-def0307fcadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8893B20D0>]}
03:04:43.223012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f90d08-1d36-41bd-9e54-def0307fcadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8891334C0>]}
03:04:43.223982 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:04:43.227013 [info ] [MainThread]: 
03:04:43.228984 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:43.230984 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:04:43.230984 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:43.855797 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:04:44.006164 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:44.575479 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:04:44.577148 [info ] [MainThread]: 
03:04:44.584160 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:44.584160 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:04:44.586160 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:04:44.587159 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:44.587159 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:44.613205 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:04:44.617195 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:04:44.618674 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:04:44.621684 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:04:44.623700 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:04:44.628686 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:04:44.669721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:04:44.671698 [debug] [Thread-1  ]: finished collecting timing info
03:04:44.672743 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:44.702683 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:04:44.704682 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:04:44.709681 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:04:45.972894 [debug] [Thread-1  ]: finished collecting timing info
03:04:45.973895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f90d08-1d36-41bd-9e54-def0307fcadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88949CAF0>]}
03:04:45.974895 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.39s]
03:04:45.976895 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:04:45.978894 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:45.979900 [info ] [MainThread]: 
03:04:45.980897 [info ] [MainThread]: Finished running 1 view model in 2.75s.
03:04:45.981896 [debug] [MainThread]: Connection 'master' was properly closed.
03:04:45.982897 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:04:45.982897 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:04:45.983897 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:04:46.013895 [info ] [MainThread]: 
03:04:46.015896 [info ] [MainThread]: [32mCompleted successfully[0m
03:04:46.018900 [info ] [MainThread]: 
03:04:46.019899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:04:46.021896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8893A3AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88939E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A889180AC0>]}


============================== 2022-05-24 03:04:55.240764 | 65c2ddfd-4b83-4e78-92d7-b61f6740ab96 ==============================
03:04:55.240764 [info ] [MainThread]: Running with dbt=1.0.4
03:04:55.241764 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:04:55.242763 [debug] [MainThread]: Tracking: tracking
03:04:55.257762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C531D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C5332490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C5332430>]}
03:04:55.388762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:04:55.389763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:04:55.398762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65c2ddfd-4b83-4e78-92d7-b61f6740ab96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C56010D0>]}
03:04:55.419776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65c2ddfd-4b83-4e78-92d7-b61f6740ab96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C54BC520>]}
03:04:55.420763 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:04:55.424799 [info ] [MainThread]: 
03:04:55.426763 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:55.429765 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:04:55.430765 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:56.015197 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:04:56.016198 [info ] [MainThread]: 
03:04:56.023832 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:56.024865 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:56.024865 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:04:56.025830 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:04:56.027844 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:56.028830 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:56.028830 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:56.029867 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:56.029867 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:56.030830 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:56.043857 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:56.050868 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:56.052832 [debug] [Thread-1  ]: finished collecting timing info
03:04:56.053830 [debug] [Thread-2  ]: finished collecting timing info
03:04:56.053830 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:56.054844 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:56.078865 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:04:56.081829 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:04:56.083829 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:04:56.083829 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:04:56.090833 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:04:56.091832 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:04:56.955358 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [18:12]')
03:04:57.696738 [debug] [Thread-1  ]: finished collecting timing info
03:04:57.697749 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: id at [18:12]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:04:57.697749 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 1.67s]
03:04:57.699748 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:04:59.143166 [debug] [Thread-2  ]: finished collecting timing info
03:04:59.144139 [error] [Thread-2  ]: 2 of 2 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [[31mFAIL 10078[0m in 3.12s]
03:04:59.146147 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:04:59.148142 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:04:59.148142 [info ] [MainThread]: 
03:04:59.149177 [info ] [MainThread]: Finished running 2 tests in 3.72s.
03:04:59.150138 [debug] [MainThread]: Connection 'master' was properly closed.
03:04:59.151140 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:04:59.151140 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:04:59.152139 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:04:59.171137 [info ] [MainThread]: 
03:04:59.172138 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
03:04:59.174138 [info ] [MainThread]: 
03:04:59.175148 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:04:59.177138 [error] [MainThread]:   Unrecognized name: id at [18:12]
03:04:59.179141 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:04:59.180139 [info ] [MainThread]: 
03:04:59.181140 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrderDetail_id (models\marts\fact_SalesOrdersDetails.yml)[0m
03:04:59.183138 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
03:04:59.184147 [info ] [MainThread]: 
03:04:59.185142 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrderDetail_id.sql
03:04:59.187139 [info ] [MainThread]: 
03:04:59.188139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
03:04:59.190139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C530D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C53DB220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C568CFD0>]}


============================== 2022-05-24 03:06:38.221074 | 823368a0-96ce-451b-8f0b-31c8e0319c66 ==============================
03:06:38.221074 [info ] [MainThread]: Running with dbt=1.0.4
03:06:38.221074 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:06:38.222050 [debug] [MainThread]: Tracking: tracking
03:06:38.237076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C73D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C752C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C752CA0>]}
03:06:38.422717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:06:38.422717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:06:38.431272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '823368a0-96ce-451b-8f0b-31c8e0319c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487CA200D0>]}
03:06:38.448308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '823368a0-96ce-451b-8f0b-31c8e0319c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C7A44C0>]}
03:06:38.449285 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:06:38.452276 [info ] [MainThread]: 
03:06:38.453275 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:06:38.455274 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:06:38.455274 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:06:39.071279 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:06:39.072489 [info ] [MainThread]: 
03:06:39.081500 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:06:39.081500 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:06:39.082498 [info ] [Thread-1  ]: 1 of 3 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
03:06:39.083518 [info ] [Thread-2  ]: 2 of 3 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:06:39.085506 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:06:39.087502 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:06:39.087502 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:06:39.087502 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:06:39.088500 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:06:39.088500 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:06:39.105498 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:06:39.117527 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:06:39.118497 [debug] [Thread-1  ]: finished collecting timing info
03:06:39.119498 [debug] [Thread-2  ]: finished collecting timing info
03:06:39.119498 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:06:39.120498 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:06:39.148532 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:06:39.150532 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:06:39.151498 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:06:39.157532 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
03:06:39.222913 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:06:39.227961 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:06:40.146773 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [18:12]')
03:06:40.922092 [debug] [Thread-1  ]: finished collecting timing info
03:06:40.922092 [info ] [Thread-1  ]: 1 of 3 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.84s]
03:06:40.924094 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:06:40.925098 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:06:40.925098 [info ] [Thread-1  ]: 3 of 3 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
03:06:40.927095 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:06:40.927095 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:06:40.928098 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:06:40.936092 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:06:40.937103 [debug] [Thread-1  ]: finished collecting timing info
03:06:40.938092 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:06:40.941092 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:06:41.001055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:06:41.006057 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:06:41.353298 [debug] [Thread-2  ]: finished collecting timing info
03:06:41.354295 [debug] [Thread-2  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: id at [18:12]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:06:41.354295 [error] [Thread-2  ]: 2 of 3 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.27s]
03:06:41.356298 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:06:42.886193 [debug] [Thread-1  ]: finished collecting timing info
03:06:42.887192 [info ] [Thread-1  ]: 3 of 3 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 1.96s]
03:06:42.889190 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:06:42.891198 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:06:42.892190 [info ] [MainThread]: 
03:06:42.893189 [info ] [MainThread]: Finished running 3 tests in 4.44s.
03:06:42.894190 [debug] [MainThread]: Connection 'master' was properly closed.
03:06:42.895191 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:06:42.895191 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
03:06:42.896192 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:06:42.911232 [info ] [MainThread]: 
03:06:42.913190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:06:42.914213 [info ] [MainThread]: 
03:06:42.916191 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:06:42.918193 [error] [MainThread]:   Unrecognized name: id at [18:12]
03:06:42.919192 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:06:42.921190 [info ] [MainThread]: 
03:06:42.922194 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
03:06:42.924192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487CA11340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487CA11100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487CA0CEB0>]}


============================== 2022-05-24 03:08:02.859263 | f3a22442-d93f-4e5f-9750-eab1bd7810e2 ==============================
03:08:02.859263 [info ] [MainThread]: Running with dbt=1.0.4
03:08:02.860264 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:08:02.860264 [debug] [MainThread]: Tracking: tracking
03:08:02.876267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F68F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F6A2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F6A2CA0>]}
03:08:03.007266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:08:03.008267 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:08:03.021267 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:08:03.058265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:08:03.130266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a22442-d93f-4e5f-9750-eab1bd7810e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F9AB0D0>]}
03:08:03.151265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a22442-d93f-4e5f-9750-eab1bd7810e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F88DBE0>]}
03:08:03.152264 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:08:03.156266 [info ] [MainThread]: 
03:08:03.157277 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:03.159271 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:08:03.160271 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:03.758263 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:08:03.758263 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:04.344455 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:08:04.345486 [info ] [MainThread]: 
03:08:04.353460 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:04.354458 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:08:04.356459 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:04.357466 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:04.357466 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:04.367489 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:08:04.370489 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:08:04.371458 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:08:04.375481 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:08:04.377458 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:08:04.380478 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:08:04.419601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:04.420614 [debug] [Thread-1  ]: finished collecting timing info
03:08:04.421566 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:04.453600 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:08:04.455577 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:08:04.460566 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            -- ,territory_sk
            -- ,customer_sk
            -- ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        -- left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        -- left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:08:05.742851 [debug] [Thread-1  ]: finished collecting timing info
03:08:05.743854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a22442-d93f-4e5f-9750-eab1bd7810e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3FAD2E50>]}
03:08:05.745852 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.39s]
03:08:05.747864 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:08:05.750851 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:05.752851 [info ] [MainThread]: 
03:08:05.753851 [info ] [MainThread]: Finished running 1 view model in 2.60s.
03:08:05.754851 [debug] [MainThread]: Connection 'master' was properly closed.
03:08:05.755871 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:08:05.756859 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:08:05.757852 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:08:05.779852 [info ] [MainThread]: 
03:08:05.780852 [info ] [MainThread]: [32mCompleted successfully[0m
03:08:05.782867 [info ] [MainThread]: 
03:08:05.783851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:08:05.785853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F9AB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F9ABC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C3F72E4C0>]}


============================== 2022-05-24 03:08:15.377107 | b1d81d9c-d5a9-400a-9f57-6a8e07be0b21 ==============================
03:08:15.377107 [info ] [MainThread]: Running with dbt=1.0.4
03:08:15.378107 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:08:15.379109 [debug] [MainThread]: Tracking: tracking
03:08:15.393108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E373340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E373BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E373160>]}
03:08:15.526108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:08:15.526108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:08:15.535107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d81d9c-d5a9-400a-9f57-6a8e07be0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E6400D0>]}
03:08:15.552108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d81d9c-d5a9-400a-9f57-6a8e07be0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E3C54C0>]}
03:08:15.552108 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:08:15.557108 [info ] [MainThread]: 
03:08:15.558113 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:15.560109 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:08:15.561109 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:16.149944 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:08:16.151392 [info ] [MainThread]: 
03:08:16.158404 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:08:16.159426 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:08:16.159426 [info ] [Thread-1  ]: 1 of 2 START test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [RUN]
03:08:16.160433 [info ] [Thread-2  ]: 2 of 2 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:08:16.162412 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:08:16.163407 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:08:16.164421 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:08:16.164421 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:08:16.165404 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:08:16.165404 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:08:16.179403 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:08:16.187438 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:08:16.189427 [debug] [Thread-1  ]: finished collecting timing info
03:08:16.190405 [debug] [Thread-2  ]: finished collecting timing info
03:08:16.190405 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:08:16.191430 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:08:16.215402 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"
03:08:16.217439 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:08:16.219403 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:08:16.219403 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:08:16.225403 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select id as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:08:16.226403 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:08:17.371174 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditCard_sk at [14:11]')
03:08:18.315529 [debug] [Thread-2  ]: finished collecting timing info
03:08:18.316535 [info ] [Thread-2  ]: 2 of 2 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 2.15s]
03:08:18.318285 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:08:18.622278 [debug] [Thread-1  ]: finished collecting timing info
03:08:18.623236 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: creditCard_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:08:18.623236 [error] [Thread-1  ]: 1 of 2 ERROR relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ [[31mERROR[0m in 2.46s]
03:08:18.625235 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4
03:08:18.627238 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:08:18.628237 [info ] [MainThread]: 
03:08:18.629236 [info ] [MainThread]: Finished running 2 tests in 3.07s.
03:08:18.630236 [debug] [MainThread]: Connection 'master' was properly closed.
03:08:18.630236 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:08:18.631237 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_.afc9e355d4' was properly closed.
03:08:18.631237 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:08:18.666709 [info ] [MainThread]: 
03:08:18.667704 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:08:18.668709 [info ] [MainThread]: 
03:08:18.669704 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_creditCard_sk__id__ref_dim_CreditCards_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:08:18.671707 [error] [MainThread]:   Unrecognized name: creditCard_sk at [14:11]
03:08:18.672722 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_9c39621381036e7d2b2db7181f850dbc.sql
03:08:18.673705 [info ] [MainThread]: 
03:08:18.675705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
03:08:18.676704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06B460280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E6CC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E6CC7F0>]}


============================== 2022-05-24 03:11:41.228292 | 0b5a2cf6-7850-4db8-8361-59b1a4c2698e ==============================
03:11:41.228292 [info ] [MainThread]: Running with dbt=1.0.4
03:11:41.229292 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:11:41.230269 [debug] [MainThread]: Tracking: tracking
03:11:41.245301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706B3D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706B52820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706B52C40>]}
03:11:41.402259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
03:11:41.403259 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
03:11:41.404270 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
03:11:41.418258 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:11:41.451292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:11:41.453293 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
03:11:41.459294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
03:11:41.517291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5a2cf6-7850-4db8-8361-59b1a4c2698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706F200D0>]}
03:11:41.533264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5a2cf6-7850-4db8-8361-59b1a4c2698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706D3DA00>]}
03:11:41.533264 [info ] [MainThread]: Found 19 models, 14 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:11:41.537287 [info ] [MainThread]: 
03:11:41.538288 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:11:41.541256 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:11:41.541256 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:11:42.492647 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:11:42.493647 [info ] [MainThread]: 
03:11:42.500647 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:11:42.501646 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24
03:11:42.501646 [info ] [Thread-1  ]: 1 of 3 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
03:11:42.502653 [info ] [Thread-2  ]: 2 of 3 START test unique_dim_CreditCards_creditCard_id.......................... [RUN]
03:11:42.503649 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:11:42.505647 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24"
03:11:42.506646 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:11:42.506646 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24
03:11:42.507647 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:11:42.507647 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24
03:11:42.520647 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:11:42.529649 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24"
03:11:42.531646 [debug] [Thread-1  ]: finished collecting timing info
03:11:42.531646 [debug] [Thread-2  ]: finished collecting timing info
03:11:42.531646 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:11:42.532646 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24
03:11:42.557163 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:11:42.562162 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24"
03:11:42.563161 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:11:42.564175 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:11:42.570161 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:11:42.570161 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
03:11:44.236683 [debug] [Thread-1  ]: finished collecting timing info
03:11:44.237683 [info ] [Thread-1  ]: 1 of 3 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.73s]
03:11:44.239349 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:11:44.239349 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:11:44.240347 [info ] [Thread-1  ]: 3 of 3 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
03:11:44.241345 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:11:44.241345 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:11:44.242349 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:11:44.249377 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:11:44.251344 [debug] [Thread-1  ]: finished collecting timing info
03:11:44.251344 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:11:44.257380 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:11:44.258380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:11:44.264378 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:11:44.666969 [debug] [Thread-2  ]: finished collecting timing info
03:11:44.666969 [info ] [Thread-2  ]: 2 of 3 PASS unique_dim_CreditCards_creditCard_id................................ [[32mPASS[0m in 2.16s]
03:11:44.669200 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24
03:11:45.928478 [debug] [Thread-1  ]: finished collecting timing info
03:11:45.929477 [info ] [Thread-1  ]: 3 of 3 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 1.69s]
03:11:45.930787 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:11:45.932800 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:11:45.933844 [info ] [MainThread]: 
03:11:45.934803 [info ] [MainThread]: Finished running 3 tests in 4.40s.
03:11:45.935801 [debug] [MainThread]: Connection 'master' was properly closed.
03:11:45.936802 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:11:45.937856 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
03:11:45.937856 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_id.1767defa24' was properly closed.
03:11:45.953808 [info ] [MainThread]: 
03:11:45.954800 [info ] [MainThread]: [32mCompleted successfully[0m
03:11:45.957798 [info ] [MainThread]: 
03:11:45.958809 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
03:11:45.960801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706BA31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706BA30D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017706F20A90>]}


============================== 2022-05-24 03:18:11.358923 | 61f2fcfc-9451-4547-be3a-66daab62984b ==============================
03:18:11.358923 [info ] [MainThread]: Running with dbt=1.0.4
03:18:11.359924 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:18:11.359924 [debug] [MainThread]: Tracking: tracking
03:18:11.379926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72D7D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72D92C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72D92CA0>]}
03:18:11.532924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
03:18:11.533924 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
03:18:11.534924 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
03:18:11.548926 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:18:11.586924 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:18:11.588960 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
03:18:11.594923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
03:18:11.674961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61f2fcfc-9451-4547-be3a-66daab62984b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB7315E0D0>]}
03:18:11.692942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f2fcfc-9451-4547-be3a-66daab62984b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72F73E80>]}
03:18:11.692942 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:18:11.697982 [info ] [MainThread]: 
03:18:11.698924 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:18:11.700960 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:18:11.701924 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:18:12.731835 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:18:12.732835 [info ] [MainThread]: 
03:18:12.739099 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:18:12.739099 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:18:12.740101 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:18:12.740101 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:18:12.742102 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:18:12.743099 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:18:12.743099 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:18:12.743099 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:18:12.744099 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:18:12.744099 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:18:12.759122 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:18:12.767097 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:18:12.769099 [debug] [Thread-1  ]: finished collecting timing info
03:18:12.770111 [debug] [Thread-2  ]: finished collecting timing info
03:18:12.770111 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:18:12.771097 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:18:12.807098 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:18:12.813103 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:18:12.816116 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:18:12.816116 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:18:12.823099 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:18:12.824100 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:18:14.617091 [debug] [Thread-2  ]: finished collecting timing info
03:18:14.631017 [info ] [Thread-2  ]: 2 of 3 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.89s]
03:18:14.633056 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:18:14.633056 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:18:14.634056 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:18:14.635028 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:18:14.635028 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:18:14.636026 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:18:14.642027 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:18:14.643056 [debug] [Thread-2  ]: finished collecting timing info
03:18:14.644027 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:18:14.649070 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:18:14.650080 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:18:14.656027 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:18:15.059099 [debug] [Thread-1  ]: finished collecting timing info
03:18:15.059099 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.32s]
03:18:15.061351 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:18:17.006335 [debug] [Thread-2  ]: finished collecting timing info
03:18:17.007293 [info ] [Thread-2  ]: 3 of 3 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 2.37s]
03:18:17.008982 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:18:17.009993 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:18:17.010994 [info ] [MainThread]: 
03:18:17.012993 [info ] [MainThread]: Finished running 3 tests in 5.31s.
03:18:17.013997 [debug] [MainThread]: Connection 'master' was properly closed.
03:18:17.013997 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:18:17.014999 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
03:18:17.014999 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:18:17.029995 [info ] [MainThread]: 
03:18:17.031994 [info ] [MainThread]: [32mCompleted successfully[0m
03:18:17.033998 [info ] [MainThread]: 
03:18:17.034995 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
03:18:17.036994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72E2E220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB72F7D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB7315E940>]}


============================== 2022-05-24 03:18:53.899357 | d71ef339-831f-446f-8afd-08c3bc79fceb ==============================
03:18:53.899357 [info ] [MainThread]: Running with dbt=1.0.4
03:18:53.900355 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:18:53.901363 [debug] [MainThread]: Tracking: tracking
03:18:53.915388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFD1F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFD32F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFD32CA0>]}
03:18:54.068763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:18:54.068763 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:18:54.081798 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:18:54.112792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:18:54.161763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd71ef339-831f-446f-8afd-08c3bc79fceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758205B0D0>]}
03:18:54.176764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd71ef339-831f-446f-8afd-08c3bc79fceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFF14E80>]}
03:18:54.177774 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:18:54.181800 [info ] [MainThread]: 
03:18:54.183765 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:18:54.185766 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:18:54.186785 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:18:54.760127 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:18:54.761091 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:18:55.331406 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:18:55.332442 [info ] [MainThread]: 
03:18:55.340439 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:18:55.341410 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:18:55.342405 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:18:55.342405 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:18:55.343406 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:18:55.352427 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:18:55.357430 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:18:55.359430 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:18:55.363405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:18:55.364422 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:18:55.367407 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:18:55.408438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:18:55.409419 [debug] [Thread-1  ]: finished collecting timing info
03:18:55.410407 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:18:55.440438 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:18:55.441441 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:18:55.446432 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:18:56.762632 [debug] [Thread-1  ]: finished collecting timing info
03:18:56.763650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71ef339-831f-446f-8afd-08c3bc79fceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFD70130>]}
03:18:56.764632 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.42s]
03:18:56.766633 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:18:56.768636 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:18:56.769634 [info ] [MainThread]: 
03:18:56.770632 [info ] [MainThread]: Finished running 1 view model in 2.59s.
03:18:56.771633 [debug] [MainThread]: Connection 'master' was properly closed.
03:18:56.772632 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:18:56.772632 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:18:56.773654 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:18:56.792632 [info ] [MainThread]: 
03:18:56.794632 [info ] [MainThread]: [32mCompleted successfully[0m
03:18:56.796632 [info ] [MainThread]: 
03:18:56.797632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:18:56.799649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175820A0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175820A07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175FFDDAB20>]}


============================== 2022-05-24 03:19:05.952524 | 2350399d-1692-49d8-afcc-e7af2e72b3b2 ==============================
03:19:05.952524 [info ] [MainThread]: Running with dbt=1.0.4
03:19:05.953524 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:19:05.954528 [debug] [MainThread]: Tracking: tracking
03:19:05.967526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE76D3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE76E30A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE76E3C70>]}
03:19:06.111524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:19:06.112535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:19:06.121524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2350399d-1692-49d8-afcc-e7af2e72b3b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE79B00D0>]}
03:19:06.142524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2350399d-1692-49d8-afcc-e7af2e72b3b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE773D0A0>]}
03:19:06.142524 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:19:06.145524 [info ] [MainThread]: 
03:19:06.147528 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:19:06.149529 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:19:06.150528 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:19:06.767549 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:19:06.768569 [info ] [MainThread]: 
03:19:06.775549 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:19:06.775549 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:19:06.776550 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:19:06.777549 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:19:06.778551 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:19:06.779550 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:19:06.780549 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:19:06.780549 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:19:06.781549 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:19:06.782555 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:19:06.797558 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:19:06.806552 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:19:06.808568 [debug] [Thread-1  ]: finished collecting timing info
03:19:06.808568 [debug] [Thread-2  ]: finished collecting timing info
03:19:06.808568 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:19:06.809550 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:19:06.837592 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:19:06.840551 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:19:06.842549 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:19:06.842549 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:19:06.847548 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:19:06.850554 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:19:09.432862 [debug] [Thread-1  ]: finished collecting timing info
03:19:09.433829 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.66s]
03:19:09.434827 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:19:09.435832 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:19:09.435832 [info ] [Thread-1  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:19:09.436830 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:19:09.437833 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:19:09.437833 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:19:09.442856 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:19:09.443852 [debug] [Thread-1  ]: finished collecting timing info
03:19:09.444837 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:19:09.446830 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:19:09.447854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:19:09.453862 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:19:09.718679 [debug] [Thread-2  ]: finished collecting timing info
03:19:09.719681 [error] [Thread-2  ]: 2 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [[31mFAIL 10078[0m in 2.94s]
03:19:09.720681 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:19:12.532840 [debug] [Thread-1  ]: finished collecting timing info
03:19:12.533804 [error] [Thread-1  ]: 3 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [[31mFAIL 10078[0m in 3.10s]
03:19:12.534805 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:19:12.536802 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:19:12.537831 [info ] [MainThread]: 
03:19:12.538805 [info ] [MainThread]: Finished running 3 tests in 6.39s.
03:19:12.539804 [debug] [MainThread]: Connection 'master' was properly closed.
03:19:12.540806 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:19:12.541804 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:19:12.541804 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:19:12.557803 [info ] [MainThread]: 
03:19:12.558807 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
03:19:12.560805 [info ] [MainThread]: 
03:19:12.561802 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrderDetail_id (models\marts\fact_SalesOrdersDetails.yml)[0m
03:19:12.562855 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
03:19:12.563865 [info ] [MainThread]: 
03:19:12.564903 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrderDetail_id.sql
03:19:12.565865 [info ] [MainThread]: 
03:19:12.567865 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk (models\marts\fact_SalesOrdersDetails.yml)[0m
03:19:12.568901 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
03:19:12.569880 [info ] [MainThread]: 
03:19:12.571866 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.sql
03:19:12.572865 [info ] [MainThread]: 
03:19:12.574865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
03:19:12.575878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE773DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE773D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE7AB7AF0>]}


============================== 2022-05-24 03:24:44.629427 | 6be42c69-71b6-4127-bac7-9271e4bd209b ==============================
03:24:44.629427 [info ] [MainThread]: Running with dbt=1.0.4
03:24:44.630427 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:24:44.631402 [debug] [MainThread]: Tracking: tracking
03:24:44.646428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB162FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB162DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB162490>]}
03:24:44.772434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:24:44.772434 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:24:44.785435 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:24:44.818433 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:24:44.869433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be42c69-71b6-4127-bac7-9271e4bd209b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB45E0D0>]}
03:24:44.884427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be42c69-71b6-4127-bac7-9271e4bd209b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB34DCA0>]}
03:24:44.885396 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:24:44.888398 [info ] [MainThread]: 
03:24:44.889396 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:24:44.891406 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:24:44.891406 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:24:45.990736 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:24:45.991738 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:24:46.590785 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:24:46.591798 [info ] [MainThread]: 
03:24:46.598799 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:24:46.599798 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:24:46.601804 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:24:46.601804 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:24:46.602797 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:24:46.611839 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:24:46.614798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:24:46.616796 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:24:46.619799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:24:46.621803 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:24:46.624801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:24:46.666795 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:24:46.668813 [debug] [Thread-1  ]: finished collecting timing info
03:24:46.669810 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:24:46.700834 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:24:46.702799 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:24:46.707826 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:24:48.181063 [debug] [Thread-1  ]: finished collecting timing info
03:24:48.182063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be42c69-71b6-4127-bac7-9271e4bd209b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB1A0160>]}
03:24:48.183064 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.58s]
03:24:48.185229 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:24:48.186228 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:24:48.187232 [info ] [MainThread]: 
03:24:48.188267 [info ] [MainThread]: Finished running 1 view model in 3.30s.
03:24:48.189232 [debug] [MainThread]: Connection 'master' was properly closed.
03:24:48.190230 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:24:48.190230 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:24:48.191230 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:24:48.203232 [info ] [MainThread]: 
03:24:48.204252 [info ] [MainThread]: [32mCompleted successfully[0m
03:24:48.206232 [info ] [MainThread]: 
03:24:48.207230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:24:48.209248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB1F6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB1F6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB45CA90>]}


============================== 2022-05-24 03:24:56.363626 | 0a22fad5-a9e4-4fc9-8aa2-50ca85514cb8 ==============================
03:24:56.363626 [info ] [MainThread]: Running with dbt=1.0.4
03:24:56.364627 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:24:56.364627 [debug] [MainThread]: Tracking: tracking
03:24:56.377627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235329CFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235329E2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235329E2C70>]}
03:24:56.509630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:24:56.510648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:24:56.518627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a22fad5-a9e4-4fc9-8aa2-50ca85514cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023532CB30D0>]}
03:24:56.535642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a22fad5-a9e4-4fc9-8aa2-50ca85514cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023532A71A60>]}
03:24:56.535642 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:24:56.539658 [info ] [MainThread]: 
03:24:56.540628 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:24:56.543629 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:24:56.543629 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:24:57.118766 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:24:57.119905 [info ] [MainThread]: 
03:24:57.126917 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:24:57.127916 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:24:57.127916 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:24:57.128931 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:24:57.130925 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:24:57.132936 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:24:57.132936 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:24:57.133917 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:24:57.134916 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:24:57.135918 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:24:57.148951 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:24:57.156915 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:24:57.158903 [debug] [Thread-1  ]: finished collecting timing info
03:24:57.158903 [debug] [Thread-2  ]: finished collecting timing info
03:24:57.159914 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:24:57.159914 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:24:57.182948 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:24:57.186913 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:24:57.188929 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:24:57.188929 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:24:57.194947 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:24:57.194947 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:24:59.794879 [debug] [Thread-2  ]: finished collecting timing info
03:24:59.795879 [info ] [Thread-2  ]: 2 of 3 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 2.66s]
03:24:59.797892 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:24:59.798903 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:24:59.798903 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:24:59.800906 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:24:59.800906 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:24:59.801929 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:24:59.808939 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:24:59.810908 [debug] [Thread-2  ]: finished collecting timing info
03:24:59.811905 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:24:59.813933 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:24:59.814905 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:24:59.820906 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:24:59.969661 [debug] [Thread-1  ]: finished collecting timing info
03:24:59.969661 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.84s]
03:24:59.971729 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:02.496610 [debug] [Thread-2  ]: finished collecting timing info
03:25:02.497610 [info ] [Thread-2  ]: 3 of 3 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 2.70s]
03:25:02.498610 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:02.499612 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:25:02.500624 [info ] [MainThread]: 
03:25:02.501613 [info ] [MainThread]: Finished running 3 tests in 5.96s.
03:25:02.502615 [debug] [MainThread]: Connection 'master' was properly closed.
03:25:02.502615 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:25:02.503613 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
03:25:02.503613 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:25:02.518622 [info ] [MainThread]: 
03:25:02.519614 [info ] [MainThread]: [32mCompleted successfully[0m
03:25:02.521622 [info ] [MainThread]: 
03:25:02.522630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
03:25:02.523658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023532A71F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023532A717C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023532C98F10>]}


============================== 2022-05-24 03:25:41.202067 | 38eab5fc-67e9-468f-ab7c-a9d1b0b49750 ==============================
03:25:41.202067 [info ] [MainThread]: Running with dbt=1.0.4
03:25:41.203067 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:25:41.204069 [debug] [MainThread]: Tracking: tracking
03:25:41.218064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B3CE3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B3E2C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B3E2640>]}
03:25:41.356099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:25:41.357062 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:25:41.370066 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:25:41.401457 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:25:41.453489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38eab5fc-67e9-468f-ab7c-a9d1b0b49750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B6E20D0>]}
03:25:41.470461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38eab5fc-67e9-468f-ab7c-a9d1b0b49750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B5CDC70>]}
03:25:41.471458 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:25:41.475466 [info ] [MainThread]: 
03:25:41.476460 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:25:41.478460 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:25:41.479459 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:25:42.107048 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:25:42.107048 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:25:42.665706 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:25:42.666753 [info ] [MainThread]: 
03:25:42.674717 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:25:42.675715 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:25:42.676718 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:25:42.677714 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:25:42.677714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:25:42.687477 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:25:42.691483 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:25:42.693477 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:25:42.697513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:25:42.698509 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:25:42.701476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:25:42.742150 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:25:42.743132 [debug] [Thread-1  ]: finished collecting timing info
03:25:42.744109 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:25:42.774142 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:25:42.776113 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:25:42.781143 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:25:44.054776 [debug] [Thread-1  ]: finished collecting timing info
03:25:44.054776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38eab5fc-67e9-468f-ab7c-a9d1b0b49750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B420AF0>]}
03:25:44.055774 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.38s]
03:25:44.057773 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:25:44.059774 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:25:44.060775 [info ] [MainThread]: 
03:25:44.062775 [info ] [MainThread]: Finished running 1 view model in 2.58s.
03:25:44.063775 [debug] [MainThread]: Connection 'master' was properly closed.
03:25:44.064777 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:25:44.065776 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:25:44.066774 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:25:44.088773 [info ] [MainThread]: 
03:25:44.090774 [info ] [MainThread]: [32mCompleted successfully[0m
03:25:44.092772 [info ] [MainThread]: 
03:25:44.093783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:25:44.094774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B45B0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B5CD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001565B46E190>]}


============================== 2022-05-24 03:25:50.618084 | 6ababc11-8283-4332-99cf-f9b0a846bf47 ==============================
03:25:50.618084 [info ] [MainThread]: Running with dbt=1.0.4
03:25:50.619100 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:25:50.621057 [debug] [MainThread]: Tracking: tracking
03:25:50.634091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF74ED3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF7502C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF7502CD0>]}
03:25:50.761086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:25:50.762063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:25:50.771089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ababc11-8283-4332-99cf-f9b0a846bf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF77D10D0>]}
03:25:50.787056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ababc11-8283-4332-99cf-f9b0a846bf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF75ABA30>]}
03:25:50.787056 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:25:50.792086 [info ] [MainThread]: 
03:25:50.793057 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:25:50.795139 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:25:50.796055 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:25:51.386547 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:25:51.387550 [info ] [MainThread]: 
03:25:51.396564 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:51.397557 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:25:51.397557 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:25:51.398544 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:25:51.399544 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:25:51.400545 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:25:51.401545 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:51.401545 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:25:51.402544 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:51.402544 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:25:51.418581 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:25:51.426549 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:25:51.428548 [debug] [Thread-1  ]: finished collecting timing info
03:25:51.429567 [debug] [Thread-2  ]: finished collecting timing info
03:25:51.429567 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:51.430564 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:25:51.453580 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:25:51.457544 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:25:51.459555 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:25:51.460545 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:25:51.465579 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:25:51.467546 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:25:53.775441 [debug] [Thread-1  ]: finished collecting timing info
03:25:53.775441 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.38s]
03:25:53.777406 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:25:53.777406 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:53.778409 [info ] [Thread-1  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:25:53.779405 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:25:53.780405 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:53.780405 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:53.785432 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:25:53.787407 [debug] [Thread-1  ]: finished collecting timing info
03:25:53.788403 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:53.791408 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:25:53.793403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:25:53.797401 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:25:54.029927 [debug] [Thread-2  ]: finished collecting timing info
03:25:54.030891 [error] [Thread-2  ]: 2 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [[31mFAIL 10078[0m in 2.63s]
03:25:54.032891 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:25:56.473605 [debug] [Thread-1  ]: finished collecting timing info
03:25:56.474606 [error] [Thread-1  ]: 3 of 3 FAIL 10078 unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [[31mFAIL 10078[0m in 2.69s]
03:25:56.475607 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:25:56.477607 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:25:56.478639 [info ] [MainThread]: 
03:25:56.480611 [info ] [MainThread]: Finished running 3 tests in 5.69s.
03:25:56.481609 [debug] [MainThread]: Connection 'master' was properly closed.
03:25:56.482612 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:25:56.483620 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:25:56.483620 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:25:56.497606 [info ] [MainThread]: 
03:25:56.499610 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
03:25:56.501613 [info ] [MainThread]: 
03:25:56.502611 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrderDetail_id (models\marts\fact_SalesOrdersDetails.yml)[0m
03:25:56.504611 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
03:25:56.505610 [info ] [MainThread]: 
03:25:56.506610 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrderDetail_id.sql
03:25:56.507606 [info ] [MainThread]: 
03:25:56.508606 [error] [MainThread]: [31mFailure in test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk (models\marts\fact_SalesOrdersDetails.yml)[0m
03:25:56.511612 [error] [MainThread]:   Got 10078 results, configured to fail if != 0
03:25:56.512630 [info ] [MainThread]: 
03:25:56.513615 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.sql
03:25:56.515631 [info ] [MainThread]: 
03:25:56.516609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
03:25:56.518610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF78C89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF77B98E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF78D4460>]}


============================== 2022-05-24 03:28:01.345694 | 755884fb-4711-44fe-adc5-dd951803c2d1 ==============================
03:28:01.345694 [info ] [MainThread]: Running with dbt=1.0.4
03:28:01.346711 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:28:01.346711 [debug] [MainThread]: Tracking: tracking
03:28:01.361696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14CE9E940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14CEB2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14CEB23D0>]}
03:28:01.484694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:28:01.484694 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
03:28:01.497694 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
03:28:01.527695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
03:28:01.567695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '755884fb-4711-44fe-adc5-dd951803c2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D21E0D0>]}
03:28:01.582697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '755884fb-4711-44fe-adc5-dd951803c2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D08DBE0>]}
03:28:01.583708 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:28:01.586695 [info ] [MainThread]: 
03:28:01.588697 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:01.590697 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:28:01.591696 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:28:02.194260 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:28:02.195224 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:28:02.831123 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:28:02.832173 [info ] [MainThread]: 
03:28:02.840137 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:02.841138 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:28:02.842138 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:02.844141 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:02.844141 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:28:02.850161 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:28:02.853170 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
03:28:02.855140 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:28:02.860171 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:28:02.876150 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:02.877150 [debug] [Thread-1  ]: finished collecting timing info
03:28:02.878137 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:02.910174 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:02.912169 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:28:02.917190 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


03:28:04.096270 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name salesReason_id is ambiguous at [51:52]')
03:28:06.004041 [debug] [Thread-1  ]: finished collecting timing info
03:28:06.006041 [debug] [Thread-1  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Column name salesReason_id is ambiguous at [51:52]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
03:28:06.006041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755884fb-4711-44fe-adc5-dd951803c2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D2A9160>]}
03:28:06.007040 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_Reasons............... [[31mERROR[0m in 3.16s]
03:28:06.008042 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:06.011041 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:06.012042 [info ] [MainThread]: 
03:28:06.013045 [info ] [MainThread]: Finished running 1 view model in 4.42s.
03:28:06.014043 [debug] [MainThread]: Connection 'master' was properly closed.
03:28:06.015041 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:28:06.016041 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:28:06.016041 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
03:28:06.039041 [info ] [MainThread]: 
03:28:06.040041 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:28:06.042057 [info ] [MainThread]: 
03:28:06.043046 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
03:28:06.045043 [error] [MainThread]:   Column name salesReason_id is ambiguous at [51:52]
03:28:06.046040 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
03:28:06.048041 [info ] [MainThread]: 
03:28:06.049041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
03:28:06.050042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D39B640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D39BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D39B700>]}


============================== 2022-05-24 03:28:34.675384 | 4c9fcfee-1581-4923-a5cd-15fa5c35bb78 ==============================
03:28:34.675384 [info ] [MainThread]: Running with dbt=1.0.4
03:28:34.676385 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:28:34.677386 [debug] [MainThread]: Tracking: tracking
03:28:34.691393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F57E940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F5923D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F592CA0>]}
03:28:34.820415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:28:34.821414 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
03:28:34.833423 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
03:28:34.864421 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
03:28:34.906414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c9fcfee-1581-4923-a5cd-15fa5c35bb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F8E90D0>]}
03:28:34.922421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c9fcfee-1581-4923-a5cd-15fa5c35bb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F77DBB0>]}
03:28:34.922421 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:28:34.926388 [info ] [MainThread]: 
03:28:34.927388 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:34.929387 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:28:34.930393 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:28:35.527021 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:28:35.528057 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:28:36.115076 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:28:36.116080 [info ] [MainThread]: 
03:28:36.123079 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:36.124076 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:28:36.126077 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:36.126077 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:36.127076 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:28:36.137077 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:28:36.141078 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
03:28:36.143078 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:28:36.145076 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:28:36.170077 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:36.172082 [debug] [Thread-1  ]: finished collecting timing info
03:28:36.172082 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:36.215076 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:28:36.217075 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:28:36.224075 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


03:28:37.529080 [debug] [Thread-1  ]: finished collecting timing info
03:28:37.530070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c9fcfee-1581-4923-a5cd-15fa5c35bb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F93EE50>]}
03:28:37.531071 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.40s]
03:28:37.532073 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:28:37.535101 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:37.535101 [info ] [MainThread]: 
03:28:37.536072 [info ] [MainThread]: Finished running 1 view model in 2.61s.
03:28:37.538075 [debug] [MainThread]: Connection 'master' was properly closed.
03:28:37.539072 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:28:37.539072 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:28:37.540075 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
03:28:37.562102 [info ] [MainThread]: 
03:28:37.563074 [info ] [MainThread]: [32mCompleted successfully[0m
03:28:37.565076 [info ] [MainThread]: 
03:28:37.566071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:28:37.568074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FA7BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FA7B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FA7BA60>]}


============================== 2022-05-24 03:28:53.900645 | 3c6b945c-da01-422b-8da8-bfd1a685b7af ==============================
03:28:53.900645 [info ] [MainThread]: Running with dbt=1.0.4
03:28:53.901646 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:28:53.902643 [debug] [MainThread]: Tracking: tracking
03:28:53.917643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020471F4D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020471F62C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020471F62C70>]}
03:28:54.046914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:28:54.047904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:28:54.056015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c6b945c-da01-422b-8da8-bfd1a685b7af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204722310D0>]}
03:28:54.073052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c6b945c-da01-422b-8da8-bfd1a685b7af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020472006400>]}
03:28:54.074080 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:28:54.077039 [info ] [MainThread]: 
03:28:54.079018 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:54.081017 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:28:54.081017 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:28:54.673850 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:28:54.673850 [info ] [MainThread]: 
03:28:54.681871 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:28:54.682852 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:28:54.682852 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
03:28:54.683853 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
03:28:54.684854 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:28:54.686864 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:28:54.686864 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:28:54.687862 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:28:54.688866 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:28:54.688866 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:28:54.702884 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:28:54.710859 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:28:54.712855 [debug] [Thread-1  ]: finished collecting timing info
03:28:54.712855 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:28:54.713854 [debug] [Thread-2  ]: finished collecting timing info
03:28:54.739887 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:28:54.740884 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:28:54.744875 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:28:54.745852 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:28:54.746859 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:28:54.750883 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
03:28:54.754849 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:28:56.623137 [debug] [Thread-1  ]: finished collecting timing info
03:28:56.624119 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.94s]
03:28:56.626107 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:28:56.833931 [debug] [Thread-2  ]: finished collecting timing info
03:28:56.834931 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 2.15s]
03:28:56.835936 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:28:56.837937 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:28:56.838930 [info ] [MainThread]: 
03:28:56.839945 [info ] [MainThread]: Finished running 2 tests in 2.76s.
03:28:56.840936 [debug] [MainThread]: Connection 'master' was properly closed.
03:28:56.841937 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:28:56.842936 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
03:28:56.842936 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
03:28:56.864986 [info ] [MainThread]: 
03:28:56.866037 [info ] [MainThread]: [32mCompleted successfully[0m
03:28:56.868980 [info ] [MainThread]: 
03:28:56.869982 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
03:28:56.870985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045F050280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204722221C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204722CAEE0>]}


============================== 2022-05-24 03:30:12.979654 | 7898b65c-19ca-47c7-9ae1-6f2ce457d18e ==============================
03:30:12.979654 [info ] [MainThread]: Running with dbt=1.0.4
03:30:12.980655 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:30:12.981674 [debug] [MainThread]: Tracking: tracking
03:30:12.994656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E92FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E929A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C1E92190>]}
03:30:13.128658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:30:13.129658 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:30:13.141691 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:30:13.175658 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:30:13.227671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7898b65c-19ca-47c7-9ae1-6f2ce457d18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C21920D0>]}
03:30:13.243673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7898b65c-19ca-47c7-9ae1-6f2ce457d18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C2074EE0>]}
03:30:13.243673 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:30:13.247656 [info ] [MainThread]: 
03:30:13.248655 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:30:13.250658 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:30:13.251670 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:30:14.335068 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:30:14.336035 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:30:14.892976 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:30:14.894778 [info ] [MainThread]: 
03:30:14.901792 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:30:14.902828 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:30:14.904790 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:30:14.904790 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:30:14.905812 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:30:14.914830 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:30:14.917825 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:30:14.918826 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:30:14.921825 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:30:14.923580 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:30:14.926590 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:30:14.966593 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:30:14.968596 [debug] [Thread-1  ]: finished collecting timing info
03:30:14.968596 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:30:15.003624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:30:15.004591 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:30:15.010589 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:30:16.215705 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: salesReason_id at [122:14]')
03:30:17.498479 [debug] [Thread-1  ]: finished collecting timing info
03:30:17.499517 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: salesReason_id at [122:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:30:17.500476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7898b65c-19ca-47c7-9ae1-6f2ce457d18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C22E88B0>]}
03:30:17.500476 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.fact_SalesOrdersDetails... [[31mERROR[0m in 2.60s]
03:30:17.502480 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:30:17.504478 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:30:17.505478 [info ] [MainThread]: 
03:30:17.505478 [info ] [MainThread]: Finished running 1 view model in 4.26s.
03:30:17.507478 [debug] [MainThread]: Connection 'master' was properly closed.
03:30:17.507478 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:30:17.508483 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:30:17.509507 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:30:17.528482 [info ] [MainThread]: 
03:30:17.529477 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:30:17.531484 [info ] [MainThread]: 
03:30:17.533479 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
03:30:17.535495 [error] [MainThread]:   Unrecognized name: salesReason_id at [122:14]
03:30:17.536477 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
03:30:17.537477 [info ] [MainThread]: 
03:30:17.539480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
03:30:17.540480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C207D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C21DFBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C22013D0>]}


============================== 2022-05-24 03:33:00.955021 | 658a818c-d43d-4797-b603-2bc5b26503f8 ==============================
03:33:00.955021 [info ] [MainThread]: Running with dbt=1.0.4
03:33:00.956021 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:33:00.957023 [debug] [MainThread]: Tracking: tracking
03:33:00.970025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EB94B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EBA20A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EBA2C70>]}
03:33:01.100019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:33:01.101021 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:33:01.113020 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:33:01.144057 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:33:01.198021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658a818c-d43d-4797-b603-2bc5b26503f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EEAB0D0>]}
03:33:01.219027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658a818c-d43d-4797-b603-2bc5b26503f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2ED8EB20>]}
03:33:01.220022 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:33:01.223057 [info ] [MainThread]: 
03:33:01.225052 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:33:01.227024 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:33:01.228028 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:33:01.843596 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:33:01.843596 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:33:02.450924 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:33:02.451974 [info ] [MainThread]: 
03:33:02.459990 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:33:02.460962 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:33:02.462967 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:33:02.462967 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:33:02.463962 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:33:02.473971 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:33:02.477966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:33:02.478965 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:33:02.481998 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:33:02.482962 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:33:02.486974 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:33:02.528996 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:33:02.529959 [debug] [Thread-1  ]: finished collecting timing info
03:33:02.530961 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:33:02.559995 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:33:02.561990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:33:02.566989 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            -- ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        -- left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        -- left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        -- left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:33:04.127376 [debug] [Thread-1  ]: finished collecting timing info
03:33:04.128368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658a818c-d43d-4797-b603-2bc5b26503f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EBED6D0>]}
03:33:04.129371 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.67s]
03:33:04.131371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:33:04.133371 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:33:04.133371 [info ] [MainThread]: 
03:33:04.134422 [info ] [MainThread]: Finished running 1 view model in 2.91s.
03:33:04.135372 [debug] [MainThread]: Connection 'master' was properly closed.
03:33:04.136370 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:33:04.136370 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:33:04.137371 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:33:04.149370 [info ] [MainThread]: 
03:33:04.150044 [info ] [MainThread]: [32mCompleted successfully[0m
03:33:04.151056 [info ] [MainThread]: 
03:33:04.152057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:33:04.154057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EC3CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EC3C1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EC36D00>]}


============================== 2022-05-24 03:33:27.442528 | 21fea573-b8fb-4110-9d3f-3d3cd3c75ad9 ==============================
03:33:27.442528 [info ] [MainThread]: Running with dbt=1.0.4
03:33:27.443529 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:33:27.444530 [debug] [MainThread]: Tracking: tracking
03:33:27.458529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B27FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B2924F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B292C70>]}
03:33:27.584604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:33:27.585585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:33:27.595568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21fea573-b8fb-4110-9d3f-3d3cd3c75ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B5610D0>]}
03:33:27.612567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21fea573-b8fb-4110-9d3f-3d3cd3c75ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B317A60>]}
03:33:27.613567 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:33:27.616566 [info ] [MainThread]: 
03:33:27.618567 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:33:27.619568 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:33:27.620606 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:33:28.219582 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:33:28.220565 [info ] [MainThread]: 
03:33:28.227652 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:33:28.227652 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:33:28.228653 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:33:28.228653 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:33:28.230654 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:33:28.231657 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:33:28.232656 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:33:28.232656 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:33:28.233653 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:33:28.233653 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:33:28.248689 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:33:28.256696 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:33:28.258652 [debug] [Thread-1  ]: finished collecting timing info
03:33:28.259654 [debug] [Thread-2  ]: finished collecting timing info
03:33:28.259654 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:33:28.260652 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:33:28.290289 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:33:28.293326 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:33:28.294290 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:33:28.295289 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:33:28.301323 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:33:28.304340 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:33:30.963013 [debug] [Thread-2  ]: finished collecting timing info
03:33:30.964013 [info ] [Thread-2  ]: 2 of 3 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 2.73s]
03:33:30.965015 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:33:30.966035 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:33:30.966035 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:33:30.967015 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:33:30.968016 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:33:30.968016 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:33:30.974014 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:33:30.975014 [debug] [Thread-2  ]: finished collecting timing info
03:33:30.975014 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:33:30.978325 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:33:30.980324 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:33:30.985323 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:33:31.056890 [debug] [Thread-1  ]: finished collecting timing info
03:33:31.056890 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.83s]
03:33:31.058856 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:33:34.145990 [debug] [Thread-2  ]: finished collecting timing info
03:33:34.146990 [info ] [Thread-2  ]: 3 of 3 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 3.18s]
03:33:34.147992 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:33:34.149992 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:33:34.150994 [info ] [MainThread]: 
03:33:34.152996 [info ] [MainThread]: Finished running 3 tests in 6.53s.
03:33:34.154032 [debug] [MainThread]: Connection 'master' was properly closed.
03:33:34.154032 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:33:34.154993 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
03:33:34.154993 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:33:34.169025 [info ] [MainThread]: 
03:33:34.169991 [info ] [MainThread]: [32mCompleted successfully[0m
03:33:34.172005 [info ] [MainThread]: 
03:33:34.172999 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
03:33:34.173991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B519EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B552E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B65A4F0>]}


============================== 2022-05-24 03:34:05.669824 | 535ff598-f1a5-4282-8b76-089569c4cd15 ==============================
03:34:05.669824 [info ] [MainThread]: Running with dbt=1.0.4
03:34:05.670824 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:34:05.671833 [debug] [MainThread]: Tracking: tracking
03:34:05.683826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE5FE3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE6136D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE613F70>]}
03:34:05.827825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:34:05.828825 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
03:34:05.843836 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:34:05.887825 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:34:05.944859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '535ff598-f1a5-4282-8b76-089569c4cd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE9120D0>]}
03:34:05.962824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '535ff598-f1a5-4282-8b76-089569c4cd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE7FDC70>]}
03:34:05.963826 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:34:05.966825 [info ] [MainThread]: 
03:34:05.968825 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:34:05.970828 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:34:05.970828 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:34:06.551831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:34:06.551831 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:34:07.101824 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:34:07.102825 [info ] [MainThread]: 
03:34:07.112824 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:34:07.112824 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:34:07.114825 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:34:07.114825 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:34:07.115830 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:34:07.128827 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:34:07.132825 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:34:07.133829 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:34:07.136828 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:34:07.138826 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:34:07.143827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:34:07.193824 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:34:07.195824 [debug] [Thread-1  ]: finished collecting timing info
03:34:07.195824 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:34:07.229860 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:34:07.230860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:34:07.236824 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:34:08.541298 [debug] [Thread-1  ]: finished collecting timing info
03:34:08.542292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535ff598-f1a5-4282-8b76-089569c4cd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE64FEE0>]}
03:34:08.543283 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.43s]
03:34:08.544299 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:34:08.547283 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:34:08.548284 [info ] [MainThread]: 
03:34:08.549304 [info ] [MainThread]: Finished running 1 view model in 2.58s.
03:34:08.550282 [debug] [MainThread]: Connection 'master' was properly closed.
03:34:08.551283 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:34:08.552281 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:34:08.553302 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:34:08.574282 [info ] [MainThread]: 
03:34:08.575283 [info ] [MainThread]: [32mCompleted successfully[0m
03:34:08.577283 [info ] [MainThread]: 
03:34:08.578284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
03:34:08.580307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE937D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE7FD910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE6A2D60>]}


============================== 2022-05-24 03:34:17.923775 | 60f4d224-17bf-4673-a0a1-d5555cad3c29 ==============================
03:34:17.923775 [info ] [MainThread]: Running with dbt=1.0.4
03:34:17.924775 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:34:17.925743 [debug] [MainThread]: Tracking: tracking
03:34:17.941774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710D1F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710D33040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710D334C0>]}
03:34:18.069769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:34:18.070742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:34:18.079322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f4d224-17bf-4673-a0a1-d5555cad3c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267110030D0>]}
03:34:18.096379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f4d224-17bf-4673-a0a1-d5555cad3c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710DC6070>]}
03:34:18.096379 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:34:18.100384 [info ] [MainThread]: 
03:34:18.101382 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:34:18.104355 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:34:18.104355 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:34:18.694119 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:34:18.695132 [info ] [MainThread]: 
03:34:18.703117 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:34:18.703117 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:34:18.704116 [info ] [Thread-1  ]: 1 of 3 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:34:18.704116 [info ] [Thread-2  ]: 2 of 3 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:34:18.706115 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:34:18.708119 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:34:18.708119 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:34:18.709117 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:34:18.710131 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:34:18.710131 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:34:18.726119 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:34:18.734130 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:34:18.736126 [debug] [Thread-1  ]: finished collecting timing info
03:34:18.737118 [debug] [Thread-2  ]: finished collecting timing info
03:34:18.737118 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:34:18.738118 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:34:18.767118 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:34:18.771113 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:34:18.772113 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:34:18.773113 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:34:18.779112 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:34:18.779112 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:34:21.551761 [debug] [Thread-2  ]: finished collecting timing info
03:34:21.551761 [info ] [Thread-2  ]: 2 of 3 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 2.84s]
03:34:21.553721 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:34:21.553721 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:34:21.554723 [info ] [Thread-2  ]: 3 of 3 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:34:21.555725 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:34:21.556726 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:34:21.557725 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:34:21.562724 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:34:21.563739 [debug] [Thread-2  ]: finished collecting timing info
03:34:21.564722 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:34:21.568720 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:34:21.569721 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:34:21.574721 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:34:22.654600 [debug] [Thread-1  ]: finished collecting timing info
03:34:22.654600 [info ] [Thread-1  ]: 1 of 3 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 3.95s]
03:34:22.656604 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:34:24.632428 [debug] [Thread-2  ]: finished collecting timing info
03:34:24.633378 [info ] [Thread-2  ]: 3 of 3 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 3.08s]
03:34:24.635381 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:34:24.636381 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:34:24.637379 [info ] [MainThread]: 
03:34:24.638407 [info ] [MainThread]: Finished running 3 tests in 6.54s.
03:34:24.639381 [debug] [MainThread]: Connection 'master' was properly closed.
03:34:24.640382 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:34:24.641380 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4' was properly closed.
03:34:24.641380 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:34:24.657378 [info ] [MainThread]: 
03:34:24.658380 [info ] [MainThread]: [32mCompleted successfully[0m
03:34:24.660380 [info ] [MainThread]: 
03:34:24.661380 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
03:34:24.662381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710FE8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710FE8E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710DBD880>]}


============================== 2022-05-24 03:35:19.548522 | f10e0f34-3a53-4d17-9465-44b2b566629b ==============================
03:35:19.548522 [info ] [MainThread]: Running with dbt=1.0.4
03:35:19.549522 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
03:35:19.550524 [debug] [MainThread]: Tracking: tracking
03:35:19.564523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E4CE3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E4E2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E4E2CD0>]}
03:35:19.692551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:35:19.692551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:35:19.702529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E7B10D0>]}
03:35:19.721559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E58BA30>]}
03:35:19.722524 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:35:19.726523 [info ] [MainThread]: 
03:35:19.728527 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:35:19.729528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
03:35:19.730553 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:35:20.770806 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:35:20.771769 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:35:21.314395 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:35:21.315394 [info ] [MainThread]: 
03:35:21.324398 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:35:21.324398 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:35:21.325396 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:35:21.326395 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:35:21.326395 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:35:21.327395 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:35:21.327395 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:35:21.328362 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:35:21.331860 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
03:35:21.335610 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
03:35:21.336611 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.337612 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
03:35:21.337612 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.338611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:35:21.339610 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
03:35:21.340611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:35:21.341611 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:35:21.342615 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:35:21.343613 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:35:21.343613 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:35:21.344614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:35:21.347614 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
03:35:21.348618 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:35:21.351873 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
03:35:21.352877 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.353879 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
03:35:21.354884 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.355877 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:35:21.356891 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
03:35:21.357874 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:35:21.357874 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:35:21.358873 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:35:21.358873 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:35:21.359912 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:35:21.360678 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:35:21.363041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
03:35:21.364041 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:35:21.368045 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
03:35:21.368045 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.370045 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
03:35:21.371043 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:35:21.371043 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.372058 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:35:21.373080 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
03:35:21.374068 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:35:21.374068 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:35:21.375040 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:35:21.376044 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:35:21.379041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
03:35:21.380041 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:35:21.380041 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:35:21.384042 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
03:35:21.385044 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.386042 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
03:35:21.387058 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.388060 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:35:21.389041 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
03:35:21.389041 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:35:21.390055 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:35:21.390055 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:35:21.391043 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
03:35:21.391043 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:35:21.392041 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:35:21.395041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
03:35:21.396041 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:35:21.399078 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
03:35:21.400058 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.401041 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
03:35:21.401041 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.402043 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:35:21.403043 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
03:35:21.404045 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:35:21.404045 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:35:21.405042 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:35:21.406046 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:35:21.406046 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:35:21.407042 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:35:21.410078 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
03:35:21.410078 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:35:21.414076 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
03:35:21.414076 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.415042 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
03:35:21.416045 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.416045 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:35:21.417049 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
03:35:21.418042 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
03:35:21.419058 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
03:35:21.420042 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:35:21.421043 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
03:35:21.422043 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
03:35:21.423042 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
03:35:21.423042 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
03:35:21.424041 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
03:35:21.461041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:35:21.461041 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
03:35:21.481078 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:35:21.482076 [debug] [Thread-1  ]: finished collecting timing info
03:35:21.483041 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
03:35:21.484041 [debug] [Thread-2  ]: finished collecting timing info
03:35:21.518049 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
03:35:21.519046 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
03:35:21.522077 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
03:35:21.523045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:21.524041 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:21.529076 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


03:35:21.530076 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


03:35:22.704983 [debug] [Thread-1  ]: finished collecting timing info
03:35:22.705983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E842F40>]}
03:35:22.706984 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.29s]
03:35:22.708983 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
03:35:22.708983 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
03:35:22.709994 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
03:35:22.710982 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
03:35:22.711983 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
03:35:22.711983 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
03:35:22.744019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:35:22.746983 [debug] [Thread-2  ]: finished collecting timing info
03:35:22.747985 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E8BDFD0>]}
03:35:22.747985 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.33s]
03:35:22.748984 [debug] [Thread-1  ]: finished collecting timing info
03:35:22.749987 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
03:35:22.752984 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
03:35:22.760021 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
03:35:22.760021 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
03:35:22.761003 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
03:35:22.761983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:22.762983 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
03:35:22.764007 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
03:35:22.764007 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
03:35:22.782986 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:35:22.784004 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products
    )

select * from final;


03:35:22.784004 [debug] [Thread-2  ]: finished collecting timing info
03:35:22.786984 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
03:35:22.790983 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
03:35:22.793983 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:22.800019 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


03:35:23.942022 [debug] [Thread-1  ]: finished collecting timing info
03:35:23.942022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E919D90>]}
03:35:23.943022 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.23s]
03:35:23.945022 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
03:35:23.945022 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:35:23.946023 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
03:35:23.947063 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:35:23.947063 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:35:23.948025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:35:23.969027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:35:23.973060 [debug] [Thread-2  ]: finished collecting timing info
03:35:23.974024 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E8C4760>]}
03:35:23.974024 [debug] [Thread-1  ]: finished collecting timing info
03:35:23.975041 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.21s]
03:35:23.975041 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:35:23.980022 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
03:35:23.980022 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
03:35:23.981022 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
03:35:23.981022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:23.982022 [info ] [Thread-2  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
03:35:23.985025 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
03:35:23.985025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
03:35:23.986022 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
03:35:24.009063 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:35:24.010059 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


03:35:24.011683 [debug] [Thread-2  ]: finished collecting timing info
03:35:24.015683 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
03:35:24.019684 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
03:35:24.022234 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:24.027286 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


03:35:25.128482 [debug] [Thread-1  ]: finished collecting timing info
03:35:25.129746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17F951FA0>]}
03:35:25.130759 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.18s]
03:35:25.131460 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
03:35:25.168783 [debug] [Thread-2  ]: finished collecting timing info
03:35:25.169745 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E8AF5B0>]}
03:35:25.169745 [info ] [Thread-2  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.19s]
03:35:25.171745 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
03:35:25.172744 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:35:25.173745 [info ] [Thread-1  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
03:35:25.174864 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:35:25.175879 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:35:25.175879 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:35:25.217874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:35:25.219887 [debug] [Thread-1  ]: finished collecting timing info
03:35:25.219887 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:35:25.223929 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
03:35:25.225873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:25.230910 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


03:35:26.579942 [debug] [Thread-1  ]: finished collecting timing info
03:35:26.579942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10e0f34-3a53-4d17-9465-44b2b566629b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17F979B50>]}
03:35:26.580906 [info ] [Thread-1  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.41s]
03:35:26.582907 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
03:35:26.584906 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:35:26.585906 [info ] [MainThread]: 
03:35:26.586914 [info ] [MainThread]: Finished running 7 view models in 6.86s.
03:35:26.588909 [debug] [MainThread]: Connection 'master' was properly closed.
03:35:26.588909 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
03:35:26.589921 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:35:26.589921 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
03:35:26.590905 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
03:35:26.612907 [info ] [MainThread]: 
03:35:26.614906 [info ] [MainThread]: [32mCompleted successfully[0m
03:35:26.615923 [info ] [MainThread]: 
03:35:26.617909 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
03:35:26.618908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E76EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E58B4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17E8C0280>]}


============================== 2022-05-24 03:35:38.400544 | 067476e2-a29a-41d4-af7a-e4c79d9f96ea ==============================
03:35:38.400544 [info ] [MainThread]: Running with dbt=1.0.4
03:35:38.401542 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:35:38.402544 [debug] [MainThread]: Tracking: tracking
03:35:38.416543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136399C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213639B1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213639B1CA0>]}
03:35:38.554541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:35:38.554541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:35:38.565542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067476e2-a29a-41d4-af7a-e4c79d9f96ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363C800D0>]}
03:35:38.584542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067476e2-a29a-41d4-af7a-e4c79d9f96ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363A5CA30>]}
03:35:38.585544 [info ] [MainThread]: Found 19 models, 15 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:35:38.590545 [info ] [MainThread]: 
03:35:38.591543 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:35:38.593543 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:35:38.594561 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:35:39.160317 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:35:39.161331 [info ] [MainThread]: 
03:35:39.169330 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
03:35:39.169330 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:35:39.170331 [info ] [Thread-1  ]: 1 of 15 START test not_null_dim_Addresses_address_sk............................ [RUN]
03:35:39.170331 [info ] [Thread-2  ]: 2 of 15 START test not_null_dim_CreditCards_creditCard_sk....................... [RUN]
03:35:39.172330 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
03:35:39.173337 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:35:39.174336 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
03:35:39.174336 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:35:39.175330 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
03:35:39.175330 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:35:39.190333 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
03:35:39.194332 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:35:39.196135 [debug] [Thread-1  ]: finished collecting timing info
03:35:39.196135 [debug] [Thread-2  ]: finished collecting timing info
03:35:39.196135 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
03:35:39.197147 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:35:39.222179 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
03:35:39.225147 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
03:35:39.226146 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:35:39.227161 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:35:39.233141 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
03:35:39.235145 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
where address_sk is null



      
    ) dbt_internal_test
03:35:40.902354 [debug] [Thread-2  ]: finished collecting timing info
03:35:40.903355 [info ] [Thread-2  ]: 2 of 15 PASS not_null_dim_CreditCards_creditCard_sk............................. [[32mPASS[0m in 1.73s]
03:35:40.904351 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
03:35:40.905356 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
03:35:40.905356 [info ] [Thread-2  ]: 3 of 15 START test not_null_dim_Customers_customer_sk........................... [RUN]
03:35:40.906350 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
03:35:40.906350 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
03:35:40.907357 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
03:35:40.912353 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
03:35:40.913358 [debug] [Thread-2  ]: finished collecting timing info
03:35:40.914354 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
03:35:40.918354 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
03:35:40.919388 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:40.924352 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
where customer_sk is null



      
    ) dbt_internal_test
03:35:41.114123 [debug] [Thread-1  ]: finished collecting timing info
03:35:41.115122 [info ] [Thread-1  ]: 1 of 15 PASS not_null_dim_Addresses_address_sk.................................. [[32mPASS[0m in 1.94s]
03:35:41.117126 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
03:35:41.117126 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
03:35:41.118127 [info ] [Thread-1  ]: 4 of 15 START test not_null_dim_Products_product_sk............................. [RUN]
03:35:41.119123 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
03:35:41.119123 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
03:35:41.120127 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
03:35:41.126129 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
03:35:41.130125 [debug] [Thread-1  ]: finished collecting timing info
03:35:41.131124 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
03:35:41.134157 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
03:35:41.136130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:41.141120 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
03:35:42.593623 [debug] [Thread-2  ]: finished collecting timing info
03:35:42.594624 [info ] [Thread-2  ]: 3 of 15 PASS not_null_dim_Customers_customer_sk................................. [[32mPASS[0m in 1.69s]
03:35:42.595628 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
03:35:42.596625 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:35:42.596625 [info ] [Thread-2  ]: 5 of 15 START test not_null_dim_Reasons_reason_sk............................... [RUN]
03:35:42.598626 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:35:42.599627 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:35:42.599627 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:35:42.605627 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:35:42.606659 [debug] [Thread-2  ]: finished collecting timing info
03:35:42.607627 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:35:42.609659 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
03:35:42.611233 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:42.615242 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
03:35:42.780435 [debug] [Thread-1  ]: finished collecting timing info
03:35:42.781400 [info ] [Thread-1  ]: 4 of 15 PASS not_null_dim_Products_product_sk................................... [[32mPASS[0m in 1.66s]
03:35:42.782400 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
03:35:42.783402 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
03:35:42.784403 [info ] [Thread-1  ]: 6 of 15 START test not_null_dim_SalesTerritories_territory_sk................... [RUN]
03:35:42.785401 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
03:35:42.785401 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
03:35:42.786429 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
03:35:42.791435 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
03:35:42.792426 [debug] [Thread-1  ]: finished collecting timing info
03:35:42.792426 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
03:35:42.795432 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
03:35:42.796400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:42.802402 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
03:35:44.466155 [debug] [Thread-1  ]: finished collecting timing info
03:35:44.467119 [info ] [Thread-1  ]: 6 of 15 PASS not_null_dim_SalesTerritories_territory_sk......................... [[32mPASS[0m in 1.68s]
03:35:44.468118 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
03:35:44.469120 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:35:44.469120 [info ] [Thread-1  ]: 7 of 15 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk........ [RUN]
03:35:44.471155 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:35:44.471155 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:35:44.472119 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:35:44.483115 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:35:44.484117 [debug] [Thread-1  ]: finished collecting timing info
03:35:44.485132 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:35:44.489116 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:35:44.490117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:44.496121 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:35:44.572688 [debug] [Thread-2  ]: finished collecting timing info
03:35:44.573653 [info ] [Thread-2  ]: 5 of 15 PASS not_null_dim_Reasons_reason_sk..................................... [[32mPASS[0m in 1.98s]
03:35:44.574652 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
03:35:44.575651 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
03:35:44.575651 [info ] [Thread-2  ]: 8 of 15 START test unique_dim_Addresses_address_sk.............................. [RUN]
03:35:44.577653 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
03:35:44.577653 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
03:35:44.578677 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
03:35:44.585655 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
03:35:44.587657 [debug] [Thread-2  ]: finished collecting timing info
03:35:44.588652 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
03:35:44.590652 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
03:35:44.592651 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:44.597653 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select address_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  where address_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:46.561257 [debug] [Thread-2  ]: finished collecting timing info
03:35:46.562256 [info ] [Thread-2  ]: 8 of 15 PASS unique_dim_Addresses_address_sk.................................... [[32mPASS[0m in 1.99s]
03:35:46.563906 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
03:35:46.563906 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:35:46.564907 [info ] [Thread-2  ]: 9 of 15 START test unique_dim_CreditCards_creditCard_sk......................... [RUN]
03:35:46.565906 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:35:46.565906 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:35:46.566906 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:35:46.571931 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:35:46.572947 [debug] [Thread-2  ]: finished collecting timing info
03:35:46.573901 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:35:46.576910 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
03:35:46.578905 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:46.584905 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:47.264809 [debug] [Thread-1  ]: finished collecting timing info
03:35:47.265808 [info ] [Thread-1  ]: 7 of 15 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.............. [[32mPASS[0m in 2.80s]
03:35:47.266810 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:35:47.267812 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
03:35:47.267812 [info ] [Thread-1  ]: 10 of 15 START test unique_dim_Customers_customer_sk............................ [RUN]
03:35:47.269812 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
03:35:47.270828 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
03:35:47.270828 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
03:35:47.275844 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
03:35:47.294817 [debug] [Thread-1  ]: finished collecting timing info
03:35:47.295825 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
03:35:47.305856 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
03:35:47.306854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:47.312827 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  where customer_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:48.352092 [debug] [Thread-2  ]: finished collecting timing info
03:35:48.353128 [info ] [Thread-2  ]: 9 of 15 PASS unique_dim_CreditCards_creditCard_sk............................... [[32mPASS[0m in 1.79s]
03:35:48.355091 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
03:35:48.356091 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
03:35:48.356091 [info ] [Thread-2  ]: 11 of 15 START test unique_dim_Products_product_sk.............................. [RUN]
03:35:48.358091 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
03:35:48.358091 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
03:35:48.359095 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
03:35:48.366110 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
03:35:48.379475 [debug] [Thread-2  ]: finished collecting timing info
03:35:48.380476 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
03:35:48.382511 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
03:35:48.383510 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:48.389509 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:49.266825 [debug] [Thread-1  ]: finished collecting timing info
03:35:49.267826 [info ] [Thread-1  ]: 10 of 15 PASS unique_dim_Customers_customer_sk.................................. [[32mPASS[0m in 2.00s]
03:35:49.268715 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
03:35:49.269728 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:35:49.269728 [info ] [Thread-1  ]: 12 of 15 START test unique_dim_Reasons_reason_sk................................ [RUN]
03:35:49.271730 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:35:49.271730 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:35:49.272731 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:35:49.277727 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:35:49.278728 [debug] [Thread-1  ]: finished collecting timing info
03:35:49.279733 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:35:49.281767 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
03:35:49.283744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:49.288765 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:50.482501 [debug] [Thread-2  ]: finished collecting timing info
03:35:50.483460 [info ] [Thread-2  ]: 11 of 15 PASS unique_dim_Products_product_sk.................................... [[32mPASS[0m in 2.13s]
03:35:50.485463 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
03:35:50.485463 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
03:35:50.486552 [info ] [Thread-2  ]: 13 of 15 START test unique_dim_SalesTerritories_territory_sk.................... [RUN]
03:35:50.487460 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
03:35:50.487460 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
03:35:50.488500 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
03:35:50.493488 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
03:35:50.494462 [debug] [Thread-2  ]: finished collecting timing info
03:35:50.495460 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
03:35:50.498460 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
03:35:50.499463 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:50.504460 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:51.253325 [debug] [Thread-1  ]: finished collecting timing info
03:35:51.254325 [info ] [Thread-1  ]: 12 of 15 PASS unique_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.98s]
03:35:51.255330 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
03:35:51.256329 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:35:51.257862 [info ] [Thread-1  ]: 14 of 15 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id.......... [RUN]
03:35:51.258860 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:35:51.259856 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:35:51.260857 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:35:51.274854 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:35:51.275854 [debug] [Thread-1  ]: finished collecting timing info
03:35:51.276853 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:35:51.284852 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:35:51.285855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:35:51.290852 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:52.233383 [debug] [Thread-2  ]: finished collecting timing info
03:35:52.234381 [info ] [Thread-2  ]: 13 of 15 PASS unique_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.75s]
03:35:52.235385 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
03:35:52.236383 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:35:52.237384 [info ] [Thread-2  ]: 15 of 15 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:35:52.238413 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:35:52.238413 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:35:52.239383 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:35:52.244392 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:35:52.245383 [debug] [Thread-2  ]: finished collecting timing info
03:35:52.246382 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:35:52.249413 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:35:52.251388 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:35:52.256417 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:35:53.881685 [debug] [Thread-1  ]: finished collecting timing info
03:35:53.882684 [info ] [Thread-1  ]: 14 of 15 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id................ [[32mPASS[0m in 2.62s]
03:35:53.884987 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:35:55.253558 [debug] [Thread-2  ]: finished collecting timing info
03:35:55.254557 [info ] [Thread-2  ]: 15 of 15 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 3.02s]
03:35:55.256558 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:35:55.258556 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:35:55.259556 [info ] [MainThread]: 
03:35:55.261555 [info ] [MainThread]: Finished running 15 tests in 16.67s.
03:35:55.262557 [debug] [MainThread]: Connection 'master' was properly closed.
03:35:55.263567 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:35:55.264557 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:35:55.264557 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:35:55.292612 [info ] [MainThread]: 
03:35:55.293596 [info ] [MainThread]: [32mCompleted successfully[0m
03:35:55.296597 [info ] [MainThread]: 
03:35:55.297597 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
03:35:55.299601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363CE6C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363CE62B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363CE6640>]}


============================== 2022-05-24 03:36:46.197592 | e3ef6bd8-8918-4796-877d-e554e32b324e ==============================
03:36:46.197592 [info ] [MainThread]: Running with dbt=1.0.4
03:36:46.198592 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:36:46.198592 [debug] [MainThread]: Tracking: tracking
03:36:46.212591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D72E940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D7424C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D742CA0>]}
03:36:46.335627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:36:46.336627 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
03:36:46.348628 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:36:46.380621 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:36:46.445589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3ef6bd8-8918-4796-877d-e554e32b324e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69DB2A0D0>]}
03:36:46.462592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3ef6bd8-8918-4796-877d-e554e32b324e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D92DB50>]}
03:36:46.462592 [info ] [MainThread]: Found 19 models, 16 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:36:46.466591 [info ] [MainThread]: 
03:36:46.467591 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:36:46.469594 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:36:46.470591 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:36:47.054108 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:36:47.055108 [info ] [MainThread]: 
03:36:47.062109 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:36:47.063146 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:36:47.063146 [info ] [Thread-1  ]: 1 of 4 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:36:47.064109 [info ] [Thread-2  ]: 2 of 4 START test relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [RUN]
03:36:47.065113 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:36:47.067113 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:36:47.067113 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:36:47.068107 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:36:47.069108 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:36:47.069108 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:36:47.077106 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:36:47.084156 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:36:47.086106 [debug] [Thread-1  ]: finished collecting timing info
03:36:47.086106 [debug] [Thread-2  ]: finished collecting timing info
03:36:47.087106 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:36:47.088107 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:36:47.117845 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:36:47.119874 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:36:47.121838 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:36:47.122841 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:36:47.127837 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:36:47.127837 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:36:48.928028 [debug] [Thread-1  ]: finished collecting timing info
03:36:48.928028 [info ] [Thread-1  ]: 1 of 4 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 1.86s]
03:36:48.930188 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:36:48.930188 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:36:48.931200 [info ] [Thread-1  ]: 3 of 4 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:36:48.932200 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:36:48.932200 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:36:48.932200 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:36:48.941221 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:36:48.942219 [debug] [Thread-1  ]: finished collecting timing info
03:36:48.942219 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:36:48.945219 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:36:48.947197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:36:48.953223 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:36:50.111470 [debug] [Thread-2  ]: finished collecting timing info
03:36:50.112434 [info ] [Thread-2  ]: 2 of 4 PASS relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [[32mPASS[0m in 3.05s]
03:36:50.113433 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:36:50.114435 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:36:50.114435 [info ] [Thread-2  ]: 4 of 4 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:36:50.116436 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:36:50.116436 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:36:50.117434 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:36:50.123458 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:36:50.124458 [debug] [Thread-2  ]: finished collecting timing info
03:36:50.125432 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:36:50.128461 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:36:50.129458 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:36:50.135432 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:36:50.556876 [debug] [Thread-1  ]: finished collecting timing info
03:36:50.557833 [info ] [Thread-1  ]: 3 of 4 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.63s]
03:36:50.559227 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:36:51.814446 [debug] [Thread-2  ]: finished collecting timing info
03:36:51.815443 [info ] [Thread-2  ]: 4 of 4 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 1.70s]
03:36:51.817411 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:36:51.819408 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:36:51.819408 [info ] [MainThread]: 
03:36:51.820447 [info ] [MainThread]: Finished running 4 tests in 5.35s.
03:36:51.821406 [debug] [MainThread]: Connection 'master' was properly closed.
03:36:51.822407 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:36:51.823407 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:36:51.823407 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:36:51.845432 [info ] [MainThread]: 
03:36:51.846477 [info ] [MainThread]: [32mCompleted successfully[0m
03:36:51.848409 [info ] [MainThread]: 
03:36:51.849407 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
03:36:51.850405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D742430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69D92D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B69DB63130>]}


============================== 2022-05-24 03:38:39.649070 | bbea592e-f7e9-462a-8d59-2e84e9df10c8 ==============================
03:38:39.649070 [info ] [MainThread]: Running with dbt=1.0.4
03:38:39.650069 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['fact_SalesOrdersDetails'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
03:38:39.650069 [debug] [MainThread]: Tracking: tracking
03:38:39.665071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD33F82FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD33F82880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD33F82820>]}
03:38:39.801106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:38:39.802106 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
03:38:39.815106 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
03:38:39.848072 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
03:38:39.940112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbea592e-f7e9-462a-8d59-2e84e9df10c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD343360D0>]}
03:38:39.958070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbea592e-f7e9-462a-8d59-2e84e9df10c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD34170970>]}
03:38:39.958070 [info ] [MainThread]: Found 19 models, 20 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
03:38:39.963070 [info ] [MainThread]: 
03:38:39.965072 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:38:39.967073 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
03:38:39.968073 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:38:40.581148 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
03:38:40.582150 [info ] [MainThread]: 
03:38:40.592152 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:38:40.592152 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
03:38:40.593152 [info ] [Thread-1  ]: 1 of 8 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
03:38:40.594158 [info ] [Thread-2  ]: 2 of 8 START test relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [RUN]
03:38:40.595157 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:38:40.597148 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
03:38:40.597148 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:38:40.598148 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
03:38:40.598148 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:38:40.599151 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
03:38:40.607185 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:38:40.614183 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
03:38:40.615147 [debug] [Thread-1  ]: finished collecting timing info
03:38:40.616147 [debug] [Thread-2  ]: finished collecting timing info
03:38:40.616147 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:38:40.616147 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
03:38:40.641178 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
03:38:40.644146 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
03:38:40.645148 [debug] [Thread-1  ]: Opening a new connection, currently in state init
03:38:40.646150 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:38:40.651182 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select creditCard_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:38:40.652182 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
03:38:42.376254 [debug] [Thread-1  ]: finished collecting timing info
03:38:42.376254 [info ] [Thread-1  ]: 1 of 8 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 1.78s]
03:38:42.378213 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
03:38:42.379220 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
03:38:42.379220 [info ] [Thread-1  ]: 3 of 8 START test relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [RUN]
03:38:42.381218 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
03:38:42.381218 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
03:38:42.381218 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
03:38:42.389218 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
03:38:42.390218 [debug] [Thread-1  ]: finished collecting timing info
03:38:42.391232 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
03:38:42.394228 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
03:38:42.396216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:38:42.401248 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:38:43.480143 [debug] [Thread-2  ]: finished collecting timing info
03:38:43.481107 [info ] [Thread-2  ]: 2 of 8 PASS relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [[32mPASS[0m in 2.88s]
03:38:43.482519 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
03:38:43.483536 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:38:43.483536 [info ] [Thread-2  ]: 4 of 8 START test relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [RUN]
03:38:43.484537 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:38:43.485534 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:38:43.486531 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:38:43.492567 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:38:43.494300 [debug] [Thread-2  ]: finished collecting timing info
03:38:43.494300 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:38:43.497309 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
03:38:43.498346 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:38:43.504312 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:38:45.082577 [debug] [Thread-1  ]: finished collecting timing info
03:38:45.083578 [info ] [Thread-1  ]: 3 of 8 PASS relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [[32mPASS[0m in 2.70s]
03:38:45.085177 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
03:38:45.085177 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
03:38:45.086176 [info ] [Thread-1  ]: 5 of 8 START test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [RUN]
03:38:45.087176 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
03:38:45.087176 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
03:38:45.088177 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
03:38:45.094206 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
03:38:45.096175 [debug] [Thread-1  ]: finished collecting timing info
03:38:45.096175 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
03:38:45.099177 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
03:38:45.101175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:38:45.109175 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select reason_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where reason_sk is not null
),

parent as (
    select reason_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:38:45.237430 [debug] [Thread-2  ]: finished collecting timing info
03:38:45.238429 [info ] [Thread-2  ]: 4 of 8 PASS relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [[32mPASS[0m in 1.75s]
03:38:45.240388 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
03:38:45.240388 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3
03:38:45.241383 [info ] [Thread-2  ]: 6 of 8 START test relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_ [RUN]
03:38:45.242383 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3"
03:38:45.242383 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3
03:38:45.243388 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3
03:38:45.257383 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3"
03:38:45.258385 [debug] [Thread-2  ]: finished collecting timing info
03:38:45.259386 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3
03:38:45.264382 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3"
03:38:45.265414 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:38:45.271420 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select territory_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where territory_sk is not null
),

parent as (
    select reason_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
03:38:45.922365 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reason_sk at [14:11]')
03:38:46.994690 [debug] [Thread-1  ]: finished collecting timing info
03:38:46.995689 [debug] [Thread-1  ]: Database Error in test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: reason_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_5151800d8a11236f7eb0e51e9c04d525.sql
03:38:46.995689 [error] [Thread-1  ]: 5 of 8 ERROR relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [[31mERROR[0m in 1.91s]
03:38:46.997686 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
03:38:46.998689 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:38:46.998689 [info ] [Thread-1  ]: 7 of 8 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id............ [RUN]
03:38:47.000688 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:38:47.000688 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:38:47.000688 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:38:47.009687 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:38:47.010689 [debug] [Thread-1  ]: finished collecting timing info
03:38:47.011690 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:38:47.014685 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
03:38:47.015687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:38:47.023687 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:38:48.261208 [debug] [Thread-2  ]: finished collecting timing info
03:38:48.261208 [error] [Thread-2  ]: 6 of 8 FAIL 121317 relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_ [[31mFAIL 121317[0m in 3.02s]
03:38:48.263212 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_.63aadda5b3
03:38:48.264211 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:38:48.264211 [info ] [Thread-2  ]: 8 of 8 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk........... [RUN]
03:38:48.265210 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:38:48.266216 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:38:48.266216 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:38:48.273215 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:38:48.274483 [debug] [Thread-2  ]: finished collecting timing info
03:38:48.274483 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:38:48.277494 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
03:38:48.278494 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
03:38:48.284493 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
03:38:48.799601 [debug] [Thread-1  ]: finished collecting timing info
03:38:48.800602 [info ] [Thread-1  ]: 7 of 8 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id.................. [[32mPASS[0m in 1.80s]
03:38:48.802602 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
03:38:49.873665 [debug] [Thread-2  ]: finished collecting timing info
03:38:49.874629 [info ] [Thread-2  ]: 8 of 8 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk................. [[32mPASS[0m in 1.61s]
03:38:49.875631 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
03:38:49.877627 [debug] [MainThread]: Acquiring new bigquery connection "master"
03:38:49.878627 [info ] [MainThread]: 
03:38:49.879627 [info ] [MainThread]: Finished running 8 tests in 9.91s.
03:38:49.880629 [debug] [MainThread]: Connection 'master' was properly closed.
03:38:49.881627 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
03:38:49.881627 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
03:38:49.882655 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
03:38:49.906629 [info ] [MainThread]: 
03:38:49.907628 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
03:38:49.909630 [info ] [MainThread]: 
03:38:49.910632 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:38:49.913028 [error] [MainThread]:   Unrecognized name: reason_sk at [14:11]
03:38:49.914053 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_5151800d8a11236f7eb0e51e9c04d525.sql
03:38:49.916039 [info ] [MainThread]: 
03:38:49.917039 [error] [MainThread]: [31mFailure in test relationships_fact_SalesOrdersDetails_territory_sk__reason_sk__ref_dim_Reasons_ (models\marts\fact_SalesOrdersDetails.yml)[0m
03:38:49.919040 [error] [MainThread]:   Got 121317 results, configured to fail if != 0
03:38:49.920055 [info ] [MainThread]: 
03:38:49.922045 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_363f5082e26103d5abfb8ad7575768cd.sql
03:38:49.923038 [info ] [MainThread]: 
03:38:49.924038 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
03:38:49.925049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD34336190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD34170D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD34490130>]}


============================== 2022-05-24 13:41:33.252749 | be9621fa-3710-4d19-9d0c-116924b80ed5 ==============================
13:41:33.252749 [info ] [MainThread]: Running with dbt=1.0.4
13:41:33.254722 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:41:33.255725 [debug] [MainThread]: Tracking: tracking
13:41:33.272719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A5FF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A613C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A6132B0>]}
13:41:33.971748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:41:33.972748 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.yml
13:41:33.984748 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:41:34.016748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:41:34.113756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be9621fa-3710-4d19-9d0c-116924b80ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94AA3F0D0>]}
13:41:34.131752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be9621fa-3710-4d19-9d0c-116924b80ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A8103D0>]}
13:41:34.132722 [info ] [MainThread]: Found 19 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 12 sources, 0 exposures, 0 metrics
13:41:34.137722 [info ] [MainThread]: 
13:41:34.138721 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:41:34.140718 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
13:41:34.140718 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:41:35.254709 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
13:41:35.255711 [info ] [MainThread]: 
13:41:35.272704 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:41:35.273704 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:41:35.273704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:41:35.274705 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:41:35.275705 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:41:35.276705 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:41:35.276705 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:41:35.277705 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:41:35.282722 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
13:41:35.287705 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:41:35.289703 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.290706 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.290706 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
13:41:35.292709 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:41:35.292709 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:41:35.293705 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:41:35.294708 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:41:35.296716 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:41:35.297729 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:41:35.297729 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:41:35.298708 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:41:35.298708 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:41:35.302743 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
13:41:35.306740 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
13:41:35.307706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.308704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.309704 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
13:41:35.310706 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
13:41:35.311705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:41:35.312707 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:41:35.313723 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:41:35.314704 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:41:35.314704 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:41:35.315713 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:41:35.315713 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:41:35.316723 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:41:35.319703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
13:41:35.325718 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:41:35.327705 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.328704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.328704 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
13:41:35.330702 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:41:35.330702 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:41:35.331704 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:41:35.332708 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:41:35.333703 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:41:35.334705 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:41:35.335703 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:41:35.335703 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:41:35.336704 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:41:35.340702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:41:35.344703 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:41:35.345707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.346706 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.347704 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:41:35.348705 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:41:35.348705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:41:35.349706 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:41:35.350706 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:41:35.351708 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:41:35.351708 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:41:35.352712 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:41:35.353705 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:41:35.353705 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:41:35.360705 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:41:35.363702 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
13:41:35.365706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.366759 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:41:35.366759 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.367704 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:41:35.368712 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
13:41:35.369703 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:41:35.369703 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:41:35.370702 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:41:35.371704 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:41:35.371704 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:41:35.372718 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:41:35.375703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:41:35.375703 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:41:35.380709 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
13:41:35.381707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.382705 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:41:35.382705 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.382705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:41:35.384704 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
13:41:35.385704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:41:35.385704 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
13:41:35.386704 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
13:41:35.387704 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
13:41:35.387704 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
13:41:35.388703 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
13:41:35.411703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
13:41:35.412704 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
13:41:35.435704 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
13:41:35.436706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.436706 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
13:41:35.437705 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.437705 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.438706 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
13:41:35.438706 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
13:41:35.439705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:41:35.440704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.440704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:41:35.441705 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
13:41:35.442707 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:41:35.442707 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:41:35.443707 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:41:35.444710 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:41:35.477705 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:41:35.478704 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:41:35.479705 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:41:35.492723 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.496707 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:41:35.497703 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:41:35.497703 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.498726 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.498726 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:41:35.499706 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:41:35.500703 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:41:35.500703 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.501704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:41:35.502714 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:41:35.503705 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:41:35.503705 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
13:41:35.504705 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:41:35.505703 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
13:41:35.525707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:41:35.525707 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
13:41:35.526708 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
13:41:35.545703 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
13:41:35.545703 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.546702 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:41:35.546702 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.546702 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.547705 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:41:35.547705 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
13:41:35.548709 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:41:35.548709 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.549704 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:41:35.550707 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
13:41:35.550707 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:41:35.550707 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:41:35.551706 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:41:35.551706 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:41:35.558704 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:41:35.559725 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:41:35.559725 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:41:35.567706 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:41:35.567706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.568717 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:41:35.568717 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.569718 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:41:35.569718 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.569718 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:41:35.570724 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:41:35.570724 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:41:35.571706 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.571706 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:41:35.572707 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:41:35.572707 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:41:35.573707 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:41:35.577703 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
13:41:35.578711 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:41:35.579717 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:41:35.579717 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:41:35.583707 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
13:41:35.583707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.584726 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:41:35.584726 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.585716 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
13:41:35.585716 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.586707 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:41:35.586707 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:41:35.587704 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:41:35.587704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.588704 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:41:35.589704 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
13:41:35.589704 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:41:35.590706 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:41:35.595703 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:41:35.595703 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:41:35.596708 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:41:35.597707 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:41:35.597707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.604708 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:41:35.604708 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:41:35.605708 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.606705 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:41:35.606705 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:41:35.606705 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.607703 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:41:35.607703 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:41:35.608703 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:41:35.608703 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.609705 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:41:35.610707 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:41:35.614703 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:41:35.614703 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:41:35.615707 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:41:35.615707 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:41:35.616707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.616707 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:41:35.616707 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:41:35.620707 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:41:35.621707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.622706 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:41:35.622706 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.623719 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:41:35.623719 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:41:35.624719 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:41:35.624719 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.625705 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:41:35.625705 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:41:35.626707 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:41:35.626707 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:41:35.630703 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:41:35.631703 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:41:35.632706 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:41:35.632706 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:41:35.633706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.637706 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:41:35.637706 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:41:35.638722 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.639706 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:41:35.639706 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:41:35.639706 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.640707 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:41:35.641704 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:41:35.641704 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:41:35.642717 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.642717 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:41:35.643702 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:41:35.680732 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:41:35.681733 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
13:41:35.682705 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
13:41:35.683707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.683707 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
13:41:35.683707 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:41:35.684705 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
13:41:35.685715 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.690739 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
13:41:35.691718 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:41:35.692717 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
13:41:35.693705 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
13:41:35.693705 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.694711 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
13:41:35.695716 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
13:41:35.695716 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
13:41:35.696718 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.736741 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
13:41:35.737707 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
13:41:35.738703 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
13:41:35.738703 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
13:41:35.739708 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.739708 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
13:41:35.739708 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
13:41:35.740704 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
13:41:35.740704 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.745707 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
13:41:35.746720 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
13:41:35.747704 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
13:41:35.747704 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
13:41:35.748704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.748704 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
13:41:35.748704 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
13:41:35.749707 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
13:41:35.749707 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.754739 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
13:41:35.755740 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
13:41:35.756705 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
13:41:35.757706 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
13:41:35.757706 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.758711 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
13:41:35.758711 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
13:41:35.759720 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
13:41:35.759720 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.765706 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
13:41:35.765706 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
13:41:35.766737 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
13:41:35.767705 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
13:41:35.767705 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
13:41:35.768702 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.768702 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
13:41:35.768702 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
13:41:35.774740 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
13:41:35.774740 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.775706 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
13:41:35.776709 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.776709 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
13:41:35.776709 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
13:41:35.777705 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
13:41:35.778705 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.778705 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
13:41:35.779705 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
13:41:35.779705 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
13:41:35.780705 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
13:41:35.785706 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
13:41:35.786706 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
13:41:35.787707 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
13:41:35.788709 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.788709 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
13:41:35.788709 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
13:41:35.797704 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
13:41:35.798704 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.799704 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
13:41:35.800703 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.800703 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
13:41:35.801721 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
13:41:35.802707 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
13:41:35.802707 [debug] [Thread-1  ]: finished collecting timing info
13:41:35.803710 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
13:41:35.803710 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
13:41:35.804705 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
13:41:35.810707 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
13:41:35.812707 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.812707 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
13:41:35.812707 [debug] [Thread-2  ]: finished collecting timing info
13:41:35.813707 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
13:41:35.814705 [debug] [MainThread]: Connection 'master' was properly closed.
13:41:35.815705 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
13:41:35.815705 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
13:41:35.816721 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
13:41:35.830741 [info ] [MainThread]: Done.
13:41:36.002705 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
13:41:36.002705 [info ] [MainThread]: Building catalog
13:41:36.007732 [debug] [MainThread]: Opening a new connection, currently in state init
13:41:36.709528 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:41:36.723530 [debug] [ThreadPool]: Acquiring new bigquery connection "snappy-meridian-350123.information_schema"
13:41:36.726556 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:41:36.729564 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:41:36.734525 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:41:36.734525 [debug] [ThreadPool]: On snappy-meridian-350123.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "connection_name": "snappy-meridian-350123.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `snappy-meridian-350123`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `snappy-meridian-350123`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
13:41:40.507659 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\target\catalog.json
13:41:40.509660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A613C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A9F5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94AA44460>]}
13:41:41.843350 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:41:41.843350 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.
13:41:41.844313 [debug] [MainThread]: Connection 'snappy-meridian-350123.information_schema' was properly closed.


============================== 2022-05-24 13:41:47.141325 | 489c3cda-3d32-4e99-bb81-9ed6c5795bc1 ==============================
13:41:47.141325 [info ] [MainThread]: Running with dbt=1.0.4
13:41:47.142342 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:41:47.142342 [debug] [MainThread]: Tracking: tracking
13:41:47.157329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002392C379B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002392C393250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002392C393760>]}
13:41:47.161362 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:41:47.162327 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:41:47.163342 [info ] [MainThread]: 
13:41:47.164328 [info ] [MainThread]: 
13:41:47.165327 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-24 22:49:45.847105 | 3af69047-06b8-4d65-a77f-b6ab6f0a2af3 ==============================
22:49:45.847105 [info ] [MainThread]: Running with dbt=1.0.4
22:49:45.849106 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
22:49:45.850107 [debug] [MainThread]: Tracking: tracking
22:49:45.864107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A01BFB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A01D32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A01D3C70>]}
22:49:47.046106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
22:49:47.047106 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_ProductSubcategories.sql
22:49:47.047106 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_ProductCategories.sql
22:49:47.049105 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks.yml
22:49:47.050119 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
22:49:47.051109 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
22:49:47.052106 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
22:49:47.052106 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
22:49:47.053106 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
22:49:47.054107 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
22:49:47.054107 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
22:49:47.055108 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
22:49:47.056107 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
22:49:47.056107 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_person
22:49:47.057106 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_address
22:49:47.058106 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_stateprovince
22:49:47.058106 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
22:49:47.059105 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
22:49:47.084106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_ProductSubcategories.sql
22:49:47.108106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_ProductCategories.sql
22:49:47.114106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_StateProvinces.sql
22:49:47.119108 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
22:49:47.165107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
22:49:47.168106 [debug] [MainThread]: 1603: static parser failed on marts\dim_Addresses.sql
22:49:47.175104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Addresses.sql
22:49:47.178105 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
22:49:47.190106 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
22:49:47.194106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
22:49:47.200108 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
22:49:47.210106 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
22:49:47.212107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
22:49:47.218106 [debug] [MainThread]: 1603: static parser failed on marts\dim_Customers.sql
22:49:47.233108 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Customers.sql
22:49:47.236107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customers.sql
22:49:47.242107 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
22:49:47.257107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
22:49:47.260107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
22:49:47.265108 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
22:49:47.269106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
22:49:47.273107 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
22:49:47.282108 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
22:49:47.284108 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
22:49:47.290105 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReasons.sql
22:49:47.294107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
22:49:47.299106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Persons.sql
22:49:47.303107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Addresses.sql
22:49:47.665317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af69047-06b8-4d65-a77f-b6ab6f0a2af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A065F0D0>]}
22:49:47.685316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af69047-06b8-4d65-a77f-b6ab6f0a2af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A03E9250>]}
22:49:47.686316 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:49:47.689317 [info ] [MainThread]: 
22:49:47.691316 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:49:47.693318 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:49:47.694315 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:49:48.930915 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:49:48.931933 [info ] [MainThread]: 
22:49:48.943918 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:49:48.943918 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:49:48.944916 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:49:48.946918 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:49:48.947917 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:49:48.947917 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:49:48.948915 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:49:48.949917 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:49:48.955919 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:49:48.958915 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:49:48.960915 [debug] [Thread-1  ]: finished collecting timing info
22:49:48.961918 [debug] [Thread-2  ]: finished collecting timing info
22:49:48.962917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:49:48.963918 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:49:48.964916 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:49:48.965915 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:49:48.965915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:49:48.966917 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:49:48.967915 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:49:48.968937 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:49:48.968937 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:49:48.969916 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:49:48.974921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:49:48.979917 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:49:48.981918 [debug] [Thread-1  ]: finished collecting timing info
22:49:48.982917 [debug] [Thread-2  ]: finished collecting timing info
22:49:48.983917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:49:48.985917 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:49:48.985917 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:49:48.986916 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:49:48.987915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:49:48.988932 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:49:48.989915 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:49:48.990915 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:49:48.990915 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:49:48.991915 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:49:48.996914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:49:49.001917 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:49:49.002916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.003937 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.004916 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:49:49.005914 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:49:49.006916 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:49:49.006916 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:49:49.007915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:49:49.008915 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:49:49.008915 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:49:49.009916 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:49:49.010921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:49:49.010921 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:49:49.015945 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:49:49.020915 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:49:49.021914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.022915 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:49:49.023915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.023915 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:49:49.024917 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:49:49.025915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:49:49.026919 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:49:49.027935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:49:49.028914 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:49:49.028914 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:49:49.029916 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:49:49.078914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:49:49.078914 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:49:49.083916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:49:49.083916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.084915 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:49:49.084915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.085916 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:49:49.086916 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:49:49.086916 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:49:49.087917 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:49:49.087917 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:49:49.088915 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:49:49.089914 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:49:49.089914 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:49:49.093918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:49:49.094916 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:49:49.097913 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:49:49.098916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.099915 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:49:49.099915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.100916 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:49:49.101914 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:49:49.102915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:49:49.102915 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:49:49.103931 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:49:49.104915 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:49:49.104915 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:49:49.105917 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:49:49.108916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:49:49.109913 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:49:49.113915 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:49:49.113915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.114917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:49:49.115916 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.115916 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:49:49.116915 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:49:49.117916 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:49:49.117916 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:49:49.118918 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:49:49.119916 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:49:49.119916 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:49:49.120914 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:49:49.139914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:49:49.140914 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:49:49.159914 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:49:49.159914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.160917 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:49:49.161914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.161914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.162914 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:49:49.162914 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:49:49.163915 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:49:49.163915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.164914 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:49:49.165916 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:49:49.166915 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:49:49.166915 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:49:49.167914 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:49:49.168927 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:49:49.205916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:49:49.205916 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:49:49.206916 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:49:49.206916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.222914 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:49:49.223915 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:49:49.223915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.224916 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:49:49.225915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.225915 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:49:49.226915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:49:49.226915 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:49:49.227917 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.227917 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:49:49.228915 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:49:49.229915 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:49:49.229915 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:49:49.249914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:49:49.250915 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:49:49.251923 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:49:49.252915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.252915 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:49:49.252915 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:49:49.285916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:49:49.285916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.287915 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:49:49.287915 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:49:49.288916 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.289915 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:49:49.289915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:49:49.289915 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:49:49.290915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.291919 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:49:49.292915 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:49:49.303914 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:49:49.304915 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:49:49.305913 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:49:49.306916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.306916 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:49:49.307915 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:49:49.307915 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:49:49.307915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.315915 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:49:49.316914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:49:49.316914 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:49:49.317914 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:49:49.317914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.318916 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:49:49.318916 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:49:49.319918 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:49:49.319918 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.324915 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:49:49.325915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:49:49.326913 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:49:49.326913 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:49:49.327914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.327914 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:49:49.327914 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:49:49.328915 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:49:49.328915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.333914 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:49:49.334914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:49:49.335916 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:49:49.336915 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:49:49.336915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.336915 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:49:49.337917 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:49:49.337917 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:49:49.338916 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.342914 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:49:49.343915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:49:49.344916 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:49:49.345915 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:49:49.345915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.345915 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:49:49.346915 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:49:49.347914 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:49:49.347914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.352914 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:49:49.352914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:49:49.353915 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:49:49.354914 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:49:49.354914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.355916 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:49:49.355916 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:49:49.356917 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:49:49.356917 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.362915 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:49:49.363915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:49:49.364915 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:49:49.365917 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:49:49.365917 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.366914 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:49:49.366914 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:49:49.367915 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:49:49.367915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.372914 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:49:49.373914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:49:49.374917 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:49:49.374917 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.375915 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:49:49.375915 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:49:49.376916 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:49:49.376916 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.377915 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:49:49.378917 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:49:49.383916 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:49:49.383916 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:49:49.385915 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:49:49.385915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.385915 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:49:49.386914 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:49:49.386914 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:49:49.387916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.391913 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:49:49.392914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:49:49.393914 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:49:49.393914 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:49:49.394915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.394915 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:49:49.395915 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:49:49.395915 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:49:49.396914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.444915 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:49:49.445915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:49:49.447919 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:49:49.448916 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:49:49.448916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.449914 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:49:49.449914 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:49:49.450914 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:49:49.450914 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.456928 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:49:49.457914 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:49:49.458914 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:49:49.459914 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:49:49.459914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.460913 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:49:49.460913 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:49:49.461914 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:49:49.461914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.468915 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:49:49.469915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:49:49.470916 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:49:49.470916 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:49:49.471916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.471916 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:49:49.471916 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:49:49.472915 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:49:49.472915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.477914 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:49:49.478915 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:49:49.479916 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:49:49.480917 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:49:49.480917 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.481916 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:49:49.481916 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:49:49.482916 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:49:49.483930 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.490913 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:49:49.491930 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:49:49.492915 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:49:49.493916 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:49:49.494916 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.494916 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:49:49.495931 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:49:49.495931 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:49:49.496931 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.503918 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:49:49.504915 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:49:49.504915 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:49:49.505915 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:49:49.505915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.506914 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:49:49.506914 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:49:49.507914 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:49:49.507914 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.515913 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:49:49.515913 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:49:49.516914 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:49:49.517915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.517915 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:49:49.518914 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:49:49.518914 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:49:49.519915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.519915 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:49:49.520914 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:49:49.527915 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:49:49.528915 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:49:49.529914 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:49:49.530915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.530915 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:49:49.531915 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:49:49.531915 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:49:49.532915 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.537915 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:49:49.537915 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:49:49.538916 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:49:49.539915 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:49:49.539915 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.540924 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:49:49.541918 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:49:49.541918 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:49:49.542921 [debug] [Thread-1  ]: finished collecting timing info
22:49:49.548916 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:49:49.549917 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:49:49.550932 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.551923 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:49:49.552917 [debug] [Thread-2  ]: finished collecting timing info
22:49:49.552917 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:49:49.554916 [debug] [MainThread]: Connection 'master' was properly closed.
22:49:49.555915 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:49:49.555915 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
22:49:49.556918 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
22:49:49.574915 [info ] [MainThread]: Done.
22:49:49.575938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A07718E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A0771F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A0771FA0>]}


============================== 2022-05-24 22:50:25.427344 | f52d0500-9f2c-4b18-b58c-1707dcfc397b ==============================
22:50:25.427344 [info ] [MainThread]: Running with dbt=1.0.4
22:50:25.428362 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:50:25.429342 [debug] [MainThread]: Tracking: tracking
22:50:25.444342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74A95EB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74A9710A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74A9718E0>]}
22:50:25.612344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:50:25.613343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:50:25.625344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AC680D0>]}
22:50:25.648355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AA15220>]}
22:50:25.649352 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:50:25.655341 [info ] [MainThread]: 
22:50:25.657345 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:50:25.659346 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
22:50:25.660343 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:26.288510 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:50:26.289501 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:26.881156 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:50:26.882159 [info ] [MainThread]: 
22:50:26.891156 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:50:26.892159 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:50:26.893158 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:50:26.894166 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:50:26.895167 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:50:26.896157 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:50:26.896157 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:50:26.897155 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:50:26.901158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:50:26.907162 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:50:26.908170 [debug] [Thread-1  ]: finished collecting timing info
22:50:26.909157 [debug] [Thread-2  ]: finished collecting timing info
22:50:26.910157 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:50:26.911165 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:50:26.912155 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:50:26.913160 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:50:26.914157 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:50:26.915155 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:50:26.916166 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:50:26.917157 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:50:26.917157 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:50:26.918157 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:50:26.922162 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:50:26.928158 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:50:26.930155 [debug] [Thread-1  ]: finished collecting timing info
22:50:26.930155 [debug] [Thread-2  ]: finished collecting timing info
22:50:26.931179 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:50:26.932155 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:50:26.933155 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:50:26.934155 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:50:26.935157 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:50:26.936157 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:50:26.937156 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:50:26.937156 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:50:26.938157 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:50:26.939158 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:50:26.943156 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:50:26.948154 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:50:26.949154 [debug] [Thread-1  ]: finished collecting timing info
22:50:26.950174 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:50:26.951174 [debug] [Thread-2  ]: finished collecting timing info
22:50:26.951174 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:50:26.952154 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:50:26.953157 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:50:26.954156 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:50:26.956173 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:50:26.957156 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:50:26.957156 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:50:26.958156 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:50:26.961155 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:50:26.962190 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:50:26.967184 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:50:26.968157 [debug] [Thread-1  ]: finished collecting timing info
22:50:26.969155 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:50:26.970157 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:50:26.970157 [debug] [Thread-2  ]: finished collecting timing info
22:50:26.971157 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:50:26.972156 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:50:26.973163 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:50:26.973163 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:50:26.974154 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:50:26.975155 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:50:26.979193 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:50:26.980155 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:50:26.981158 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:50:26.985156 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:50:26.986180 [debug] [Thread-1  ]: finished collecting timing info
22:50:26.987158 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:50:26.988157 [debug] [Thread-2  ]: finished collecting timing info
22:50:26.988157 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:50:26.989155 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:50:26.990155 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:50:26.990155 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:50:26.991155 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:50:26.992156 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:50:26.993155 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:50:26.993155 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:50:26.997156 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:50:26.997156 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:50:27.003194 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:50:27.003194 [debug] [Thread-1  ]: finished collecting timing info
22:50:27.005157 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:50:27.005157 [debug] [Thread-2  ]: finished collecting timing info
22:50:27.006155 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:50:27.007155 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:50:27.008155 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:50:27.008155 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:50:27.009155 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:50:27.010155 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:50:27.010155 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:50:27.011155 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:50:27.015154 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:50:27.016155 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:50:27.021154 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:50:27.022155 [debug] [Thread-1  ]: finished collecting timing info
22:50:27.022155 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:50:27.023156 [debug] [Thread-2  ]: finished collecting timing info
22:50:27.023156 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:50:27.025155 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:50:27.025155 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
22:50:27.026154 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:50:27.028156 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:50:27.029155 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
22:50:27.029155 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:50:27.031157 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:50:27.031157 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:50:27.032155 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:50:27.082154 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:50:27.082154 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:50:27.107155 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:50:27.107155 [debug] [Thread-1  ]: finished collecting timing info
22:50:27.108154 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:50:27.108154 [debug] [Thread-2  ]: finished collecting timing info
22:50:27.146670 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:50:27.147712 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:50:27.151707 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:50:27.152670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:50:27.153675 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:50:27.157697 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


22:50:27.158670 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


22:50:28.398310 [debug] [Thread-1  ]: finished collecting timing info
22:50:28.401307 [debug] [Thread-2  ]: finished collecting timing info
22:50:28.402306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AD2CEE0>]}
22:50:28.403306 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AE15CD0>]}
22:50:28.404362 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.37s]
22:50:28.405307 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.37s]
22:50:28.407311 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:50:28.408308 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:50:28.409321 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
22:50:28.409321 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:50:28.411307 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:50:28.411307 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:50:28.412307 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:50:28.413309 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
22:50:28.414311 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:50:28.416308 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:50:28.468311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:50:28.468311 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:50:28.470309 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:50:28.482308 [debug] [Thread-1  ]: finished collecting timing info
22:50:28.494307 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:50:28.495308 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:50:28.500307 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:50:28.501308 [debug] [Thread-2  ]: finished collecting timing info
22:50:28.502308 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:50:28.506308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:50:28.520307 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:50:28.522308 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:50:28.527310 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,productSubcategory
            ,productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


22:50:28.529309 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


22:50:29.688223 [debug] [Thread-2  ]: finished collecting timing info
22:50:29.689236 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74BE02E80>]}
22:50:29.690220 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.27s]
22:50:29.692225 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:50:29.692225 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:50:29.694219 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
22:50:29.695230 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name productSubcategory_id is ambiguous at [104:32]')
22:50:29.696243 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:50:29.697227 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:50:29.698233 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:50:29.725221 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:50:29.727221 [debug] [Thread-2  ]: finished collecting timing info
22:50:29.728235 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:50:29.736220 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:50:29.738223 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:50:29.745223 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


22:50:30.979380 [debug] [Thread-2  ]: finished collecting timing info
22:50:30.980382 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AD45100>]}
22:50:30.981383 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.28s]
22:50:30.982382 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:50:30.983397 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:50:30.984394 [info ] [Thread-2  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
22:50:30.986382 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:50:30.986382 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:50:30.987384 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:50:31.008384 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:50:31.010380 [debug] [Thread-2  ]: finished collecting timing info
22:50:31.011381 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:50:31.023394 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:50:31.026382 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:50:31.033029 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


22:50:31.035993 [debug] [Thread-1  ]: finished collecting timing info
22:50:31.039010 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Column name productSubcategory_id is ambiguous at [104:32]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:50:31.039992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74BE236D0>]}
22:50:31.040991 [error] [Thread-1  ]: 3 of 7 ERROR creating view model AdventureWorks_marts.dim_Products.............. [[31mERROR[0m in 2.63s]
22:50:31.043013 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:50:32.222992 [debug] [Thread-2  ]: finished collecting timing info
22:50:32.223991 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52d0500-9f2c-4b18-b58c-1707dcfc397b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74BE44970>]}
22:50:32.224992 [info ] [Thread-2  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.24s]
22:50:32.226991 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:50:32.227993 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:50:32.228993 [info ] [Thread-1  ]: 7 of 7 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
22:50:32.230010 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:50:32.232992 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:50:32.233997 [info ] [MainThread]: 
22:50:32.234995 [info ] [MainThread]: Finished running 7 view models in 6.58s.
22:50:32.236991 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:32.236991 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
22:50:32.238009 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:50:32.238009 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
22:50:32.238993 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
22:50:32.268992 [info ] [MainThread]: 
22:50:32.269992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:50:32.271991 [info ] [MainThread]: 
22:50:32.272995 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
22:50:32.275994 [error] [MainThread]:   Column name productSubcategory_id is ambiguous at [104:32]
22:50:32.277014 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:50:32.277993 [info ] [MainThread]: 
22:50:32.278993 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
22:50:32.280991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AC57C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74AC68C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74BDF1850>]}


============================== 2022-05-24 22:51:37.690932 | bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f ==============================
22:51:37.690932 [info ] [MainThread]: Running with dbt=1.0.4
22:51:37.692905 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:51:37.692905 [debug] [MainThread]: Tracking: tracking
22:51:37.705906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0341CC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0341E26D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0341E2430>]}
22:51:37.911541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:51:37.912540 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
22:51:37.926541 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
22:51:37.966540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
22:51:38.025542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03460A0D0>]}
22:51:38.045540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0343E9760>]}
22:51:38.046543 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:51:38.050542 [info ] [MainThread]: 
22:51:38.052541 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:38.055542 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
22:51:38.055542 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:38.661499 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:51:38.662498 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:39.232710 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:51:39.233697 [info ] [MainThread]: 
22:51:39.243698 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:51:39.244716 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:51:39.245700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:51:39.246713 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:51:39.247701 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:51:39.248699 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:51:39.249700 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:51:39.249700 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:51:39.254698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:51:39.260729 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:51:39.261698 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.262698 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.263700 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:51:39.264698 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:51:39.266703 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:51:39.266703 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:51:39.267704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:51:39.268696 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:51:39.269697 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:51:39.270698 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:51:39.270698 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:51:39.271697 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:51:39.278716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:51:39.282705 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:51:39.284709 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.285699 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:51:39.285699 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.286698 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:51:39.287698 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:51:39.288698 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:51:39.290701 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:51:39.291700 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:51:39.292697 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:51:39.293698 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:51:39.294697 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:51:39.298714 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:51:39.299710 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:51:39.304698 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:51:39.305697 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.306700 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:51:39.307702 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:51:39.307702 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.310696 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:51:39.311698 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:51:39.311698 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:51:39.312698 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:51:39.313697 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:51:39.313697 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:51:39.317714 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:51:39.318734 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:51:39.319698 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:51:39.324712 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:51:39.325712 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.326712 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:51:39.327697 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:51:39.327697 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.328715 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:51:39.329697 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:51:39.330703 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:51:39.330703 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:51:39.331699 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:51:39.333732 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:51:39.337700 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:51:39.337700 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:51:39.338698 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:51:39.339700 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.343697 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:51:39.343697 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:51:39.344697 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:51:39.345699 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.345699 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:51:39.346698 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:51:39.347699 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:51:39.347699 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:51:39.348696 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:51:39.348696 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:51:39.352696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:51:39.352696 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:51:39.353697 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:51:39.357696 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:51:39.357696 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.358698 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:51:39.359697 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.359697 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:51:39.360700 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:51:39.360700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:51:39.361704 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:51:39.361704 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:51:39.362697 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:51:39.363698 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:51:39.363698 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:51:39.367697 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:51:39.367697 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:51:39.374698 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:51:39.375697 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.376699 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:51:39.376699 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.377697 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:51:39.378700 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:51:39.378700 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
22:51:39.379696 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:51:39.380704 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:51:39.381697 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
22:51:39.381697 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:51:39.382697 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:51:39.383699 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:51:39.383699 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:51:39.405700 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:51:39.411699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:51:39.429696 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:51:39.431697 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.431697 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.431697 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:51:39.432696 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:51:39.500698 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:51:39.503698 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:51:39.505701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:39.506699 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:51:39.513698 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


22:51:39.515703 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


22:51:40.709472 [debug] [Thread-2  ]: finished collecting timing info
22:51:40.710468 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0346A51C0>]}
22:51:40.711474 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.33s]
22:51:40.713468 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:51:40.714468 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:51:40.715468 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
22:51:40.716470 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:51:40.717472 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:51:40.718468 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:51:40.763466 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:51:40.764468 [debug] [Thread-2  ]: finished collecting timing info
22:51:40.765469 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:51:40.771469 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:51:40.773468 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:51:40.781468 [debug] [Thread-1  ]: finished collecting timing info
22:51:40.782470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E034748220>]}
22:51:40.783468 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,ProductSubcategories.productSubcategory
            ,ProductCategories.productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


22:51:40.783468 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.40s]
22:51:40.787471 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:51:40.789471 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:51:40.790469 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
22:51:40.792470 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:51:40.793472 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:51:40.793472 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:51:40.816467 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:51:40.818469 [debug] [Thread-1  ]: finished collecting timing info
22:51:40.818469 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:51:40.823469 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:51:40.825469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:40.833470 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


22:51:41.992653 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name productSubcategory_id is ambiguous at [104:32]')
22:51:42.087462 [debug] [Thread-1  ]: finished collecting timing info
22:51:42.087462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0346CDCD0>]}
22:51:42.088460 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.30s]
22:51:42.090460 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:51:42.090460 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:51:42.091461 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
22:51:42.093461 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:51:42.093461 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:51:42.094466 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:51:42.125466 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:51:42.127461 [debug] [Thread-1  ]: finished collecting timing info
22:51:42.128465 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:51:42.194495 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:51:42.195460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:42.201496 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


22:51:43.496241 [debug] [Thread-1  ]: finished collecting timing info
22:51:43.496241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0341ACD60>]}
22:51:43.497259 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.40s]
22:51:43.499242 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:51:43.499242 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:51:43.500248 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
22:51:43.501257 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:51:43.502247 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:51:43.502247 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:51:43.523289 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:51:43.524243 [debug] [Thread-1  ]: finished collecting timing info
22:51:43.525244 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:51:43.530244 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:51:43.532242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:43.539242 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


22:51:43.593792 [debug] [Thread-2  ]: finished collecting timing info
22:51:43.594790 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Column name productSubcategory_id is ambiguous at [104:32]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:51:43.594790 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03573E730>]}
22:51:43.595791 [error] [Thread-2  ]: 3 of 7 ERROR creating view model AdventureWorks_marts.dim_Products.............. [[31mERROR[0m in 2.88s]
22:51:43.596790 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:51:44.961841 [debug] [Thread-1  ]: finished collecting timing info
22:51:44.962840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7fc-3aa8-491f-95ab-cbe5e3d17e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03455B610>]}
22:51:44.962840 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.46s]
22:51:44.964843 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:51:44.965837 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:51:44.966849 [info ] [Thread-2  ]: 7 of 7 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
22:51:44.967840 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:51:44.969848 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:44.970840 [info ] [MainThread]: 
22:51:44.971838 [info ] [MainThread]: Finished running 7 view models in 6.92s.
22:51:44.973842 [debug] [MainThread]: Connection 'master' was properly closed.
22:51:44.974839 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
22:51:44.975840 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:51:44.975840 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
22:51:44.975840 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
22:51:45.001838 [info ] [MainThread]: 
22:51:45.002840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:51:45.004837 [info ] [MainThread]: 
22:51:45.005842 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
22:51:45.007839 [error] [MainThread]:   Column name productSubcategory_id is ambiguous at [104:32]
22:51:45.009842 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:51:45.010862 [info ] [MainThread]: 
22:51:45.012839 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
22:51:45.014841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0343E9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0346D1B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0234B9E80>]}


============================== 2022-05-24 22:52:36.728518 | c1d2e469-8969-4dab-b2f1-c3d7378a089b ==============================
22:52:36.728518 [info ] [MainThread]: Running with dbt=1.0.4
22:52:36.729530 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:52:36.729530 [debug] [MainThread]: Tracking: tracking
22:52:36.744518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B292340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B292C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B292310>]}
22:52:36.924517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:52:36.925519 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
22:52:36.944516 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
22:52:37.000517 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
22:52:37.071517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B65D0D0>]}
22:52:37.092517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B496850>]}
22:52:37.093519 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:52:37.098518 [info ] [MainThread]: 
22:52:37.099517 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:52:37.101517 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
22:52:37.102517 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:52:37.747859 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:52:37.747859 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:52:38.317093 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:52:38.318120 [info ] [MainThread]: 
22:52:38.327093 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:52:38.327093 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:52:38.328098 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:52:38.329095 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:52:38.330123 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:52:38.331096 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:52:38.332098 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:52:38.332098 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:52:38.336099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:52:38.341102 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:52:38.343099 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.343099 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.344096 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:52:38.345093 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:52:38.346096 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:52:38.347094 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:52:38.348092 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:52:38.349094 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:52:38.349094 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:52:38.350132 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:52:38.350132 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:52:38.351093 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:52:38.356097 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:52:38.361099 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:52:38.362095 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.363094 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.364098 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:52:38.365098 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:52:38.366093 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:52:38.367094 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:52:38.368103 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:52:38.368103 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:52:38.369125 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:52:38.370098 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:52:38.371100 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:52:38.371100 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:52:38.377094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:52:38.382137 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:52:38.384116 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.384116 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.385095 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:52:38.386098 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:52:38.387095 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:52:38.387095 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:52:38.388112 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:52:38.389111 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:52:38.390095 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:52:38.391095 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:52:38.392097 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:52:38.393100 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:52:38.398130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:52:38.402134 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:52:38.404113 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.404113 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.405095 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:52:38.407095 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:52:38.407095 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:52:38.408103 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:52:38.410111 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:52:38.410111 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:52:38.411098 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:52:38.412098 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:52:38.413098 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:52:38.413098 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:52:38.418138 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:52:38.422098 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:52:38.424096 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.425099 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:52:38.425099 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.426125 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:52:38.427096 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:52:38.427096 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:52:38.428126 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:52:38.429094 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:52:38.429094 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:52:38.430099 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:52:38.430099 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:52:38.434099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:52:38.434099 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:52:38.438096 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:52:38.439094 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.440097 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:52:38.440097 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.440097 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:52:38.441097 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:52:38.442098 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:52:38.443094 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:52:38.443094 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:52:38.444130 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:52:38.445093 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:52:38.445093 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:52:38.450093 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:52:38.450093 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:52:38.455098 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:52:38.455098 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.456099 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:52:38.457111 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.457111 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:52:38.458099 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:52:38.459099 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
22:52:38.459099 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:52:38.461095 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:52:38.461095 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
22:52:38.462121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:52:38.463096 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:52:38.464095 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:52:38.464095 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:52:38.485104 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:52:38.486094 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:52:38.506095 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:52:38.506095 [debug] [Thread-1  ]: finished collecting timing info
22:52:38.507097 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:52:38.508099 [debug] [Thread-2  ]: finished collecting timing info
22:52:38.545095 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:52:38.545095 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:52:38.549119 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:52:38.550094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:38.551096 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:52:38.555098 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


22:52:38.558095 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


22:52:39.716591 [debug] [Thread-2  ]: finished collecting timing info
22:52:39.716591 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B748EB0>]}
22:52:39.717595 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.25s]
22:52:39.719591 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:52:39.720593 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:52:39.720593 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
22:52:39.722602 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:52:39.722602 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:52:39.723591 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:52:39.774110 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:52:39.776113 [debug] [Thread-2  ]: finished collecting timing info
22:52:39.777111 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:52:39.782114 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:52:39.784113 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:52:39.791128 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,ProductSubcategories.productSubcategory
            ,ProductCategories.productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


22:52:39.847111 [debug] [Thread-1  ]: finished collecting timing info
22:52:39.848111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B7302B0>]}
22:52:39.849113 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.39s]
22:52:39.851127 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:52:39.852111 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:52:39.852111 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
22:52:39.854113 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:52:39.854113 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:52:39.855114 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:52:39.884112 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:52:39.885112 [debug] [Thread-1  ]: finished collecting timing info
22:52:39.886112 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:52:39.891112 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:52:39.892114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:39.901111 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


22:52:40.988252 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name productSubcategory_id is ambiguous at [111:14]')
22:52:41.028812 [debug] [Thread-1  ]: finished collecting timing info
22:52:41.029785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0C7A9F70>]}
22:52:41.030785 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.18s]
22:52:41.032784 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:52:41.032784 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:52:41.033783 [info ] [Thread-1  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
22:52:41.034789 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:52:41.035818 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:52:41.036784 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:52:41.127818 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:52:41.129783 [debug] [Thread-1  ]: finished collecting timing info
22:52:41.129783 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:52:41.133844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:52:41.134784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:41.140783 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


22:52:42.368751 [debug] [Thread-1  ]: finished collecting timing info
22:52:42.369752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B2508B0>]}
22:52:42.370755 [info ] [Thread-1  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.33s]
22:52:42.372754 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:52:42.372754 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:52:42.373750 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
22:52:42.375751 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:52:42.375751 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:52:42.376756 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:52:42.408768 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:52:42.410767 [debug] [Thread-1  ]: finished collecting timing info
22:52:42.410767 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:52:42.416753 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:52:42.418763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:42.425752 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


22:52:42.666038 [debug] [Thread-2  ]: finished collecting timing info
22:52:42.667038 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Column name productSubcategory_id is ambiguous at [111:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:52:42.668039 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B7257F0>]}
22:52:42.669041 [error] [Thread-2  ]: 3 of 7 ERROR creating view model AdventureWorks_marts.dim_Products.............. [[31mERROR[0m in 2.95s]
22:52:42.671040 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:52:43.564457 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.565459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d2e469-8969-4dab-b2f1-c3d7378a089b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B6F2BB0>]}
22:52:43.566462 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.19s]
22:52:43.567462 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:52:43.568459 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:52:43.569459 [info ] [Thread-2  ]: 7 of 7 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
22:52:43.570487 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:52:43.572474 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:52:43.574464 [info ] [MainThread]: 
22:52:43.575471 [info ] [MainThread]: Finished running 7 view models in 6.47s.
22:52:43.576464 [debug] [MainThread]: Connection 'master' was properly closed.
22:52:43.577462 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
22:52:43.577462 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:52:43.578496 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
22:52:43.578496 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
22:52:43.601458 [info ] [MainThread]: 
22:52:43.602460 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:52:43.604463 [info ] [MainThread]: 
22:52:43.605459 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
22:52:43.607480 [error] [MainThread]:   Column name productSubcategory_id is ambiguous at [111:14]
22:52:43.609465 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:52:43.610462 [info ] [MainThread]: 
22:52:43.612461 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
22:52:43.613460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B3319D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B331190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0B54B2E0>]}


============================== 2022-05-24 22:53:35.339285 | 904666c6-4a72-435f-b060-b863c4e69a63 ==============================
22:53:35.339285 [info ] [MainThread]: Running with dbt=1.0.4
22:53:35.340286 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:53:35.341287 [debug] [MainThread]: Tracking: tracking
22:53:35.354286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E7FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E91A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E91D30>]}
22:53:35.535286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:53:35.536335 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
22:53:35.552284 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
22:53:35.590287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
22:53:35.652285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C422620D0>]}
22:53:35.673285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C42096880>]}
22:53:35.674300 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:53:35.680288 [info ] [MainThread]: 
22:53:35.681287 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:35.684287 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
22:53:35.684287 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:36.283826 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:53:36.284826 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:36.844875 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:53:36.845876 [info ] [MainThread]: 
22:53:36.855875 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:53:36.856890 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:53:36.857889 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:53:36.858872 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:53:36.859883 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:53:36.859883 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:53:36.860874 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:53:36.861906 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:53:36.867873 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:53:36.873907 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:53:36.875872 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.876876 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.876876 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:53:36.877872 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:53:36.878873 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:53:36.879874 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:53:36.880875 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:53:36.881874 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:53:36.881874 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:53:36.882875 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:53:36.883875 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:53:36.884874 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:53:36.888871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:53:36.893874 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:53:36.895872 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.897873 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:53:36.897873 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.898872 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:53:36.899870 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:53:36.900871 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:53:36.900871 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:53:36.901871 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:53:36.902872 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:53:36.902872 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:53:36.903874 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:53:36.908872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:53:36.908872 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:53:36.915872 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:53:36.916873 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.917871 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:53:36.918873 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.918873 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:53:36.919873 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:53:36.920884 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:53:36.921871 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:36.922870 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:53:36.923871 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:36.923871 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:53:36.924873 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:36.930870 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:53:36.931872 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:36.939877 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:36.940871 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.942872 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:53:36.942872 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:36.943871 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.944872 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:36.945871 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:36.945871 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:36.946878 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:36.947872 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:36.948871 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:36.953872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:36.954870 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:36.955870 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:36.955870 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.959871 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:36.960872 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:36.961872 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:36.961872 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.962870 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:36.963872 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:36.963872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:36.964870 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:53:36.965871 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:36.966870 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:53:36.970871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:36.970871 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:53:36.971869 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:53:36.971869 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.975870 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:53:36.976871 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:36.977871 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:36.978878 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:36.979872 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.979872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:36.980870 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:53:36.981871 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:36.981871 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:53:36.986875 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:36.986875 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:53:36.987870 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:53:36.988872 [debug] [Thread-1  ]: finished collecting timing info
22:53:36.988872 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:53:36.990871 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:36.993870 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:53:36.994870 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:53:36.995870 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
22:53:36.996872 [debug] [Thread-2  ]: finished collecting timing info
22:53:36.997872 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:53:36.998870 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:53:36.998870 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:53:36.999869 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:53:36.999869 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:53:37.000871 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
22:53:37.026871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:53:37.028871 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:53:37.029871 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:53:37.029871 [debug] [Thread-1  ]: finished collecting timing info
22:53:37.030870 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:53:37.030870 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:53:37.057869 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:53:37.105873 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:53:37.106870 [debug] [Thread-2  ]: finished collecting timing info
22:53:37.106870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:37.107872 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:53:37.111871 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:53:37.112870 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:37.116869 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


22:53:37.120870 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


22:53:38.269867 [debug] [Thread-1  ]: finished collecting timing info
22:53:38.270869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C422D1FA0>]}
22:53:38.271868 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.27s]
22:53:38.273869 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:53:38.273869 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:53:38.274869 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
22:53:38.276870 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:53:38.277874 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:53:38.277874 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:53:38.311878 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:38.315878 [debug] [Thread-2  ]: finished collecting timing info
22:53:38.317868 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C42235B80>]}
22:53:38.318905 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.29s]
22:53:38.318905 [debug] [Thread-1  ]: finished collecting timing info
22:53:38.319866 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:53:38.319866 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:53:38.323867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:38.324886 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:38.326872 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
22:53:38.327868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:38.328870 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:38.328870 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:38.329893 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:53:38.346868 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:38.347867 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,ProductSubcategories.productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,ProductSubcategories.productSubcategory
            ,ProductCategories.productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


22:53:38.348869 [debug] [Thread-2  ]: finished collecting timing info
22:53:38.349868 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:38.353867 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:38.355867 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:38.362869 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


22:53:39.491139 [debug] [Thread-2  ]: finished collecting timing info
22:53:39.492138 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4223B4F0>]}
22:53:39.493134 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.16s]
22:53:39.494142 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:39.495135 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:39.496137 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
22:53:39.497151 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:39.498137 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:39.498137 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:39.529136 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:39.531135 [debug] [Thread-2  ]: finished collecting timing info
22:53:39.532136 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:39.538146 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:39.540135 [debug] [Thread-1  ]: finished collecting timing info
22:53:39.542134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4339E130>]}
22:53:39.543135 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.26s]
22:53:39.543135 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:39.545138 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:53:39.546135 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:53:39.547135 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
22:53:39.549134 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:53:39.549134 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:53:39.550142 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:53:39.573135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:53:39.574143 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


22:53:39.576136 [debug] [Thread-1  ]: finished collecting timing info
22:53:39.577134 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:53:39.582135 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:53:39.585134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:39.591134 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


22:53:40.679553 [debug] [Thread-1  ]: finished collecting timing info
22:53:40.680551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C42370400>]}
22:53:40.681559 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.13s]
22:53:40.683552 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:53:40.695550 [debug] [Thread-2  ]: finished collecting timing info
22:53:40.696553 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4223BC40>]}
22:53:40.696553 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.20s]
22:53:40.698549 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:40.700557 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:40.700557 [info ] [Thread-1  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
22:53:40.702550 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:53:40.702550 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:40.703552 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:40.827552 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:53:40.828552 [debug] [Thread-1  ]: finished collecting timing info
22:53:40.829552 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:40.836549 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:53:40.838561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:40.843584 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            -- ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


22:53:42.412314 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.413312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '904666c6-4a72-435f-b060-b863c4e69a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E5CBE0>]}
22:53:42.414285 [info ] [Thread-1  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.71s]
22:53:42.415286 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:42.417285 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:42.418285 [info ] [MainThread]: 
22:53:42.419287 [info ] [MainThread]: Finished running 7 view models in 6.74s.
22:53:42.421287 [debug] [MainThread]: Connection 'master' was properly closed.
22:53:42.421287 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
22:53:42.422286 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:53:42.423286 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
22:53:42.424287 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
22:53:42.447285 [info ] [MainThread]: 
22:53:42.448289 [info ] [MainThread]: [32mCompleted successfully[0m
22:53:42.450296 [info ] [MainThread]: 
22:53:42.452286 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:53:42.453288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E62CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41F307F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C41E91F70>]}


============================== 2022-05-24 22:53:52.722026 | 47f01940-f3df-42d4-ae85-d28f88005ec6 ==============================
22:53:52.722026 [info ] [MainThread]: Running with dbt=1.0.4
22:53:52.723028 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:53:52.724027 [debug] [MainThread]: Tracking: tracking
22:53:52.739027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D14DDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D14F23A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D14F2D30>]}
22:53:52.907881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:53:52.907881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:53:52.919848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f01940-f3df-42d4-ae85-d28f88005ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D17E80D0>]}
22:53:52.943850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f01940-f3df-42d4-ae85-d28f88005ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D159E1C0>]}
22:53:52.944849 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:53:52.951851 [info ] [MainThread]: 
22:53:52.952865 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:52.955848 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:53:52.956852 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:53.527180 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:53:53.528181 [info ] [MainThread]: 
22:53:53.537182 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:53:53.537182 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:53:53.538183 [info ] [Thread-1  ]: 1 of 19 START test not_null_dim_Addresses_address_sk............................ [RUN]
22:53:53.539182 [info ] [Thread-2  ]: 2 of 19 START test not_null_dim_CreditCards_creditCard_sk....................... [RUN]
22:53:53.541184 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:53:53.543183 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:53:53.543183 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:53:53.544185 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:53:53.545196 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:53:53.546182 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:53:53.563185 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:53:53.569182 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:53:53.571182 [debug] [Thread-1  ]: finished collecting timing info
22:53:53.571182 [debug] [Thread-2  ]: finished collecting timing info
22:53:53.572183 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:53:53.573183 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:53:53.605184 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:53:53.611212 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:53:53.613183 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:53:53.614183 [debug] [Thread-1  ]: Opening a new connection, currently in state init
22:53:53.620212 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
22:53:53.620212 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
where address_sk is null



      
    ) dbt_internal_test
22:53:55.354080 [debug] [Thread-2  ]: finished collecting timing info
22:53:55.354080 [info ] [Thread-2  ]: 2 of 19 PASS not_null_dim_CreditCards_creditCard_sk............................. [[32mPASS[0m in 1.81s]
22:53:55.356075 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:53:55.357077 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:53:55.358078 [info ] [Thread-2  ]: 3 of 19 START test not_null_dim_Customers_customer_sk........................... [RUN]
22:53:55.359074 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:53:55.360090 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:53:55.361075 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:53:55.367089 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:53:55.369073 [debug] [Thread-2  ]: finished collecting timing info
22:53:55.369073 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:53:55.373076 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:53:55.375076 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:55.382074 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
where customer_sk is null



      
    ) dbt_internal_test
22:53:57.313107 [debug] [Thread-2  ]: finished collecting timing info
22:53:57.314109 [info ] [Thread-2  ]: 3 of 19 PASS not_null_dim_Customers_customer_sk................................. [[32mPASS[0m in 1.96s]
22:53:57.315108 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:53:57.316110 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:53:57.317111 [info ] [Thread-2  ]: 4 of 19 START test not_null_dim_Products_product_sk............................. [RUN]
22:53:57.318113 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:53:57.319109 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:53:57.319109 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:53:57.329109 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:53:57.331108 [debug] [Thread-2  ]: finished collecting timing info
22:53:57.331108 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:53:57.335106 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:53:57.336120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:57.346108 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
22:53:59.424049 [debug] [Thread-2  ]: finished collecting timing info
22:53:59.425045 [info ] [Thread-2  ]: 4 of 19 PASS not_null_dim_Products_product_sk................................... [[32mPASS[0m in 2.11s]
22:53:59.427049 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:53:59.428045 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:53:59.428045 [info ] [Thread-2  ]: 5 of 19 START test not_null_dim_Reasons_reason_sk............................... [RUN]
22:53:59.430045 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:53:59.431066 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:53:59.432047 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:53:59.440049 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:53:59.441048 [debug] [Thread-2  ]: finished collecting timing info
22:53:59.442050 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:53:59.452045 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:53:59.453043 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:59.459043 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
22:54:00.571923 [debug] [Thread-1  ]: finished collecting timing info
22:54:00.572890 [info ] [Thread-1  ]: 1 of 19 PASS not_null_dim_Addresses_address_sk.................................. [[32mPASS[0m in 7.03s]
22:54:00.573889 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:54:00.574888 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:54:00.574888 [info ] [Thread-1  ]: 6 of 19 START test not_null_dim_SalesTerritories_territory_sk................... [RUN]
22:54:00.576890 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:54:00.576890 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:54:00.577888 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:54:00.586891 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:54:00.588910 [debug] [Thread-1  ]: finished collecting timing info
22:54:00.588910 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:54:00.592895 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:54:00.593892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:00.599923 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
22:54:01.402568 [debug] [Thread-2  ]: finished collecting timing info
22:54:01.402568 [info ] [Thread-2  ]: 5 of 19 PASS not_null_dim_Reasons_reason_sk..................................... [[32mPASS[0m in 1.97s]
22:54:01.404571 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:54:01.405567 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:54:01.405567 [info ] [Thread-2  ]: 7 of 19 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk........ [RUN]
22:54:01.407567 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:54:01.408570 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:54:01.408570 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:54:01.414569 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:54:01.416567 [debug] [Thread-2  ]: finished collecting timing info
22:54:01.416567 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:54:01.420569 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:54:01.422567 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:01.429568 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
22:54:02.427616 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.428638 [info ] [Thread-1  ]: 6 of 19 PASS not_null_dim_SalesTerritories_territory_sk......................... [[32mPASS[0m in 1.85s]
22:54:02.429616 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:54:02.430616 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:54:02.431615 [info ] [Thread-1  ]: 8 of 19 START test relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [RUN]
22:54:02.432614 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:54:02.433617 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:54:02.433617 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:54:02.445620 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:54:02.446619 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.447614 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:54:02.449650 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:54:02.451615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:02.457618 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select creditCard_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:54:04.199637 [debug] [Thread-2  ]: finished collecting timing info
22:54:04.200635 [info ] [Thread-2  ]: 7 of 19 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.............. [[32mPASS[0m in 2.79s]
22:54:04.201651 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:54:04.202638 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:54:04.203637 [info ] [Thread-2  ]: 9 of 19 START test relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [RUN]
22:54:04.204642 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:54:04.205645 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:54:04.206636 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:54:04.225635 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:54:04.227636 [debug] [Thread-2  ]: finished collecting timing info
22:54:04.228652 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:54:04.232671 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:54:04.234633 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:04.241634 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:54:05.072478 [debug] [Thread-1  ]: finished collecting timing info
22:54:05.073480 [info ] [Thread-1  ]: 8 of 19 PASS relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [[32mPASS[0m in 2.64s]
22:54:05.074492 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:54:05.075482 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:54:05.076478 [info ] [Thread-1  ]: 10 of 19 START test relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [RUN]
22:54:05.077478 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:54:05.078489 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:54:05.078489 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:54:05.087481 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:54:05.089479 [debug] [Thread-1  ]: finished collecting timing info
22:54:05.089479 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:54:05.092481 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:54:05.094478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:05.099517 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:54:07.026030 [debug] [Thread-2  ]: finished collecting timing info
22:54:07.027030 [info ] [Thread-2  ]: 9 of 19 PASS relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [[32mPASS[0m in 2.82s]
22:54:07.029030 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:54:07.029030 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:54:07.030032 [info ] [Thread-2  ]: 11 of 19 START test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [RUN]
22:54:07.031041 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:54:07.032040 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:54:07.032040 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:54:07.041059 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:54:07.042032 [debug] [Thread-2  ]: finished collecting timing info
22:54:07.042032 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:54:07.046034 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:54:07.048031 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:07.057032 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select reason_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where reason_sk is not null
),

parent as (
    select reason_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:54:07.869321 [debug] [Thread-1  ]: finished collecting timing info
22:54:07.870316 [info ] [Thread-1  ]: 10 of 19 PASS relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [[32mPASS[0m in 2.79s]
22:54:07.872322 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:54:07.872322 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:54:07.873318 [info ] [Thread-1  ]: 12 of 19 START test unique_dim_Addresses_address_sk............................. [RUN]
22:54:07.874316 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:54:07.875315 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:54:07.875315 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:54:07.881320 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reason_sk at [14:11]')
22:54:07.893335 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:54:07.894347 [debug] [Thread-1  ]: finished collecting timing info
22:54:07.895318 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:54:07.902320 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:54:07.903317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:07.910319 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select address_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  where address_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:09.423753 [debug] [Thread-2  ]: finished collecting timing info
22:54:09.424767 [debug] [Thread-2  ]: Database Error in test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ (models\marts\fact_SalesOrdersDetails.yml)
  Unrecognized name: reason_sk at [14:11]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_5151800d8a11236f7eb0e51e9c04d525.sql
22:54:09.425753 [error] [Thread-2  ]: 11 of 19 ERROR relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [[31mERROR[0m in 2.39s]
22:54:09.426754 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:54:09.427756 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:54:09.427756 [info ] [Thread-2  ]: 13 of 19 START test unique_dim_CreditCards_creditCard_sk........................ [RUN]
22:54:09.429753 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:54:09.429753 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:54:09.430754 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:54:09.438789 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:54:09.440754 [debug] [Thread-2  ]: finished collecting timing info
22:54:09.441754 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:54:09.446768 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:54:09.447754 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:09.455754 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:09.865584 [debug] [Thread-1  ]: finished collecting timing info
22:54:09.866593 [info ] [Thread-1  ]: 12 of 19 PASS unique_dim_Addresses_address_sk................................... [[32mPASS[0m in 1.99s]
22:54:09.868571 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:54:09.869567 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:54:09.870567 [info ] [Thread-1  ]: 14 of 19 START test unique_dim_Customers_customer_sk............................ [RUN]
22:54:09.871593 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:54:09.872569 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:54:09.873567 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:54:09.879602 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:54:09.880595 [debug] [Thread-1  ]: finished collecting timing info
22:54:09.881569 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:54:09.884568 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:54:09.886566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:09.894570 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  where customer_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:11.226803 [debug] [Thread-2  ]: finished collecting timing info
22:54:11.226803 [info ] [Thread-2  ]: 13 of 19 PASS unique_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.80s]
22:54:11.228803 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:54:11.228803 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:54:11.229804 [info ] [Thread-2  ]: 15 of 19 START test unique_dim_Products_product_sk.............................. [RUN]
22:54:11.230803 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:54:11.231802 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:54:11.232802 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:54:11.239802 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:54:11.240808 [debug] [Thread-2  ]: finished collecting timing info
22:54:11.241803 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:54:11.255802 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:54:11.256806 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:11.262802 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:11.633744 [debug] [Thread-1  ]: finished collecting timing info
22:54:11.634768 [info ] [Thread-1  ]: 14 of 19 PASS unique_dim_Customers_customer_sk.................................. [[32mPASS[0m in 1.76s]
22:54:11.635756 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:54:11.636741 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:54:11.636741 [info ] [Thread-1  ]: 16 of 19 START test unique_dim_Reasons_reason_sk................................ [RUN]
22:54:11.638747 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:54:11.638747 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:54:11.638747 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:54:11.643745 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:54:11.644745 [debug] [Thread-1  ]: finished collecting timing info
22:54:11.645745 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:54:11.648773 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:54:11.649755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:11.657062 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:13.232089 [debug] [Thread-2  ]: finished collecting timing info
22:54:13.232089 [info ] [Thread-2  ]: 15 of 19 PASS unique_dim_Products_product_sk.................................... [[32mPASS[0m in 2.00s]
22:54:13.234089 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:54:13.235088 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:54:13.236090 [info ] [Thread-2  ]: 17 of 19 START test unique_dim_SalesTerritories_territory_sk.................... [RUN]
22:54:13.237089 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:54:13.238089 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:54:13.238089 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:54:13.244087 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:54:13.246111 [debug] [Thread-2  ]: finished collecting timing info
22:54:13.246111 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:54:13.252091 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:54:13.253087 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:13.261089 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:13.745735 [debug] [Thread-1  ]: finished collecting timing info
22:54:13.745735 [info ] [Thread-1  ]: 16 of 19 PASS unique_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.11s]
22:54:13.747734 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:54:13.748739 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:54:13.748739 [info ] [Thread-1  ]: 18 of 19 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id.......... [RUN]
22:54:13.749738 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:54:13.750737 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:54:13.751735 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:54:13.756753 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:54:13.757734 [debug] [Thread-1  ]: finished collecting timing info
22:54:13.758737 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:54:13.761760 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:54:13.763734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:13.769754 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:15.220157 [debug] [Thread-2  ]: finished collecting timing info
22:54:15.221157 [info ] [Thread-2  ]: 17 of 19 PASS unique_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.98s]
22:54:15.223169 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:54:15.224158 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:54:15.224158 [info ] [Thread-2  ]: 19 of 19 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
22:54:15.226159 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:54:15.226159 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:54:15.227159 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:54:15.301809 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:54:15.303776 [debug] [Thread-2  ]: finished collecting timing info
22:54:15.304775 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:54:15.315795 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:54:15.317774 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:54:15.323780 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:54:16.511541 [debug] [Thread-1  ]: finished collecting timing info
22:54:16.512529 [info ] [Thread-1  ]: 18 of 19 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id................ [[32mPASS[0m in 2.76s]
22:54:16.514521 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:54:17.923652 [debug] [Thread-2  ]: finished collecting timing info
22:54:17.924638 [info ] [Thread-2  ]: 19 of 19 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.70s]
22:54:17.926639 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:54:17.928637 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:54:17.929639 [info ] [MainThread]: 
22:54:17.930640 [info ] [MainThread]: Finished running 19 tests in 24.98s.
22:54:17.932646 [debug] [MainThread]: Connection 'master' was properly closed.
22:54:17.933646 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:54:17.934640 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
22:54:17.935637 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
22:54:17.962639 [info ] [MainThread]: 
22:54:17.988638 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:54:17.990641 [info ] [MainThread]: 
22:54:17.993638 [error] [MainThread]: [33mDatabase Error in test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ (models\marts\fact_SalesOrdersDetails.yml)[0m
22:54:17.995638 [error] [MainThread]:   Unrecognized name: reason_sk at [14:11]
22:54:17.997637 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.yml\relationships_fact_SalesOrders_5151800d8a11236f7eb0e51e9c04d525.sql
22:54:17.999642 [info ] [MainThread]: 
22:54:18.000648 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 TOTAL=19
22:54:18.002641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D2A21B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D1591460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D19171F0>]}


============================== 2022-05-24 22:57:59.419863 | db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f ==============================
22:57:59.419863 [info ] [MainThread]: Running with dbt=1.0.4
22:57:59.420874 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:57:59.420874 [debug] [MainThread]: Tracking: tracking
22:57:59.436862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F79B3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F7B1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F7B1370>]}
22:57:59.619867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
22:57:59.620866 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
22:57:59.621864 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
22:57:59.641863 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
22:57:59.691864 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
22:57:59.693864 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
22:57:59.704867 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
22:57:59.840864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FBBF0D0>]}
22:57:59.864864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F9A7BE0>]}
22:57:59.865873 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:57:59.870868 [info ] [MainThread]: 
22:57:59.872867 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:57:59.875868 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
22:57:59.875868 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:58:00.954496 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:58:00.955548 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:58:01.523370 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:58:01.524371 [info ] [MainThread]: 
22:58:01.532371 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:58:01.532371 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:58:01.533371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:58:01.533371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:58:01.534371 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:58:01.534371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:58:01.535371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:58:01.535371 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:58:01.539371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
22:58:01.544370 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
22:58:01.546373 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.547371 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.547371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
22:58:01.548371 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
22:58:01.549371 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:58:01.549371 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:58:01.550371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:58:01.550371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:58:01.551371 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:58:01.551371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:58:01.552371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:58:01.552371 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:58:01.555371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
22:58:01.559371 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
22:58:01.560371 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.560371 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.561371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
22:58:01.562373 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
22:58:01.563371 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:58:01.564375 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:58:01.564375 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:58:01.565371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:58:01.566371 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:58:01.566371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:58:01.567370 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:58:01.567370 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:58:01.571370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
22:58:01.575371 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
22:58:01.576370 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.577374 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.577374 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
22:58:01.578371 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
22:58:01.579371 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:58:01.580371 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:58:01.580371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:58:01.581371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:58:01.582371 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:58:01.582371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:58:01.582371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:58:01.583371 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:58:01.588370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
22:58:01.591370 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:58:01.592370 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.593372 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
22:58:01.594370 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.594370 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:58:01.595372 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:58:01.596374 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:58:01.597389 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:58:01.597389 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:58:01.598371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:58:01.599371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:58:01.599371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:58:01.604371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:58:01.604371 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:58:01.608371 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:58:01.608371 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.609370 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:58:01.610372 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.610372 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:58:01.611371 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:58:01.611371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:58:01.612371 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:58:01.613371 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:58:01.613371 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:58:01.614373 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:58:01.614373 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:58:01.618370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:58:01.618370 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:58:01.622374 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
22:58:01.622374 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.623375 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:58:01.624379 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.625372 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:58:01.625372 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
22:58:01.626371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:58:01.627372 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:58:01.627372 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:58:01.628372 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:58:01.629374 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:58:01.630371 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:58:01.633370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:58:01.634375 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:58:01.637369 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
22:58:01.638372 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.639371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:58:01.639371 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.640372 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:58:01.641372 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
22:58:01.641372 [info ] [Thread-1  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
22:58:01.642373 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
22:58:01.643371 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:58:01.643371 [info ] [Thread-2  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
22:58:01.644372 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
22:58:01.646375 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
22:58:01.647372 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
22:58:01.647372 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
22:58:01.670370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:58:01.670370 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
22:58:01.697370 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:58:01.698370 [debug] [Thread-1  ]: finished collecting timing info
22:58:01.698370 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
22:58:01.713377 [debug] [Thread-2  ]: finished collecting timing info
22:58:01.714377 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
22:58:01.740372 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
22:58:01.745372 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
22:58:01.746371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:01.747371 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:01.755369 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


22:58:01.756372 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


22:58:02.928260 [debug] [Thread-1  ]: finished collecting timing info
22:58:02.929257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FC28B50>]}
22:58:02.930258 [info ] [Thread-1  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.29s]
22:58:02.931257 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
22:58:02.932264 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:58:02.933258 [info ] [Thread-1  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
22:58:02.934257 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:58:02.935259 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:58:02.935259 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:58:02.968297 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:58:02.970259 [debug] [Thread-1  ]: finished collecting timing info
22:58:02.970259 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:58:03.029281 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:58:03.032275 [debug] [Thread-2  ]: finished collecting timing info
22:58:03.033257 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F6D1A60>]}
22:58:03.033257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:03.034258 [info ] [Thread-2  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.39s]
22:58:03.037259 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
22:58:03.037259 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:58:03.038296 [info ] [Thread-2  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
22:58:03.039257 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:58:03.040277 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:58:03.040277 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:58:03.066259 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:58:03.067258 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,ProductSubcategories.productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,ProductSubcategories.productSubcategory
            ,ProductCategories.productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


22:58:03.069260 [debug] [Thread-2  ]: finished collecting timing info
22:58:03.070258 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:58:03.075257 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:58:03.077257 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:03.084256 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


22:58:04.200966 [debug] [Thread-2  ]: finished collecting timing info
22:58:04.201968 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FAC8790>]}
22:58:04.202981 [info ] [Thread-2  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.16s]
22:58:04.204970 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:58:04.205968 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:58:04.206967 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
22:58:04.209966 [debug] [Thread-1  ]: finished collecting timing info
22:58:04.210981 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:58:04.211968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FAC8C40>]}
22:58:04.212969 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:58:04.213968 [info ] [Thread-1  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.28s]
22:58:04.214762 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:58:04.238747 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:58:04.239763 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:58:04.239763 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
22:58:04.240753 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
22:58:04.241749 [debug] [Thread-2  ]: finished collecting timing info
22:58:04.242748 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
22:58:04.242748 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:58:04.243761 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
22:58:04.248748 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:58:04.249753 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
22:58:04.266747 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:04.280748 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:58:04.282750 [debug] [Thread-1  ]: finished collecting timing info
22:58:04.282750 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
22:58:04.289782 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
22:58:04.290748 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


22:58:04.291756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:04.298748 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


22:58:05.373308 [debug] [Thread-2  ]: finished collecting timing info
22:58:05.374307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FB736A0>]}
22:58:05.375308 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.16s]
22:58:05.376310 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:58:05.463018 [debug] [Thread-1  ]: finished collecting timing info
22:58:05.465018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FC1D2E0>]}
22:58:05.466019 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.22s]
22:58:05.467037 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
22:58:05.469021 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:58:05.470035 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
22:58:05.471019 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:58:05.472030 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:58:05.472030 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:58:05.536021 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:58:05.537020 [debug] [Thread-2  ]: finished collecting timing info
22:58:05.538018 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:58:05.542019 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
22:58:05.544020 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:05.550019 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


22:58:07.088462 [debug] [Thread-2  ]: finished collecting timing info
22:58:07.089460 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27cd7c-6ae9-4fc3-99f4-4f08459d2e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FD0A910>]}
22:58:07.089460 [info ] [Thread-2  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.62s]
22:58:07.091461 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:58:07.093459 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:58:07.094083 [info ] [MainThread]: 
22:58:07.095062 [info ] [MainThread]: Finished running 7 view models in 7.22s.
22:58:07.096067 [debug] [MainThread]: Connection 'master' was properly closed.
22:58:07.097065 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
22:58:07.098062 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:58:07.098062 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
22:58:07.099065 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
22:58:07.129063 [info ] [MainThread]: 
22:58:07.130064 [info ] [MainThread]: [32mCompleted successfully[0m
22:58:07.131062 [info ] [MainThread]: 
22:58:07.133063 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:58:07.134065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756F9A7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FD0A4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FD0A790>]}


============================== 2022-05-24 22:58:15.454105 | 62e9715c-a39d-4b81-8fad-554b4f054671 ==============================
22:58:15.454105 [info ] [MainThread]: Running with dbt=1.0.4
22:58:15.455110 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:58:15.456109 [debug] [MainThread]: Tracking: tracking
22:58:15.470109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F10F2B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F10F2370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F10F2790>]}
22:58:15.631105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:58:15.631105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:58:15.642131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62e9715c-a39d-4b81-8fad-554b4f054671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F13EA0D0>]}
22:58:15.665105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62e9715c-a39d-4b81-8fad-554b4f054671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F1174100>]}
22:58:15.666133 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
22:58:15.673107 [info ] [MainThread]: 
22:58:15.675109 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:58:15.677163 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
22:58:15.678111 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:58:16.238144 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
22:58:16.239146 [info ] [MainThread]: 
22:58:16.248164 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:58:16.248164 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:58:16.249147 [info ] [Thread-1  ]: 1 of 19 START test not_null_dim_Addresses_address_sk............................ [RUN]
22:58:16.249147 [info ] [Thread-2  ]: 2 of 19 START test not_null_dim_CreditCards_creditCard_sk....................... [RUN]
22:58:16.251148 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:58:16.252148 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:58:16.253152 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:58:16.254145 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:58:16.255151 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:58:16.255151 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:58:16.272151 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:58:16.280149 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:58:16.281145 [debug] [Thread-1  ]: finished collecting timing info
22:58:16.282147 [debug] [Thread-2  ]: finished collecting timing info
22:58:16.282147 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:58:16.283145 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:58:16.312145 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
22:58:16.317145 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
22:58:16.319144 [debug] [Thread-1  ]: Opening a new connection, currently in state init
22:58:16.320144 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:58:16.326147 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
where address_sk is null



      
    ) dbt_internal_test
22:58:16.329145 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
22:58:17.931646 [debug] [Thread-2  ]: finished collecting timing info
22:58:17.932659 [info ] [Thread-2  ]: 2 of 19 PASS not_null_dim_CreditCards_creditCard_sk............................. [[32mPASS[0m in 1.68s]
22:58:17.933646 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
22:58:17.934660 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:58:17.935659 [info ] [Thread-2  ]: 3 of 19 START test not_null_dim_Customers_customer_sk........................... [RUN]
22:58:17.936647 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:58:17.936647 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:58:17.937648 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:58:17.942647 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:58:17.943649 [debug] [Thread-2  ]: finished collecting timing info
22:58:17.944651 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:58:17.948649 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
22:58:17.950647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:17.955649 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
where customer_sk is null



      
    ) dbt_internal_test
22:58:18.187488 [debug] [Thread-1  ]: finished collecting timing info
22:58:18.188489 [info ] [Thread-1  ]: 1 of 19 PASS not_null_dim_Addresses_address_sk.................................. [[32mPASS[0m in 1.94s]
22:58:18.189488 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
22:58:18.190484 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:58:18.190484 [info ] [Thread-1  ]: 4 of 19 START test not_null_dim_Products_product_sk............................. [RUN]
22:58:18.192493 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:58:18.192493 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:58:18.193483 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:58:18.200485 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:58:18.201484 [debug] [Thread-1  ]: finished collecting timing info
22:58:18.202483 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:58:18.206500 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
22:58:18.207483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:18.213481 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
22:58:19.777095 [debug] [Thread-2  ]: finished collecting timing info
22:58:19.778080 [info ] [Thread-2  ]: 3 of 19 PASS not_null_dim_Customers_customer_sk................................. [[32mPASS[0m in 1.84s]
22:58:19.780080 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
22:58:19.780080 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:58:19.781083 [info ] [Thread-2  ]: 5 of 19 START test not_null_dim_Reasons_reason_sk............................... [RUN]
22:58:19.783083 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:58:19.783083 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:58:19.784082 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:58:19.791081 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:58:19.792081 [debug] [Thread-2  ]: finished collecting timing info
22:58:19.793082 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:58:19.805080 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
22:58:19.806079 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:19.813081 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
22:58:20.099780 [debug] [Thread-1  ]: finished collecting timing info
22:58:20.100770 [info ] [Thread-1  ]: 4 of 19 PASS not_null_dim_Products_product_sk................................... [[32mPASS[0m in 1.91s]
22:58:20.101775 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
22:58:20.102755 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:58:20.103757 [info ] [Thread-1  ]: 6 of 19 START test not_null_dim_SalesTerritories_territory_sk................... [RUN]
22:58:20.104757 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:58:20.105754 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:58:20.106755 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:58:20.116753 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:58:20.117771 [debug] [Thread-1  ]: finished collecting timing info
22:58:20.118754 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:58:20.122753 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
22:58:20.124755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:20.132755 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
22:58:21.738741 [debug] [Thread-2  ]: finished collecting timing info
22:58:21.739772 [info ] [Thread-2  ]: 5 of 19 PASS not_null_dim_Reasons_reason_sk..................................... [[32mPASS[0m in 1.96s]
22:58:21.740742 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
22:58:21.741743 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:58:21.741743 [info ] [Thread-2  ]: 7 of 19 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk........ [RUN]
22:58:21.743751 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:58:21.743751 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:58:21.744744 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:58:21.751745 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:58:21.752741 [debug] [Thread-2  ]: finished collecting timing info
22:58:21.753744 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:58:21.758747 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
22:58:21.759745 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:21.766742 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
22:58:22.026544 [debug] [Thread-1  ]: finished collecting timing info
22:58:22.027544 [info ] [Thread-1  ]: 6 of 19 PASS not_null_dim_SalesTerritories_territory_sk......................... [[32mPASS[0m in 1.92s]
22:58:22.028550 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
22:58:22.029542 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:58:22.030551 [info ] [Thread-1  ]: 8 of 19 START test relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [RUN]
22:58:22.031541 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:58:22.032543 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:58:22.033544 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:58:22.048579 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:58:22.049608 [debug] [Thread-1  ]: finished collecting timing info
22:58:22.050584 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:58:22.053580 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
22:58:22.055598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:22.062584 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select creditCard_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:58:24.423527 [debug] [Thread-2  ]: finished collecting timing info
22:58:24.424522 [info ] [Thread-2  ]: 7 of 19 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.............. [[32mPASS[0m in 2.68s]
22:58:24.426488 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
22:58:24.426488 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:58:24.427487 [info ] [Thread-2  ]: 9 of 19 START test relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [RUN]
22:58:24.428486 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:58:24.429487 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:58:24.430489 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:58:24.451483 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:58:24.452520 [debug] [Thread-2  ]: finished collecting timing info
22:58:24.453489 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:58:24.456483 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
22:58:24.458495 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:24.463486 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:58:24.787003 [debug] [Thread-1  ]: finished collecting timing info
22:58:24.787989 [info ] [Thread-1  ]: 8 of 19 PASS relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [[32mPASS[0m in 2.76s]
22:58:24.789992 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
22:58:24.790977 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:58:24.790977 [info ] [Thread-1  ]: 10 of 19 START test relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [RUN]
22:58:24.791980 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:58:24.792993 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:58:24.793978 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:58:24.799000 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:58:24.800003 [debug] [Thread-1  ]: finished collecting timing info
22:58:24.800977 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:58:24.803003 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
22:58:24.804000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:24.809004 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:58:26.956575 [debug] [Thread-2  ]: finished collecting timing info
22:58:26.957572 [info ] [Thread-2  ]: 9 of 19 PASS relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [[32mPASS[0m in 2.53s]
22:58:26.959573 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
22:58:26.960574 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:58:26.961574 [info ] [Thread-2  ]: 11 of 19 START test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [RUN]
22:58:26.962577 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:58:26.963576 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:58:26.964575 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:58:26.978575 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:58:26.980575 [debug] [Thread-2  ]: finished collecting timing info
22:58:26.980575 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:58:26.985575 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
22:58:26.987575 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:26.995573 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select reason_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where reason_sk is not null
),

parent as (
    select reason_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:58:27.418691 [debug] [Thread-1  ]: finished collecting timing info
22:58:27.419664 [info ] [Thread-1  ]: 10 of 19 PASS relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [[32mPASS[0m in 2.63s]
22:58:27.421665 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
22:58:27.421665 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:58:27.422666 [info ] [Thread-1  ]: 12 of 19 START test unique_dim_Addresses_address_sk............................. [RUN]
22:58:27.423666 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:58:27.424678 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:58:27.424678 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:58:27.441687 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:58:27.443668 [debug] [Thread-1  ]: finished collecting timing info
22:58:27.443668 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:58:27.450665 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
22:58:27.452675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:27.459666 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select address_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  where address_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:29.346436 [debug] [Thread-1  ]: finished collecting timing info
22:58:29.347473 [info ] [Thread-1  ]: 12 of 19 PASS unique_dim_Addresses_address_sk................................... [[32mPASS[0m in 1.92s]
22:58:29.349435 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
22:58:29.349435 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:58:29.350437 [info ] [Thread-1  ]: 13 of 19 START test unique_dim_CreditCards_creditCard_sk........................ [RUN]
22:58:29.351434 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:58:29.352436 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:58:29.352436 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:58:29.358437 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:58:29.359439 [debug] [Thread-1  ]: finished collecting timing info
22:58:29.360439 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:58:29.364435 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
22:58:29.366851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:29.372884 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:29.761204 [debug] [Thread-2  ]: finished collecting timing info
22:58:29.762206 [info ] [Thread-2  ]: 11 of 19 PASS relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [[32mPASS[0m in 2.80s]
22:58:29.763205 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
22:58:29.764083 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:58:29.765067 [info ] [Thread-2  ]: 14 of 19 START test unique_dim_Customers_customer_sk............................ [RUN]
22:58:29.767088 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:58:29.767088 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:58:29.768069 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:58:29.777068 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:58:29.778068 [debug] [Thread-2  ]: finished collecting timing info
22:58:29.779085 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:58:29.784067 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
22:58:29.785075 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:29.793104 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  where customer_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:31.372689 [debug] [Thread-1  ]: finished collecting timing info
22:58:31.373664 [info ] [Thread-1  ]: 13 of 19 PASS unique_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.02s]
22:58:31.374664 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
22:58:31.375666 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:58:31.375666 [info ] [Thread-1  ]: 15 of 19 START test unique_dim_Products_product_sk.............................. [RUN]
22:58:31.377667 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:58:31.377667 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:58:31.378664 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:58:31.384693 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:58:31.385665 [debug] [Thread-1  ]: finished collecting timing info
22:58:31.386663 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:58:31.402668 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
22:58:31.404671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:31.411663 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:31.751813 [debug] [Thread-2  ]: finished collecting timing info
22:58:31.752812 [info ] [Thread-2  ]: 14 of 19 PASS unique_dim_Customers_customer_sk.................................. [[32mPASS[0m in 1.99s]
22:58:31.753813 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
22:58:31.754815 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:58:31.755816 [info ] [Thread-2  ]: 16 of 19 START test unique_dim_Reasons_reason_sk................................ [RUN]
22:58:31.756824 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:58:31.757815 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:58:31.757815 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:58:31.764813 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:58:31.765817 [debug] [Thread-2  ]: finished collecting timing info
22:58:31.766815 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:58:31.769814 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
22:58:31.770821 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:31.777816 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:33.394951 [debug] [Thread-1  ]: finished collecting timing info
22:58:33.395950 [info ] [Thread-1  ]: 15 of 19 PASS unique_dim_Products_product_sk.................................... [[32mPASS[0m in 2.02s]
22:58:33.396951 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
22:58:33.396951 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:58:33.397951 [info ] [Thread-1  ]: 17 of 19 START test unique_dim_SalesTerritories_territory_sk.................... [RUN]
22:58:33.398950 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:58:33.399951 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:58:33.399951 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:58:33.405954 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:58:33.407956 [debug] [Thread-1  ]: finished collecting timing info
22:58:33.408951 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:58:33.412953 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
22:58:33.413952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:33.419949 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:33.635949 [debug] [Thread-2  ]: finished collecting timing info
22:58:33.636952 [info ] [Thread-2  ]: 16 of 19 PASS unique_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.88s]
22:58:33.638952 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
22:58:33.638952 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:58:33.639953 [info ] [Thread-2  ]: 18 of 19 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id.......... [RUN]
22:58:33.641952 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:58:33.641952 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:58:33.642951 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:58:33.649953 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:58:33.650953 [debug] [Thread-2  ]: finished collecting timing info
22:58:33.651953 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:58:33.655954 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
22:58:33.656952 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:58:33.665949 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:35.237463 [debug] [Thread-1  ]: finished collecting timing info
22:58:35.238473 [info ] [Thread-1  ]: 17 of 19 PASS unique_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.84s]
22:58:35.240468 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
22:58:35.240468 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:58:35.241466 [info ] [Thread-1  ]: 19 of 19 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
22:58:35.242466 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:58:35.243464 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:58:35.244468 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:58:35.328013 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:58:35.329011 [debug] [Thread-1  ]: finished collecting timing info
22:58:35.330011 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:58:35.341011 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
22:58:35.342011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:58:35.348010 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:58:36.305895 [debug] [Thread-2  ]: finished collecting timing info
22:58:36.306900 [info ] [Thread-2  ]: 18 of 19 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id................ [[32mPASS[0m in 2.67s]
22:58:36.307893 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
22:58:38.081575 [debug] [Thread-1  ]: finished collecting timing info
22:58:38.082578 [info ] [Thread-1  ]: 19 of 19 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 2.84s]
22:58:38.084576 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
22:58:38.086575 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:58:38.087578 [info ] [MainThread]: 
22:58:38.088578 [info ] [MainThread]: Finished running 19 tests in 22.41s.
22:58:38.090576 [debug] [MainThread]: Connection 'master' was properly closed.
22:58:38.091577 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
22:58:38.091577 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
22:58:38.092577 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
22:58:38.114576 [info ] [MainThread]: 
22:58:38.115576 [info ] [MainThread]: [32mCompleted successfully[0m
22:58:38.118580 [info ] [MainThread]: 
22:58:38.119577 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
22:58:38.121578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F2579940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F11963A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F264A850>]}


============================== 2022-05-24 23:38:16.612862 | 5e1ac1c5-8541-42ad-973a-f0033ac1cd82 ==============================
23:38:16.612862 [info ] [MainThread]: Running with dbt=1.0.4
23:38:16.613835 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:38:16.613835 [debug] [MainThread]: Tracking: tracking
23:38:16.649584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEA62FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEA62DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEA62820>]}
23:38:16.812627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:38:16.891952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:38:16.903156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EED5A0D0>]}
23:38:16.987163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEB0E190>]}
23:38:17.035211 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
23:38:17.183259 [info ] [MainThread]: 
23:38:17.253034 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:38:17.324540 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
23:38:17.397164 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:18.401280 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
23:38:18.402381 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:18.979749 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
23:38:18.980750 [info ] [MainThread]: 
23:38:18.989917 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
23:38:18.989917 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
23:38:18.990919 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
23:38:18.992122 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
23:38:18.992122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
23:38:18.993121 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
23:38:18.993474 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
23:38:18.993956 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
23:38:18.997471 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses"
23:38:19.001382 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
23:38:19.002579 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.003592 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.004579 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Addresses
23:38:19.005583 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
23:38:19.005583 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
23:38:19.006583 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
23:38:19.007583 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
23:38:19.007583 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
23:38:19.008580 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
23:38:19.008580 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
23:38:19.009580 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
23:38:19.009580 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
23:38:19.012885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
23:38:19.015847 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers"
23:38:19.017856 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.017856 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.018863 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
23:38:19.019850 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customers
23:38:19.020849 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
23:38:19.021850 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
23:38:19.021993 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
23:38:19.023028 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
23:38:19.023994 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
23:38:19.023994 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
23:38:19.024994 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
23:38:19.024994 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
23:38:19.029006 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons"
23:38:19.031991 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories"
23:38:19.033175 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.034177 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.035174 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Persons
23:38:19.036175 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductCategories
23:38:19.036175 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
23:38:19.037174 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:38:19.038175 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
23:38:19.039173 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:38:19.040174 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
23:38:19.040174 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:38:19.041178 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
23:38:19.041178 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:38:19.045437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories"
23:38:19.048441 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:38:19.050418 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.050418 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.051371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_ProductSubcategories
23:38:19.052404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:38:19.053522 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:38:19.053588 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:38:19.054587 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:38:19.055591 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:38:19.055591 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:38:19.056702 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:38:19.057200 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:38:19.057702 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:38:19.060747 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:38:19.062972 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:38:19.064935 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.064935 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.065937 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:38:19.066936 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:38:19.066936 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:38:19.067936 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
23:38:19.068936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:38:19.068936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
23:38:19.069935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:38:19.069935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
23:38:19.070937 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:38:19.070937 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
23:38:19.074935 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:38:19.080937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons"
23:38:19.081935 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.082937 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.083940 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:38:19.084949 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReasons
23:38:19.085938 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:38:19.086940 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
23:38:19.087972 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:38:19.087972 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
23:38:19.088935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:38:19.089362 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
23:38:19.089887 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:38:19.090399 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
23:38:19.092891 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:38:19.096892 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces"
23:38:19.097920 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.098892 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.098892 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:38:19.099905 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_StateProvinces
23:38:19.100919 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
23:38:19.101903 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Customers
23:38:19.102118 [info ] [Thread-2  ]: 1 of 7 START view model AdventureWorks_marts.dim_CreditCards.................... [RUN]
23:38:19.103139 [info ] [Thread-1  ]: 2 of 7 START view model AdventureWorks_marts.dim_Customers...................... [RUN]
23:38:19.104121 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
23:38:19.105180 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
23:38:19.106118 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Customers"
23:38:19.106118 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
23:38:19.107118 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Customers
23:38:19.140041 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
23:38:19.141041 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Customers
23:38:19.159527 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
23:38:19.159527 [debug] [Thread-2  ]: finished collecting timing info
23:38:19.160493 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
23:38:19.172951 [debug] [Thread-1  ]: finished collecting timing info
23:38:19.194448 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
23:38:19.195489 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Customers
23:38:19.199490 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Customers"
23:38:19.200431 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:38:19.201428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:38:19.206466 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final;


23:38:19.207427 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Customers"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Customers as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_customer`
),

Customers as (
    select
        /* Natural Key */
        customerid as customer_id
        /* Foreing Key */
        ,personid as person_id
        ,territoryid as territory_id
        -- ,storeid as store_id
        /* Columns */
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Customers
),  __dbt__cte__stg_AdventureWorks_Persons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_person`
),

Persons as (
    select
        /* Natural Key */
        businessentityid as persons_id
        /* Columms */        
        ,persontype as personType
        ,title
        ,suffix
        ,firstname as firstName
        ,middlename as middleName
        ,lastname as lastName
        ,namestyle as nameStyle
        --,demographics --not useful
        ,emailpromotion as emailPromotion
        ,additionalcontactinfo as additionalContactInfo
        
        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Persons
),Customers as (
        select * from __dbt__cte__stg_AdventureWorks_Customers 
    ),

    Persons as (
        select * from __dbt__cte__stg_AdventureWorks_Persons
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(customer_id as 
    string
), '') as 
    string
))) as customer_sk --hashed surrogate key
            /* Natural Key */
            ,customer_id
            /* Foreing Key */
            ,Customers.person_id
            ,territory_id
            /* Columms */ 
            ,personType
            ,title
            ,suffix
            ,firstName
            ,middleName
            ,lastName
            ,nameStyle
            ,emailPromotion
            ,additionalContactInfo
        from Customers

        left join Persons on Customers.person_id = Persons.persons_id
    )

select * from final;


23:38:20.390443 [debug] [Thread-2  ]: finished collecting timing info
23:38:20.391450 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEE37970>]}
23:38:20.391450 [info ] [Thread-2  ]: 1 of 7 OK created view model AdventureWorks_marts.dim_CreditCards............... [[32mOK[0m in 1.29s]
23:38:20.393721 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
23:38:20.394688 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:38:20.395706 [info ] [Thread-2  ]: 3 of 7 START view model AdventureWorks_marts.dim_Products....................... [RUN]
23:38:20.396556 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:38:20.396556 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:38:20.397568 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:38:20.422221 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:38:20.424257 [debug] [Thread-1  ]: finished collecting timing info
23:38:20.425220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EED976A0>]}
23:38:20.425220 [info ] [Thread-1  ]: 2 of 7 OK created view model AdventureWorks_marts.dim_Customers................. [[32mOK[0m in 1.32s]
23:38:20.425220 [debug] [Thread-2  ]: finished collecting timing info
23:38:20.426847 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:38:20.429895 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:38:20.430857 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Customers
23:38:20.431857 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:38:20.432866 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:38:20.433868 [info ] [Thread-1  ]: 4 of 7 START view model AdventureWorks_marts.dim_Reasons........................ [RUN]
23:38:20.435857 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:38:20.436863 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:38:20.436863 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:38:20.454860 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:38:20.456859 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,source.name as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,source.weight as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),  __dbt__cte__stg_AdventureWorks_ProductSubcategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productsubcategory`
),

ProductSubcategory as (
    select
        /* Natural Key */
        productsubcategoryid as productSubcategory_id
        /* Foreing Key */
        ,productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productSubcategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductSubcategory
),  __dbt__cte__stg_AdventureWorks_ProductCategories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_productcategory`
),

ProductCategories as (
    select
        /* Natural Key */
        productcategoryid as productCategory_id
        /* Columms */
        ,source.name as productCategory

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from ProductCategories
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),

    ProductSubcategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductSubcategories 
    ),

    ProductCategories as (
        select * from __dbt__cte__stg_AdventureWorks_ProductCategories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,ProductSubcategories.productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
            ,ProductSubcategories.productSubcategory
            ,ProductCategories.productCategory
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
        from Products

        left join ProductSubcategories on Products.productSubcategory_id = ProductSubcategories.productSubcategory_id
        left join ProductCategories on ProductSubcategories.productCategory_id = ProductCategories.productCategory_id
    )

select * from final;


23:38:20.458861 [debug] [Thread-1  ]: finished collecting timing info
23:38:20.463856 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:38:20.473859 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:38:20.477860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:38:20.484858 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesReasons as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,source.name as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReasons as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReasons 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(SalesReasons.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesReasons.salesReason_id
            /* Foreing Key */
            salesOrder_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReasons

        left join SalesOrderSalesReason on SalesReasons.salesReason_id = SalesOrderSalesReason.salesReason_id
    )

select * from final;


23:38:21.720412 [debug] [Thread-2  ]: finished collecting timing info
23:38:21.721379 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEEBEF70>]}
23:38:21.721379 [info ] [Thread-2  ]: 3 of 7 OK created view model AdventureWorks_marts.dim_Products.................. [[32mOK[0m in 1.32s]
23:38:21.723606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:38:21.723606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:38:21.724631 [info ] [Thread-2  ]: 5 of 7 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
23:38:21.725602 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:38:21.726617 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:38:21.726617 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:38:21.744862 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:38:21.746825 [debug] [Thread-1  ]: finished collecting timing info
23:38:21.747827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEE5CCA0>]}
23:38:21.748826 [info ] [Thread-1  ]: 4 of 7 OK created view model AdventureWorks_marts.dim_Reasons................... [[32mOK[0m in 1.31s]
23:38:21.749856 [debug] [Thread-2  ]: finished collecting timing info
23:38:21.750287 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:38:21.755545 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:38:21.755545 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:38:21.756544 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Addresses
23:38:21.757544 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:38:21.758544 [info ] [Thread-1  ]: 6 of 7 START view model AdventureWorks_marts.dim_Addresses...................... [RUN]
23:38:21.759581 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Addresses"
23:38:21.760542 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Addresses
23:38:21.760542 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Addresses
23:38:21.778577 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
23:38:21.778577 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as territoryName
        ,source.group as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


23:38:21.780548 [debug] [Thread-1  ]: finished collecting timing info
23:38:21.781544 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Addresses
23:38:21.784840 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Addresses"
23:38:21.788018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:38:21.792207 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Addresses: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Addresses"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_Addresses as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_address`
),

Addresses as (
    select
        /* Natural Key */
        addressid as address_id
        /* Foreing Key */
        ,stateprovinceid as stateProvince_id 
        /* Columms */
        ,postalcode as postalCode
        ,addressline1 as addressLine1
        ,addressline2 as addressLine2
        ,city
        ,spatiallocation as spatialLocation

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from Addresses
),  __dbt__cte__stg_AdventureWorks_StateProvinces as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_stateprovince`
),

StateProvinces as (
    select
        /* Natural Key */
        stateprovinceid as stateProvince_id
        /* Foreing Key */
        ,territoryid as territory_id 
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as provinceName
        ,stateprovincecode as stateProvinceCode
        ,isonlystateprovinceflag as isOnlyStateProvinceFlag

        ,rowguid
        ,modifieddate as modifiedDate
    from source
)

select * from StateProvinces
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,source.name as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),Addresses as (
        select * from __dbt__cte__stg_AdventureWorks_Addresses 
    ),

    StateProvinces as (
        select * from __dbt__cte__stg_AdventureWorks_StateProvinces 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(address_id as 
    string
), '') as 
    string
))) as address_sk --hashed surrogate key
            /* Natural Key */
            ,address_id
            /* Columms */ 
            ,postalCode
            ,addressLine1
            ,addressLine2
            ,city
            ,spatialLocation

            ,provinceName
            ,stateProvinceCode
            ,isOnlyStateProvinceFlag

            ,countryName
        from Addresses

        left join StateProvinces on Addresses.stateProvince_id = StateProvinces.stateProvince_id
        left join CountryRegions on StateProvinces.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final;


23:38:22.900271 [debug] [Thread-2  ]: finished collecting timing info
23:38:22.901270 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EFEE73D0>]}
23:38:22.902448 [info ] [Thread-2  ]: 5 of 7 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.18s]
23:38:22.903450 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:38:22.966808 [debug] [Thread-1  ]: finished collecting timing info
23:38:22.967771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EFF28DF0>]}
23:38:22.968772 [info ] [Thread-1  ]: 6 of 7 OK created view model AdventureWorks_marts.dim_Addresses................. [[32mOK[0m in 1.21s]
23:38:22.969770 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Addresses
23:38:22.970772 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:38:22.971770 [info ] [Thread-2  ]: 7 of 7 START view model AdventureWorks_marts.fact_SalesOrdersDetails............ [RUN]
23:38:22.973010 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:38:22.973010 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:38:22.974013 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:38:23.014942 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:38:23.016446 [debug] [Thread-2  ]: finished collecting timing info
23:38:23.016446 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:38:23.019454 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:38:23.021458 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:38:23.025840 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        ,billtoaddressid as billToAddress_id
        /* Columns */
        ,source.status as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderdetailid as salesOrderDetail_id
        ,salesorderid as salesOrder_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_Addresses as (
        select
            address_sk
            ,address_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
    ),


    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),

    dim_Customers as (
        select
            customer_sk
            ,customer_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            ,customer_sk
            ,billToAddress_id
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            --,SalesOrders.rowguid
            --,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
        left join dim_Customers on SalesOrders.customer_id = dim_Customers.customer_id
    )

select * from final;


23:38:24.325650 [debug] [Thread-2  ]: finished collecting timing info
23:38:24.325650 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1ac1c5-8541-42ad-973a-f0033ac1cd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EFEE7100>]}
23:38:24.326650 [info ] [Thread-2  ]: 7 of 7 OK created view model AdventureWorks_marts.fact_SalesOrdersDetails....... [[32mOK[0m in 1.35s]
23:38:24.328653 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:38:24.330651 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:38:24.330651 [info ] [MainThread]: 
23:38:24.331683 [info ] [MainThread]: Finished running 7 view models in 7.08s.
23:38:24.332772 [debug] [MainThread]: Connection 'master' was properly closed.
23:38:24.333773 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
23:38:24.333773 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
23:38:24.333773 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Addresses' was properly closed.
23:38:24.334772 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
23:38:24.352304 [info ] [MainThread]: 
23:38:24.354312 [info ] [MainThread]: [32mCompleted successfully[0m
23:38:24.356307 [info ] [MainThread]: 
23:38:24.357309 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:38:24.358307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EED490A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEA2C700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EEEC6160>]}


============================== 2022-05-24 23:57:24.685851 | 2ff8dcee-a24c-4825-9607-650d8c8d468e ==============================
23:57:24.685851 [info ] [MainThread]: Running with dbt=1.0.4
23:57:24.686852 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
23:57:24.687853 [debug] [MainThread]: Tracking: tracking
23:57:24.701856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029455492940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029455492790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029455492280>]}
23:57:24.872500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:57:24.873363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:57:24.884937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ff8dcee-a24c-4825-9607-650d8c8d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945578A0D0>]}
23:57:24.906943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ff8dcee-a24c-4825-9607-650d8c8d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294555131F0>]}
23:57:24.907937 [info ] [MainThread]: Found 21 models, 19 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
23:57:24.912938 [info ] [MainThread]: 
23:57:24.913939 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:24.916938 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
23:57:24.917938 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:26.116941 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
23:57:26.117949 [info ] [MainThread]: 
23:57:26.126943 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
23:57:26.126943 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
23:57:26.127944 [info ] [Thread-1  ]: 1 of 19 START test not_null_dim_Addresses_address_sk............................ [RUN]
23:57:26.128947 [info ] [Thread-2  ]: 2 of 19 START test not_null_dim_CreditCards_creditCard_sk....................... [RUN]
23:57:26.129946 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
23:57:26.131944 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
23:57:26.131944 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
23:57:26.132945 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
23:57:26.133947 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
23:57:26.133947 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
23:57:26.151943 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
23:57:26.157947 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
23:57:26.158945 [debug] [Thread-1  ]: finished collecting timing info
23:57:26.159964 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
23:57:26.159964 [debug] [Thread-2  ]: finished collecting timing info
23:57:26.188947 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"
23:57:26.189947 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
23:57:26.192978 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
23:57:26.193980 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:57:26.195942 [debug] [Thread-2  ]: Opening a new connection, currently in state init
23:57:26.201972 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
where address_sk is null



      
    ) dbt_internal_test
23:57:26.203942 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
23:57:27.879622 [debug] [Thread-2  ]: finished collecting timing info
23:57:27.880624 [info ] [Thread-2  ]: 2 of 19 PASS not_null_dim_CreditCards_creditCard_sk............................. [[32mPASS[0m in 1.75s]
23:57:27.881622 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
23:57:27.882623 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
23:57:27.883623 [info ] [Thread-2  ]: 3 of 19 START test not_null_dim_Customers_customer_sk........................... [RUN]
23:57:27.884622 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
23:57:27.884622 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
23:57:27.885625 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
23:57:27.890646 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
23:57:27.892619 [debug] [Thread-2  ]: finished collecting timing info
23:57:27.893628 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
23:57:27.896619 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"
23:57:27.897626 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:27.903627 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
where customer_sk is null



      
    ) dbt_internal_test
23:57:28.182641 [debug] [Thread-1  ]: finished collecting timing info
23:57:28.183644 [info ] [Thread-1  ]: 1 of 19 PASS not_null_dim_Addresses_address_sk.................................. [[32mPASS[0m in 2.05s]
23:57:28.184644 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Addresses_address_sk.f4dbb5e14f
23:57:28.185642 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
23:57:28.185642 [info ] [Thread-1  ]: 4 of 19 START test not_null_dim_Products_product_sk............................. [RUN]
23:57:28.187644 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
23:57:28.187644 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
23:57:28.187644 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
23:57:28.193671 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
23:57:28.195644 [debug] [Thread-1  ]: finished collecting timing info
23:57:28.195644 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
23:57:28.198647 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
23:57:28.199693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:28.205680 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
23:57:29.931167 [debug] [Thread-2  ]: finished collecting timing info
23:57:29.931167 [info ] [Thread-2  ]: 3 of 19 PASS not_null_dim_Customers_customer_sk................................. [[32mPASS[0m in 2.05s]
23:57:29.933402 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Customers_customer_sk.8fd4593094
23:57:29.934405 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
23:57:29.934405 [info ] [Thread-2  ]: 5 of 19 START test not_null_dim_Reasons_reason_sk............................... [RUN]
23:57:29.936415 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
23:57:29.936415 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
23:57:29.937395 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
23:57:29.943397 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
23:57:29.944399 [debug] [Thread-2  ]: finished collecting timing info
23:57:29.945398 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
23:57:29.954399 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
23:57:29.955402 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:29.961397 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
23:57:30.083298 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.084335 [info ] [Thread-1  ]: 4 of 19 PASS not_null_dim_Products_product_sk................................... [[32mPASS[0m in 1.90s]
23:57:30.086296 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
23:57:30.087297 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
23:57:30.087297 [info ] [Thread-1  ]: 6 of 19 START test not_null_dim_SalesTerritories_territory_sk................... [RUN]
23:57:30.089297 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
23:57:30.090301 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
23:57:30.090301 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
23:57:30.100300 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
23:57:30.102326 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.102326 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
23:57:30.105296 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
23:57:30.106295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:30.111298 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
23:57:31.923131 [debug] [Thread-1  ]: finished collecting timing info
23:57:31.924092 [info ] [Thread-1  ]: 6 of 19 PASS not_null_dim_SalesTerritories_territory_sk......................... [[32mPASS[0m in 1.83s]
23:57:31.926093 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
23:57:31.926093 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
23:57:31.927094 [info ] [Thread-1  ]: 7 of 19 START test not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk........ [RUN]
23:57:31.928094 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
23:57:31.929093 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
23:57:31.929093 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
23:57:31.934118 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
23:57:31.936093 [debug] [Thread-1  ]: finished collecting timing info
23:57:31.936093 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
23:57:31.940131 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"
23:57:31.941093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:31.947129 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
where salesOrdersDetais_sk is null



      
    ) dbt_internal_test
23:57:31.956993 [debug] [Thread-2  ]: finished collecting timing info
23:57:31.957994 [info ] [Thread-2  ]: 5 of 19 PASS not_null_dim_Reasons_reason_sk..................................... [[32mPASS[0m in 2.02s]
23:57:31.959994 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
23:57:31.959994 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
23:57:31.961009 [info ] [Thread-2  ]: 8 of 19 START test relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [RUN]
23:57:31.962995 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
23:57:31.962995 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
23:57:31.964006 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
23:57:31.974048 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
23:57:31.975026 [debug] [Thread-2  ]: finished collecting timing info
23:57:31.975993 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
23:57:31.980029 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"
23:57:31.980996 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:31.989994 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select creditCard_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where creditCard_sk is not null
),

parent as (
    select creditCard_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
23:57:34.761355 [debug] [Thread-1  ]: finished collecting timing info
23:57:34.762392 [info ] [Thread-1  ]: 7 of 19 PASS not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.............. [[32mPASS[0m in 2.83s]
23:57:34.763390 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_fact_SalesOrdersDetails_salesOrdersDetais_sk.5654f742f4
23:57:34.764353 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
23:57:34.764353 [info ] [Thread-1  ]: 9 of 19 START test relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [RUN]
23:57:34.766352 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
23:57:34.766352 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
23:57:34.767352 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
23:57:34.784388 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
23:57:34.785371 [debug] [Thread-1  ]: finished collecting timing info
23:57:34.786365 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
23:57:34.790359 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"
23:57:34.791352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:34.796380 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
23:57:35.380281 [debug] [Thread-2  ]: finished collecting timing info
23:57:35.401498 [info ] [Thread-2  ]: 8 of 19 PASS relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_ [[32mPASS[0m in 3.44s]
23:57:35.403513 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_creditCard_sk__creditCard_sk__ref_dim_CreditCards_.84527a1169
23:57:35.404521 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
23:57:35.404521 [info ] [Thread-2  ]: 10 of 19 START test relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [RUN]
23:57:35.406506 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
23:57:35.407495 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
23:57:35.407495 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
23:57:35.415496 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
23:57:35.417494 [debug] [Thread-2  ]: finished collecting timing info
23:57:35.417494 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
23:57:35.420494 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"
23:57:35.421494 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:35.426499 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
23:57:37.606632 [debug] [Thread-1  ]: finished collecting timing info
23:57:37.607658 [info ] [Thread-1  ]: 9 of 19 PASS relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_ [[32mPASS[0m in 2.84s]
23:57:37.609638 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_customer_sk__customer_sk__ref_dim_Customers_.0355c26e12
23:57:37.610632 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
23:57:37.610632 [info ] [Thread-1  ]: 11 of 19 START test relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [RUN]
23:57:37.612633 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
23:57:37.612633 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
23:57:37.613653 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
23:57:37.620635 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
23:57:37.621632 [debug] [Thread-1  ]: finished collecting timing info
23:57:37.622634 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
23:57:37.625647 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"
23:57:37.627638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:37.634633 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select reason_sk as from_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
    where reason_sk is not null
),

parent as (
    select reason_sk as to_field
    from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
23:57:38.560778 [debug] [Thread-2  ]: finished collecting timing info
23:57:38.561775 [info ] [Thread-2  ]: 10 of 19 PASS relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_ [[32mPASS[0m in 3.16s]
23:57:38.562777 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_product_sk__product_sk__ref_dim_Products_.3bd5c498da
23:57:38.563789 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
23:57:38.564777 [info ] [Thread-2  ]: 12 of 19 START test unique_dim_Addresses_address_sk............................. [RUN]
23:57:38.565788 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
23:57:38.566778 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
23:57:38.566778 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
23:57:38.581777 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
23:57:38.583777 [debug] [Thread-2  ]: finished collecting timing info
23:57:38.584775 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
23:57:38.590775 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"
23:57:38.592783 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:38.601781 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select address_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Addresses`
  where address_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:40.415504 [debug] [Thread-1  ]: finished collecting timing info
23:57:40.415504 [info ] [Thread-1  ]: 11 of 19 PASS relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_ [[32mPASS[0m in 2.80s]
23:57:40.417504 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.relationships_fact_SalesOrdersDetails_reason_sk__reason_sk__ref_dim_Reasons_.a6d97d04f1
23:57:40.418502 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
23:57:40.418502 [info ] [Thread-1  ]: 13 of 19 START test unique_dim_CreditCards_creditCard_sk........................ [RUN]
23:57:40.420503 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
23:57:40.420503 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
23:57:40.421504 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
23:57:40.428504 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
23:57:40.429503 [debug] [Thread-1  ]: finished collecting timing info
23:57:40.430507 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
23:57:40.434505 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
23:57:40.436502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:40.443506 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:41.846229 [debug] [Thread-2  ]: finished collecting timing info
23:57:41.847228 [info ] [Thread-2  ]: 12 of 19 PASS unique_dim_Addresses_address_sk................................... [[32mPASS[0m in 3.28s]
23:57:41.849229 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Addresses_address_sk.c07bd6247a
23:57:41.850231 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
23:57:41.850231 [info ] [Thread-2  ]: 14 of 19 START test unique_dim_Customers_customer_sk............................ [RUN]
23:57:41.852230 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
23:57:41.852230 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
23:57:41.853230 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
23:57:41.860235 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
23:57:41.861230 [debug] [Thread-2  ]: finished collecting timing info
23:57:41.862232 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
23:57:41.865229 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"
23:57:41.867229 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:41.873228 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Customers`
  where customer_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:42.365323 [debug] [Thread-1  ]: finished collecting timing info
23:57:42.366301 [info ] [Thread-1  ]: 13 of 19 PASS unique_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.95s]
23:57:42.367307 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
23:57:42.368302 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
23:57:42.369304 [info ] [Thread-1  ]: 15 of 19 START test unique_dim_Products_product_sk.............................. [RUN]
23:57:42.370303 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
23:57:42.371301 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
23:57:42.372304 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
23:57:42.380305 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
23:57:42.381332 [debug] [Thread-1  ]: finished collecting timing info
23:57:42.381332 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
23:57:42.390308 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
23:57:42.392310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:42.398331 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:43.763578 [debug] [Thread-2  ]: finished collecting timing info
23:57:43.764579 [info ] [Thread-2  ]: 14 of 19 PASS unique_dim_Customers_customer_sk.................................. [[32mPASS[0m in 1.91s]
23:57:43.765583 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Customers_customer_sk.ffb823a6c0
23:57:43.766579 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
23:57:43.767578 [info ] [Thread-2  ]: 16 of 19 START test unique_dim_Reasons_reason_sk................................ [RUN]
23:57:43.768581 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
23:57:43.769579 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
23:57:43.769579 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
23:57:43.775578 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
23:57:43.776577 [debug] [Thread-2  ]: finished collecting timing info
23:57:43.777582 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
23:57:43.780578 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
23:57:43.781578 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:43.786613 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:44.313601 [debug] [Thread-1  ]: finished collecting timing info
23:57:44.314594 [info ] [Thread-1  ]: 15 of 19 PASS unique_dim_Products_product_sk.................................... [[32mPASS[0m in 1.94s]
23:57:44.315601 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
23:57:44.316559 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
23:57:44.316559 [info ] [Thread-1  ]: 17 of 19 START test unique_dim_SalesTerritories_territory_sk.................... [RUN]
23:57:44.317559 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
23:57:44.318558 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
23:57:44.318558 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
23:57:44.324559 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
23:57:44.325565 [debug] [Thread-1  ]: finished collecting timing info
23:57:44.326560 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
23:57:44.328558 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
23:57:44.330566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:44.335596 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:45.863439 [debug] [Thread-2  ]: finished collecting timing info
23:57:45.864440 [info ] [Thread-2  ]: 16 of 19 PASS unique_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.10s]
23:57:45.865484 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
23:57:45.866442 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
23:57:45.867453 [info ] [Thread-2  ]: 18 of 19 START test unique_fact_SalesOrdersDetails_salesOrderDetail_id.......... [RUN]
23:57:45.868382 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
23:57:45.868382 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
23:57:45.869395 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
23:57:45.874419 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
23:57:45.875437 [debug] [Thread-2  ]: finished collecting timing info
23:57:45.876395 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
23:57:45.880395 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"
23:57:45.881395 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:57:45.887417 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrderDetail_id as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrderDetail_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:46.215445 [debug] [Thread-1  ]: finished collecting timing info
23:57:46.216453 [info ] [Thread-1  ]: 17 of 19 PASS unique_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.90s]
23:57:46.218448 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
23:57:46.218448 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
23:57:46.219446 [info ] [Thread-1  ]: 19 of 19 START test unique_fact_SalesOrdersDetails_salesOrdersDetais_sk......... [RUN]
23:57:46.220446 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
23:57:46.220446 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
23:57:46.221446 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
23:57:46.302482 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
23:57:46.304449 [debug] [Thread-1  ]: finished collecting timing info
23:57:46.304449 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
23:57:46.312444 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"
23:57:46.313445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:57:46.318443 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select salesOrdersDetais_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  where salesOrdersDetais_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
23:57:48.691248 [debug] [Thread-2  ]: finished collecting timing info
23:57:48.692287 [info ] [Thread-2  ]: 18 of 19 PASS unique_fact_SalesOrdersDetails_salesOrderDetail_id................ [[32mPASS[0m in 2.82s]
23:57:48.694247 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555
23:57:49.535826 [debug] [Thread-1  ]: finished collecting timing info
23:57:49.536827 [info ] [Thread-1  ]: 19 of 19 PASS unique_fact_SalesOrdersDetails_salesOrdersDetais_sk............... [[32mPASS[0m in 3.32s]
23:57:49.538795 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c
23:57:49.540789 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:49.541827 [info ] [MainThread]: 
23:57:49.542788 [info ] [MainThread]: Finished running 19 tests in 24.63s.
23:57:49.544424 [debug] [MainThread]: Connection 'master' was properly closed.
23:57:49.545424 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
23:57:49.545424 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrdersDetais_sk.cc1c40261c' was properly closed.
23:57:49.546423 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_fact_SalesOrdersDetails_salesOrderDetail_id.5cd4664555' was properly closed.
23:57:49.562425 [info ] [MainThread]: 
23:57:49.565426 [info ] [MainThread]: [32mCompleted successfully[0m
23:57:49.590425 [info ] [MainThread]: 
23:57:49.591424 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
23:57:49.592459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945576C6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945576C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029455535A30>]}
