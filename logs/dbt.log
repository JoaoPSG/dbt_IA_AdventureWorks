

============================== 2022-04-24 19:35:21.321929 | 7899179d-1776-4c66-88ca-71467985ee8d ==============================
19:35:21.321929 [info ] [MainThread]: Running with dbt=1.0.4
19:35:21.322914 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
19:35:21.324912 [debug] [MainThread]: Tracking: tracking
19:35:21.342915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F531233C40>]}
19:35:21.362912 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
19:35:21.362912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7899179d-1776-4c66-88ca-71467985ee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5312430A0>]}
19:35:21.665913 [debug] [MainThread]: Parsing macros\adapters.sql
19:35:21.692913 [debug] [MainThread]: Parsing macros\catalog.sql
19:35:21.698914 [debug] [MainThread]: Parsing macros\etc.sql
19:35:21.700915 [debug] [MainThread]: Parsing macros\materializations\copy.sql
19:35:21.703914 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
19:35:21.720915 [debug] [MainThread]: Parsing macros\materializations\seed.sql
19:35:21.723914 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
19:35:21.725914 [debug] [MainThread]: Parsing macros\materializations\table.sql
19:35:21.729913 [debug] [MainThread]: Parsing macros\materializations\view.sql
19:35:21.733914 [debug] [MainThread]: Parsing macros\adapters\columns.sql
19:35:21.743915 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
19:35:21.747913 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
19:35:21.753912 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
19:35:21.769912 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
19:35:21.775915 [debug] [MainThread]: Parsing macros\adapters\relation.sql
19:35:21.785915 [debug] [MainThread]: Parsing macros\adapters\schema.sql
19:35:21.788915 [debug] [MainThread]: Parsing macros\etc\datetime.sql
19:35:21.797914 [debug] [MainThread]: Parsing macros\etc\statement.sql
19:35:21.802913 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
19:35:21.804915 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
19:35:21.805916 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
19:35:21.806915 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
19:35:21.807915 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
19:35:21.809914 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
19:35:21.811914 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
19:35:21.814915 [debug] [MainThread]: Parsing macros\materializations\configs.sql
19:35:21.817915 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
19:35:21.822914 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
19:35:21.827915 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
19:35:21.838914 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
19:35:21.839915 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
19:35:21.852226 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
19:35:21.868215 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
19:35:21.872219 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
19:35:21.880215 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
19:35:21.883216 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
19:35:21.886216 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
19:35:21.888215 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
19:35:21.896217 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
19:35:21.913213 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
19:35:21.920213 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
19:35:21.939215 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
19:35:21.957215 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
19:35:21.959218 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
19:35:21.979243 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
19:35:21.982245 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
19:35:21.988215 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
19:35:21.991218 [debug] [MainThread]: Parsing tests\generic\builtin.sql
19:35:22.245249 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_CreditCard.sql
19:35:22.264232 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
19:35:22.268216 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
19:35:22.273213 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
19:35:22.277213 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
19:35:22.281215 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
19:35:22.285214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
19:35:22.290215 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
19:35:22.294214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
19:35:22.297214 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
19:35:22.300212 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
19:35:22.303211 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
19:35:22.383214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BC970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5313BCEE0>]}


============================== 2022-04-24 20:26:21.186495 | 0c4f3b28-9007-403d-8310-8dd09fff71b5 ==============================
20:26:21.186495 [info ] [MainThread]: Running with dbt=1.0.4
20:26:21.187495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
20:26:21.188497 [debug] [MainThread]: Tracking: tracking
20:26:21.223495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001249232D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492331DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124923312E0>]}
20:26:22.290769 [debug] [MainThread]: Executing "git --help"
20:26:22.396768 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
20:26:22.397768 [debug] [MainThread]: STDERR: "b''"
20:26:22.402769 [debug] [MainThread]: Acquiring new bigquery connection "debug"
20:26:22.403769 [debug] [MainThread]: Opening a new connection, currently in state init
20:26:22.418767 [debug] [MainThread]: On debug: select 1 as id
20:26:23.892504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001249016E2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124A3052B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124A3052340>]}
20:26:24.621151 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-04-25 13:36:42.181084 | c7e512cf-ba70-44bf-bf92-57d8b87dc842 ==============================
13:36:42.181084 [info ] [MainThread]: Running with dbt=1.0.4
13:36:42.183057 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:36:42.183057 [debug] [MainThread]: Tracking: tracking
13:36:42.198056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D23E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D233D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D23C40>]}
13:36:42.217060 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:36:42.218091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7e512cf-ba70-44bf-bf92-57d8b87dc842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54D732E0>]}
13:36:42.516084 [debug] [MainThread]: Parsing macros\adapters.sql
13:36:42.541075 [debug] [MainThread]: Parsing macros\catalog.sql
13:36:42.547090 [debug] [MainThread]: Parsing macros\etc.sql
13:36:42.549090 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:36:42.552090 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:36:42.567084 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:36:42.570084 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:36:42.572087 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:36:42.576090 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:36:42.579057 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:36:42.589090 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:36:42.593090 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:36:42.596092 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:36:42.603092 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:36:42.608083 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:36:42.618095 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:36:42.621090 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:36:42.629090 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:36:42.634090 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:36:42.636090 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:36:42.637056 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:36:42.638056 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:36:42.639055 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:36:42.641054 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:36:42.644055 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:36:42.646090 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:36:42.649092 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:36:42.654089 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:36:42.659055 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:36:42.670090 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:36:42.671090 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:36:42.683092 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:36:42.698084 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:36:42.701084 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:36:42.709090 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:36:42.712090 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:36:42.714090 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:36:42.716091 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:36:42.723090 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:36:42.739084 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:36:42.746084 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:36:42.757084 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:36:42.770055 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:36:42.772061 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:36:42.789090 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:36:42.792086 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:36:42.796090 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:36:42.799090 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:36:43.005070 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_CreditCard.sql
13:36:43.018081 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:36:43.021090 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:36:43.024054 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:36:43.028084 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:36:43.031084 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:36:43.034090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:36:43.037055 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:36:43.041066 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
13:36:43.044090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
13:36:43.047092 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:36:43.049092 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:36:43.052090 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:36:43.114088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B54EAF9A0>]}


============================== 2022-04-25 13:37:44.521613 | 0077e611-be19-45e9-b9fe-9babadd40927 ==============================
13:37:44.521613 [info ] [MainThread]: Running with dbt=1.0.4
13:37:44.522614 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:37:44.523615 [debug] [MainThread]: Tracking: tracking
13:37:44.537619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF469E1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03AC0>]}
13:37:44.537619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A038B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46A03130>]}


============================== 2022-04-25 13:38:10.280942 | db920e06-469e-42b9-ba24-1267682ea14a ==============================
13:38:10.280942 [info ] [MainThread]: Running with dbt=1.0.4
13:38:10.281941 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
13:38:10.282944 [debug] [MainThread]: Tracking: tracking
13:38:10.311952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774895B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489EB0>]}
13:38:10.314952 [debug] [MainThread]: Set downloads directory='C:\Users\jpedr\AppData\Local\Temp\dbt-downloads-3_jtrqln'
13:38:10.315940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
13:38:11.554041 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
13:38:11.555070 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
13:38:11.668077 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
13:38:11.692076 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
13:38:11.838630 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
13:38:11.839621 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
13:38:12.220763 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
13:38:12.243798 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
13:38:12.402793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
13:38:12.403791 [info ] [MainThread]: Installing dbt-labs/dbt_utils
13:38:13.355635 [info ] [MainThread]:   Installed from version 0.8.4
13:38:13.356637 [info ] [MainThread]:   Up to date!
13:38:13.357634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db920e06-469e-42b9-ba24-1267682ea14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774DE9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146774DE3A0>]}
13:38:13.359634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677489A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014677506220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146775062B0>]}


============================== 2022-04-25 13:39:06.555110 | b64a9cb8-2a45-41a2-89a7-d3ec49bb4c68 ==============================
13:39:06.555110 [info ] [MainThread]: Running with dbt=1.0.4
13:39:06.556137 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:39:06.556137 [debug] [MainThread]: Tracking: tracking
13:39:06.570086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E698E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E6C4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E6C45E0>]}
13:39:06.592092 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:39:06.594099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b64a9cb8-2a45-41a2-89a7-d3ec49bb4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E719280>]}
13:39:07.014556 [debug] [MainThread]: Parsing macros\adapters.sql
13:39:07.041553 [debug] [MainThread]: Parsing macros\catalog.sql
13:39:07.047557 [debug] [MainThread]: Parsing macros\etc.sql
13:39:07.049553 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:39:07.052553 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:39:07.067553 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:39:07.070553 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:39:07.072553 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:39:07.077553 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:39:07.080553 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:39:07.089552 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:39:07.093581 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:39:07.096553 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:39:07.103553 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:39:07.108553 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:39:07.117553 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:39:07.120553 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:39:07.128553 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:39:07.133553 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:39:07.135581 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:39:07.136560 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:39:07.137553 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:39:07.138554 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:39:07.140553 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:39:07.142553 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:39:07.145553 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:39:07.147553 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:39:07.152562 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:39:07.157553 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:39:07.167552 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:39:07.170553 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:39:07.181551 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:39:07.196552 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:39:07.200552 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:39:07.207553 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:39:07.210552 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:39:07.213552 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:39:07.214553 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:39:07.222584 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:39:07.238583 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:39:07.245553 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:39:07.256553 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:39:07.268564 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:39:07.270555 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:39:07.287553 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:39:07.289553 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:39:07.294553 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:39:07.297555 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:39:07.301555 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
13:39:07.302555 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
13:39:07.304555 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
13:39:07.306555 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
13:39:07.308555 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
13:39:07.312554 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
13:39:07.319553 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
13:39:07.322553 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
13:39:07.333554 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
13:39:07.334555 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
13:39:07.336553 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
13:39:07.338554 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
13:39:07.340553 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
13:39:07.342553 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
13:39:07.344553 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
13:39:07.348552 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
13:39:07.350553 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
13:39:07.359553 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
13:39:07.360553 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
13:39:07.362553 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
13:39:07.364553 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
13:39:07.366553 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
13:39:07.369553 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
13:39:07.371552 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
13:39:07.377553 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
13:39:07.379553 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
13:39:07.380554 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
13:39:07.383553 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
13:39:07.385553 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
13:39:07.387553 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
13:39:07.402552 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
13:39:07.405552 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
13:39:07.407553 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
13:39:07.409553 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
13:39:07.420552 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
13:39:07.422552 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
13:39:07.424553 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
13:39:07.426552 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
13:39:07.428552 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
13:39:07.431552 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
13:39:07.434551 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
13:39:07.436553 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
13:39:07.437554 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
13:39:07.442554 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
13:39:07.443555 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
13:39:07.445554 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
13:39:07.446554 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
13:39:07.448553 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
13:39:07.472553 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
13:39:07.476552 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
13:39:07.480552 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
13:39:07.484551 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
13:39:07.490553 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
13:39:07.493551 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
13:39:07.496551 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
13:39:07.499553 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
13:39:07.503553 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
13:39:07.510553 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
13:39:07.512553 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
13:39:07.514553 [debug] [MainThread]: Parsing macros\sql\groupby.sql
13:39:07.516552 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
13:39:07.522552 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
13:39:07.524553 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
13:39:07.526553 [debug] [MainThread]: Parsing macros\sql\pivot.sql
13:39:07.530553 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
13:39:07.532553 [debug] [MainThread]: Parsing macros\sql\star.sql
13:39:07.536553 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
13:39:07.540553 [debug] [MainThread]: Parsing macros\sql\union.sql
13:39:07.550554 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
13:39:07.559553 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
13:39:07.562553 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
13:39:07.564553 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
13:39:07.943583 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:39:07.972553 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:39:07.974553 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:39:07.978557 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:39:07.981558 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:39:07.984584 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:39:07.987593 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:39:07.990594 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:39:07.993590 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:39:07.995590 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetail.sql
13:39:07.998563 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderHeader.sql
13:39:08.001553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:39:08.004553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:39:08.007553 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:39:08.076553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E8F0DF0>]}


============================== 2022-04-25 13:43:05.011676 | 8f7603df-9049-48dc-be9c-86c67fa05acc ==============================
13:43:05.011676 [info ] [MainThread]: Running with dbt=1.0.4
13:43:05.011676 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:05.012676 [debug] [MainThread]: Tracking: tracking
13:43:05.026677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8984EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8995AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A89957F0>]}
13:43:05.047674 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:43:05.047674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A89D6280>]}
13:43:05.159674 [debug] [MainThread]: Parsing macros\adapters.sql
13:43:05.183674 [debug] [MainThread]: Parsing macros\catalog.sql
13:43:05.188675 [debug] [MainThread]: Parsing macros\etc.sql
13:43:05.190675 [debug] [MainThread]: Parsing macros\materializations\copy.sql
13:43:05.193675 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
13:43:05.208675 [debug] [MainThread]: Parsing macros\materializations\seed.sql
13:43:05.211675 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
13:43:05.213675 [debug] [MainThread]: Parsing macros\materializations\table.sql
13:43:05.217675 [debug] [MainThread]: Parsing macros\materializations\view.sql
13:43:05.220675 [debug] [MainThread]: Parsing macros\adapters\columns.sql
13:43:05.231675 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
13:43:05.234675 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
13:43:05.238675 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
13:43:05.245675 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
13:43:05.251675 [debug] [MainThread]: Parsing macros\adapters\relation.sql
13:43:05.263677 [debug] [MainThread]: Parsing macros\adapters\schema.sql
13:43:05.268677 [debug] [MainThread]: Parsing macros\etc\datetime.sql
13:43:05.277675 [debug] [MainThread]: Parsing macros\etc\statement.sql
13:43:05.282675 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
13:43:05.283676 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
13:43:05.284675 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
13:43:05.285675 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
13:43:05.287675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
13:43:05.288675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
13:43:05.290675 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
13:43:05.293674 [debug] [MainThread]: Parsing macros\materializations\configs.sql
13:43:05.296674 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
13:43:05.300675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
13:43:05.305676 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
13:43:05.316674 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
13:43:05.318675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
13:43:05.329675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
13:43:05.345675 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
13:43:05.348674 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
13:43:05.355674 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
13:43:05.358675 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
13:43:05.361675 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
13:43:05.362675 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
13:43:05.370675 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
13:43:05.386674 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
13:43:05.392674 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
13:43:05.403768 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
13:43:05.414675 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
13:43:05.416675 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
13:43:05.433674 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
13:43:05.435675 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
13:43:05.440674 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
13:43:05.442675 [debug] [MainThread]: Parsing tests\generic\builtin.sql
13:43:05.445675 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
13:43:05.447675 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
13:43:05.449686 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
13:43:05.451676 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
13:43:05.453676 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
13:43:05.457675 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
13:43:05.463677 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
13:43:05.466675 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
13:43:05.475674 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
13:43:05.477676 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
13:43:05.479675 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
13:43:05.481676 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
13:43:05.483675 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
13:43:05.485674 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
13:43:05.487675 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
13:43:05.491675 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
13:43:05.492676 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
13:43:05.501674 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
13:43:05.503676 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
13:43:05.504676 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
13:43:05.506676 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
13:43:05.509675 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
13:43:05.511674 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
13:43:05.513674 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
13:43:05.519674 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
13:43:05.521674 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
13:43:05.522675 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
13:43:05.525674 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
13:43:05.526675 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
13:43:05.529674 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
13:43:05.533675 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
13:43:05.535675 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
13:43:05.537675 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
13:43:05.539675 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
13:43:05.548674 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
13:43:05.551674 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
13:43:05.553674 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
13:43:05.555674 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
13:43:05.557675 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
13:43:05.560674 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
13:43:05.563676 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
13:43:05.566676 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
13:43:05.567677 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
13:43:05.572676 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
13:43:05.573676 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
13:43:05.575676 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
13:43:05.577675 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
13:43:05.579675 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
13:43:05.606677 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
13:43:05.611678 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
13:43:05.614678 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
13:43:05.619678 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
13:43:05.624678 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
13:43:05.627679 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
13:43:05.630675 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
13:43:05.634675 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
13:43:05.637675 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
13:43:05.645675 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
13:43:05.647675 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
13:43:05.649688 [debug] [MainThread]: Parsing macros\sql\groupby.sql
13:43:05.651676 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
13:43:05.657674 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
13:43:05.660674 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
13:43:05.662675 [debug] [MainThread]: Parsing macros\sql\pivot.sql
13:43:05.667711 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
13:43:05.669712 [debug] [MainThread]: Parsing macros\sql\star.sql
13:43:05.673711 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
13:43:05.677675 [debug] [MainThread]: Parsing macros\sql\union.sql
13:43:05.688675 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
13:43:05.696674 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
13:43:05.698675 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
13:43:05.700675 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
13:43:06.089677 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:43:06.118679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:43:06.120679 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Product.sql
13:43:06.123679 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
13:43:06.126712 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_SalesTerritory.sql
13:43:06.129711 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
13:43:06.132693 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:43:06.135711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:43:06.138711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:43:06.141713 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:43:06.143711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:43:06.146712 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:43:06.149677 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:43:06.152711 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:43:06.263675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8C860A0>]}
13:43:06.279676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f7603df-9049-48dc-be9c-86c67fa05acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8C86130>]}
13:43:06.279676 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
13:43:06.282681 [info ] [MainThread]: 
13:43:06.284679 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:06.286682 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:06.286682 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:07.389955 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:07.391957 [info ] [MainThread]: 
13:43:07.452480 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.452480 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.454474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:07.455477 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:07.456478 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.456478 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.457476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.458476 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.461476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:07.466477 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:07.471476 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.471476 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.472477 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:07.473475 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:07.474474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.475475 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.476474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:07.477485 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:07.478474 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.478474 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.479474 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.480476 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.488474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:07.493473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:07.495473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.496474 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:07.496474 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.497475 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.498473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:07.499476 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:07.499476 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.500477 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.501474 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:07.502490 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.503473 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.507474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:07.508474 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.513473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:07.513473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.515474 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:07.515474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.516481 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.517474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:07.518512 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:07.518512 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.519473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.520483 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.521474 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:07.524471 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:07.525481 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.526473 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.530506 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:07.530506 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.531472 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:07.532473 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.533478 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.534472 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:07.535473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:07.535473 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.536473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.537479 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.538487 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Product"
13:43:07.559472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:07.560472 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.561473 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Product
13:43:07.589473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
13:43:07.590471 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.591475 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.591475 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.592473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.592473 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.593473 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:07.593473 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.594473 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.595496 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Product
13:43:07.596473 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:07.596473 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.597472 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.598473 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:07.599475 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.599475 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.616473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:07.617474 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.630473 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:07.630473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.631474 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.631474 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.632474 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.633477 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:07.634473 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.635472 [debug] [Thread-2  ]: finished collecting timing info
13:43:07.636473 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:07.637472 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.638474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:07.639472 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.639472 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.671472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:07.707472 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.707472 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.708473 [debug] [Thread-1  ]: finished collecting timing info
13:43:07.708473 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:07.710473 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:07.710473 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:07.711473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:07.711473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:07.723473 [info ] [MainThread]: Done.
13:43:07.724472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D625E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D62A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155A8D62A30>]}


============================== 2022-04-25 14:44:23.610395 | 80cf16fe-adee-4842-995a-9caa6ad05295 ==============================
14:44:23.610395 [info ] [MainThread]: Running with dbt=1.0.4
14:44:23.611396 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:44:23.612397 [debug] [MainThread]: Tracking: tracking
14:44:23.627397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001784766DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847673700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847673220>]}
14:44:23.753432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:44:23.753432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:44:23.762435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178478A90D0>]}
14:44:23.776396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178477DD280>]}
14:44:23.777397 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:44:23.780397 [info ] [MainThread]: 
14:44:23.781401 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:44:23.783398 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:44:23.784413 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:44:24.891575 [debug] [ThreadPool]: Acquiring new bigquery connection "create_valid-sol-346522_AdventureWorks_marts"
14:44:24.892571 [debug] [ThreadPool]: Acquiring new bigquery connection "create_valid-sol-346522_AdventureWorks_marts"
14:44:24.893573 [debug] [ThreadPool]: BigQuery adapter: Creating schema "valid-sol-346522.AdventureWorks_marts".
14:44:24.893573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:44:25.932788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:44:25.932788 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:44:26.742033 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:44:26.742033 [info ] [MainThread]: 
14:44:26.750032 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.750032 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.751039 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:44:26.751039 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:44:26.752031 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.753031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.753031 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.754042 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.758029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:44:26.761029 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:44:26.762922 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.763928 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:44:26.763928 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.764917 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.765918 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:44:26.765918 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:44:26.766919 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.766919 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.767956 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:44:26.767956 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.768918 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.770917 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.776947 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:44:26.780917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:44:26.782247 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.782247 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.783251 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:44:26.783251 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:44:26.784234 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.785232 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.786267 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:44:26.786267 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:44:26.787232 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.787232 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.788231 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.788231 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.793231 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:44:26.796016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:44:26.797037 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.798016 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.799047 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:44:26.799047 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:44:26.800018 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.801022 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.801022 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:44:26.802058 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:44:26.803039 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.803039 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.803733 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.804232 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.807245 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:44:26.810280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:44:26.812242 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.812242 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.813253 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:44:26.813253 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:44:26.814277 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.815263 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.816242 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:44:26.817254 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Product....................... [RUN]
14:44:26.818246 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.819245 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.819245 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.820242 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.820242 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.821261 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Product
14:44:26.861278 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.877278 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.879248 [debug] [Thread-2  ]: finished collecting timing info
14:44:26.879248 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:26.880253 [debug] [Thread-1  ]: finished collecting timing info
14:44:26.913280 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:44:26.913280 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Product
14:44:26.917277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Product"
14:44:26.920180 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:44:26.921181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:44:26.927211 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by creditCard_id) as reason_sk --auto incremental surrogate key
            ,to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as reason_sk_test
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:44:26.927211 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Product: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Product"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Product`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        "name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by product_id) as product_sk --auto incremental surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:44:27.814761 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got string literal "name" at [23:9]')
14:44:29.181571 [debug] [Thread-1  ]: finished collecting timing info
14:44:29.182603 [debug] [Thread-1  ]: Database Error in model dim_Product (models\marts\dim_Product.sql)
  Syntax error: Expected ")" but got string literal "name" at [23:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Product.sql
14:44:29.182603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479283D0>]}
14:44:29.183603 [error] [Thread-1  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Product.............. [[31mERROR[0m in 2.36s]
14:44:29.184567 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Product
14:44:29.185564 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.186568 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:44:29.187567 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.187567 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.188577 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.199594 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.200982 [debug] [Thread-1  ]: finished collecting timing info
14:44:29.200982 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:29.203991 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:44:29.204993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:44:29.210991 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by salesReason_id) as Reason_sk --auto incremental surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:44:30.983668 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name salesReason_id is ambiguous at [55:41]')
14:44:31.073862 [debug] [Thread-2  ]: finished collecting timing info
14:44:31.073862 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178478EB460>]}
14:44:31.074864 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.26s]
14:44:31.076829 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:44:31.077829 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.077829 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:44:31.079829 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.079829 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.079829 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.095827 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.096828 [debug] [Thread-2  ]: finished collecting timing info
14:44:31.097827 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:31.102826 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:44:31.103827 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:44:31.109827 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by territory_id) as territory_sk --auto incremental surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:44:31.901154 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:44:32.954042 [debug] [Thread-1  ]: finished collecting timing info
14:44:32.955032 [debug] [Thread-1  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Column name salesReason_id is ambiguous at [55:41]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:44:32.955032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847972520>]}
14:44:32.956076 [error] [Thread-1  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.77s]
14:44:32.958034 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:44:33.223673 [debug] [Thread-2  ]: finished collecting timing info
14:44:33.224668 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:44:33.225631 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80cf16fe-adee-4842-995a-9caa6ad05295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017847972FA0>]}
14:44:33.225631 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.15s]
14:44:33.227632 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:44:33.228630 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:44:33.229629 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:44:33.230682 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:44:33.232696 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:44:33.233698 [info ] [MainThread]: 
14:44:33.234696 [info ] [MainThread]: Finished running 5 table models in 9.45s.
14:44:33.236694 [debug] [MainThread]: Connection 'master' was properly closed.
14:44:33.236694 [debug] [MainThread]: Connection 'create_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:44:33.237696 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:44:33.237696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:44:33.238702 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:44:33.251693 [info ] [MainThread]: 
14:44:33.252693 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:44:33.254699 [info ] [MainThread]: 
14:44:33.255698 [error] [MainThread]: [33mDatabase Error in model dim_Product (models\marts\dim_Product.sql)[0m
14:44:33.257698 [error] [MainThread]:   Syntax error: Expected ")" but got string literal "name" at [23:9]
14:44:33.258701 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Product.sql
14:44:33.259694 [info ] [MainThread]: 
14:44:33.260707 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:44:33.262696 [error] [MainThread]:   Column name salesReason_id is ambiguous at [55:41]
14:44:33.263698 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:44:33.265695 [info ] [MainThread]: 
14:44:33.266693 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:44:33.267700 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:44:33.269704 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:44:33.270708 [info ] [MainThread]: 
14:44:33.271706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:44:33.272694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479DDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178479DDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178477D5AF0>]}


============================== 2022-04-25 14:52:11.510518 | aa3e762f-84b9-4684-a97a-0ad64fd642ab ==============================
14:52:11.510518 [info ] [MainThread]: Running with dbt=1.0.4
14:52:11.512520 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:52:11.513519 [debug] [MainThread]: Tracking: tracking
14:52:11.529520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF34C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DCF3040>]}
14:52:11.725516 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
14:52:11.726520 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
14:52:11.727518 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_Product.sql
14:52:11.728525 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:52:11.729519 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
14:52:11.730520 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:52:11.752520 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Products.sql
14:52:11.773516 [debug] [MainThread]: 1699: static parser successfully parsed marts\fact_SalesOrdersDetails.sql
14:52:11.777517 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:52:11.781519 [debug] [MainThread]: 1699: static parser successfully parsed marts\dim_Reasons.sql
14:52:11.799518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa3e762f-84b9-4684-a97a-0ad64fd642ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DF790D0>]}
14:52:11.814519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa3e762f-84b9-4684-a97a-0ad64fd642ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3DE45B80>]}
14:52:11.815518 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:52:11.817518 [info ] [MainThread]: 
14:52:11.818517 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:11.820518 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:11.820518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:12.786643 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:12.788645 [info ] [MainThread]: 
14:52:12.797644 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.797644 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.798643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:12.799641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:12.800642 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.800642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.801642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.802642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.806642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:12.810642 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:12.811643 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.812643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.813644 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:12.814644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:12.814644 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.815642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.815642 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:12.816641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:12.817643 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.818642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.818642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.819642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.822641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:12.826646 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:12.828645 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.829643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.829643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:12.831642 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:12.831642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.832644 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.833642 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:12.834641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:12.835641 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.835641 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.836642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.836642 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.839641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:12.842641 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:12.844644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.844644 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.845643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:12.846643 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:12.847642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.847642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.848644 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:12.849643 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:12.850642 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.850642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.851641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.851641 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.855643 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:12.859643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:12.861643 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.861643 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.862642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:12.863641 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:12.864641 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.865642 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.866643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:12.866643 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:12.867641 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.867641 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.868641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.868641 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:12.915640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:12.935643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:12.937645 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.937645 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.938644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.939642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:12.940648 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.941643 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:12.941643 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.942643 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.963642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:12.964642 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.964642 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.965644 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.965644 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.966643 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.967642 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:12.968641 [debug] [Thread-1  ]: finished collecting timing info
14:52:12.968641 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.969642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:12.970642 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:12.971643 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.971643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.993643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:12.995645 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.996653 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:12.997658 [debug] [Thread-2  ]: finished collecting timing info
14:52:12.999644 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:13.000643 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.001648 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:13.002646 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.003643 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.076644 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:13.078645 [debug] [Thread-1  ]: finished collecting timing info
14:52:13.078645 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.079643 [debug] [Thread-1  ]: finished collecting timing info
14:52:13.080643 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:13.082642 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:13.083643 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:13.084643 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:52:13.084643 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:52:13.163643 [info ] [MainThread]: Done.
14:52:13.165643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3E0C1FA0>]}


============================== 2022-04-25 14:52:48.736862 | 74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d ==============================
14:52:48.736862 [info ] [MainThread]: Running with dbt=1.0.4
14:52:48.737874 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:52:48.738834 [debug] [MainThread]: Tracking: tracking
14:52:48.752833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C50E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C74B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65C74F70>]}
14:52:48.867831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:52:48.867831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:52:48.874831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EAA0D0>]}
14:52:48.886831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65DDD2B0>]}
14:52:48.887832 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:52:48.890833 [info ] [MainThread]: 
14:52:48.891833 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:48.893832 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:52:48.894832 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:49.482232 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:49.483260 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:50.107754 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:50.108796 [info ] [MainThread]: 
14:52:50.116790 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.116790 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.117760 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:50.119758 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:50.120774 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.120774 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.121762 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.122761 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.125757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:52:50.128789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:50.129764 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.130755 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:52:50.131774 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.131774 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.132768 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:50.133771 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:50.133771 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.134752 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.135760 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:50.136759 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.137763 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.140781 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:50.141755 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.145757 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:50.145757 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.147753 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:50.147753 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.147753 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.148752 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:50.149753 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:50.150769 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.150769 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.151765 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:50.152757 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.153759 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.157798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:50.157798 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.161789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:50.161789 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.162783 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:50.163756 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.163756 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.164757 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:50.165756 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:50.165756 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.166756 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.167755 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:50.167755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.168754 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.172757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:50.173762 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.176789 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:52:50.177752 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.177752 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:50.178758 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.178758 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.179768 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:52:50.180753 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:52:50.180753 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.182758 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.182758 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:52:50.183754 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.184754 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.185757 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.185757 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.224797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.224797 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:50.242792 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.242792 [debug] [Thread-1  ]: finished collecting timing info
14:52:50.243773 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:50.244776 [debug] [Thread-2  ]: finished collecting timing info
14:52:50.258791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:50.259788 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:50.284788 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:50.286755 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:50.293783 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by product_id) as product_sk --auto incremental surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:52:50.858602 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:52:50.859576 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by creditCard_id) as reason_sk --auto incremental surrogate key
            ,to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as reason_sk_test
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:52:51.618301 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellstartdatsellStartDate at [79:14]')
14:52:52.924521 [debug] [Thread-2  ]: finished collecting timing info
14:52:52.925514 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellstartdatsellStartDate at [79:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:52:52.926531 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65F3DA90>]}
14:52:52.927523 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.74s]
14:52:52.929533 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:52.930523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.930523 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:52:52.932518 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.933516 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.934514 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.946513 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.947514 [debug] [Thread-2  ]: finished collecting timing info
14:52:52.948513 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:52.952523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:52.953516 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:52.959533 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            row_number() over (order by SalesOrderSalesReason.salesReason_id) as Reason_sk --auto incremental surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:52:54.168864 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name salesorderid not found inside SalesOrderSalesReason at [57:36]')
14:52:54.766361 [debug] [Thread-1  ]: finished collecting timing info
14:52:54.767328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B66FB7F70>]}
14:52:54.767328 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.58s]
14:52:54.770350 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:52:54.770350 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.771364 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:52:54.772331 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.773330 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.773330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.788329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.790331 [debug] [Thread-1  ]: finished collecting timing info
14:52:54.790331 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:54.793366 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:52:54.795327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:54.800365 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            row_number() over (order by territory_id) as territory_sk --auto incremental surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:52:55.756815 [debug] [Thread-2  ]: finished collecting timing info
14:52:55.757814 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Name salesorderid not found inside SalesOrderSalesReason at [57:36]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:52:55.757814 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B670215E0>]}
14:52:55.758816 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.83s]
14:52:55.759815 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:56.491177 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:52:57.545131 [debug] [Thread-1  ]: finished collecting timing info
14:52:57.545131 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:52:57.546124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a4d7b6-9523-4bdf-aa3c-2508fd8b4b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EFF850>]}
14:52:57.546124 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.77s]
14:52:57.548093 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:52:57.549092 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:57.550126 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:52:57.552093 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:57.553093 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:57.554117 [info ] [MainThread]: 
14:52:57.555092 [info ] [MainThread]: Finished running 5 table models in 8.66s.
14:52:57.556092 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:57.556092 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:52:57.557091 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:57.557091 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:52:57.558097 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:52:57.568109 [info ] [MainThread]: 
14:52:57.569111 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:52:57.571130 [info ] [MainThread]: 
14:52:57.572104 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:52:57.573104 [error] [MainThread]:   Unrecognized name: sellstartdatsellStartDate at [79:14]
14:52:57.575102 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:52:57.576093 [info ] [MainThread]: 
14:52:57.578093 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:52:57.579092 [error] [MainThread]:   Name salesorderid not found inside SalesOrderSalesReason at [57:36]
14:52:57.580112 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:52:57.582091 [info ] [MainThread]: 
14:52:57.582091 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:52:57.584103 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:52:57.585090 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:52:57.586096 [info ] [MainThread]: 
14:52:57.587090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:52:57.588091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65DD53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65FDC1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B65EF1C70>]}


============================== 2022-04-26 13:43:46.349726 | 1ee67fab-0ee4-44ec-89a9-0dfc96feee47 ==============================
13:43:46.349726 [info ] [MainThread]: Running with dbt=1.0.4
13:43:46.350728 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:46.351724 [debug] [MainThread]: Tracking: tracking
13:43:46.367723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BD1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BF3CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426BF38B0>]}
13:43:47.206810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
13:43:47.208811 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
13:43:47.208811 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
13:43:47.209819 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
13:43:47.210813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
13:43:47.211813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
13:43:47.211813 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
13:43:47.212812 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
13:43:47.212812 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
13:43:47.213815 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
13:43:47.213815 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritory.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
13:43:47.214811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:43:47.215811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
13:43:47.215811 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:43:47.229811 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:43:47.266848 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:43:47.269833 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCard.sql
13:43:47.275834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCard.sql
13:43:47.277839 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCard.sql
13:43:47.281839 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritory.sql
13:43:47.287850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritory.sql
13:43:47.289817 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
13:43:47.292850 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:43:47.295851 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:43:47.302814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:43:47.304814 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:43:47.307838 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:43:47.311829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:43:47.315842 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:43:47.322840 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:43:47.324849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:43:47.327817 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:43:47.405606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ee67fab-0ee4-44ec-89a9-0dfc96feee47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426F010D0>]}
13:43:47.417571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ee67fab-0ee4-44ec-89a9-0dfc96feee47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426DFE070>]}
13:43:47.418585 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:43:47.420572 [info ] [MainThread]: 
13:43:47.421574 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:47.424572 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:47.425572 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:48.890504 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:48.890504 [info ] [MainThread]: 
13:43:48.937901 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.937901 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.938899 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:48.938899 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:48.939923 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.939923 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.940900 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.940900 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.944903 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:48.948904 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:48.949905 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.950917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:48.951905 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.951905 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.952902 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:48.953906 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:48.954924 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.954924 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.955902 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:48.956901 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.957140 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.960503 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:48.961504 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.965020 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:48.965020 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.965981 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:48.967019 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.967019 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.967984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:48.968994 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:48.968994 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.969984 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.970983 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.970983 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:48.974017 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:48.975001 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.975001 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.975985 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.978983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:48.979994 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:48.980990 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.981994 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:48.981994 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.981994 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.982984 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:48.982984 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.983982 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.987020 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:48.987985 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:48.988377 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.989403 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.989403 [debug] [Thread-1  ]: finished collecting timing info
13:43:48.992423 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:48.993390 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:48.994303 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.995330 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:48.996317 [debug] [Thread-2  ]: finished collecting timing info
13:43:48.996317 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.997314 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:48.997314 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:48.998313 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.014620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:49.015055 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:43:49.015614 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.016625 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:43:49.023658 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.035631 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:43:49.035631 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:49.036561 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.037570 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:49.038580 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.038580 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.039585 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.040585 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:49.040585 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.041573 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.041573 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:43:49.042571 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.043571 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.056571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:49.056571 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:49.057586 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.058570 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.058570 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.070569 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:49.071574 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.072571 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.073594 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.074590 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:49.074590 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.075573 [debug] [Thread-2  ]: finished collecting timing info
13:43:49.077573 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:49.078573 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.079749 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:49.079749 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.080772 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.111772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:49.112773 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.112773 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.113773 [debug] [Thread-1  ]: finished collecting timing info
13:43:49.114775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:49.116774 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:49.116774 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:49.117778 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:49.117778 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:49.128807 [info ] [MainThread]: Done.
13:43:49.129773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427056850>]}


============================== 2022-04-26 13:43:53.929832 | 8971f773-2c09-4152-a2e9-3cece4d245f2 ==============================
13:43:53.929832 [info ] [MainThread]: Running with dbt=1.0.4
13:43:53.930819 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
13:43:53.930819 [debug] [MainThread]: Tracking: tracking
13:43:53.946835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BCE0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BD04130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BD04370>]}
13:43:54.115819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:43:54.116817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:43:54.124818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8971f773-2c09-4152-a2e9-3cece4d245f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF460D0>]}
13:43:54.136818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8971f773-2c09-4152-a2e9-3cece4d245f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF0C5E0>]}
13:43:54.136818 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:43:54.139820 [info ] [MainThread]: 
13:43:54.141821 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:43:54.144820 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:43:54.144820 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:43:55.205532 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:43:55.206521 [info ] [MainThread]: 
13:43:55.214523 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.214523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.215541 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:55.216519 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:55.216519 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.217546 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.218532 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.218532 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.222539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
13:43:55.226525 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
13:43:55.227525 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.228533 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.229520 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
13:43:55.230524 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
13:43:55.230524 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.231522 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.232520 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:55.233519 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:55.233519 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.234525 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.234525 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.235522 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.238545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
13:43:55.241519 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
13:43:55.243522 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.243522 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.244521 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
13:43:55.245521 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
13:43:55.246522 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.246522 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.247519 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:55.248521 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:55.248521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.249520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.250520 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.251521 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.254520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
13:43:55.259558 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
13:43:55.260521 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.261524 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.262540 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
13:43:55.263536 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
13:43:55.264521 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.264521 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.265521 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:55.266558 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:55.267521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.267521 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.268521 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.268521 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.271557 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
13:43:55.274556 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
13:43:55.275529 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.276519 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.276519 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
13:43:55.277519 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
13:43:55.278521 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.279526 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.279526 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:55.280577 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
13:43:55.281520 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.281520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.282539 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.282539 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
13:43:55.315555 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
13:43:55.332555 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
13:43:55.334519 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.335520 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.335520 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.336520 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.336520 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.337530 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
13:43:55.338522 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.338522 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.339535 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
13:43:55.340523 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:55.340523 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.341534 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.342540 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:55.342540 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.343520 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.356545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
13:43:55.356545 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.371518 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
13:43:55.372518 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.372518 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.373519 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.373519 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.374525 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
13:43:55.375521 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.376533 [debug] [Thread-2  ]: finished collecting timing info
13:43:55.377523 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
13:43:55.378530 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.378530 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:55.379529 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.379529 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.416522 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
13:43:55.417523 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.417523 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.418522 [debug] [Thread-1  ]: finished collecting timing info
13:43:55.419538 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
13:43:55.420565 [debug] [MainThread]: Connection 'master' was properly closed.
13:43:55.421555 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:43:55.421555 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
13:43:55.422519 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
13:43:55.432519 [info ] [MainThread]: Done.
13:43:55.433520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF0C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF16520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6BF16490>]}


============================== 2022-04-26 14:27:13.437528 | 656e4bb5-35b4-4b73-a7eb-6de8acc96e03 ==============================
14:27:13.437528 [info ] [MainThread]: Running with dbt=1.0.4
14:27:13.440526 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:27:13.440526 [debug] [MainThread]: Tracking: tracking
14:27:13.457528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA2DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFA33B20>]}
14:27:13.654528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:27:13.654528 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:27:13.668527 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:27:13.711528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:27:13.731527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCDEF10>]}
14:27:13.749526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFC479D0>]}
14:27:13.749526 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:27:13.752530 [info ] [MainThread]: 
14:27:13.753530 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:13.755528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:27:13.756529 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:16.416209 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:16.417210 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:17.184209 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:17.185209 [info ] [MainThread]: 
14:27:17.196212 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.196212 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.198214 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:27:17.199211 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:17.199211 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.200211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.200211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.201210 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.207215 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:27:17.212216 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:17.214211 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.215213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.215213 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:27:17.216211 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:17.217213 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.218211 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.219210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:17.220212 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:17.221214 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.222211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.222211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.223213 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.226214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:17.229209 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:17.230209 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.231213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.232214 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:17.233212 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:17.234210 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.235216 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.235216 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:17.236214 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:17.237226 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.238210 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.238210 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.239209 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.242213 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:17.246210 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:17.248209 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.249213 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:17.249213 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.249213 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.250213 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:17.251210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:17.252222 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.252222 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.253212 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:27:17.254210 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.254210 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.257211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:17.258216 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.262219 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:27:17.262219 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.263210 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:17.264211 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.264211 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.265210 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:27:17.266210 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:27:17.267221 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.268210 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:27:17.268210 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:17.270213 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.270213 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.271211 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.271211 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.272215 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:27:17.295212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:17.317213 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.318210 [debug] [Thread-1  ]: finished collecting timing info
14:27:17.319214 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:17.319214 [debug] [Thread-2  ]: finished collecting timing info
14:27:17.337211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:17.338212 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:27:17.374210 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:17.398209 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:17.404210 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellstartdatsellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:27:18.134645 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:27:18.136643 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:27:18.870501 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellstartdatsellStartDate at [83:14]')
14:27:20.831423 [debug] [Thread-2  ]: finished collecting timing info
14:27:20.832423 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellstartdatsellStartDate at [83:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:27:20.833422 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFD50B50>]}
14:27:20.833422 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.56s]
14:27:20.835423 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:27:20.835423 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.836423 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:27:20.837421 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.838422 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.838422 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.860880 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.862497 [debug] [Thread-2  ]: finished collecting timing info
14:27:20.863031 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:20.868319 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:20.869409 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:20.877418 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:27:21.286987 [debug] [Thread-1  ]: finished collecting timing info
14:27:21.287986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFD7BCA0>]}
14:27:21.287986 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.02s]
14:27:21.289993 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:27:21.290986 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.290986 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:27:21.293000 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.293000 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.294412 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.312929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.313929 [debug] [Thread-1  ]: finished collecting timing info
14:27:21.314930 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:21.317930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:27:21.319931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:21.325932 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:27:22.108818 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:27:22.339844 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name salesReason_id is ambiguous at [55:43]')
14:27:23.450817 [debug] [Thread-1  ]: finished collecting timing info
14:27:23.450817 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:27:23.451813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE73EB0>]}
14:27:23.451813 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 2.16s]
14:27:23.453815 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:27:24.281002 [debug] [Thread-2  ]: finished collecting timing info
14:27:24.282004 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Column name salesReason_id is ambiguous at [55:43]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:27:24.283004 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656e4bb5-35b4-4b73-a7eb-6de8acc96e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE7F610>]}
14:27:24.283004 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.45s]
14:27:24.285004 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:24.286003 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:24.286003 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:27:24.287001 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:24.289005 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:24.290003 [info ] [MainThread]: 
14:27:24.292005 [info ] [MainThread]: Finished running 5 table models in 10.54s.
14:27:24.293010 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:24.294002 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:27:24.295003 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:27:24.307004 [info ] [MainThread]: 
14:27:24.308011 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:27:24.310006 [info ] [MainThread]: 
14:27:24.312005 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:27:24.314012 [error] [MainThread]:   Unrecognized name: sellstartdatsellStartDate at [83:14]
14:27:24.315003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:27:24.316010 [info ] [MainThread]: 
14:27:24.317003 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:27:24.318004 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:27:24.319003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:27:24.321005 [info ] [MainThread]: 
14:27:24.322008 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:27:24.323005 [error] [MainThread]:   Column name salesReason_id is ambiguous at [55:43]
14:27:24.324003 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:27:24.325005 [info ] [MainThread]: 
14:27:24.326004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:27:24.327004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCB5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFCB5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FFE4C7C0>]}


============================== 2022-04-26 14:33:19.157400 | 1df07343-a2c3-4157-93eb-050db0523eac ==============================
14:33:19.157400 [info ] [MainThread]: Running with dbt=1.0.4
14:33:19.158417 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:33:19.158417 [debug] [MainThread]: Tracking: tracking
14:33:19.173401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F3F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2566F36D0>]}
14:33:19.307401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
14:33:19.308401 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
14:33:19.309405 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritory.sql
14:33:19.310402 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:33:19.327400 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:33:19.358401 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:33:19.472403 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritory.sql
14:33:19.476401 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:33:19.482403 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:33:19.497400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2569350D0>]}
14:33:19.509402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905B50>]}
14:33:19.510400 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:33:19.513400 [info ] [MainThread]: 
14:33:19.515404 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:19.517402 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:33:19.518402 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:20.765580 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:33:20.765580 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:21.596163 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:33:21.597165 [info ] [MainThread]: 
14:33:21.607178 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.608166 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.609166 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:33:21.611167 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:33:21.611167 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.612174 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.613170 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.613170 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.618165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:33:21.623167 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:33:21.625165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.626165 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.626165 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:33:21.627183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:33:21.628166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.629166 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.630183 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:33:21.631184 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:33:21.632164 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.633180 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.633180 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.634165 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.640167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:33:21.644163 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:33:21.645164 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.645164 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.646165 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:33:21.647166 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:33:21.647166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.648163 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.649165 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:33:21.650167 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:33:21.651165 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.651165 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.652166 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.653182 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.656164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:33:21.659164 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:33:21.660163 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.661164 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:33:21.661164 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.662168 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.663164 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:33:21.664164 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:33:21.664164 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.665165 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.667166 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:33:21.667166 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.668166 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.673164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:33:21.673164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.678164 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory"
14:33:21.679165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.680182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:33:21.680182 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.681164 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.682165 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritory
14:33:21.682165 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:33:21.683165 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.684166 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:21.685182 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:33:21.686166 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.687164 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.687164 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.688165 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.706164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:21.707164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:33:21.731165 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.732165 [debug] [Thread-1  ]: finished collecting timing info
14:33:21.732165 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:21.733167 [debug] [Thread-2  ]: finished collecting timing info
14:33:21.754164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:21.754164 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:33:21.779163 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:33:21.781164 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:33:21.789164 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:33:22.966164 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:33:22.967164 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:33:23.330752 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
14:33:25.036373 [debug] [Thread-2  ]: finished collecting timing info
14:33:25.036373 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:33:25.037373 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256A577C0>]}
14:33:25.037373 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.35s]
14:33:25.039373 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:33:25.040374 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.040374 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:33:25.042373 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.043375 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.043375 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.070375 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.072375 [debug] [Thread-2  ]: finished collecting timing info
14:33:25.073377 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:25.079381 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:33:25.080378 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:33:25.089372 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesorderid
            ,SalesOrderSalesReason.salesreasonid
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:33:26.493962 [debug] [Thread-1  ]: finished collecting timing info
14:33:26.494962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256AB2040>]}
14:33:26.495962 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 4.81s]
14:33:26.496963 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:33:26.497961 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.498962 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritory................ [RUN]
14:33:26.500963 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.500963 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.501962 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.519963 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.520963 [debug] [Thread-1  ]: finished collecting timing info
14:33:26.521965 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:26.526979 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritory"
14:33:26.528963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:26.535963 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritory: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritory"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritory`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritory as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritory as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritory
),SalesTerritory as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritory 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritory
    )

select * from final
  );
  
14:33:26.722099 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name salesorderid not found inside SalesOrderSalesReason at [61:36]')
14:33:27.338232 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:33:28.478761 [debug] [Thread-1  ]: finished collecting timing info
14:33:28.479761 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:33:28.480761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D257AF3FA0>]}
14:33:28.481762 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritory....... [[31mERROR[0m in 1.98s]
14:33:28.482775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritory
14:33:28.831903 [debug] [Thread-2  ]: finished collecting timing info
14:33:28.832903 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Name salesorderid not found inside SalesOrderSalesReason at [61:36]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:33:28.833903 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df07343-a2c3-4157-93eb-050db0523eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256A4A5E0>]}
14:33:28.833903 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 3.79s]
14:33:28.835905 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:33:28.836903 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:33:28.836903 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:33:28.838904 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:33:28.839904 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:28.841905 [info ] [MainThread]: 
14:33:28.842906 [info ] [MainThread]: Finished running 5 table models in 9.33s.
14:33:28.843909 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:28.844931 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:33:28.844931 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:33:28.845912 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritory' was properly closed.
14:33:28.845912 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:33:28.858905 [info ] [MainThread]: 
14:33:28.859905 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:33:28.861906 [info ] [MainThread]: 
14:33:28.862905 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:33:28.864908 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
14:33:28.865910 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:33:28.867904 [info ] [MainThread]: 
14:33:28.868912 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritory (models\marts\dim_SalesTerritory.sql)[0m
14:33:28.870904 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:33:28.871905 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritory.sql
14:33:28.872904 [info ] [MainThread]: 
14:33:28.873906 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:33:28.875906 [error] [MainThread]:   Name salesorderid not found inside SalesOrderSalesReason at [61:36]
14:33:28.876906 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:33:28.877919 [info ] [MainThread]: 
14:33:28.878905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
14:33:28.879904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D256905160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D257ABFBE0>]}


============================== 2022-04-26 14:43:35.390241 | 7b82b561-ab3e-4602-a87d-4c92cd68dcfe ==============================
14:43:35.390241 [info ] [MainThread]: Running with dbt=1.0.4
14:43:35.391239 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:43:35.392240 [debug] [MainThread]: Tracking: tracking
14:43:35.406241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F61F1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6213370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6213A90>]}
14:43:35.552105 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
14:43:35.553104 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:43:35.553104 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:43:35.554105 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritory.sql
14:43:35.554105 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritory.sql
14:43:35.555122 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:43:35.556105 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:43:35.570107 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:43:35.584104 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:43:35.607105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:43:35.611121 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:43:35.627107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:43:35.629123 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:43:35.642643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:43:35.660435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b82b561-ab3e-4602-a87d-4c92cd68dcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64470D0>]}
14:43:35.684437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b82b561-ab3e-4602-a87d-4c92cd68dcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64214F0>]}
14:43:35.685436 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:43:35.689436 [info ] [MainThread]: 
14:43:35.690436 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:43:35.693437 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:43:35.694437 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:43:36.572025 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:43:36.574035 [info ] [MainThread]: 
14:43:36.582023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.583023 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.583023 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:43:36.584026 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:43:36.584026 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.585025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.585025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.586025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.589029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:43:36.595034 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:43:36.596053 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.597036 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.598033 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:43:36.599043 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:43:36.599043 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.600035 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.601030 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:43:36.602045 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:43:36.603030 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.604036 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.604036 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.605032 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.609032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:43:36.614028 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:43:36.616032 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.617027 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.618025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:43:36.618025 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:43:36.619030 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.620025 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.621031 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:43:36.622025 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:43:36.623025 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.623025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.624025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.625025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.629025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:43:36.635024 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:43:36.637026 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.638026 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:43:36.639025 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.639025 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.640027 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:43:36.641026 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:43:36.642025 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.643024 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.644024 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:43:36.644024 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.645031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.650024 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:43:36.651029 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.657024 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:43:36.657024 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.659024 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:43:36.659973 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.660621 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.662140 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:43:36.663140 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:43:36.664140 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.665140 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.667140 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:43:36.667140 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.668140 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.701140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:43:36.701140 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:43:36.727139 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:43:36.727139 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.728139 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.729140 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.729140 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.729140 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.730140 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:43:36.731141 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.732141 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.732349 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:43:36.733140 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:43:36.734140 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.734140 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.735141 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:43:36.736151 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.736151 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.758405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:43:36.758926 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.792445 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:43:36.793447 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.794897 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.795479 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.796025 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.797221 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.798291 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:43:36.799380 [debug] [Thread-2  ]: finished collecting timing info
14:43:36.800992 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:43:36.802068 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.803770 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:43:36.804872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.805932 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.899089 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:43:36.901089 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.901089 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.902093 [debug] [Thread-1  ]: finished collecting timing info
14:43:36.903097 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:43:36.905099 [debug] [MainThread]: Connection 'master' was properly closed.
14:43:36.906099 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:43:36.907093 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:43:36.907093 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:43:36.927089 [info ] [MainThread]: Done.
14:43:36.929089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F63FC040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F6424760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F64247C0>]}


============================== 2022-04-26 14:46:08.839003 | d28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3 ==============================
14:46:08.839003 [info ] [MainThread]: Running with dbt=1.0.4
14:46:08.840003 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:46:08.840003 [debug] [MainThread]: Tracking: tracking
14:46:08.856004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03693DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036943FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036943D30>]}
14:46:09.012005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:46:09.012005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:46:09.022011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036B860D0>]}
14:46:09.037004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0369B45B0>]}
14:46:09.038018 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:46:09.042004 [info ] [MainThread]: 
14:46:09.044004 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:09.045003 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:46:09.046003 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:09.866004 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:46:09.867006 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:10.629356 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:46:10.630355 [info ] [MainThread]: 
14:46:10.637355 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.637355 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.638356 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:46:10.638356 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:46:10.639358 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.639358 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.640357 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.640357 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.643356 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
14:46:10.647355 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:46:10.649356 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.650357 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.650357 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
14:46:10.651356 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:46:10.652370 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.653357 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.653357 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:46:10.655231 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:46:10.655760 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.656304 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.656861 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.657975 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.664679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:46:10.670776 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:46:10.672414 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.673488 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.674024 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:46:10.674535 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:46:10.675546 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.676549 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.677544 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:46:10.678543 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:46:10.679545 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.680545 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.680545 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.681561 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.685544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:46:10.691543 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:46:10.692557 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.693599 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.694107 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:46:10.695118 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:46:10.696125 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.697117 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.697117 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:46:10.698117 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:10.699117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.699117 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.700116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.700116 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.704116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:46:10.708115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:10.709115 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.710117 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.711115 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:46:10.711115 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:10.712115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.713116 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.713116 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
14:46:10.714115 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:46:10.715116 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:10.716133 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.716133 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.717117 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.718116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.718116 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:46:10.765658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:10.787967 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.789968 [debug] [Thread-1  ]: finished collecting timing info
14:46:10.789968 [debug] [Thread-2  ]: finished collecting timing info
14:46:10.790970 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:10.790970 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:46:10.814532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:10.838533 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:46:10.840532 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:10.849537 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:46:11.632681 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
14:46:11.633681 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
14:46:12.372975 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
14:46:14.321982 [debug] [Thread-2  ]: finished collecting timing info
14:46:14.323000 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:46:14.323982 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037C9BD90>]}
14:46:14.325347 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.61s]
14:46:14.326984 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:46:14.326984 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.327982 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:46:14.328982 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.328982 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.329983 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.347984 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.349985 [debug] [Thread-2  ]: finished collecting timing info
14:46:14.349985 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:14.353983 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:46:14.355982 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:14.360983 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:46:14.518774 [debug] [Thread-1  ]: finished collecting timing info
14:46:14.519306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036C46A30>]}
14:46:14.519830 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (19.1k rows, 976.2 KB processed)[0m in 3.80s]
14:46:14.521416 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
14:46:14.521949 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.522473 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:46:14.523479 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.523479 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.524480 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.539479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.540480 [debug] [Thread-1  ]: finished collecting timing info
14:46:14.541480 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:14.545480 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:14.580478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:14.587479 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
14:46:15.417886 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
14:46:15.820123 [debug] [Thread-1  ]: finished collecting timing info
14:46:15.821129 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:46:15.822124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037D1F550>]}
14:46:15.823124 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.30s]
14:46:15.824124 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:17.732572 [debug] [Thread-2  ]: finished collecting timing info
14:46:17.733571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c4426-e0fb-4b06-ab32-2b3ddf8e4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036BB0B50>]}
14:46:17.734572 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (27.6k rows, 432.2 KB processed)[0m in 3.40s]
14:46:17.735572 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:46:17.736573 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:46:17.736573 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:46:17.738578 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:46:17.740573 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:17.741572 [info ] [MainThread]: 
14:46:17.742573 [info ] [MainThread]: Finished running 5 table models in 8.70s.
14:46:17.743573 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:17.744572 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:46:17.745574 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:46:17.745574 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:46:17.746572 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:46:17.761572 [info ] [MainThread]: 
14:46:17.762572 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
14:46:17.764575 [info ] [MainThread]: 
14:46:17.765573 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
14:46:17.766576 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
14:46:17.767573 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
14:46:17.768574 [info ] [MainThread]: 
14:46:17.769572 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:46:17.770572 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
14:46:17.772586 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:46:17.773574 [info ] [MainThread]: 
14:46:17.774574 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
14:46:17.776573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036C126A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0369B4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F037D028E0>]}


============================== 2022-04-26 22:53:40.071800 | f2267904-6a04-49b2-a472-3fdaffb4a61f ==============================
22:53:40.071800 [info ] [MainThread]: Running with dbt=1.0.4
22:53:40.073799 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:53:40.073799 [debug] [MainThread]: Tracking: tracking
22:53:40.091831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A27EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A284F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A284BB0>]}
22:53:41.352007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:53:41.352007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:53:41.362998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A4C80D0>]}
22:53:41.380997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6550>]}
22:53:41.381997 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
22:53:41.384996 [info ] [MainThread]: 
22:53:41.385997 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:41.387996 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
22:53:41.388997 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:42.184568 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
22:53:42.184568 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:42.782485 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
22:53:42.784207 [info ] [MainThread]: 
22:53:42.919886 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.920884 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.921885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
22:53:42.921885 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
22:53:42.922886 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.923884 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.924103 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.924704 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.930715 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
22:53:42.935742 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
22:53:42.937715 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.938715 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.938715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
22:53:42.939716 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
22:53:42.940716 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.941717 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.941717 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:42.942714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:42.943717 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.944731 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.945728 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.946720 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.950752 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
22:53:42.953715 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
22:53:42.955891 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.955891 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.956913 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
22:53:42.957891 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
22:53:42.957891 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.958891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.960894 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:42.961893 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:42.962908 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.963899 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.963899 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.964929 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.967891 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
22:53:42.971745 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
22:53:42.972735 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.973736 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
22:53:42.973736 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.974757 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.974757 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
22:53:42.975736 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
22:53:42.976738 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.977742 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.978743 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:42.979742 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.980739 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.984772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
22:53:42.985757 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.989737 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
22:53:42.989737 [debug] [Thread-1  ]: finished collecting timing info
22:53:42.990742 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
22:53:42.990742 [debug] [Thread-2  ]: finished collecting timing info
22:53:42.991737 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:42.992743 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
22:53:42.993739 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
22:53:42.995742 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
22:53:42.997746 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
22:53:42.997746 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:42.999741 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
22:53:42.999741 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.000737 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
22:53:43.000737 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.001737 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
22:53:43.042772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:43.066772 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:43.081744 [debug] [Thread-1  ]: finished collecting timing info
22:53:43.081744 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:43.098737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:43.120993 [debug] [Thread-2  ]: finished collecting timing info
22:53:43.122009 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
22:53:43.151028 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
22:53:43.153988 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:43.158987 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight"
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,"weight"
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
22:53:43.697636 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
22:53:43.698638 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
22:53:44.415289 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [8:6]')
22:53:46.322345 [debug] [Thread-2  ]: finished collecting timing info
22:53:46.323333 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [8:6]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:53:46.323333 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B5ECC40>]}
22:53:46.324332 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.32s]
22:53:46.325334 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
22:53:46.326334 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.327335 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
22:53:46.328339 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.329334 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.330428 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.349367 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.351352 [debug] [Thread-2  ]: finished collecting timing info
22:53:46.352339 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:46.354337 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:53:46.936597 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
22:53:46.939565 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
22:53:47.300621 [debug] [Thread-1  ]: finished collecting timing info
22:53:47.301623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A552F40>]}
22:53:47.302624 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.30s]
22:53:47.304624 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
22:53:47.305643 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.306622 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
22:53:47.308623 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.309624 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.310626 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.329624 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.330623 [debug] [Thread-1  ]: finished collecting timing info
22:53:47.331623 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:47.334660 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
22:53:47.338622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:47.345622 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
22:53:48.000355 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
22:53:49.298829 [debug] [Thread-1  ]: finished collecting timing info
22:53:49.299828 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
22:53:49.300828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B66DDF0>]}
22:53:49.301831 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.99s]
22:53:49.303831 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
22:53:49.992920 [debug] [Thread-2  ]: finished collecting timing info
22:53:49.993920 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2267904-6a04-49b2-a472-3fdaffb4a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A4F0DF0>]}
22:53:49.993920 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.67s]
22:53:49.995919 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
22:53:49.996924 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:49.997919 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
22:53:49.999921 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
22:53:50.001921 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:53:50.002956 [info ] [MainThread]: 
22:53:50.002956 [info ] [MainThread]: Finished running 5 table models in 8.62s.
22:53:50.003921 [debug] [MainThread]: Connection 'master' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
22:53:50.004920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
22:53:50.005919 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
22:53:50.050454 [info ] [MainThread]: 
22:53:50.051454 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
22:53:50.054473 [info ] [MainThread]: 
22:53:50.055454 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
22:53:50.057455 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [8:6]
22:53:50.058456 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
22:53:50.060455 [info ] [MainThread]: 
22:53:50.062455 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
22:53:50.065469 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
22:53:50.067454 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
22:53:50.068493 [info ] [MainThread]: 
22:53:50.069455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
22:53:50.071453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092A2F6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B647820>]}


============================== 2022-04-26 23:02:55.039061 | 9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0 ==============================
23:02:55.039061 [info ] [MainThread]: Running with dbt=1.0.4
23:02:55.040062 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
23:02:55.041035 [debug] [MainThread]: Tracking: tracking
23:02:55.055039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D13EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D24490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D24340>]}
23:02:55.172060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:02:55.173063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:02:55.180061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850F570D0>]}
23:02:55.192031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd6f835-fb8d-475c-beeb-f14dbaa7b0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024850D82610>]}
23:02:55.193042 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:02:55.196032 [info ] [MainThread]: 
23:02:55.198034 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:02:55.199032 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:02:55.200033 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:02:55.917481 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:02:55.918483 [info ] [MainThread]: 
23:02:55.925480 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.926479 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.927483 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:02:55.928481 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:02:55.928481 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.929482 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.930525 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.930525 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.934518 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:02:55.938484 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:02:55.940335 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.940335 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.941341 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:02:55.942340 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:02:55.942340 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.943335 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.944366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:02:55.945341 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:02:55.946345 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.947339 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.947339 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.948338 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.951334 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:02:55.954082 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:02:55.956119 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.956119 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.957083 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:02:55.958087 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:02:55.958087 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.959084 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.960084 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:02:55.961084 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:02:55.962087 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.963092 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.963092 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.964090 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.968083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:02:55.970086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:02:55.972083 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.972083 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.973094 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:02:55.974089 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:02:55.974089 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.975085 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.976085 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:02:55.976085 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:02:55.977083 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.978085 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.978085 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.979093 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.983121 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:02:55.986083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:02:55.987085 [debug] [Thread-2  ]: finished collecting timing info
23:02:55.988085 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:02:55.988085 [debug] [Thread-1  ]: finished collecting timing info
23:02:55.988085 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.989085 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:02:55.990090 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:02:55.991114 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:02:55.992092 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.992092 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:02:55.993084 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:55.993084 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.028086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:02:56.029086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:02:56.048082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:02:56.048082 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.049083 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:56.050083 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.050083 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.051083 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.051083 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:02:56.052083 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.053098 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.054083 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:02:56.054083 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:02:56.055083 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.056083 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.056083 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:02:56.057143 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.057143 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.071118 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:02:56.071118 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.083953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:02:56.084915 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.084915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.085924 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.085924 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.086918 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.087924 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:02:56.087924 [debug] [Thread-1  ]: finished collecting timing info
23:02:56.089917 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:02:56.090917 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.090917 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:02:56.091915 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.091915 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.124952 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
23:02:56.125951 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.126915 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.126915 [debug] [Thread-2  ]: finished collecting timing info
23:02:56.127916 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:02:56.129926 [debug] [MainThread]: Connection 'master' was properly closed.
23:02:56.129926 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:02:56.130920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:02:56.130920 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
23:02:56.140935 [info ] [MainThread]: Done.
23:02:56.141927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024851088730>]}


============================== 2022-04-26 23:53:39.231693 | 247066ce-e39a-4c7e-9caf-6bf0c5e336db ==============================
23:53:39.231693 [info ] [MainThread]: Running with dbt=1.0.4
23:53:39.232705 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:53:39.232705 [debug] [MainThread]: Tracking: tracking
23:53:39.249695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A6BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A93670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9A93280>]}
23:53:39.473693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
23:53:39.474693 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:53:39.475696 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
23:53:39.522706 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:53:39.543695 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
23:53:39.566693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
23:53:39.583695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9D3D0D0>]}
23:53:39.595694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9CA59D0>]}
23:53:39.595694 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:53:39.598696 [info ] [MainThread]: 
23:53:39.600704 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:53:39.601695 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:53:39.602695 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:40.402592 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:53:40.403591 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:40.995127 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:53:40.996121 [info ] [MainThread]: 
23:53:41.004123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.004123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.006122 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:53:41.007122 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:53:41.007122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.008139 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.009125 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.009125 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.014159 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:53:41.018125 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:53:41.020124 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.021121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:53:41.021121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.021121 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.023121 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:53:41.024124 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:53:41.025122 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.025122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.027131 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:53:41.027131 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.028133 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.034134 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:53:41.035140 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.041120 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:53:41.043122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.045121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:53:41.046122 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.047124 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:53:41.048122 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.049132 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.056121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:53:41.061122 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.063123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:53:41.064123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.065123 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:53:41.067123 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.068121 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.067123 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.076124 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:53:41.082123 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:53:41.084123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.085121 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:53:41.085121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.086121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.087123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:53:41.087123 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.088121 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.093121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:53:41.094122 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:53:41.096121 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.096121 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.097122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.102123 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:53:41.103124 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:53:41.104122 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.105124 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:53:41.106125 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.107123 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.108123 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:53:41.109121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.110123 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.110123 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.111123 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:53:41.138145 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.140136 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.140136 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.141122 [debug] [Thread-1  ]: finished collecting timing info
23:53:41.141122 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:53:41.142121 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:41.171120 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.187156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:53:41.188121 [debug] [Thread-2  ]: finished collecting timing info
23:53:41.188121 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:53:41.212123 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:53:41.214120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:53:41.220155 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:53:41.808033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:53:41.808995 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:53:42.745016 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:53:43.969666 [debug] [Thread-2  ]: finished collecting timing info
23:53:43.970669 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:53:43.971664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E09280>]}
23:53:43.971664 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.83s]
23:53:43.974665 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:53:43.974665 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:43.975665 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:53:43.977670 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:43.977670 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:43.978684 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:53:44.002663 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:44.004664 [debug] [Thread-2  ]: finished collecting timing info
23:53:44.004664 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:44.009665 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:53:44.578402 [debug] [Thread-1  ]: finished collecting timing info
23:53:44.579399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E07EB0>]}
23:53:44.580403 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.47s]
23:53:44.582364 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:53:44.583364 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.583364 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:53:44.585365 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.585365 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.586368 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.603400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.604368 [debug] [Thread-1  ]: finished collecting timing info
23:53:44.605363 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:44.611361 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:53:44.613398 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:53:44.614362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:53:44.615363 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:53:44.620392 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:53:45.240496 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:53:46.517329 [debug] [Thread-1  ]: finished collecting timing info
23:53:46.517878 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:53:46.518434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AAE9FEB0>]}
23:53:46.519592 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.93s]
23:53:46.521299 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:53:48.241196 [debug] [Thread-2  ]: finished collecting timing info
23:53:48.242176 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247066ce-e39a-4c7e-9caf-6bf0c5e336db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9DBA1F0>]}
23:53:48.242176 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.27s]
23:53:48.244176 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:53:48.245188 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:53:48.245188 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:53:48.247190 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:53:48.249176 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:53:48.250176 [info ] [MainThread]: 
23:53:48.251176 [info ] [MainThread]: Finished running 5 table models in 8.65s.
23:53:48.253179 [debug] [MainThread]: Connection 'master' was properly closed.
23:53:48.253179 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:53:48.254177 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:53:48.254177 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:53:48.255178 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:53:48.279179 [info ] [MainThread]: 
23:53:48.281177 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:53:48.282179 [info ] [MainThread]: 
23:53:48.284179 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:53:48.285177 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:53:48.286177 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:53:48.288180 [info ] [MainThread]: 
23:53:48.289175 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:53:48.291179 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:53:48.292177 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:53:48.294180 [info ] [MainThread]: 
23:53:48.295177 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:53:48.297177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9E1CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A9B04310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AAE79730>]}


============================== 2022-04-26 23:55:08.396209 | dfc8bff0-99b8-4510-b9a7-d649c52bfe23 ==============================
23:55:08.396209 [info ] [MainThread]: Running with dbt=1.0.4
23:55:08.397221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:55:08.398211 [debug] [MainThread]: Tracking: tracking
23:55:08.412217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB4DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB53D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EB536A0>]}
23:55:08.537244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:55:08.537244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:55:08.545244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6ED970D0>]}
23:55:08.557245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC55B0>]}
23:55:08.557245 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:55:08.561244 [info ] [MainThread]: 
23:55:08.563213 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:08.565214 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:55:08.565214 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:09.191947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:55:09.192986 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:09.816155 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:55:09.817194 [info ] [MainThread]: 
23:55:09.825153 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.826154 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.827156 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:09.828158 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:09.828158 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.829153 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.829153 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.830153 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.832614 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:09.835650 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:09.837619 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.837619 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.838630 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:09.839616 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:09.839616 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.840618 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.841614 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:09.842616 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:09.842616 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.843619 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.843619 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.844615 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.848620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:09.852652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:09.853615 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.854617 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:09.855623 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.856637 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.857625 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:09.858634 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:09.859620 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.860644 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.860644 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:09.861619 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.862136 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.865184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:09.865184 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.868994 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:09.868994 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.869958 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:09.869958 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.870960 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.871972 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:09.872970 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:09.873965 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.874961 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.874961 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.875960 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:09.878957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:09.878957 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.879959 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.880958 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.883994 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:09.883994 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:09.884960 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.885971 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:55:09.885971 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.887960 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:09.888975 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:09.889958 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.890962 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:55:09.891974 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.892959 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:55:09.932956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:09.933977 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:55:09.933977 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:55:09.934958 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:55:09.934958 [debug] [Thread-1  ]: finished collecting timing info
23:55:09.958983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:09.959990 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:09.982994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:09.983960 [debug] [Thread-2  ]: finished collecting timing info
23:55:09.983960 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:55:10.006005 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:10.009960 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:10.014994 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:55:10.610236 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:10.612194 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:55:11.430275 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:55:13.376535 [debug] [Thread-1  ]: finished collecting timing info
23:55:13.377518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FEB30D0>]}
23:55:13.377518 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.49s]
23:55:13.379518 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:13.380531 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.381533 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:55:13.382521 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.382521 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.383542 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.400551 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.402541 [debug] [Thread-1  ]: finished collecting timing info
23:55:13.402541 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:13.408520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:13.561638 [debug] [Thread-2  ]: finished collecting timing info
23:55:13.562605 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:13.562605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FEACBB0>]}
23:55:13.563603 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.63s]
23:55:13.565605 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:55:13.566619 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.567614 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:55:13.569610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.569610 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.570608 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.584640 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.586623 [debug] [Thread-2  ]: finished collecting timing info
23:55:13.586623 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:13.591604 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:13.592604 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:13.598602 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:55:13.969975 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:13.970976 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:55:14.196799 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:55:15.530547 [debug] [Thread-2  ]: finished collecting timing info
23:55:15.531586 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:15.531586 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6FF080A0>]}
23:55:15.532548 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.96s]
23:55:15.534548 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:17.230954 [debug] [Thread-1  ]: finished collecting timing info
23:55:17.231918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc8bff0-99b8-4510-b9a7-d649c52bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EDC0CA0>]}
23:55:17.232917 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.85s]
23:55:17.234922 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:17.235920 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:17.236917 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:55:17.237923 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:17.240922 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:17.240922 [info ] [MainThread]: 
23:55:17.242919 [info ] [MainThread]: Finished running 5 table models in 8.68s.
23:55:17.243921 [debug] [MainThread]: Connection 'master' was properly closed.
23:55:17.243921 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:55:17.244919 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:55:17.245918 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:55:17.245918 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:55:17.264953 [info ] [MainThread]: 
23:55:17.265919 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:55:17.267920 [info ] [MainThread]: 
23:55:17.269925 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:55:17.271918 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:55:17.272919 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:17.273919 [info ] [MainThread]: 
23:55:17.274918 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:55:17.276919 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:55:17.277922 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:17.279919 [info ] [MainThread]: 
23:55:17.280919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:55:17.282921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EBC52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6EDC0BB0>]}


============================== 2022-04-26 23:55:32.521907 | ef37e0ad-c3a9-44ff-9442-429fa9877cc2 ==============================
23:55:32.521907 [info ] [MainThread]: Running with dbt=1.0.4
23:55:32.522873 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:55:32.523872 [debug] [MainThread]: Tracking: tracking
23:55:32.538879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5D1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5F4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA5F4B20>]}
23:55:32.665871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:55:32.666872 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:55:32.683873 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:55:32.710908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA826F70>]}
23:55:32.722876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA808A60>]}
23:55:32.723877 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:55:32.726908 [info ] [MainThread]: 
23:55:32.727874 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:32.729872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:55:32.730890 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:33.369300 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:55:33.370301 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:55:33.955210 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:55:33.956586 [info ] [MainThread]: 
23:55:33.964599 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.965601 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.966600 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:33.967598 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:33.967598 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.968607 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.969597 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.969597 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.972598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:55:33.977596 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:55:33.978597 [debug] [Thread-1  ]: finished collecting timing info
23:55:33.979597 [debug] [Thread-2  ]: finished collecting timing info
23:55:33.980597 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:55:33.981597 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:55:33.982605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.983606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.984600 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:33.985597 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:33.985597 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.986597 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.987614 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.987614 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.990635 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:55:33.994632 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:55:33.995596 [debug] [Thread-1  ]: finished collecting timing info
23:55:33.996598 [debug] [Thread-2  ]: finished collecting timing info
23:55:33.997596 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:55:33.998599 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:55:33.999610 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.000600 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.001611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:34.002601 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:34.002601 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.003601 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.003601 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.004598 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.007632 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:55:34.010636 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:55:34.011597 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.012595 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.012595 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:55:34.013612 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:55:34.014605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.014605 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.016599 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:34.017606 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:34.018599 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.018599 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.019598 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.019598 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.022634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:55:34.025600 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:55:34.027599 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.028597 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:55:34.028597 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.028597 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.029597 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:55:34.030630 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:55:34.031597 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.033598 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.033598 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:55:34.034597 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.035598 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.036599 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.072597 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.073610 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.074602 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:55:34.075614 [debug] [Thread-1  ]: finished collecting timing info
23:55:34.095594 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.096596 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:34.112595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:34.112595 [debug] [Thread-2  ]: finished collecting timing info
23:55:34.113597 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:55:34.139594 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:55:34.141594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:34.147594 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate as sellEndDate -- see below
        --,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:55:34.728599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:55:34.729574 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:55:35.574386 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2012-05-30T00:00:00.000000Z'")
23:55:37.574048 [debug] [Thread-2  ]: finished collecting timing info
23:55:37.575040 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2012-05-30T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:37.575040 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA914460>]}
23:55:37.576002 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.54s]
23:55:37.577006 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:55:37.578008 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.579005 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:55:37.580005 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:37.580005 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.581006 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.594042 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:37.595002 [debug] [Thread-2  ]: finished collecting timing info
23:55:37.596002 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:37.599002 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:55:37.692938 [debug] [Thread-1  ]: finished collecting timing info
23:55:37.693899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8FF9D0>]}
23:55:37.694901 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.66s]
23:55:37.696911 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:55:37.697901 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.697901 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:55:37.699734 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.700720 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.700720 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.712765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.714730 [debug] [Thread-1  ]: finished collecting timing info
23:55:37.714730 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:37.717731 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:55:37.719733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:55:37.725766 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:55:38.162740 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:55:38.163739 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:55:38.381306 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:55:38.916182 [debug] [Thread-1  ]: finished collecting timing info
23:55:38.916182 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:38.917217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCB9C56D0>]}
23:55:38.917217 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.22s]
23:55:38.919178 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:55:41.410406 [debug] [Thread-2  ]: finished collecting timing info
23:55:41.411369 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef37e0ad-c3a9-44ff-9442-429fa9877cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8285E0>]}
23:55:41.411369 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.83s]
23:55:41.413376 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:55:41.414409 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:41.415371 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:55:41.417371 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:55:41.419371 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:55:41.419371 [info ] [MainThread]: 
23:55:41.420409 [info ] [MainThread]: Finished running 5 table models in 8.69s.
23:55:41.421370 [debug] [MainThread]: Connection 'master' was properly closed.
23:55:41.422369 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:55:41.423372 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:55:41.424374 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:55:41.425370 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:55:41.440452 [info ] [MainThread]: 
23:55:41.441462 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:55:41.443463 [info ] [MainThread]: 
23:55:41.444462 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:55:41.446463 [error] [MainThread]:   Invalid date: '2012-05-30T00:00:00.000000Z'
23:55:41.448465 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:55:41.449464 [info ] [MainThread]: 
23:55:41.450464 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:55:41.452462 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:55:41.453463 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:55:41.454464 [info ] [MainThread]: 
23:55:41.455465 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:55:41.457478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA935EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCA8081C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FCB9B1070>]}


============================== 2022-04-26 23:56:20.795479 | ca53a700-d8b9-4608-b0ee-9d6e0912bb4a ==============================
23:56:20.795479 [info ] [MainThread]: Running with dbt=1.0.4
23:56:20.796495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:56:20.797450 [debug] [MainThread]: Tracking: tracking
23:56:20.810453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964083D5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640843C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640843B50>]}
23:56:20.935449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:56:20.936449 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:56:20.949450 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:56:20.976110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A74F70>]}
23:56:20.988123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A58A00>]}
23:56:20.989091 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:56:20.992122 [info ] [MainThread]: 
23:56:20.993095 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:56:20.996097 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:56:20.997117 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:56:21.654540 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:56:21.655543 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:56:22.242887 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:56:22.243896 [info ] [MainThread]: 
23:56:22.250888 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.250888 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.251890 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:56:22.252889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:56:22.253903 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.253903 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.254909 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.255891 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.258894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard"
23:56:22.262922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
23:56:22.263888 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.264890 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.265888 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCard
23:56:22.266888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
23:56:22.266888 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.267891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.268891 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:56:22.268891 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:56:22.269942 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.270903 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.271912 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.271912 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.275921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:56:22.279887 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
23:56:22.280889 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.281889 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.281889 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:56:22.282887 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
23:56:22.283887 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.283887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.284888 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:56:22.285889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:56:22.285889 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.286888 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.287888 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.287888 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.291916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
23:56:22.294924 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
23:56:22.296736 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.297747 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
23:56:22.297747 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.297747 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.298746 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
23:56:22.299751 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:56:22.299751 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.300744 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.301369 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:56:22.301369 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.302380 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.306383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
23:56:22.307394 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.310751 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
23:56:22.310751 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.311715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
23:56:22.312716 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.312716 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.313718 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
23:56:22.314716 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCard.................... [RUN]
23:56:22.314716 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.316719 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:22.316719 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:56:22.317752 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.318714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.318714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.359718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:22.360716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.361715 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:56:22.361715 [debug] [Thread-1  ]: finished collecting timing info
23:56:22.381751 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.382713 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:22.391713 [debug] [Thread-2  ]: finished collecting timing info
23:56:22.399713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:56:22.400674 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:56:22.422091 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:56:22.425071 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:56:22.430091 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate as sellEndDate 
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,sellstartdate as sellStartDate-- see below
        --,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:56:23.147707 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCard"
23:56:23.148706 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCard: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCard"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCard`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCard as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCard as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCard
),CreditCard as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCard 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCard
    )

select * from final
  );
  
23:56:23.670778 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name sellEndDate is ambiguous at [82:14]')
23:56:24.680817 [debug] [Thread-2  ]: finished collecting timing info
23:56:24.681813 [debug] [Thread-2  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Column name sellEndDate is ambiguous at [82:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:56:24.681813 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BE2BE0>]}
23:56:24.682816 [error] [Thread-2  ]: 2 of 5 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.36s]
23:56:24.684817 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:56:24.684817 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.685849 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
23:56:24.686814 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:24.687818 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.687818 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.705816 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:24.706817 [debug] [Thread-2  ]: finished collecting timing info
23:56:24.707813 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:24.711853 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:56:25.277610 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
23:56:25.279538 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
23:56:26.199042 [debug] [Thread-1  ]: finished collecting timing info
23:56:26.199042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BE1940>]}
23:56:26.200048 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCard............... [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.88s]
23:56:26.202018 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCard
23:56:26.203012 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.204015 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
23:56:26.205015 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.206018 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.207015 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.221034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.222043 [debug] [Thread-1  ]: finished collecting timing info
23:56:26.223019 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:26.227014 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
23:56:26.228016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:56:26.233048 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
23:56:26.891285 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
23:56:28.186771 [debug] [Thread-1  ]: finished collecting timing info
23:56:28.187808 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:56:28.188766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641C36250>]}
23:56:28.188766 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.98s]
23:56:28.190766 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
23:56:28.558182 [debug] [Thread-2  ]: finished collecting timing info
23:56:28.558182 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca53a700-d8b9-4608-b0ee-9d6e0912bb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A77760>]}
23:56:28.559182 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.87s]
23:56:28.561151 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
23:56:28.562146 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:56:28.563144 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
23:56:28.564149 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
23:56:28.566151 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:56:28.567145 [info ] [MainThread]: 
23:56:28.568144 [info ] [MainThread]: Finished running 5 table models in 7.57s.
23:56:28.570149 [debug] [MainThread]: Connection 'master' was properly closed.
23:56:28.570149 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:56:28.571147 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:56:28.572144 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
23:56:28.572144 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
23:56:28.583146 [info ] [MainThread]: 
23:56:28.584163 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
23:56:28.586165 [info ] [MainThread]: 
23:56:28.588147 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:56:28.590157 [error] [MainThread]:   Column name sellEndDate is ambiguous at [82:14]
23:56:28.591143 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:56:28.592144 [info ] [MainThread]: 
23:56:28.593145 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
23:56:28.595146 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
23:56:28.596144 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
23:56:28.597147 [info ] [MainThread]: 
23:56:28.598150 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
23:56:28.600157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029641BC90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640AF05B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640A76700>]}


============================== 2022-04-26 23:57:35.973581 | 4f536f65-a96d-40ff-bc29-8d8bdb42c2bc ==============================
23:57:35.973581 [info ] [MainThread]: Running with dbt=1.0.4
23:57:35.974582 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:57:35.975592 [debug] [MainThread]: Tracking: tracking
23:57:35.988588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E91193E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E911B4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E911B4430>]}
23:57:36.116583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:57:36.117594 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:57:36.131600 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:57:36.166583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913E5F70>]}
23:57:36.180585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913C8A60>]}
23:57:36.181584 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:57:36.183586 [info ] [MainThread]: 
23:57:36.184584 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:36.186591 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:57:36.187584 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:36.995722 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:57:36.995722 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:37.631306 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:57:37.632307 [info ] [MainThread]: 
23:57:37.640314 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.641306 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:57:37.642312 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.643316 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.643316 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:57:37.666308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:57:37.670311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:57:37.693343 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.694307 [debug] [Thread-1  ]: finished collecting timing info
23:57:37.695306 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:57:37.733856 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:57:37.735823 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:57:37.740833 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,sellstartdate as sellStartDate-- see below
        --,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:57:39.228564 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:57:41.296161 [debug] [Thread-1  ]: finished collecting timing info
23:57:41.297158 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:57:41.297158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f536f65-a96d-40ff-bc29-8d8bdb42c2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E914B4940>]}
23:57:41.298159 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.65s]
23:57:41.300152 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:57:41.303152 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:57:41.304158 [info ] [MainThread]: 
23:57:41.305157 [info ] [MainThread]: Finished running 1 table model in 5.12s.
23:57:41.306155 [debug] [MainThread]: Connection 'master' was properly closed.
23:57:41.306155 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:57:41.307157 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:57:41.307157 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:57:41.318154 [info ] [MainThread]: 
23:57:41.319163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:57:41.321152 [info ] [MainThread]: 
23:57:41.322151 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:57:41.324165 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:57:41.325158 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:57:41.326164 [info ] [MainThread]: 
23:57:41.328151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:57:41.330154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913B8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913B8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E913E6A90>]}


============================== 2022-04-26 23:58:17.489967 | cfe37798-cc01-4bea-bf3f-a21aae4f3ba2 ==============================
23:58:17.489967 [info ] [MainThread]: Running with dbt=1.0.4
23:58:17.490967 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:58:17.491978 [debug] [MainThread]: Tracking: tracking
23:58:17.506987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A147585E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1475A5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1475A5A30>]}
23:58:17.631003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:58:17.631967 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:58:17.645006 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:58:17.671546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477D6F70>]}
23:58:17.683511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477B9A60>]}
23:58:17.683511 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:58:17.686511 [info ] [MainThread]: 
23:58:17.688515 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:58:17.689514 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:58:17.690515 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:58:18.311708 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:58:18.311708 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:58:18.909706 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:58:18.910707 [info ] [MainThread]: 
23:58:18.919705 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:58:18.920703 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:58:18.921705 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:58:18.922706 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:58:18.922706 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:58:18.950706 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:58:18.957704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:58:18.980707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:58:18.981704 [debug] [Thread-1  ]: finished collecting timing info
23:58:18.981704 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:58:19.018703 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:58:19.020704 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:58:19.025703 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:58:20.186041 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discontinuedDate at [84:14]')
23:58:21.660619 [debug] [Thread-1  ]: finished collecting timing info
23:58:21.661578 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: discontinuedDate at [84:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:58:21.661578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe37798-cc01-4bea-bf3f-a21aae4f3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1478A0F10>]}
23:58:21.662616 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 2.74s]
23:58:21.664583 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:58:21.665581 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:58:21.666619 [info ] [MainThread]: 
23:58:21.667617 [info ] [MainThread]: Finished running 1 table model in 3.98s.
23:58:21.669172 [debug] [MainThread]: Connection 'master' was properly closed.
23:58:21.670169 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:58:21.670169 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:58:21.671169 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:58:21.682170 [info ] [MainThread]: 
23:58:21.683177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:58:21.685168 [info ] [MainThread]: 
23:58:21.686169 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:58:21.688169 [error] [MainThread]:   Unrecognized name: discontinuedDate at [84:14]
23:58:21.689053 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:58:21.690065 [info ] [MainThread]: 
23:58:21.691064 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:58:21.692081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477A8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477A8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1477D7910>]}


============================== 2022-04-26 23:59:11.031081 | f003ff7a-01fa-4415-b767-0f3a4af85b1b ==============================
23:59:11.031081 [info ] [MainThread]: Running with dbt=1.0.4
23:59:11.032082 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:59:11.033052 [debug] [MainThread]: Tracking: tracking
23:59:11.048052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548695EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155486A5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155486A5310>]}
23:59:11.171087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:59:11.172087 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:59:11.184087 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:59:11.211051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488C5F10>]}
23:59:11.224052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488A9A90>]}
23:59:11.225052 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:59:11.229053 [info ] [MainThread]: 
23:59:11.231058 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:11.233054 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:59:11.233054 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:11.870398 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:59:11.871392 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:12.459781 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:59:12.460780 [info ] [MainThread]: 
23:59:12.469755 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.469755 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:59:12.470755 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.471755 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.471755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:59:12.500755 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:59:12.505756 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:59:12.528791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.529759 [debug] [Thread-1  ]: finished collecting timing info
23:59:12.530794 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:59:12.568758 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:12.570756 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:59:12.577755 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,discontinueddate as discontinuedDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:59:14.002422 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:59:15.481329 [debug] [Thread-1  ]: finished collecting timing info
23:59:15.482326 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:15.482326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f003ff7a-01fa-4415-b767-0f3a4af85b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548994070>]}
23:59:15.483324 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.01s]
23:59:15.484327 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:59:15.486324 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:15.487361 [info ] [MainThread]: 
23:59:15.488326 [info ] [MainThread]: Finished running 1 table model in 4.26s.
23:59:15.489326 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:15.490328 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:59:15.490328 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:59:15.491326 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:59:15.504333 [info ] [MainThread]: 
23:59:15.505789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:15.506801 [info ] [MainThread]: 
23:59:15.508803 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:59:15.509800 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:59:15.510809 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:15.511809 [info ] [MainThread]: 
23:59:15.512799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:59:15.513820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548964700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015548964B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155488C79D0>]}


============================== 2022-04-26 23:59:52.028973 | c03ffff9-e971-4b9d-a8f7-520fe206ed61 ==============================
23:59:52.028973 [info ] [MainThread]: Running with dbt=1.0.4
23:59:52.029975 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:59:52.030974 [debug] [MainThread]: Tracking: tracking
23:59:52.046975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C187FEE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18804BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18804A90>]}
23:59:52.176032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:59:52.177010 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
23:59:52.191009 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
23:59:52.217973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A34F10>]}
23:59:52.229979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A18A30>]}
23:59:52.230974 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
23:59:52.233974 [info ] [MainThread]: 
23:59:52.235974 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:52.237974 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
23:59:52.237974 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:52.996888 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
23:59:52.996888 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:53.647331 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
23:59:53.648339 [info ] [MainThread]: 
23:59:53.655701 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.656704 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
23:59:53.657700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.658705 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.659701 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
23:59:53.682743 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
23:59:53.685736 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
23:59:53.706734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.707713 [debug] [Thread-1  ]: finished collecting timing info
23:59:53.708700 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
23:59:53.743479 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
23:59:53.744482 [debug] [Thread-1  ]: Opening a new connection, currently in state init
23:59:53.749481 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,modifieddate as modifiedDate
        --,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
23:59:55.167572 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
23:59:57.277086 [debug] [Thread-1  ]: finished collecting timing info
23:59:57.278142 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:57.279099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03ffff9-e971-4b9d-a8f7-520fe206ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18B04820>]}
23:59:57.280098 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.62s]
23:59:57.281100 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
23:59:57.283103 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:57.284104 [info ] [MainThread]: 
23:59:57.285108 [info ] [MainThread]: Finished running 1 table model in 5.05s.
23:59:57.287102 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:57.287102 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
23:59:57.288102 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
23:59:57.288102 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
23:59:57.299143 [info ] [MainThread]: 
23:59:57.300098 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:57.301097 [info ] [MainThread]: 
23:59:57.303104 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
23:59:57.304100 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
23:59:57.306099 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
23:59:57.307097 [info ] [MainThread]: 
23:59:57.308099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:59:57.309097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18AD4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18AD4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C18A36D00>]}


============================== 2022-04-27 00:00:25.712096 | 99f86e8a-00c3-4070-88ac-06e5073c402f ==============================
00:00:25.712096 [info ] [MainThread]: Running with dbt=1.0.4
00:00:25.713088 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:00:25.713088 [debug] [MainThread]: Tracking: tracking
00:00:25.728104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021B3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021D40A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B021D4A00>]}
00:00:25.849088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:00:25.850088 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:00:25.863087 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:00:25.890102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B02405F70>]}
00:00:25.902088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023E8A60>]}
00:00:25.903093 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:00:25.905090 [info ] [MainThread]: 
00:00:25.907090 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:25.908090 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:00:25.909089 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:26.542693 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:00:26.542693 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:27.143218 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:00:27.144213 [info ] [MainThread]: 
00:00:27.152175 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.153177 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:00:27.155234 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.156181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.157191 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:00:27.178184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:00:27.183178 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:00:27.203211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.205175 [debug] [Thread-1  ]: finished collecting timing info
00:00:27.206175 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:00:27.242205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:00:27.243224 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:00:27.249204 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        --,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        --,cast(sellstartdate as date) as sellStartDate
        --,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,modifieddate as modifiedDate
        --,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:00:28.776852 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sellEndDate at [81:14]')
00:00:30.576718 [debug] [Thread-1  ]: finished collecting timing info
00:00:30.577717 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Unrecognized name: sellEndDate at [81:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:00:30.578715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f86e8a-00c3-4070-88ac-06e5073c402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B024D4B20>]}
00:00:30.578715 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.42s]
00:00:30.580715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:00:30.582715 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:30.583717 [info ] [MainThread]: 
00:00:30.584756 [info ] [MainThread]: Finished running 1 table model in 4.68s.
00:00:30.585718 [debug] [MainThread]: Connection 'master' was properly closed.
00:00:30.586716 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:00:30.586716 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:00:30.587722 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:00:30.599720 [info ] [MainThread]: 
00:00:30.600720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:00:30.602721 [info ] [MainThread]: 
00:00:30.603735 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:00:30.605739 [error] [MainThread]:   Unrecognized name: sellEndDate at [81:14]
00:00:30.606739 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:00:30.607769 [info ] [MainThread]: 
00:00:30.608766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:00:30.609759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023D8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B023D8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B02406A30>]}


============================== 2022-04-27 00:01:58.391987 | 6752875d-787d-4c6f-a8ae-b93299860ecd ==============================
00:01:58.391987 [info ] [MainThread]: Running with dbt=1.0.4
00:01:58.392990 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:01:58.393970 [debug] [MainThread]: Tracking: tracking
00:01:58.408952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F562B43A0>]}
00:01:58.528948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:01:58.529978 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:01:58.530984 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:01:58.542989 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:01:58.577978 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:01:58.581972 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:01:58.602949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564EEF10>]}
00:01:58.616962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8A60>]}
00:01:58.616962 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:01:58.619950 [info ] [MainThread]: 
00:01:58.620949 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:01:58.622951 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:01:58.622951 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:59.266474 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:01:59.266474 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:59.854958 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:01:59.855995 [info ] [MainThread]: 
00:01:59.862979 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.863957 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:01:59.864963 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.865965 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.865965 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:01:59.871961 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:01:59.875965 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:01:59.898966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.900965 [debug] [Thread-1  ]: finished collecting timing info
00:01:59.900965 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:01:59.936996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:01:59.937966 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:01:59.943959 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:03.300192 [debug] [Thread-1  ]: finished collecting timing info
00:02:03.301192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6752875d-787d-4c6f-a8ae-b93299860ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F565BDA00>]}
00:02:03.302204 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.44s]
00:02:03.304196 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:03.306198 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:03.307215 [info ] [MainThread]: 
00:02:03.308196 [info ] [MainThread]: Finished running 1 table model in 4.69s.
00:02:03.309197 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:03.310215 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:03.311244 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:03.311244 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:03.322203 [info ] [MainThread]: 
00:02:03.324197 [info ] [MainThread]: [32mCompleted successfully[0m
00:02:03.325196 [info ] [MainThread]: 
00:02:03.326195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:02:03.328195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564C8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F564B8B80>]}


============================== 2022-04-27 00:02:14.376320 | e5694c9a-c13b-443b-9d50-d85819364958 ==============================
00:02:14.376320 [info ] [MainThread]: Running with dbt=1.0.4
00:02:14.377308 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:14.378322 [debug] [MainThread]: Tracking: tracking
00:02:14.392309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C56A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280A8C5DC0>]}
00:02:14.517312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:02:14.518312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:02:14.527308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB0B0D0>]}
00:02:14.540323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AAD75B0>]}
00:02:14.541309 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:14.544308 [info ] [MainThread]: 
00:02:14.545312 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:14.546324 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:14.547344 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:15.174019 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:15.174019 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:15.775120 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:15.776082 [info ] [MainThread]: 
00:02:15.784081 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.785085 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:15.788082 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:15.789086 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.789086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:15.811116 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:15.815116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:15.837088 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:15.839082 [debug] [Thread-1  ]: finished collecting timing info
00:02:15.839082 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:15.856110 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:16.426621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:16.428597 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:19.087919 [debug] [Thread-1  ]: finished collecting timing info
00:02:19.088919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5694c9a-c13b-443b-9d50-d85819364958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AC1FE80>]}
00:02:19.089890 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.30s]
00:02:19.090897 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:19.092894 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:19.093890 [info ] [MainThread]: 
00:02:19.094921 [info ] [MainThread]: Finished running 1 table model in 4.55s.
00:02:19.096890 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:19.096890 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:19.097911 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:19.097911 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:19.117889 [info ] [MainThread]: 
00:02:19.119892 [info ] [MainThread]: [32mCompleted successfully[0m
00:02:19.121889 [info ] [MainThread]: 
00:02:19.122894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:02:19.124890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AAFC580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB68F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001280AB68CA0>]}


============================== 2022-04-27 00:02:32.219837 | f46d6c41-5866-4ded-9824-b02f758052a3 ==============================
00:02:32.219837 [info ] [MainThread]: Running with dbt=1.0.4
00:02:32.220797 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:32.220797 [debug] [MainThread]: Tracking: tracking
00:02:32.234799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B41C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D8B4F40>]}
00:02:32.358799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:02:32.359834 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:02:32.372840 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:02:32.412798 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:02:32.432801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB5DF70>]}
00:02:32.446799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DAC7880>]}
00:02:32.446799 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:32.451800 [info ] [MainThread]: 
00:02:32.453801 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:32.455802 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:32.456802 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:33.099440 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:33.099440 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:33.705555 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:33.706512 [info ] [MainThread]: 
00:02:33.715515 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.716516 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:33.718513 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:33.718513 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.719538 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:33.724547 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:33.728514 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:33.747547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:33.749517 [debug] [Thread-1  ]: finished collecting timing info
00:02:33.750517 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:33.767537 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:34.430006 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:34.432046 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            --,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:35.545527 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-05-29T00:00:00.000000Z'")
00:02:37.654873 [debug] [Thread-1  ]: finished collecting timing info
00:02:37.655869 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2013-05-29T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:37.656835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46d6c41-5866-4ded-9824-b02f758052a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DBE28B0>]}
00:02:37.656835 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.94s]
00:02:37.658836 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:37.660835 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:37.660835 [info ] [MainThread]: 
00:02:37.661836 [info ] [MainThread]: Finished running 1 table model in 5.21s.
00:02:37.662838 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:37.663833 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:37.664832 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:37.664832 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:37.675866 [info ] [MainThread]: 
00:02:37.676832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:02:37.678831 [info ] [MainThread]: 
00:02:37.679833 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:02:37.681845 [error] [MainThread]:   Invalid date: '2013-05-29T00:00:00.000000Z'
00:02:37.682833 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:37.684834 [info ] [MainThread]: 
00:02:37.685870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:02:37.686832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB06A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB12100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB6B8B0>]}


============================== 2022-04-27 00:02:52.680542 | 21fcc1f0-973d-4295-9f21-38e54095d6ae ==============================
00:02:52.680542 [info ] [MainThread]: Running with dbt=1.0.4
00:02:52.681537 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:02:52.682507 [debug] [MainThread]: Tracking: tracking
00:02:52.696509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9D4EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9E5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58E9E5130>]}
00:02:52.818012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:02:52.818012 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:02:52.833013 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:02:52.866979 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:02:52.881014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC7BFD0>]}
00:02:52.894018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EBE6AC0>]}
00:02:52.894018 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:02:52.895978 [info ] [MainThread]: 
00:02:52.897981 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:52.898979 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:02:52.899990 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:53.640205 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:02:53.640205 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:54.276998 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:02:54.278001 [info ] [MainThread]: 
00:02:54.284999 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.284999 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:02:54.287004 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.287004 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.288000 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:02:54.293999 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:02:54.298035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:02:54.318036 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.320083 [debug] [Thread-1  ]: finished collecting timing info
00:02:54.320999 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:02:54.337033 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:02:54.944570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:02:54.945537 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as date) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:02:56.107207 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2012-05-30T00:00:00.000000Z'")
00:02:58.198381 [debug] [Thread-1  ]: finished collecting timing info
00:02:58.198381 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Invalid date: '2012-05-30T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:58.199382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fcc1f0-973d-4295-9f21-38e54095d6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58ED140D0>]}
00:02:58.200382 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.91s]
00:02:58.202390 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:02:58.204380 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:02:58.205381 [info ] [MainThread]: 
00:02:58.207381 [info ] [MainThread]: Finished running 1 table model in 5.31s.
00:02:58.208382 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:58.209381 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:02:58.210382 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:02:58.210382 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:02:58.221382 [info ] [MainThread]: 
00:02:58.222379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:02:58.223399 [info ] [MainThread]: 
00:02:58.224415 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:02:58.226399 [error] [MainThread]:   Invalid date: '2012-05-30T00:00:00.000000Z'
00:02:58.227392 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:02:58.229379 [info ] [MainThread]: 
00:02:58.230381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:02:58.232380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC54220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC317C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A58EC26EE0>]}


============================== 2022-04-27 00:07:02.686996 | b32aa472-700a-4242-a946-62a3cec65ab5 ==============================
00:07:02.686996 [info ] [MainThread]: Running with dbt=1.0.4
00:07:02.687998 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:07:02.689000 [debug] [MainThread]: Tracking: tracking
00:07:02.704003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963B3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963D4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222963D4AC0>]}
00:07:02.865999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:07:02.867000 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:07:02.868002 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:07:02.885999 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:07:02.924034 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:07:02.927012 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:07:02.943001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296605F70>]}
00:07:02.957003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222965E6A60>]}
00:07:02.957003 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:07:02.959999 [info ] [MainThread]: 
00:07:02.961999 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:07:02.963030 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:07:02.964004 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:07:03.735999 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:07:03.735999 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:07:04.358000 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:07:04.359030 [info ] [MainThread]: 
00:07:04.367000 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.368013 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:07:04.369001 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:07:04.370002 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.371000 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:07:04.378049 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:07:04.382035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:07:04.413002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:07:04.414004 [debug] [Thread-1  ]: finished collecting timing info
00:07:04.415002 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:07:04.441002 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:07:05.013563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:07:05.014564 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as TIMESTAMP_NTZ) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:07:05.924564 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: TIMESTAMP_NTZ at [34:30]')
00:07:07.808218 [debug] [Thread-1  ]: finished collecting timing info
00:07:07.809214 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Type not found: TIMESTAMP_NTZ at [34:30]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:07:07.810217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32aa472-700a-4242-a946-62a3cec65ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296702A30>]}
00:07:07.811217 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 3.44s]
00:07:07.813241 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:07:07.815230 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:07:07.816237 [info ] [MainThread]: 
00:07:07.817270 [info ] [MainThread]: Finished running 1 table model in 4.86s.
00:07:07.819241 [debug] [MainThread]: Connection 'master' was properly closed.
00:07:07.819241 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:07:07.820245 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:07:07.820245 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:07:07.830219 [info ] [MainThread]: 
00:07:07.831217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:07:07.833219 [info ] [MainThread]: 
00:07:07.834218 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:07:07.836218 [error] [MainThread]:   Type not found: TIMESTAMP_NTZ at [34:30]
00:07:07.837218 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:07:07.838219 [info ] [MainThread]: 
00:07:07.839219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:07:07.840218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229662F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296658DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022296640220>]}


============================== 2022-04-27 00:08:18.567814 | 6cb08608-f515-41f1-9de3-d6753b15e231 ==============================
00:08:18.567814 [info ] [MainThread]: Running with dbt=1.0.4
00:08:18.568811 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:08:18.568811 [debug] [MainThread]: Tracking: tracking
00:08:18.582811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7243E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7264670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7264AF0>]}
00:08:18.721317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:08:18.722316 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:08:18.735317 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:08:18.763316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7498F70>]}
00:08:18.776318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E747AA60>]}
00:08:18.777337 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:08:18.779319 [info ] [MainThread]: 
00:08:18.780319 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:08:18.782323 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:08:18.783319 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:19.486316 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:08:19.487366 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:20.067984 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:08:20.068986 [info ] [MainThread]: 
00:08:20.076991 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.076991 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:08:20.078988 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.079991 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.080995 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:08:20.108025 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:08:20.112026 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:08:20.135042 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.137116 [debug] [Thread-1  ]: finished collecting timing info
00:08:20.137116 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:08:20.153181 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:08:20.754741 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:08:20.756672 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,sellenddate::timestamp_ntz as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:08:21.048299 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ":" at [34:21]')
00:08:21.357533 [debug] [Thread-1  ]: finished collecting timing info
00:08:21.358569 [debug] [Thread-1  ]: Database Error in model dim_Products (models\marts\dim_Products.sql)
  Syntax error: Expected ")" but got ":" at [34:21]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:08:21.359527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb08608-f515-41f1-9de3-d6753b15e231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E758ACA0>]}
00:08:21.359527 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Products............. [[31mERROR[0m in 1.28s]
00:08:21.361529 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:08:21.362529 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:08:21.364548 [info ] [MainThread]: 
00:08:21.365530 [info ] [MainThread]: Finished running 1 table model in 2.58s.
00:08:21.366550 [debug] [MainThread]: Connection 'master' was properly closed.
00:08:21.367544 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:08:21.367544 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:08:21.368530 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:08:21.378530 [info ] [MainThread]: 
00:08:21.379528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:08:21.381534 [info ] [MainThread]: 
00:08:21.383527 [error] [MainThread]: [33mDatabase Error in model dim_Products (models\marts\dim_Products.sql)[0m
00:08:21.385531 [error] [MainThread]:   Syntax error: Expected ")" but got ":" at [34:21]
00:08:21.386550 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Products.sql
00:08:21.387530 [info ] [MainThread]: 
00:08:21.388529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:08:21.389531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7468B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7468F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E7499610>]}


============================== 2022-04-27 00:12:25.034181 | dda5ca89-220c-4235-a314-2839d5a2f041 ==============================
00:12:25.034181 [info ] [MainThread]: Running with dbt=1.0.4
00:12:25.035183 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:12:25.036182 [debug] [MainThread]: Tracking: tracking
00:12:25.052210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A882E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A8A5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4A8A5640>]}
00:12:25.173181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:12:25.173181 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:12:25.187181 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:12:25.216968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAD5F70>]}
00:12:25.230996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAB8A60>]}
00:12:25.231965 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:12:25.233968 [info ] [MainThread]: 
00:12:25.235965 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:12:25.236967 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:12:25.237967 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:12:25.913124 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:12:25.914123 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:12:26.491122 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:12:26.492141 [info ] [MainThread]: 
00:12:26.499123 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.499123 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:12:26.500123 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:12:26.501127 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.501127 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:12:26.527154 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:12:26.531129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:12:26.553912 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:12:26.554912 [debug] [Thread-1  ]: finished collecting timing info
00:12:26.555929 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:12:26.572946 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:12:27.194050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:12:27.196052 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as date) as sellStartDate
        ,cast(discontinueddate as date) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            --,sellEndDate
            ,reorderPoint
            ,standardCost
            --,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:12:29.956183 [debug] [Thread-1  ]: finished collecting timing info
00:12:29.957183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dda5ca89-220c-4235-a314-2839d5a2f041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAD7100>]}
00:12:29.958183 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 120.5 KB processed)[0m in 3.46s]
00:12:29.959183 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:12:29.961182 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:12:29.961182 [info ] [MainThread]: 
00:12:29.962182 [info ] [MainThread]: Finished running 1 table model in 4.73s.
00:12:29.963187 [debug] [MainThread]: Connection 'master' was properly closed.
00:12:29.964187 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:12:29.964187 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:12:29.965183 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:12:29.977212 [info ] [MainThread]: 
00:12:29.978193 [info ] [MainThread]: [32mCompleted successfully[0m
00:12:29.980184 [info ] [MainThread]: 
00:12:29.981184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:12:29.983191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAA8B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAA8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4AAB8910>]}


============================== 2022-04-27 00:13:08.498738 | 51172ace-ac48-4ec3-a5c4-e2a507270015 ==============================
00:13:08.498738 [info ] [MainThread]: Running with dbt=1.0.4
00:13:08.499708 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:13:08.500709 [debug] [MainThread]: Tracking: tracking
00:13:08.514713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163C3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163E4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0163E4A30>]}
00:13:08.659705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:13:08.659705 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Products.sql
00:13:08.660680 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
00:13:08.673706 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:13:08.688675 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:13:08.710674 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:13:08.726232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0166860D0>]}
00:13:08.739224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0165F6A60>]}
00:13:08.740195 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:13:08.743206 [info ] [MainThread]: 
00:13:08.744245 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:08.747198 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:13:08.747198 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:09.369229 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:13:09.370201 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:09.963874 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:13:09.964904 [info ] [MainThread]: 
00:13:09.972844 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:13:09.973852 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:13:09.976847 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:13:09.977867 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:13:09.978845 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:13:09.985844 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:13:09.988847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:13:10.013884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:13:10.015848 [debug] [Thread-1  ]: finished collecting timing info
00:13:10.015848 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:13:10.035847 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:13:10.635732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:13:10.636770 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
00:13:13.340174 [debug] [Thread-1  ]: finished collecting timing info
00:13:13.340174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51172ace-ac48-4ec3-a5c4-e2a507270015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016708A00>]}
00:13:13.341174 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.36s]
00:13:13.343164 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:13:13.346143 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:13.347140 [info ] [MainThread]: 
00:13:13.348140 [info ] [MainThread]: Finished running 1 table model in 4.60s.
00:13:13.349176 [debug] [MainThread]: Connection 'master' was properly closed.
00:13:13.349176 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:13:13.350141 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:13:13.350141 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
00:13:13.359869 [info ] [MainThread]: 
00:13:13.360878 [info ] [MainThread]: [32mCompleted successfully[0m
00:13:13.361880 [info ] [MainThread]: 
00:13:13.363907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:13:13.364881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016653B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C016653280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0165F67C0>]}


============================== 2022-04-27 00:13:45.692651 | 10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6 ==============================
00:13:45.692651 [info ] [MainThread]: Running with dbt=1.0.4
00:13:45.693652 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:13:45.694660 [debug] [MainThread]: Tracking: tracking
00:13:45.733652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261442F4EB0>]}
00:13:46.375720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:13:46.376721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:13:46.384718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445390D0>]}
00:13:46.397737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026144505580>]}
00:13:46.397737 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:13:46.400721 [info ] [MainThread]: 
00:13:46.401719 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:46.403725 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
00:13:46.403725 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:47.176383 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
00:13:47.177386 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:47.756941 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
00:13:47.757942 [info ] [MainThread]: 
00:13:47.764941 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.765941 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:13:47.766940 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.767945 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.767945 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.790970 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:13:47.794941 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:13:47.812973 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.814940 [debug] [Thread-1  ]: finished collecting timing info
00:13:47.814940 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:47.850976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:13:47.851938 [debug] [Thread-1  ]: Opening a new connection, currently in state init
00:13:47.856936 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
00:13:48.494200 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
00:13:49.793350 [debug] [Thread-1  ]: finished collecting timing info
00:13:49.794353 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
00:13:49.795349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e7b1b8-62af-4ced-88ab-2f8a9b4c66e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445F9550>]}
00:13:49.796350 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.03s]
00:13:49.797351 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:13:49.799349 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:13:49.800350 [info ] [MainThread]: 
00:13:49.801354 [info ] [MainThread]: Finished running 1 table model in 3.40s.
00:13:49.802350 [debug] [MainThread]: Connection 'master' was properly closed.
00:13:49.803352 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
00:13:49.804352 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
00:13:49.805353 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:13:49.818350 [info ] [MainThread]: 
00:13:49.820349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:13:49.822352 [info ] [MainThread]: 
00:13:49.823350 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
00:13:49.825354 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
00:13:49.827365 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
00:13:49.828367 [info ] [MainThread]: 
00:13:49.829351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:13:49.831353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261445054F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614452C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614464E0A0>]}


============================== 2022-04-27 01:33:23.071706 | 3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee ==============================
01:33:23.071706 [info ] [MainThread]: Running with dbt=1.0.4
01:33:23.072755 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
01:33:23.073709 [debug] [MainThread]: Tracking: tracking
01:33:23.088712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AD3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AF4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7AF48B0>]}
01:33:23.278739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
01:33:23.279740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
01:33:23.287733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7D390D0>]}
01:33:23.301741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7B635E0>]}
01:33:23.302705 [info ] [MainThread]: Found 13 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
01:33:23.304717 [info ] [MainThread]: 
01:33:23.306735 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:33:23.308708 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
01:33:23.309706 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:33:25.513257 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
01:33:25.514257 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:33:26.202772 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
01:33:26.203771 [info ] [MainThread]: 
01:33:26.212773 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.213769 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
01:33:26.214771 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.215779 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.216789 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.241773 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
01:33:26.244774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
01:33:26.267773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.268773 [debug] [Thread-1  ]: finished collecting timing info
01:33:26.269771 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:26.306805 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
01:33:26.308770 [debug] [Thread-1  ]: Opening a new connection, currently in state init
01:33:26.315769 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,countryregioncode as countryRegionCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,countryRegionCode
            ,rowguid
        from SalesTerritories
    )

select * from final
  );
  
01:33:27.187656 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [22:9]')
01:33:28.616998 [debug] [Thread-1  ]: finished collecting timing info
01:33:28.617957 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [22:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
01:33:28.618955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e793ad7-baa8-48f7-9bb0-54fbaa3b61ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7DE06D0>]}
01:33:28.619955 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.40s]
01:33:28.620957 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
01:33:28.622961 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:33:28.623956 [info ] [MainThread]: 
01:33:28.624956 [info ] [MainThread]: Finished running 1 table model in 5.32s.
01:33:28.625958 [debug] [MainThread]: Connection 'master' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
01:33:28.626960 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
01:33:28.639957 [info ] [MainThread]: 
01:33:28.640958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
01:33:28.641957 [info ] [MainThread]: 
01:33:28.642955 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
01:33:28.643957 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [22:9]
01:33:28.643957 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
01:33:28.644981 [info ] [MainThread]: 
01:33:28.645955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
01:33:28.646955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7B634C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7D2A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A7E4F1F0>]}


============================== 2022-04-27 14:13:23.387145 | 92004c19-4ba0-4fed-9317-7c279b47f70a ==============================
14:13:23.387145 [info ] [MainThread]: Running with dbt=1.0.4
14:13:23.389073 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:13:23.390077 [debug] [MainThread]: Tracking: tracking
14:13:23.406647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E10E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E34430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B619E34AF0>]}
14:13:24.248390 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:13:24.249365 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:13:24.249365 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:13:24.250342 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:13:24.250342 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:13:24.251335 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:13:24.252296 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:13:24.252296 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:13:24.253281 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:13:24.254247 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:13:24.255225 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:13:24.255225 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:13:24.256201 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:13:24.256201 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:13:24.257177 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:13:24.257177 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:13:24.258154 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:13:24.258154 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:13:24.258154 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:13:24.259130 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:13:24.259130 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:13:24.260109 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:13:24.260109 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:13:24.274755 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:13:24.320683 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:13:24.323595 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:13:24.326538 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:13:24.329468 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:13:24.332397 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:13:24.341186 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:13:24.342164 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:13:24.349001 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:13:24.350953 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:13:24.353881 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:13:24.356811 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:13:24.359740 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:13:24.366576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:13:24.368502 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:13:24.373410 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:13:24.379269 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:13:24.392914 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:13:24.394867 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:13:24.422237 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_CreditCard' in the 'models' section of file 'models\marts\dim_CreditCards.yml'
14:13:24.496420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A069790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A093040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61A0936A0>]}


============================== 2022-04-27 14:14:46.385779 | 1ac5ba0a-9bab-4d31-91e3-5a61edaace24 ==============================
14:14:46.385779 [info ] [MainThread]: Running with dbt=1.0.4
14:14:46.386756 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:14:46.386756 [debug] [MainThread]: Tracking: tracking
14:14:46.403364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DCDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DD3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D9DD3220>]}
14:14:46.529348 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:14:46.530328 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:14:46.530328 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:14:46.531304 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:14:46.532253 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:14:46.532253 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:14:46.533239 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:14:46.533239 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:14:46.535183 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:14:46.535183 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:14:46.536193 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:14:46.537145 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:14:46.537145 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:14:46.538113 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:14:46.538113 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:14:46.539092 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:14:46.539092 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:14:46.540072 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:14:46.540072 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:14:46.541055 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:14:46.542019 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:14:46.555690 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:14:46.576195 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:14:46.598657 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:14:46.600613 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:14:46.604525 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:14:46.607448 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:14:46.615260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:14:46.617214 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:14:46.623072 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:14:46.625028 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:14:46.628936 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:14:46.631860 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:14:46.634790 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:14:46.640649 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:14:46.642602 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:14:46.645551 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:14:46.648462 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:14:46.654320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:14:46.656275 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:14:46.742198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA008760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA07DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0DA07DDF0>]}


============================== 2022-04-27 14:15:19.651730 | 3c2412e8-034c-40a2-a725-1268add661a4 ==============================
14:15:19.651730 [info ] [MainThread]: Running with dbt=1.0.4
14:15:19.652702 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:15:19.652702 [debug] [MainThread]: Tracking: tracking
14:15:19.677114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C31C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B28C33A0>]}
14:15:19.817730 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:15:19.817730 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:15:19.818710 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:15:19.819688 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:15:19.820661 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:15:19.820661 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:15:19.821639 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:15:19.822614 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:15:19.824565 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:15:19.826518 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:15:19.826518 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:15:19.827498 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:15:19.827498 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:15:19.828472 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:15:19.828472 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:15:19.829448 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:15:19.829448 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:15:19.830425 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:15:19.830425 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:15:19.831405 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:15:19.831405 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:15:19.832377 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:19.833354 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:15:19.847025 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:15:19.884132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:15:19.886084 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:15:19.891943 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:15:19.896832 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:15:19.901722 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:15:19.909521 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:15:19.912451 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:15:19.919286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:15:19.921252 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:15:19.925145 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:15:19.928074 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:15:19.931980 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:19.938819 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:19.940769 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:15:19.945651 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:15:19.951512 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:19.961279 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:19.963230 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:15:20.073573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2AF8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2B59D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2B59910>]}


============================== 2022-04-27 14:15:49.951783 | eeee387c-aa23-45d1-b1fb-e419b8b443b9 ==============================
14:15:49.951783 [info ] [MainThread]: Running with dbt=1.0.4
14:15:49.952772 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
14:15:49.953736 [debug] [MainThread]: Tracking: tracking
14:15:49.970342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D04430>]}
14:15:50.150015 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 4 files changed.
14:15:50.150992 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
14:15:50.151969 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:15:50.152942 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:15:50.152942 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:15:50.153933 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:15:50.153933 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:15:50.154895 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CountryRegions.sql
14:15:50.155871 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:15:50.156847 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:15:50.157838 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:15:50.157838 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:15:50.158801 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:15:50.158801 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:15:50.159785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:15:50.159785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:15:50.160753 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:15:50.160753 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:15:50.161731 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\marts\dim_CreditCard.sql
14:15:50.161731 [debug] [MainThread]: Partial parsing: deleted file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCard.sql
14:15:50.162707 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:15:50.162707 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:15:50.163683 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:50.178330 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:15:50.194930 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:15:50.224262 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:15:50.226181 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:15:50.230088 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:15:50.233014 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:15:50.241802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:15:50.244353 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:15:50.252172 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:15:50.255103 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:15:50.258031 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:15:50.261937 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:15:50.265844 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:50.272679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:50.274630 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:15:50.278538 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:15:50.282444 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:50.290254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:50.292207 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:15:50.452384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeee387c-aa23-45d1-b1fb-e419b8b443b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE708F0D0>]}
14:15:50.473836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeee387c-aa23-45d1-b1fb-e419b8b443b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6E8F340>]}
14:15:50.473836 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:50.478720 [info ] [MainThread]: 
14:15:50.480677 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:50.482627 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:50.482627 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:52.107335 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:52.109292 [info ] [MainThread]: 
14:15:52.168711 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.168711 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.169697 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:52.170688 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:52.170688 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.171652 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.171652 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.172631 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.175592 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:52.178521 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:52.179465 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.179465 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.180441 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:52.181418 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:52.182397 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.183378 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.184347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:52.185322 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:52.186305 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.186305 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.187301 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.187301 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.193168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:52.196098 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:52.198016 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.198995 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:52.198995 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.199983 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.200947 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:52.200947 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:52.201922 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.202898 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.202898 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:52.203877 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.204856 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.207819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:52.208772 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.211722 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:52.212681 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.213642 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:52.213642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.213642 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.214625 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:52.215593 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:52.216576 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.216576 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.217576 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.217576 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:52.222468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:52.222468 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.223405 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.224382 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.227310 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:52.228289 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:52.229278 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.230242 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:52.230242 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.230242 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.231220 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:52.232229 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.233169 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.236135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:52.237077 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:52.237077 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.238053 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.239036 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.255665 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:52.255665 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:52.256642 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.258558 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:15:52.258558 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.258558 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.259539 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.259539 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:15:52.260511 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.281052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:52.281052 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:52.282972 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.282972 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:52.283947 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.283947 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.296649 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:52.363552 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.364528 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.365501 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.366481 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:15:52.366481 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.367457 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:52.368445 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.368445 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.388939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:52.488061 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.489036 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.489036 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.490010 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:52.624742 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.625716 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.625716 [debug] [Thread-1  ]: finished collecting timing info
14:15:52.626696 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:52.627669 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.628648 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:52.628648 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.629622 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.683366 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:52.691159 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.691159 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.692121 [debug] [Thread-2  ]: finished collecting timing info
14:15:52.693131 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:52.694071 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:15:52.695058 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:15:52.707745 [info ] [MainThread]: Done.
14:15:52.708741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6E8F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D5BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFE6D5B190>]}


============================== 2022-04-27 14:16:02.354979 | 9141af10-df57-4088-92a3-376eef45e06a ==============================
14:16:02.354979 [info ] [MainThread]: Running with dbt=1.0.4
14:16:02.354979 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:16:02.356927 [debug] [MainThread]: Tracking: tracking
14:16:02.378414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580D9EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DA4EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DA4220>]}
14:16:02.515138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:16:02.516114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:16:02.523948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580FFE0D0>]}
14:16:02.537580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580F0E6D0>]}
14:16:02.538561 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:16:02.542466 [info ] [MainThread]: 
14:16:02.543441 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:16:02.545423 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:16:02.546368 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:16:03.130566 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:16:03.131545 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:16:03.821598 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:16:03.823540 [info ] [MainThread]: 
14:16:03.831354 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.832329 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.833304 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:16:03.834281 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:16:03.835256 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.836245 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.837228 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.837228 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.842094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:16:03.846973 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:16:03.848474 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.848474 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.849448 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:16:03.851404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:16:03.852382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.853358 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.854332 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:16:03.855317 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:16:03.856301 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.856301 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.857263 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.857263 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.861169 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:16:03.865076 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:16:03.867035 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.868003 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.868980 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:16:03.869958 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:16:03.869958 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.870932 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.871908 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:16:03.872902 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:16:03.872902 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.873863 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.873863 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.874838 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.878741 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:16:03.882652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:16:03.884605 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.884605 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.885581 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:16:03.886555 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:16:03.887552 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.888524 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.888524 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:16:03.889485 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:16:03.890475 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.890475 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.892417 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.892417 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.896328 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:16:03.899251 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:16:03.901211 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.901211 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.902185 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:16:03.903156 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:16:03.904135 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.904135 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.905113 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:16:03.906086 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:16:03.907063 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.909020 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:03.909020 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.909996 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.914876 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:16:03.915858 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.946124 [debug] [Thread-1  ]: finished collecting timing info
14:16:03.957840 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:03.958817 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:16:03.959811 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:16:03.960769 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:16:03.961746 [debug] [Thread-2  ]: finished collecting timing info
14:16:03.962735 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:16:03.963699 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:03.964679 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:16:03.989090 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:16:04.007644 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:16:04.032069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:16:04.033027 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:16:04.034032 [debug] [Thread-1  ]: finished collecting timing info
14:16:04.034995 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:16:04.039868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:16:04.041820 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:16:04.617954 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:16:04.618933 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:16:07.243977 [debug] [Thread-2  ]: finished collecting timing info
14:16:07.244923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810C1A30>]}
14:16:07.244923 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.34s]
14:16:07.247857 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:16:07.247857 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.248834 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:16:07.250786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.250786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.251765 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.275194 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.277154 [debug] [Thread-2  ]: finished collecting timing info
14:16:07.278126 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:07.281088 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:16:07.727346 [debug] [Thread-1  ]: finished collecting timing info
14:16:07.728292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810986D0>]}
14:16:07.729289 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.77s]
14:16:07.731221 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:16:07.731221 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.732199 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:16:07.734153 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.734153 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.735159 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.756610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.757641 [debug] [Thread-1  ]: finished collecting timing info
14:16:07.758567 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:07.762470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:16:07.763482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:16:07.769305 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            --,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:16:07.826920 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:16:07.828873 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:16:08.378642 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:16:09.162142 [debug] [Thread-1  ]: finished collecting timing info
14:16:09.163122 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:16:09.163122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5821AEE50>]}
14:16:09.164097 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.43s]
14:16:09.166070 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:16:11.164036 [debug] [Thread-2  ]: finished collecting timing info
14:16:11.165012 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9141af10-df57-4088-92a3-376eef45e06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580DF1700>]}
14:16:11.165991 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.92s]
14:16:11.167944 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:16:11.169896 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:16:11.169896 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:16:11.171851 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:16:11.174778 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:16:11.176734 [info ] [MainThread]: 
14:16:11.177709 [info ] [MainThread]: Finished running 5 table models in 8.63s.
14:16:11.178686 [debug] [MainThread]: Connection 'master' was properly closed.
14:16:11.179661 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:16:11.180637 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:16:11.180637 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:16:11.181615 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:16:11.232011 [info ] [MainThread]: 
14:16:11.232986 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:16:11.234939 [info ] [MainThread]: 
14:16:11.235916 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:16:11.236893 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:16:11.238849 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:16:11.239825 [info ] [MainThread]: 
14:16:11.240798 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:16:11.243730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5810A6E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580F0E1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5821A2A90>]}


============================== 2022-04-27 14:17:49.677058 | 35ed8691-bb7c-4f6d-9121-72249556c0a3 ==============================
14:17:49.677058 [info ] [MainThread]: Running with dbt=1.0.4
14:17:49.678022 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:17:49.678998 [debug] [MainThread]: Tracking: tracking
14:17:49.692670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F4EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F54D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767F54340>]}
14:17:49.812805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:17:49.812805 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:17:49.825500 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:17:49.855748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:17:49.885044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76823A0D0>]}
14:17:49.898717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7680A3B20>]}
14:17:49.899685 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:17:49.902616 [info ] [MainThread]: 
14:17:49.904574 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:49.906526 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:17:49.906526 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:50.479865 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:17:50.480853 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:51.025392 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:17:51.026368 [info ] [MainThread]: 
14:17:51.035156 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.036134 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.037112 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:51.038092 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:51.038092 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.039081 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.040043 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.040043 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.042966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:51.045933 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:51.046877 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.047852 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.047852 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:51.048829 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:51.048829 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.049806 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.050786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:51.051758 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:51.051758 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.052740 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.053714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.053714 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.057619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:51.061557 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:51.062501 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.063484 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.064455 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:51.064455 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:51.065462 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.066408 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.067381 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:51.068357 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:51.068357 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.069335 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.070309 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.071286 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.074218 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:51.077180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:51.079101 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.080079 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:51.080079 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.080079 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.081053 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:51.082028 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:51.082028 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.083002 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.083981 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.084960 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:51.088868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:51.089839 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.090825 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.093780 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:51.094741 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.095715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:51.096675 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.096675 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.097668 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:51.098630 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:51.098630 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.099608 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.100637 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:17:51.100637 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.103513 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.106475 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:51.107416 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.108395 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.114287 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.127958 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.127958 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:51.128902 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.130853 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:17:51.130853 [debug] [Thread-2  ]: finished collecting timing info
14:17:51.131833 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.132816 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:51.133797 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.155266 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:51.156247 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:17:51.182609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.184565 [debug] [Thread-1  ]: finished collecting timing info
14:17:51.186512 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:17:51.189473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:51.747865 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:51.748842 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:51.750795 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:17:51.750795 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:17:54.500963 [debug] [Thread-1  ]: finished collecting timing info
14:17:54.501923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7682B9A60>]}
14:17:54.502897 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.37s]
14:17:54.504868 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:17:54.505840 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.505840 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:17:54.507782 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:54.507782 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.508762 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.525376 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:54.527311 [debug] [Thread-1  ]: finished collecting timing info
14:17:54.527311 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:54.530240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:54.686478 [debug] [Thread-2  ]: finished collecting timing info
14:17:54.687480 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D768311B80>]}
14:17:54.688432 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.58s]
14:17:54.690404 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:54.691366 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.692338 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:17:54.693349 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.694310 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.694310 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.721638 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.726515 [debug] [Thread-2  ]: finished collecting timing info
14:17:54.727492 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:54.731399 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:54.733352 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:54.740189 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:17:55.068299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:55.070255 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:17:55.325304 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:17:56.611121 [debug] [Thread-2  ]: finished collecting timing info
14:17:56.612098 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:17:56.613097 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7682B8970>]}
14:17:56.614052 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.92s]
14:17:56.615035 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:58.058295 [debug] [Thread-1  ]: finished collecting timing info
14:17:58.059275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ed8691-bb7c-4f6d-9121-72249556c0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D767FA2F40>]}
14:17:58.059275 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.55s]
14:17:58.061229 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:58.063194 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:58.063194 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:17:58.065148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:58.067086 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:58.068062 [info ] [MainThread]: 
14:17:58.069057 [info ] [MainThread]: Finished running 5 table models in 8.16s.
14:17:58.070016 [debug] [MainThread]: Connection 'master' was properly closed.
14:17:58.070992 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:17:58.071969 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:17:58.071969 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:17:58.072945 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:17:58.090524 [info ] [MainThread]: 
14:17:58.091498 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:17:58.093450 [info ] [MainThread]: 
14:17:58.094432 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:17:58.095402 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:17:58.096379 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:17:58.097357 [info ] [MainThread]: 
14:17:58.098334 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:17:58.100288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76816FF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7680A3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76833A7F0>]}


============================== 2022-04-27 14:18:35.200902 | 994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe ==============================
14:18:35.200902 [info ] [MainThread]: Running with dbt=1.0.4
14:18:35.201847 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:35.202821 [debug] [MainThread]: Tracking: tracking
14:18:35.217472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFC2E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFE5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75CFE53A0>]}
14:18:35.349893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:18:35.349893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:18:35.361581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D23F0D0>]}
14:18:35.380136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '994eb5e5-96e7-41c4-9671-d2ed5c2c3fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D059700>]}
14:18:35.380136 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:35.383069 [info ] [MainThread]: 
14:18:35.384043 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:35.385998 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:18:35.386976 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:35.951763 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:18:35.952762 [info ] [MainThread]: 
14:18:35.961526 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.962506 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:18:35.963482 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.963482 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.967391 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:18:35.968367 [debug] [Thread-1  ]: finished collecting timing info
14:18:35.969345 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:18:35.970318 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:35.971332 [info ] [MainThread]: 
14:18:35.972270 [info ] [MainThread]: Finished running  in 0.59s.
14:18:35.973247 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:35.973247 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:18:35.974225 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories' was properly closed.
14:18:35.986952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D130DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D059CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75D0596D0>]}


============================== 2022-04-27 14:18:58.631773 | 07ae3af3-bf10-4e00-8ce1-c376b089a408 ==============================
14:18:58.631773 [info ] [MainThread]: Running with dbt=1.0.4
14:18:58.632750 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_CountryRegions'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:58.633732 [debug] [MainThread]: Tracking: tracking
14:18:58.649352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472C9EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472CA4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472CA4220>]}
14:18:58.765554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:18:58.766531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:18:58.774342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ae3af3-bf10-4e00-8ce1-c376b089a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472EFF0D0>]}
14:18:58.787037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ae3af3-bf10-4e00-8ce1-c376b089a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D196D0>]}
14:18:58.788014 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:58.789969 [info ] [MainThread]: 
14:18:58.791922 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:58.793873 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:18:58.793873 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:59.334961 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:18:59.335935 [info ] [MainThread]: 
14:18:59.343748 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.344726 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:18:59.345702 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.345702 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.350619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:18:59.351559 [debug] [Thread-1  ]: finished collecting timing info
14:18:59.352533 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:18:59.354488 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:59.355466 [info ] [MainThread]: 
14:18:59.356441 [info ] [MainThread]: Finished running  in 0.56s.
14:18:59.357417 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:59.358392 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:18:59.359378 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions' was properly closed.
14:18:59.373048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472DF0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D19B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029472D19730>]}


============================== 2022-04-27 14:19:19.723407 | cbb866cf-da66-472b-a933-a900f41cda77 ==============================
14:19:19.723407 [info ] [MainThread]: Running with dbt=1.0.4
14:19:19.724384 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:19:19.724384 [debug] [MainThread]: Tracking: tracking
14:19:19.741965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B6F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B75BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90B75B50>]}
14:19:19.871870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:19:19.872847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:19:19.880623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90DD00D0>]}
14:19:19.893319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90CB66A0>]}
14:19:19.894295 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:19:19.896248 [info ] [MainThread]: 
14:19:19.897225 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:19.899181 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:19:19.900171 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:20.484522 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:19:20.485465 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:21.033638 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:19:21.034620 [info ] [MainThread]: 
14:19:21.042430 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.043409 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:19:21.045366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.045366 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.046376 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.070776 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:21.073710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:21.074661 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:21.077616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:21.097114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.099071 [debug] [Thread-1  ]: finished collecting timing info
14:19:21.099071 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:21.133276 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:21.135197 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:19:21.140111 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id = CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:19:21.698047 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:19:22.057163 [debug] [Thread-1  ]: finished collecting timing info
14:19:22.058176 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:19:22.059148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb866cf-da66-472b-a933-a900f41cda77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90EA3790>]}
14:19:22.059148 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.01s]
14:19:22.061069 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:22.063038 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:22.064023 [info ] [MainThread]: 
14:19:22.064971 [info ] [MainThread]: Finished running 1 table model in 2.17s.
14:19:22.065950 [debug] [MainThread]: Connection 'master' was properly closed.
14:19:22.066924 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:19:22.067899 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:19:22.067899 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:19:22.081570 [info ] [MainThread]: 
14:19:22.082548 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:19:22.084511 [info ] [MainThread]: 
14:19:22.085476 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:19:22.087427 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:19:22.088408 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:19:22.089382 [info ] [MainThread]: 
14:19:22.091356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:19:22.092312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90EAA1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90CB61C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E90E4CA90>]}


============================== 2022-04-27 14:32:08.743710 | 6275035c-351d-4be4-b6db-072c2fedc771 ==============================
14:32:08.743710 [info ] [MainThread]: Running with dbt=1.0.4
14:32:08.744687 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:32:08.745652 [debug] [MainThread]: Tracking: tracking
14:32:08.760294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBAFFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBB05EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBB05220>]}
14:32:08.907727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
14:32:08.908705 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.yml
14:32:08.908705 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.yml
14:32:08.909682 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Products.yml
14:32:08.910659 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.yml
14:32:08.927261 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:32:08.962411 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:32:08.964368 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:32:08.972177 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:32:08.974129 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:32:08.982921 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:32:08.984874 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:32:08.991709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:32:09.083501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBE910A0>]}
14:32:09.103030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD24850>]}
14:32:09.103030 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:32:09.106970 [info ] [MainThread]: 
14:32:09.108890 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:32:09.110843 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:32:09.111819 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:11.003684 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:32:11.003684 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:12.299422 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:32:12.300398 [info ] [MainThread]: 
14:32:12.308207 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.309185 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:32:12.311146 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:12.312112 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.313090 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.319926 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:32:12.323866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:32:12.341443 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:12.342384 [debug] [Thread-1  ]: finished collecting timing info
14:32:12.342384 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:12.360976 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:32:13.660807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:32:13.662709 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:32:16.894227 [debug] [Thread-1  ]: finished collecting timing info
14:32:16.896182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6275035c-351d-4be4-b6db-072c2fedc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD8D220>]}
14:32:16.896182 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.59s]
14:32:16.899075 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:32:16.901031 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:32:16.902004 [info ] [MainThread]: 
14:32:16.902984 [info ] [MainThread]: Finished running 1 table model in 7.79s.
14:32:16.903960 [debug] [MainThread]: Connection 'master' was properly closed.
14:32:16.904936 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:32:16.905931 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:32:16.905931 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:32:16.920561 [info ] [MainThread]: 
14:32:16.921534 [info ] [MainThread]: [32mCompleted successfully[0m
14:32:16.923486 [info ] [MainThread]: 
14:32:16.924464 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:32:16.925444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD24970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD243A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EBD8DA90>]}


============================== 2022-04-27 14:33:07.914517 | 4cfcd44a-2e32-4970-91db-f1e91091558b ==============================
14:33:07.914517 [info ] [MainThread]: Running with dbt=1.0.4
14:33:07.915495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:33:07.916472 [debug] [MainThread]: Tracking: tracking
14:33:07.931119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD143A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD14430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAD14160>]}
14:33:08.064935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:33:08.064935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:33:08.074664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cfcd44a-2e32-4970-91db-f1e91091558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF820D0>]}
14:33:08.088334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cfcd44a-2e32-4970-91db-f1e91091558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAE777C0>]}
14:33:08.088334 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:33:08.093221 [info ] [MainThread]: 
14:33:08.094199 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:08.097125 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:33:08.098123 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:09.409766 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:33:09.411715 [info ] [MainThread]: 
14:33:09.420506 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.421482 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.421482 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:33:09.422457 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:33:09.424410 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.426365 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.427342 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.429294 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.428320 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.430270 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.455666 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.462500 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.464445 [debug] [Thread-1  ]: finished collecting timing info
14:33:09.464445 [debug] [Thread-2  ]: finished collecting timing info
14:33:09.465423 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:09.466406 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:09.504483 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:33:09.506469 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:33:09.508394 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:33:09.509364 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:33:09.514254 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:33:09.516200 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:33:12.034747 [debug] [Thread-1  ]: finished collecting timing info
14:33:12.035724 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.61s]
14:33:12.037674 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:33:12.277324 [debug] [Thread-2  ]: finished collecting timing info
14:33:12.278322 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.85s]
14:33:12.280261 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:33:12.284153 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:33:12.284153 [info ] [MainThread]: 
14:33:12.285126 [info ] [MainThread]: Finished running 2 tests in 4.19s.
14:33:12.287086 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:12.287086 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:33:12.288053 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:33:12.288053 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:33:12.307631 [info ] [MainThread]: 
14:33:12.308562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:33:12.310515 [info ] [MainThread]: 
14:33:12.311490 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:33:12.313476 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:33:12.314420 [info ] [MainThread]: 
14:33:12.315394 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:33:12.317351 [info ] [MainThread]: 
14:33:12.319306 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:33:12.320278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF41BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAF4A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EAFF88E0>]}


============================== 2022-04-28 13:48:25.286199 | 89c22c29-2f1e-44f8-9c76-e86bc9116047 ==============================
13:48:25.286199 [info ] [MainThread]: Running with dbt=1.0.4
13:48:25.346162 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:48:25.347083 [debug] [MainThread]: Tracking: tracking
13:48:25.421382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D079EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D07A4BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D07A45E0>]}
13:48:26.123238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:48:26.124238 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
13:48:26.135237 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
13:48:26.167238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
13:48:26.206237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c22c29-2f1e-44f8-9c76-e86bc9116047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A750D0>]}
13:48:26.219238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c22c29-2f1e-44f8-9c76-e86bc9116047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A013D0>]}
13:48:26.220238 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:48:26.222240 [info ] [MainThread]: 
13:48:26.223237 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:48:26.225239 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:48:26.226260 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:48:27.129012 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:48:27.129974 [info ] [MainThread]: 
13:48:27.140997 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.141971 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:48:27.142976 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.143972 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.147995 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:48:27.149235 [debug] [Thread-1  ]: finished collecting timing info
13:48:27.149235 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:48:27.151246 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:48:27.151246 [info ] [MainThread]: 
13:48:27.152250 [info ] [MainThread]: Finished running  in 0.93s.
13:48:27.153247 [debug] [MainThread]: Connection 'master' was properly closed.
13:48:27.153247 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:48:27.153247 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories' was properly closed.
13:48:27.169165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D0A9DF10>]}


============================== 2022-04-28 13:49:00.687760 | 6ac02cce-7ba6-4b7a-8978-c69a76a2d34c ==============================
13:49:00.687760 [info ] [MainThread]: Running with dbt=1.0.4
13:49:00.688760 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_AdventureWorks_CountryRegions'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:49:00.688760 [debug] [MainThread]: Tracking: tracking
13:49:00.703735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C365EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C374940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C374580>]}
13:49:00.824760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:49:00.825761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:49:00.833766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac02cce-7ba6-4b7a-8978-c69a76a2d34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C5D20D0>]}
13:49:00.847736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac02cce-7ba6-4b7a-8978-c69a76a2d34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B97F0>]}
13:49:00.847736 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:49:00.850761 [info ] [MainThread]: 
13:49:00.851730 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:00.853762 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:49:00.854748 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:49:01.535686 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:49:01.536687 [info ] [MainThread]: 
13:49:01.544723 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.545688 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:49:01.545688 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.546725 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.550715 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:49:01.559578 [debug] [Thread-1  ]: finished collecting timing info
13:49:01.560588 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:49:01.562591 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:01.563596 [info ] [MainThread]: 
13:49:01.564609 [info ] [MainThread]: Finished running  in 0.71s.
13:49:01.566625 [debug] [MainThread]: Connection 'master' was properly closed.
13:49:01.567588 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:49:01.567588 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions' was properly closed.
13:49:01.578592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C4B9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2C59A820>]}


============================== 2022-04-28 13:50:25.085237 | 9ce746e8-4425-49a3-95c8-a5802ba0344e ==============================
13:50:25.085237 [info ] [MainThread]: Running with dbt=1.0.4
13:50:25.086237 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:50:25.087238 [debug] [MainThread]: Tracking: tracking
13:50:25.102239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749894FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498955DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174989556A0>]}
13:50:25.218237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:50:25.219237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:50:25.226237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498BC30D0>]}
13:50:25.239238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498AB3790>]}
13:50:25.239238 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:50:25.243238 [info ] [MainThread]: 
13:50:25.244238 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:50:25.246255 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
13:50:25.247247 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:25.869849 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:50:25.870887 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:26.479095 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:50:26.480095 [info ] [MainThread]: 
13:50:26.487096 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.488099 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
13:50:26.489096 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.491098 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.491098 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.516094 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
13:50:26.520095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
13:50:26.522094 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
13:50:26.526095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
13:50:26.550097 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.552106 [debug] [Thread-1  ]: finished collecting timing info
13:50:26.553105 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:26.593096 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
13:50:26.594117 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:50:26.599094 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories 
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
13:50:27.261451 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
13:50:28.562509 [debug] [Thread-1  ]: finished collecting timing info
13:50:28.563510 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
13:50:28.564507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ce746e8-4425-49a3-95c8-a5802ba0344e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498C2B3D0>]}
13:50:28.565507 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 2.08s]
13:50:28.567508 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
13:50:28.569508 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:50:28.570507 [info ] [MainThread]: 
13:50:28.572510 [info ] [MainThread]: Finished running 1 table model in 3.33s.
13:50:28.573509 [debug] [MainThread]: Connection 'master' was properly closed.
13:50:28.573509 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
13:50:28.574508 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:50:28.575509 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
13:50:28.594508 [info ] [MainThread]: 
13:50:28.595508 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:50:28.597508 [info ] [MainThread]: 
13:50:28.598508 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
13:50:28.599508 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
13:50:28.601509 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
13:50:28.602509 [info ] [MainThread]: 
13:50:28.603510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:50:28.605509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174989A2B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498BA7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498C2B340>]}


============================== 2022-04-28 14:08:42.727702 | 807d246a-8ac7-4a37-a46c-613ca3aee9af ==============================
14:08:42.727702 [info ] [MainThread]: Running with dbt=1.0.4
14:08:42.728702 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:08:42.729670 [debug] [MainThread]: Tracking: tracking
14:08:42.743669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7411B3DC0>]}
14:08:42.862696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:08:42.862696 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:08:42.874701 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:08:42.904695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:08:42.944702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7414830D0>]}
14:08:42.957670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74140F430>]}
14:08:42.958669 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:08:42.961672 [info ] [MainThread]: 
14:08:42.962680 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:08:42.964666 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:08:42.965669 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:43.727872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:08:43.727872 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:44.357888 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:08:44.358892 [info ] [MainThread]: 
14:08:44.368893 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.368893 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.369889 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:08:44.370888 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:08:44.370888 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.371886 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.372885 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.372885 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.377885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:08:44.384887 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:08:44.385889 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.386887 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:08:44.387889 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.387889 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.388888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:08:44.389890 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:08:44.390891 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.391889 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.392889 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:08:44.392889 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.393886 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.397887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:08:44.397887 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.403899 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:08:44.404885 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.405888 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:08:44.405888 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.406887 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.406887 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:08:44.408887 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:08:44.408887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.409899 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.409899 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:08:44.410921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.411887 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.414886 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:08:44.415890 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.418922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:08:44.419884 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.420885 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:08:44.420885 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.420885 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.421884 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:08:44.422888 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:08:44.423887 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.424887 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.425887 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.426890 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:08:44.431885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:08:44.432890 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.433907 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.436916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:08:44.437889 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.438886 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:08:44.438886 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.439885 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.439885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:08:44.440890 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:08:44.441885 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.441885 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.442887 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.443918 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:08:44.446884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:08:44.448890 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:44.449906 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.450894 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.450894 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.451886 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:08:44.473921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:44.473921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.474888 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:08:44.475886 [debug] [Thread-2  ]: finished collecting timing info
14:08:44.476885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:08:44.476885 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:44.477885 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.494923 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:08:44.494923 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:08:44.516890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:08:44.519885 [debug] [Thread-1  ]: finished collecting timing info
14:08:44.521883 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:08:44.524885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:08:45.162524 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:08:45.163525 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:08:45.182529 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:08:45.190793 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:08:48.258031 [debug] [Thread-2  ]: finished collecting timing info
14:08:48.259032 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74156A580>]}
14:08:48.259032 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.81s]
14:08:48.261034 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:08:48.262036 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.263032 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:08:48.264031 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.264031 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.265033 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.287069 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.289067 [debug] [Thread-1  ]: finished collecting timing info
14:08:48.290033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74152AC10>]}
14:08:48.290033 [debug] [Thread-2  ]: finished collecting timing info
14:08:48.291034 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.81s]
14:08:48.291034 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:48.296032 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:08:48.296032 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:08:48.297035 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.298033 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:08:48.300035 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.300035 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.301034 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.319059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.322057 [debug] [Thread-1  ]: finished collecting timing info
14:08:48.324032 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:48.328065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:08:48.329076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:08:48.334033 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,group
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,group
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:08:48.926369 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:08:48.927367 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:08:48.968724 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [24:9]')
14:08:50.264988 [debug] [Thread-1  ]: finished collecting timing info
14:08:50.265982 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Syntax error: Expected keyword BY but got "," at [24:9]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:08:50.266943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D742615A30>]}
14:08:50.266943 [error] [Thread-1  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 1.97s]
14:08:50.269167 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:08:52.246979 [debug] [Thread-2  ]: finished collecting timing info
14:08:52.247968 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807d246a-8ac7-4a37-a46c-613ca3aee9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74130A070>]}
14:08:52.247968 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.98s]
14:08:52.250943 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:08:52.251937 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:08:52.251937 [info ] [Thread-1  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:08:52.253978 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:08:52.255944 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:08:52.256942 [info ] [MainThread]: 
14:08:52.256942 [info ] [MainThread]: Finished running 5 table models in 9.29s.
14:08:52.257942 [debug] [MainThread]: Connection 'master' was properly closed.
14:08:52.258945 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:08:52.259939 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:08:52.259939 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:08:52.260942 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:08:52.275591 [info ] [MainThread]: 
14:08:52.276398 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:08:52.277411 [info ] [MainThread]: 
14:08:52.279413 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:08:52.281408 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [24:9]
14:08:52.283410 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:08:52.284446 [info ] [MainThread]: 
14:08:52.285409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:08:52.287413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741590FD0>]}


============================== 2022-04-28 14:14:35.409302 | 2fe89707-29a3-4944-8fad-8924351215b3 ==============================
14:14:35.409302 [info ] [MainThread]: Running with dbt=1.0.4
14:14:35.410303 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:14:35.411306 [debug] [MainThread]: Tracking: tracking
14:14:35.426307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2D0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2F4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC2F4880>]}
14:14:35.548308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:14:35.549327 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:14:35.550304 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:14:35.561303 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:14:35.575303 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:14:35.595304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:14:35.635309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC5CC0D0>]}
14:14:35.648305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC4509D0>]}
14:14:35.649305 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:14:35.652309 [info ] [MainThread]: 
14:14:35.654308 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:35.655305 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:14:35.656305 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:36.420443 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:14:36.421400 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:37.019709 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:14:37.020757 [info ] [MainThread]: 
14:14:37.028607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.028607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.029607 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:14:37.030609 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:14:37.030609 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.031608 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.031608 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.032607 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.036608 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:14:37.040647 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:14:37.042607 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.042607 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.043608 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:14:37.043608 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:14:37.044607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.045609 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.046608 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:14:37.047610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:14:37.047610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.048609 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.048609 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.049612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.052646 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:14:37.056646 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:14:37.057605 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.058607 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.058607 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:14:37.059606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:14:37.060607 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.060607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.061607 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:14:37.062610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:14:37.063607 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.063607 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.064607 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.065619 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.069607 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:14:37.072642 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:14:37.073607 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.074606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:14:37.075611 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.075611 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.076606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:14:37.076606 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:14:37.077607 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.078608 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.078608 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:37.079642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.079642 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.084647 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:14:37.085616 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.089605 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:37.089605 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.090629 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:14:37.091606 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.091606 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.092605 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:14:37.093606 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:37.093606 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.094606 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.094606 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.095605 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:14:37.098643 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:14:37.100609 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.101606 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.101606 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.102604 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.121644 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.122606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:14:37.123605 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.124610 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:14:37.124610 [debug] [Thread-2  ]: finished collecting timing info
14:14:37.125605 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.126609 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:37.126609 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.142644 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:14:37.143641 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:14:37.168401 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.170399 [debug] [Thread-1  ]: finished collecting timing info
14:14:37.171407 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:14:37.174437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:37.775060 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:14:37.776029 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:14:37.800096 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:14:37.802068 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:14:40.865021 [debug] [Thread-1  ]: finished collecting timing info
14:14:40.866022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC6AE370>]}
14:14:40.866987 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.74s]
14:14:40.868988 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:14:40.868988 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.869990 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:14:40.870984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:40.871985 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.871985 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.891025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:40.892008 [debug] [Thread-1  ]: finished collecting timing info
14:14:40.893001 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:40.895985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:41.555211 [debug] [Thread-2  ]: finished collecting timing info
14:14:41.556210 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC6ACA90>]}
14:14:41.556210 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.45s]
14:14:41.558537 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:14:41.558537 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.559543 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:14:41.560537 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.561537 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.562538 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.582536 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.583537 [debug] [Thread-2  ]: finished collecting timing info
14:14:41.584535 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:41.587572 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:14:41.588536 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:14:41.593570 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:14:41.624577 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:41.625579 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:14:42.995076 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name countryRegion_id is ambiguous at [69:14]')
14:14:44.832257 [debug] [Thread-2  ]: finished collecting timing info
14:14:44.833257 [debug] [Thread-2  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Column name countryRegion_id is ambiguous at [69:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:14:44.833257 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185ED73FC40>]}
14:14:44.834256 [error] [Thread-2  ]: 4 of 5 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 3.27s]
14:14:44.836528 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:14:45.004853 [debug] [Thread-1  ]: finished collecting timing info
14:14:45.005892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe89707-29a3-4944-8fad-8924351215b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC564D60>]}
14:14:45.006858 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.13s]
14:14:45.007856 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:45.008855 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:14:45.009890 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:14:45.011853 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:14:45.013854 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:45.014851 [info ] [MainThread]: 
14:14:45.014851 [info ] [MainThread]: Finished running 5 table models in 9.36s.
14:14:45.016858 [debug] [MainThread]: Connection 'master' was properly closed.
14:14:45.017857 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:14:45.017857 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:14:45.018853 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:14:45.019898 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:14:45.036855 [info ] [MainThread]: 
14:14:45.037690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:14:45.039702 [info ] [MainThread]: 
14:14:45.040702 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:14:45.041700 [error] [MainThread]:   Column name countryRegion_id is ambiguous at [69:14]
14:14:45.042706 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:14:45.044714 [info ] [MainThread]: 
14:14:45.045720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:14:45.047706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC450D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC4508E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185EC66E850>]}


============================== 2022-04-28 14:15:21.166022 | 440bf19c-205c-4245-b1d7-eb4d660ae89f ==============================
14:15:21.166022 [info ] [MainThread]: Running with dbt=1.0.4
14:15:21.167008 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:21.167008 [debug] [MainThread]: Tracking: tracking
14:15:21.179997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FDE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FE5A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A223FE5F10>]}
14:15:21.304033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:15:21.305028 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:15:21.317995 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:15:21.348022 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:15:21.388022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242B60D0>]}
14:15:21.400023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A224241400>]}
14:15:21.401023 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:21.404012 [info ] [MainThread]: 
14:15:21.404992 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:21.407000 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:21.408007 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:22.066674 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:22.066674 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:22.693373 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:22.694372 [info ] [MainThread]: 
14:15:22.701374 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.702373 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:15:22.704377 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.705372 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.705372 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.711371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:22.715410 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:22.716726 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:22.720740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:22.738764 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.739737 [debug] [Thread-1  ]: finished collecting timing info
14:15:22.740749 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:22.775735 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:22.777750 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:22.782736 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:15:26.257361 [debug] [Thread-1  ]: finished collecting timing info
14:15:26.257361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440bf19c-205c-4245-b1d7-eb4d660ae89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242EFC10>]}
14:15:26.258356 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.55s]
14:15:26.260358 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:26.262358 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:26.263357 [info ] [MainThread]: 
14:15:26.264361 [info ] [MainThread]: Finished running 1 table model in 4.86s.
14:15:26.265359 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:26.266361 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:26.267360 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:26.267360 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:15:26.285358 [info ] [MainThread]: 
14:15:26.287368 [info ] [MainThread]: [32mCompleted successfully[0m
14:15:26.289358 [info ] [MainThread]: 
14:15:26.290387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:15:26.291359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DB220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2242DBB80>]}


============================== 2022-04-28 14:15:33.485935 | 9ddd682b-3fc1-40b7-95df-29a467b7cddb ==============================
14:15:33.485935 [info ] [MainThread]: Running with dbt=1.0.4
14:15:33.486936 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:33.487939 [debug] [MainThread]: Tracking: tracking
14:15:33.499935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD11E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD340A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFD34880>]}
14:15:33.630933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:15:33.630933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:15:33.638933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFFA20D0>]}
14:15:33.651933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294AFDB77C0>]}
14:15:33.651933 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:33.654935 [info ] [MainThread]: 
14:15:33.655933 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:33.658937 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:33.658937 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:34.276937 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:34.277935 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:34.965933 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:34.966934 [info ] [MainThread]: 
14:15:34.975935 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.975935 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.976936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:34.977936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:34.978937 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.979938 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.979938 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.980946 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.984934 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:15:34.987934 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:15:34.989936 [debug] [Thread-1  ]: finished collecting timing info
14:15:34.990941 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.990941 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:15:34.991935 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:15:34.992934 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.992934 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:34.993936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:34.994936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:34.995955 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.995955 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:34.996935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:34.996935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:35.000945 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:15:35.004939 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:15:35.005936 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.006939 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.006939 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:15:35.007936 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:15:35.008936 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.009952 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.010935 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:35.010935 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:35.011935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.011935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.012934 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.012934 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.016937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:15:35.020938 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:15:35.022935 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.022935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.023936 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:15:35.024936 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:15:35.025935 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.026935 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.026935 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:35.027936 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:35.028935 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.028935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.029935 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.029935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.034935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:15:35.037935 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:35.038935 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.039935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.039935 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:15:35.040937 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:35.041937 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.041937 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.042936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:35.043937 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:15:35.044942 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.045937 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.045937 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.048936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:15:35.049935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.050939 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.056936 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.087934 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.087934 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:15:35.088957 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.089935 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:15:35.089935 [debug] [Thread-2  ]: finished collecting timing info
14:15:35.091936 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.091936 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:35.092936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.110964 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:35.110964 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:15:35.134948 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.136063 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.137951 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:15:35.140933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:35.796964 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:15:35.798964 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:15:35.800940 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:15:35.801937 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:15:38.286964 [debug] [Thread-1  ]: finished collecting timing info
14:15:38.288940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B007FC40>]}
14:15:38.288940 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.20s]
14:15:38.290946 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:15:38.291936 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.292950 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:15:38.293938 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.294936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.295938 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.309970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.311946 [debug] [Thread-1  ]: finished collecting timing info
14:15:38.312939 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:38.315936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:38.543933 [debug] [Thread-2  ]: finished collecting timing info
14:15:38.544933 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00DCC70>]}
14:15:38.546934 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.50s]
14:15:38.548940 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:15:38.549936 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.550937 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:15:38.551937 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:38.552935 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.552935 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.575936 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:38.576935 [debug] [Thread-2  ]: finished collecting timing info
14:15:38.577936 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:38.584937 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:38.904933 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:38.905933 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:15:39.272933 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:15:39.274933 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:15:42.660743 [debug] [Thread-2  ]: finished collecting timing info
14:15:42.660743 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00C2BE0>]}
14:15:42.661703 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.11s]
14:15:42.663705 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:15:42.828889 [debug] [Thread-1  ]: finished collecting timing info
14:15:42.829890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B00C2E20>]}
14:15:42.830891 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.54s]
14:15:42.832895 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:42.833896 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.834891 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:15:42.835895 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.836891 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.837928 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.871921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.873932 [debug] [Thread-2  ]: finished collecting timing info
14:15:42.874893 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:42.877887 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:15:42.878891 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:42.884894 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purcharseordernumber as purcharseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqyt as orderQyt
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purcharseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:15:44.207405 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]')
14:15:46.099151 [debug] [Thread-2  ]: finished collecting timing info
14:15:46.100149 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:15:46.101148 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ddd682b-3fc1-40b7-95df-29a467b7cddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B1113A30>]}
14:15:46.101148 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.27s]
14:15:46.103148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:15:46.105149 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:46.106177 [info ] [MainThread]: 
14:15:46.108152 [info ] [MainThread]: Finished running 5 table models in 12.45s.
14:15:46.109149 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:46.110151 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:46.110151 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:46.111149 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:15:46.112148 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:15:46.128202 [info ] [MainThread]: 
14:15:46.129153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:15:46.132151 [info ] [MainThread]: 
14:15:46.133149 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:15:46.135152 [error] [MainThread]:   Unrecognized name: purcharseordernumber; Did you mean purchaseordernumber? at [37:10]
14:15:46.136149 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:15:46.137148 [info ] [MainThread]: 
14:15:46.138153 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:15:46.140152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B003F280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B0042730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B0042B20>]}


============================== 2022-04-28 14:17:31.862493 | 5a398e25-15e3-44f1-8a02-351cd1635da6 ==============================
14:17:31.862493 [info ] [MainThread]: Running with dbt=1.0.4
14:17:31.863494 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:17:31.863494 [debug] [MainThread]: Tracking: tracking
14:17:31.878499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB11E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB34400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EB34880>]}
14:17:31.996494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:17:31.996494 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:17:31.997495 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:17:32.008494 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:17:32.039494 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:17:32.041506 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:17:32.057494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787ED960D0>]}
14:17:32.070495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EBB7910>]}
14:17:32.071495 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:17:32.075496 [info ] [MainThread]: 
14:17:32.077500 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:32.079516 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:17:32.080497 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:32.777710 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:17:32.777710 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:17:33.420387 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:17:33.421391 [info ] [MainThread]: 
14:17:33.429390 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.429390 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.430387 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:33.430387 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:33.431391 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.432392 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.433387 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.433387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.436387 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:17:33.440410 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:17:33.443393 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.443393 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.444391 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:17:33.445387 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:17:33.445387 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.446387 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.446387 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:33.447390 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:33.447936 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.448337 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.448793 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.449240 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.452285 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:17:33.455262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:17:33.457250 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.457250 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.458250 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:17:33.459250 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:17:33.459250 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.460268 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.461258 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:33.462250 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:33.463249 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.463249 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.464252 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.465272 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.467663 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:17:33.472845 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:17:33.473862 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.474849 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.475846 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:17:33.475846 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:17:33.476844 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.477845 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.477845 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:33.478844 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:33.479845 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.479845 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.480712 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.481073 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.484120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:17:33.486082 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:17:33.488084 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.489084 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.489084 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:17:33.491083 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:17:33.491083 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.492091 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.493084 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:33.494084 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:17:33.494084 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.495084 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.496088 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:33.499119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:17:33.500099 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.500354 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.501365 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.518400 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:33.519456 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:17:33.520382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.521365 [debug] [Thread-2  ]: finished collecting timing info
14:17:33.522368 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:17:33.523365 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:33.524366 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:17:33.540402 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:33.541380 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.542366 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:17:33.563363 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:33.565385 [debug] [Thread-1  ]: finished collecting timing info
14:17:33.566373 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:17:33.568363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:34.241046 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:17:34.243085 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:17:34.250722 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:17:34.251722 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:17:36.930016 [debug] [Thread-1  ]: finished collecting timing info
14:17:36.930016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEFD1C0>]}
14:17:36.931011 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.41s]
14:17:36.932984 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:17:36.933982 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.934989 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:17:36.935983 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:36.936984 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.936984 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.954982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:36.957003 [debug] [Thread-1  ]: finished collecting timing info
14:17:36.957003 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:36.959980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:37.559197 [debug] [Thread-2  ]: finished collecting timing info
14:17:37.560155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEB1FD0>]}
14:17:37.560155 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.06s]
14:17:37.562154 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:17:37.563153 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.564167 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:17:37.565153 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:37.565153 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.566153 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.582152 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:37.584188 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:17:37.585175 [debug] [Thread-2  ]: finished collecting timing info
14:17:37.586152 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:17:37.586152 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:37.597196 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:17:38.314547 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:17:38.315510 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:17:40.638066 [debug] [Thread-1  ]: finished collecting timing info
14:17:40.639070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787FF23490>]}
14:17:40.639070 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.70s]
14:17:40.641069 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:17:41.043939 [debug] [Thread-2  ]: finished collecting timing info
14:17:41.044951 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EECD5B0>]}
14:17:41.045950 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.48s]
14:17:41.047954 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:17:41.048956 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.049953 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:17:41.050953 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.051950 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.051950 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.087952 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.088952 [debug] [Thread-1  ]: finished collecting timing info
14:17:41.089950 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:41.092952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:17:41.093965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:17:41.098946 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqyt as orderQyt
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:17:42.414658 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]')
14:17:44.229727 [debug] [Thread-1  ]: finished collecting timing info
14:17:44.230687 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:17:44.230687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a398e25-15e3-44f1-8a02-351cd1635da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787FF3EF40>]}
14:17:44.231724 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.18s]
14:17:44.233689 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:17:44.235714 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:17:44.235714 [info ] [MainThread]: 
14:17:44.237690 [info ] [MainThread]: Finished running 5 table models in 12.16s.
14:17:44.238691 [debug] [MainThread]: Connection 'master' was properly closed.
14:17:44.239690 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:17:44.239690 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:17:44.240696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:17:44.240696 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:17:44.254686 [info ] [MainThread]: 
14:17:44.255690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:17:44.257705 [info ] [MainThread]: 
14:17:44.258691 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:17:44.260701 [error] [MainThread]:   Unrecognized name: orderqyt; Did you mean orderqty? at [59:10]
14:17:44.262686 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:17:44.263688 [info ] [MainThread]: 
14:17:44.265824 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:17:44.267722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEABE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEAB790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EEABD00>]}


============================== 2022-04-28 14:18:59.689881 | 22508579-45f9-4287-b1c1-3da40ae2554c ==============================
14:18:59.689881 [info ] [MainThread]: Running with dbt=1.0.4
14:18:59.690882 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:18:59.690882 [debug] [MainThread]: Tracking: tracking
14:18:59.705884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF723820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF723100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF7235E0>]}
14:18:59.832912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:18:59.832912 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
14:18:59.844912 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:18:59.871881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF9C70D0>]}
14:18:59.884882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF95AD90>]}
14:18:59.884882 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:18:59.887914 [info ] [MainThread]: 
14:18:59.889883 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:18:59.891915 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:18:59.892896 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:00.532420 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:19:00.532420 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:19:01.161108 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:19:01.162132 [info ] [MainThread]: 
14:19:01.171113 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.171113 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.172126 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:01.173109 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:19:01.174114 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.175109 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.175109 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.175706 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.178120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:19:01.181114 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:19:01.182116 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.183114 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.183114 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:19:01.184116 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:19:01.185115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.186116 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.187128 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:19:01.188117 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:19:01.188117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.188862 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.188862 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.189874 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.191909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:19:01.194908 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:19:01.195872 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.196877 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:19:01.196877 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.196877 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.197873 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:19:01.198874 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:19:01.198874 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.199872 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.200876 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:19:01.201888 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.202877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.206872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:19:01.206872 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.210908 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:19:01.210908 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.211874 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:19:01.212873 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.212873 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.213872 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:19:01.214873 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:19:01.215877 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.215877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.216893 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:19:01.217876 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.218877 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.221909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:19:01.222909 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.227911 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:19:01.227911 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.228904 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:19:01.229874 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.229874 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.230872 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:01.235876 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:19:01.236877 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.237873 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.238873 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.238873 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:19:01.241935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:19:01.243884 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:01.243884 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.245905 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.245905 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.246893 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:19:01.281929 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:01.282900 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.283895 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:19:01.284903 [debug] [Thread-2  ]: finished collecting timing info
14:19:01.286919 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:19:01.287894 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:01.287894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.303928 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:01.304893 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:19:01.326931 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:19:01.328893 [debug] [Thread-1  ]: finished collecting timing info
14:19:01.329893 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:19:01.334914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:02.035867 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:19:02.036866 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:19:02.037887 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:19:02.039876 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:19:05.077910 [debug] [Thread-1  ]: finished collecting timing info
14:19:05.078910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFA99DC0>]}
14:19:05.079911 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.79s]
14:19:05.081463 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:19:05.082474 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.082474 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:19:05.084476 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.084476 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.084476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.099473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.100477 [debug] [Thread-1  ]: finished collecting timing info
14:19:05.101478 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:05.105476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:19:05.393091 [debug] [Thread-2  ]: finished collecting timing info
14:19:05.393091 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFA13D90>]}
14:19:05.394091 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.15s]
14:19:05.396056 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:19:05.397058 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.397058 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:19:05.398058 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:05.399057 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.400059 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.416065 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:05.417516 [debug] [Thread-2  ]: finished collecting timing info
14:19:05.417516 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:05.421528 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:05.718016 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:19:05.719975 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:19:06.034798 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:19:06.036082 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:19:08.995347 [debug] [Thread-2  ]: finished collecting timing info
14:19:08.996307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFAE9640>]}
14:19:08.996307 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.60s]
14:19:08.998306 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:19:09.385431 [debug] [Thread-1  ]: finished collecting timing info
14:19:09.386387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFB20D00>]}
14:19:09.386387 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.30s]
14:19:09.388388 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:19:09.390422 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.390422 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:19:09.392390 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.392390 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.393387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.435410 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.437408 [debug] [Thread-2  ]: finished collecting timing info
14:19:09.437408 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:09.440421 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:19:09.441422 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:19:09.446420 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            customer_sk
            ,customer_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.customer_id = dim_CreditCards.customer_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:19:10.689642 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_sk at [81:13]')
14:19:12.530530 [debug] [Thread-2  ]: finished collecting timing info
14:19:12.531526 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: customer_sk at [81:13]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:19:12.532527 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22508579-45f9-4287-b1c1-3da40ae2554c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFB6C8E0>]}
14:19:12.532527 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.14s]
14:19:12.534525 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:19:12.536525 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:19:12.537561 [info ] [MainThread]: 
14:19:12.538528 [info ] [MainThread]: Finished running 5 table models in 12.65s.
14:19:12.539529 [debug] [MainThread]: Connection 'master' was properly closed.
14:19:12.539529 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:19:12.540528 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:19:12.557528 [info ] [MainThread]: 
14:19:12.558988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:19:12.560001 [info ] [MainThread]: 
14:19:12.561999 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:19:12.563003 [error] [MainThread]:   Unrecognized name: customer_sk at [81:13]
14:19:12.563999 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:19:12.565999 [info ] [MainThread]: 
14:19:12.567006 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:19:12.568010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF9C7A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFF7A7B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFFAE9310>]}


============================== 2022-04-28 14:20:30.118548 | 4c089fec-2aa2-46dd-97da-8478f97b9e3b ==============================
14:20:30.118548 [info ] [MainThread]: Running with dbt=1.0.4
14:20:30.119549 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:30.120523 [debug] [MainThread]: Tracking: tracking
14:20:30.136525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65564040>]}
14:20:30.267526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:20:30.268523 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:20:30.281524 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:20:30.321519 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:20:30.338556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A657B40D0>]}
14:20:30.352551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6578ADF0>]}
14:20:30.353525 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:30.358554 [info ] [MainThread]: 
14:20:30.359548 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:30.361522 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:30.362520 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:31.098735 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:31.098735 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:31.713381 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:31.714381 [info ] [MainThread]: 
14:20:31.722381 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.722381 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.723382 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:20:31.724379 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:20:31.724379 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.725396 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.726381 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.727385 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.731383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:20:31.735416 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:20:31.737381 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.737381 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.738381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:20:31.738381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:20:31.739407 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.740380 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.741401 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:20:31.741401 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:20:31.742413 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.743387 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.743387 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.743387 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.747382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:20:31.751379 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:20:31.752382 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.752382 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.753381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:20:31.754381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:20:31.755382 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.755382 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.756381 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:20:31.757380 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:20:31.757380 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.758379 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.758379 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.759381 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.763389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:20:31.768382 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:20:31.769386 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.770381 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.771381 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:20:31.771381 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:20:31.772381 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.773392 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.773392 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:20:31.774379 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:31.775399 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.775399 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.776396 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.776728 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.780256 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:20:31.783297 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:31.785257 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.785257 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.786261 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:31.787257 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:20:31.787257 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.788256 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.789256 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:20:31.789256 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:20:31.790255 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.791496 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.792520 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:31.795508 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:20:31.796509 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.797522 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.797522 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.818544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:31.818544 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:20:31.819588 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.820601 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:20:31.821600 [debug] [Thread-1  ]: finished collecting timing info
14:20:31.822601 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:20:31.822601 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:31.823604 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.840635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:31.840635 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:20:31.868635 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:20:31.870598 [debug] [Thread-2  ]: finished collecting timing info
14:20:31.871598 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:20:31.874635 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:32.468215 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:20:32.469215 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:20:32.502790 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:20:32.503752 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:20:35.249232 [debug] [Thread-2  ]: finished collecting timing info
14:20:35.250232 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65938610>]}
14:20:35.251196 [info ] [Thread-2  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.43s]
14:20:35.253211 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:20:35.254205 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.255197 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:35.256198 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.257196 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.257196 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.271195 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.273044 [debug] [Thread-2  ]: finished collecting timing info
14:20:35.273044 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:35.275053 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:35.544600 [debug] [Thread-1  ]: finished collecting timing info
14:20:35.545600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658CB9A0>]}
14:20:35.545600 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.75s]
14:20:35.548594 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:20:35.548594 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.549627 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:20:35.550598 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:35.551596 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.552595 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.569634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:35.571703 [debug] [Thread-1  ]: finished collecting timing info
14:20:35.571703 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:35.578712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:20:35.861682 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:35.862716 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:20:36.191330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:20:36.192291 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:20:39.192621 [debug] [Thread-2  ]: finished collecting timing info
14:20:39.194627 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A66946430>]}
14:20:39.195614 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.94s]
14:20:39.197615 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:39.962473 [debug] [Thread-1  ]: finished collecting timing info
14:20:39.962473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A657CACA0>]}
14:20:39.963477 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.41s]
14:20:39.965758 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:20:39.966754 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:39.966754 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:20:39.968755 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:39.968755 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:39.969755 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:40.008788 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:40.009807 [debug] [Thread-2  ]: finished collecting timing info
14:20:40.010753 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:40.014752 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:20:40.016753 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:20:40.021787 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            employee_sk
            ,employee_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            product_sk
            ,product_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:20:41.318013 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: employee_sk at [88:13]')
14:20:43.130865 [debug] [Thread-2  ]: finished collecting timing info
14:20:43.131853 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: employee_sk at [88:13]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:20:43.132856 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c089fec-2aa2-46dd-97da-8478f97b9e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6695D820>]}
14:20:43.132856 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.16s]
14:20:43.134818 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:20:43.136819 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:43.137819 [info ] [MainThread]: 
14:20:43.138822 [info ] [MainThread]: Finished running 5 table models in 12.78s.
14:20:43.139820 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:43.140816 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:43.140816 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:43.141821 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:20:43.141821 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:20:43.157819 [info ] [MainThread]: 
14:20:43.159817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:20:43.161819 [info ] [MainThread]: 
14:20:43.162821 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:20:43.164820 [error] [MainThread]:   Unrecognized name: employee_sk at [88:13]
14:20:43.165826 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:20:43.167818 [info ] [MainThread]: 
14:20:43.168816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:20:43.169816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658EE0D0>]}


============================== 2022-04-28 14:21:38.841253 | 305d7c9f-3433-48ed-9211-e3e3df14f41a ==============================
14:21:38.841253 [info ] [MainThread]: Running with dbt=1.0.4
14:21:38.841253 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:21:38.842214 [debug] [MainThread]: Tracking: tracking
14:21:38.856245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071241E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071263370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071263A90>]}
14:21:38.981244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:21:38.981244 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:21:38.992244 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:21:39.025251 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:21:39.040253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210714BA0D0>]}
14:21:39.064217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107149ADF0>]}
14:21:39.065215 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:21:39.069244 [info ] [MainThread]: 
14:21:39.070266 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:39.072216 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:21:39.072216 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:39.713503 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:21:39.714500 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:40.328010 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:21:40.329025 [info ] [MainThread]: 
14:21:40.337040 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.337040 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.338025 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:21:40.340024 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:21:40.340024 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.341025 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.342047 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.343023 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.346025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:21:40.349027 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:21:40.350027 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.351025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:21:40.352023 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.352023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.353023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:21:40.354036 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:21:40.355032 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.355032 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.356025 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:21:40.357026 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.357026 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.360025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:21:40.360025 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.364028 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:21:40.364028 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.366026 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:21:40.366026 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.367029 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.367029 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:21:40.368060 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:21:40.368060 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.369039 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.370023 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:21:40.370023 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.371023 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.374060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:21:40.374060 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.378046 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:21:40.379046 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.380025 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:21:40.381024 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.381024 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.382029 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:21:40.383027 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:21:40.384090 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.385028 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.385028 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:21:40.386059 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.386059 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.390060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:21:40.390060 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.393058 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:21:40.394044 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.395029 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:21:40.395029 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.396023 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.397023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:21:40.397023 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:21:40.398021 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.399025 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.399025 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:21:40.400073 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.401087 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:40.404096 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:21:40.405101 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.406105 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.406105 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.425133 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:40.425133 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:21:40.426097 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.427097 [debug] [Thread-2  ]: finished collecting timing info
14:21:40.428096 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:21:40.428096 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:40.430105 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:21:40.445133 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:40.446103 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.447103 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:21:40.470096 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:21:40.472098 [debug] [Thread-1  ]: finished collecting timing info
14:21:40.473098 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:21:40.476096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:41.056551 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:21:41.057975 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:21:41.086401 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:21:41.087364 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:21:43.705750 [debug] [Thread-1  ]: finished collecting timing info
14:21:43.706768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071525820>]}
14:21:43.707713 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.28s]
14:21:43.709713 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:21:43.709713 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.710713 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:21:43.712714 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:43.712714 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.713711 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.726737 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:43.728712 [debug] [Thread-1  ]: finished collecting timing info
14:21:43.728712 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:43.731739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:44.127438 [debug] [Thread-2  ]: finished collecting timing info
14:21:44.128400 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210715DF2B0>]}
14:21:44.129399 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.73s]
14:21:44.131401 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:21:44.131401 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.132403 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:21:44.133401 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.133401 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.134401 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.152400 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.153436 [debug] [Thread-2  ]: finished collecting timing info
14:21:44.154398 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:44.160436 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:44.347055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:21:44.349017 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:21:44.816140 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:21:44.817102 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:21:47.770405 [debug] [Thread-2  ]: finished collecting timing info
14:21:47.770405 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107161B220>]}
14:21:47.771404 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.64s]
14:21:47.773411 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:21:47.953672 [debug] [Thread-1  ]: finished collecting timing info
14:21:47.954673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021072633490>]}
14:21:47.955674 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.24s]
14:21:47.956674 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:47.957674 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.958675 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:21:47.960675 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:47.960675 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.961679 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:47.998704 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:47.999702 [debug] [Thread-2  ]: finished collecting timing info
14:21:48.000689 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:48.003672 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:21:48.005688 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:21:48.010697 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,reason_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.reason_id = dim_Reasons.reason_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:21:49.351467 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]')
14:21:51.614671 [debug] [Thread-2  ]: finished collecting timing info
14:21:51.614671 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:21:51.615664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305d7c9f-3433-48ed-9211-e3e3df14f41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107267DC10>]}
14:21:51.616631 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.66s]
14:21:51.617630 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:21:51.619628 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:51.620668 [info ] [MainThread]: 
14:21:51.621632 [info ] [MainThread]: Finished running 5 table models in 12.55s.
14:21:51.622631 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:51.623631 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:21:51.624632 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:51.624632 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:21:51.625633 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:21:51.640628 [info ] [MainThread]: 
14:21:51.641629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:21:51.643634 [info ] [MainThread]: 
14:21:51.644632 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:21:51.646665 [error] [MainThread]:   Unrecognized name: reason_id; Did you mean reason_sk? at [96:14]
14:21:51.647631 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:21:51.648660 [info ] [MainThread]: 
14:21:51.649633 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:21:51.650642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107262E4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021072667130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107161C9A0>]}


============================== 2022-04-28 14:24:35.995996 | eeea4bf7-62e0-4db4-838c-9245eba32f58 ==============================
14:24:35.995996 [info ] [MainThread]: Running with dbt=1.0.4
14:24:35.996993 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:24:35.996993 [debug] [MainThread]: Tracking: tracking
14:24:36.012000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF42E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF434C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF4346A0>]}
14:24:36.131996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:24:36.132996 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:24:36.145996 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:24:36.175992 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:24:36.191992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF6940D0>]}
14:24:36.203994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF66ABB0>]}
14:24:36.204994 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:36.207998 [info ] [MainThread]: 
14:24:36.209999 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:36.210996 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:24:36.211999 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:36.891118 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:36.891118 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:37.681942 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:24:37.682937 [info ] [MainThread]: 
14:24:37.690972 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.690972 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.691938 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:37.692955 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:24:37.692955 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.693938 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.694466 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.694911 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.697957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:37.699921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:24:37.701921 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.701921 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.701921 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:37.702960 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:24:37.703923 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.704922 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.704922 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:24:37.705921 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:24:37.705921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.706924 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.706924 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.706924 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.709959 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:24:37.712920 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:24:37.713922 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.713922 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.714923 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:24:37.715921 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:24:37.715921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.716920 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.717921 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:24:37.717921 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:24:37.718921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.719925 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.719925 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.720923 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.724957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:24:37.729925 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:24:37.730922 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.731923 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:24:37.731923 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.732922 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.733922 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:24:37.733922 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:24:37.734924 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.735921 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.736922 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:24:37.737928 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.738923 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.741921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:24:37.742957 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.745921 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:24:37.746926 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.746926 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:24:37.747923 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.747923 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.748923 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:24:37.749939 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:37.750928 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.750928 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.751922 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:24:37.752921 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.754925 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:37.757956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:37.757956 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.758921 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.766920 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.777923 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:37.778960 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:37.779921 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.780932 [debug] [Thread-2  ]: finished collecting timing info
14:24:37.781923 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:24:37.781923 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:37.784930 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:24:37.801919 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:24:37.801919 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.802920 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:24:37.829920 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:24:37.831920 [debug] [Thread-1  ]: finished collecting timing info
14:24:37.833924 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:24:37.837943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:38.652440 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:24:38.653422 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:24:38.655414 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:24:38.655414 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:24:41.468861 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.469825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF6F7220>]}
14:24:41.470838 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.69s]
14:24:41.472832 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:24:41.472832 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.474824 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:24:41.475847 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:41.476894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.476894 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.495857 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:41.497465 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.497465 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:41.499510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:41.752674 [debug] [Thread-2  ]: finished collecting timing info
14:24:41.754673 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D07F7790>]}
14:24:41.755672 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.00s]
14:24:41.757669 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:24:41.758669 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.759670 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:24:41.760670 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.761668 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.761668 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.779702 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.780750 [debug] [Thread-2  ]: finished collecting timing info
14:24:41.781667 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.788674 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:24:42.138948 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:24:42.140909 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:24:42.388334 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:42.389337 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:24:45.535530 [debug] [Thread-1  ]: finished collecting timing info
14:24:45.536490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF702FD0>]}
14:24:45.536490 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.06s]
14:24:45.538490 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:24:45.765130 [debug] [Thread-2  ]: finished collecting timing info
14:24:45.766126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF702E20>]}
14:24:45.767093 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.01s]
14:24:45.769090 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:45.770090 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.770090 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:24:45.771090 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.772091 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.773086 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.809117 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.810922 [debug] [Thread-1  ]: finished collecting timing info
14:24:45.810922 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:45.813967 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:24:45.814968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:45.820953 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetatils.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:24:47.094881 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]')
14:24:48.892858 [debug] [Thread-1  ]: finished collecting timing info
14:24:48.892858 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:24:48.893862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeea4bf7-62e0-4db4-838c-9245eba32f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D0856B80>]}
14:24:48.893862 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.12s]
14:24:48.895829 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:24:48.896829 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:48.897829 [info ] [MainThread]: 
14:24:48.899830 [info ] [MainThread]: Finished running 5 table models in 12.69s.
14:24:48.900831 [debug] [MainThread]: Connection 'master' was properly closed.
14:24:48.900831 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:24:48.901830 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:24:48.901830 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:24:48.902832 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:24:48.916829 [info ] [MainThread]: 
14:24:48.918833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:24:48.920832 [info ] [MainThread]: 
14:24:48.921839 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:24:48.923834 [error] [MainThread]:   Unrecognized name: SalesOrderDetatils; Did you mean SalesOrderDetails? at [148:35]
14:24:48.924843 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:24:48.925829 [info ] [MainThread]: 
14:24:48.927830 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:24:48.928848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D0851FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF802A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CF802EE0>]}


============================== 2022-04-28 14:25:16.451560 | 34e4fc14-cdf0-4e68-8acc-b4dd5588c046 ==============================
14:25:16.451560 [info ] [MainThread]: Running with dbt=1.0.4
14:25:16.452560 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:25:16.453565 [debug] [MainThread]: Tracking: tracking
14:25:16.467587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B74EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B84AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1B84D00>]}
14:25:16.599560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:25:16.600560 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:25:16.612560 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:25:16.645562 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:25:16.662561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DCA0D0>]}
14:25:16.675562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DAADF0>]}
14:25:16.676561 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:25:16.679561 [info ] [MainThread]: 
14:25:16.681561 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:16.682567 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:25:16.683601 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:17.348339 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:25:17.348339 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:17.985726 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:25:17.986756 [info ] [MainThread]: 
14:25:17.994729 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:17.994729 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:17.995726 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:25:17.997732 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:25:17.997732 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:17.998731 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:17.999732 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:18.000730 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:18.003729 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:25:18.007762 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:25:18.008739 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.009729 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.009729 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:25:18.011736 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:25:18.012737 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.013726 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.014728 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:25:18.015727 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:25:18.015727 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.016726 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.017727 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.017727 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.020725 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:25:18.023724 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:25:18.025726 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.025726 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.026734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:25:18.027727 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:25:18.028730 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.028730 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.030728 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:25:18.031728 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:25:18.031728 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.032729 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.032729 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.033728 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.036731 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:25:18.040761 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:25:18.042730 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.042730 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.043736 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:25:18.044728 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:25:18.045730 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.046748 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.047743 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:25:18.048725 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:25:18.049725 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.049725 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.050748 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.050748 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.053762 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:25:18.057762 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:25:18.058729 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.059731 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.059731 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:25:18.060726 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:25:18.061732 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.062727 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.064729 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:25:18.064729 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:25:18.065726 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.066729 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.067726 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.067726 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.071761 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:25:18.071761 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.091764 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.092789 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.094727 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:25:18.094727 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.095729 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.096729 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:18.096729 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:25:18.114727 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:18.116729 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.117730 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.117730 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:25:18.141728 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.143746 [debug] [Thread-1  ]: finished collecting timing info
14:25:18.144730 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:25:18.148734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:18.759490 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:25:18.761491 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:25:18.763490 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:25:18.763490 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:25:21.560105 [debug] [Thread-1  ]: finished collecting timing info
14:25:21.561106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1EA1310>]}
14:25:21.561106 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.44s]
14:25:21.564107 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:25:21.564107 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.565138 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:25:21.566110 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:21.567117 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.567117 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.582107 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:21.583108 [debug] [Thread-1  ]: finished collecting timing info
14:25:21.583108 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:21.586359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:21.685456 [debug] [Thread-2  ]: finished collecting timing info
14:25:21.686452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1F558E0>]}
14:25:21.687454 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.62s]
14:25:21.689453 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:25:21.689453 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.690455 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:25:21.691452 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:21.691452 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.692458 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.708490 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:21.709454 [debug] [Thread-2  ]: finished collecting timing info
14:25:21.710452 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:21.716493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:22.240786 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:25:22.242786 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:25:22.428582 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:25:22.429580 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:25:25.256803 [debug] [Thread-1  ]: finished collecting timing info
14:25:25.257818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE2F4DFA0>]}
14:25:25.258798 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.69s]
14:25:25.260800 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:25:25.438797 [debug] [Thread-2  ]: finished collecting timing info
14:25:25.439798 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9AF0>]}
14:25:25.439798 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.75s]
14:25:25.441801 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:25:25.442800 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.443798 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:25:25.444805 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.444805 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.445797 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.480798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.481798 [debug] [Thread-1  ]: finished collecting timing info
14:25:25.482799 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:25.486801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:25:25.488799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:25.494799 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrder as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrder on SalesOrderDetails.salesOrder_id = SalesOrder.salesOrder_id

        left join dim_CreditCards on SalesOrder.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrder.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrder.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:25:26.757563 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]')
14:25:28.090091 [debug] [Thread-1  ]: finished collecting timing info
14:25:28.091016 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:25:28.091978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e4fc14-cdf0-4e68-8acc-b4dd5588c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE2F90E20>]}
14:25:28.092978 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 2.65s]
14:25:28.093977 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:25:28.096991 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:28.097992 [info ] [MainThread]: 
14:25:28.098998 [info ] [MainThread]: Finished running 5 table models in 11.42s.
14:25:28.099983 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:28.100978 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:25:28.101981 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:25:28.101981 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:25:28.102991 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:25:28.118042 [info ] [MainThread]: 
14:25:28.118979 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:28.120979 [info ] [MainThread]: 
14:25:28.122004 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:25:28.122978 [error] [MainThread]:   Unrecognized name: SalesOrders; Did you mean SalesOrder? at [111:43]
14:25:28.123978 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:25:28.124979 [info ] [MainThread]: 
14:25:28.126980 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:25:28.127979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1DE9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE1F2BAC0>]}


============================== 2022-04-28 14:26:59.430810 | c87f0be3-81e9-4bc5-89aa-eac0085b6fed ==============================
14:26:59.430810 [info ] [MainThread]: Running with dbt=1.0.4
14:26:59.431833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:59.432858 [debug] [MainThread]: Tracking: tracking
14:26:59.446856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA883EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA894AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECA894D00>]}
14:26:59.573892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:59.574856 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
14:26:59.585890 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:26:59.616893 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:26:59.631884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAE50D0>]}
14:26:59.644854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAABADF0>]}
14:26:59.645865 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:59.649885 [info ] [MainThread]: 
14:26:59.651858 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:59.653860 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:59.654856 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:00.470943 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:00.470943 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:01.114753 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:01.115765 [info ] [MainThread]: 
14:27:01.123765 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.123765 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.124767 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:27:01.125766 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:27:01.126765 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.127765 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.127765 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.128765 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.132792 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:27:01.134792 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:27:01.136770 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.137770 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.138770 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:27:01.138770 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:27:01.139769 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.140788 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.141768 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:01.142787 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:01.142787 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.143769 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.143769 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.144764 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.147811 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:27:01.150838 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:27:01.151789 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.152770 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.153782 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:27:01.153782 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:27:01.154783 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.155779 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.156778 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:01.157778 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:01.158278 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.158278 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.159289 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.159643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.162654 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:27:01.166652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:27:01.167663 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.168654 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.168654 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:27:01.169657 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:27:01.170654 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.170654 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.171654 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:01.172652 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:01.173658 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.173658 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.174654 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.174654 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.178689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:27:01.181652 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:27:01.183186 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.183186 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.184188 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:27:01.185188 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:27:01.185188 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.186187 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.187204 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:27:01.188188 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:27:01.189190 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.190188 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.190188 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.191188 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.194186 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:27:01.194186 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.213224 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.214194 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.215186 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:27:01.215186 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.216186 [debug] [Thread-2  ]: finished collecting timing info
14:27:01.216186 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:27:01.217199 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:01.233222 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:01.234222 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:27:01.235196 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.236190 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:27:01.259216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:01.261216 [debug] [Thread-1  ]: finished collecting timing info
14:27:01.263186 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:27:01.265185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:01.891049 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:27:01.892045 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:27:02.020400 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:27:02.022358 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:27:05.039832 [debug] [Thread-1  ]: finished collecting timing info
14:27:05.040815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECABB2820>]}
14:27:05.041791 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.81s]
14:27:05.043790 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:27:05.043790 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.044821 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:27:05.045801 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.046792 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.046792 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.061826 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.063805 [debug] [Thread-1  ]: finished collecting timing info
14:27:05.063805 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:05.066820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:27:05.180518 [debug] [Thread-2  ]: finished collecting timing info
14:27:05.180518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC62670>]}
14:27:05.181517 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.99s]
14:27:05.183483 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:27:05.184484 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.184484 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:27:05.186532 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.186532 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.187482 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.205483 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.207502 [debug] [Thread-2  ]: finished collecting timing info
14:27:05.207502 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:05.215515 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:05.708927 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:27:05.709931 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:27:05.830558 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:27:05.831569 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:27:09.158140 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.159104 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAFADC0>]}
14:27:09.159104 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.97s]
14:27:09.161170 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:27:09.315657 [debug] [Thread-1  ]: finished collecting timing info
14:27:09.316651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECBC56DF0>]}
14:27:09.317616 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 4.27s]
14:27:09.319635 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:27:09.320616 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.321617 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:27:09.322616 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.322616 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.323617 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.358618 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.360620 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.361614 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:09.364648 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:27:09.365647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:27:09.370614 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as date) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as date) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:27:11.114764 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-07-31T00:00:00.000000Z'")
14:27:13.517650 [debug] [Thread-2  ]: finished collecting timing info
14:27:13.518649 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Invalid date: '2013-09-19T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:27:13.518649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f0be3-81e9-4bc5-89aa-eac0085b6fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECBC9D0A0>]}
14:27:13.519682 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 4.20s]
14:27:13.521751 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:27:13.522648 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:13.523673 [info ] [MainThread]: 
14:27:13.524649 [info ] [MainThread]: Finished running 5 table models in 13.87s.
14:27:13.525649 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:13.526649 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:27:13.527650 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:13.527650 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:27:13.528664 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:27:13.544658 [info ] [MainThread]: 
14:27:13.545645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:27:13.546646 [info ] [MainThread]: 
14:27:13.548646 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:27:13.549646 [error] [MainThread]:   Invalid date: '2013-09-19T00:00:00.000000Z'
14:27:13.551645 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:27:13.552643 [info ] [MainThread]: 
14:27:13.553655 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:27:13.555655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAAFA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC4C580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ECAC4CAC0>]}


============================== 2022-04-28 14:29:04.195462 | eb640256-7fd0-47d5-8dd9-be4688b080d7 ==============================
14:29:04.195462 [info ] [MainThread]: Running with dbt=1.0.4
14:29:04.196491 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:29:04.197463 [debug] [MainThread]: Tracking: tracking
14:29:04.213468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CD1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CF3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2CF3370>]}
14:29:04.369459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:29:04.369459 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:29:04.383461 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:29:04.413460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2F970D0>]}
14:29:04.428459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2D6EDF0>]}
14:29:04.429468 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:29:04.432462 [info ] [MainThread]: 
14:29:04.434460 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:29:04.435460 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:29:04.436459 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:29:05.098788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:29:05.098788 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:29:05.707806 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:29:05.708797 [info ] [MainThread]: 
14:29:05.716733 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.716733 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.717743 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:29:05.718715 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:29:05.718715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.719714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.719714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.720713 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.724714 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:29:05.728714 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:29:05.729715 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.730715 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.730715 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:29:05.732717 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:29:05.732717 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.733716 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.735752 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:29:05.736715 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:29:05.736715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.737734 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.737734 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.738715 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.743750 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:29:05.747749 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:29:05.749714 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.749714 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.750719 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:29:05.752728 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:29:05.752728 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.753737 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.754713 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:29:05.755714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:29:05.755714 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.756714 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.757716 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.757716 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.762716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:29:05.765756 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:29:05.767716 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.768737 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.768737 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:29:05.769716 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:29:05.770734 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.770734 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.771733 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:29:05.772718 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:29:05.773716 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.773716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.774718 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.775748 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.779745 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:29:05.783741 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:29:05.785714 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.785714 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.786733 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:29:05.787713 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:29:05.787713 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.788721 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.789715 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:29:05.790734 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:29:05.791715 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.792725 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.793714 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:05.797716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:29:05.798716 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.799714 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.805743 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.837749 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:05.838714 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:29:05.839714 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.840713 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:29:05.841715 [debug] [Thread-2  ]: finished collecting timing info
14:29:05.842716 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:29:05.843728 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:05.844723 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.862714 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:05.862714 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:29:05.885738 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:29:05.887713 [debug] [Thread-1  ]: finished collecting timing info
14:29:05.889715 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:29:05.895751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:29:06.529065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:29:06.530030 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:29:06.544291 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:29:06.546292 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:29:09.345013 [debug] [Thread-1  ]: finished collecting timing info
14:29:09.346012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA3063E20>]}
14:29:09.346012 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.50s]
14:29:09.349013 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:29:09.351019 [debug] [Thread-2  ]: finished collecting timing info
14:29:09.351019 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.352019 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA306E8B0>]}
14:29:09.353022 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:29:09.354013 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 3.56s]
14:29:09.355012 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:09.356014 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.357023 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:29:09.358016 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.359014 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.373015 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:09.374013 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:29:09.376016 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:09.376016 [debug] [Thread-1  ]: finished collecting timing info
14:29:09.377021 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.377021 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:09.378013 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.381050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:29:09.399043 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:09.401013 [debug] [Thread-2  ]: finished collecting timing info
14:29:09.402013 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:09.406016 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:10.024486 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:29:10.026446 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as date) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:29:10.041073 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:29:10.042073 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:29:12.927408 [debug] [Thread-2  ]: finished collecting timing info
14:29:12.928405 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40F5AC0>]}
14:29:12.928405 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.55s]
14:29:12.930403 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:29:13.044404 [debug] [Thread-1  ]: finished collecting timing info
14:29:13.045434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40B2FD0>]}
14:29:13.046403 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 3.69s]
14:29:13.048405 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:29:13.049407 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.050407 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:29:13.051406 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.052404 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.052404 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.112404 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.113405 [debug] [Thread-2  ]: finished collecting timing info
14:29:13.114404 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:13.120405 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:29:13.122404 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:29:13.128404 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as date) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:29:14.981860 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2013-07-31T00:00:00.000000Z'")
14:29:16.449197 [debug] [Thread-2  ]: finished collecting timing info
14:29:16.450230 [debug] [Thread-2  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Invalid date: '2014-06-20T00:00:00.000000Z'
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:29:16.451231 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb640256-7fd0-47d5-8dd9-be4688b080d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40FE1C0>]}
14:29:16.452229 [error] [Thread-2  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 3.40s]
14:29:16.453189 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:29:16.455193 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:29:16.456230 [info ] [MainThread]: 
14:29:16.457193 [info ] [MainThread]: Finished running 5 table models in 12.02s.
14:29:16.458192 [debug] [MainThread]: Connection 'master' was properly closed.
14:29:16.459196 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:29:16.460191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:29:16.472201 [info ] [MainThread]: 
14:29:16.473209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:29:16.475190 [info ] [MainThread]: 
14:29:16.476190 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:29:16.477191 [error] [MainThread]:   Invalid date: '2014-06-20T00:00:00.000000Z'
14:29:16.478192 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:29:16.479191 [info ] [MainThread]: 
14:29:16.480191 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:29:16.481191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2FECB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA2D6E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA40F2670>]}


============================== 2022-04-28 14:30:20.661846 | 6be13fec-c8ca-4e7f-ba88-30d034bd357e ==============================
14:30:20.661846 [info ] [MainThread]: Running with dbt=1.0.4
14:30:20.662846 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:30:20.663858 [debug] [MainThread]: Tracking: tracking
14:30:20.678850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E89033A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8903430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8903100>]}
14:30:20.798849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
14:30:20.798849 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderDetails.sql
14:30:20.799849 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:30:20.800850 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesReason.sql
14:30:20.800850 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesOrders.sql
14:30:20.801865 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_SalesTerritories.sql
14:30:20.801865 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_Customer.sql
14:30:20.820866 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:30:20.835849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:30:20.838851 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:30:20.841849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:30:20.844849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:30:20.847849 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:30:20.865849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8BAA0D0>]}
14:30:20.879851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E895B580>]}
14:30:20.879851 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:30:20.884850 [info ] [MainThread]: 
14:30:20.885849 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:30:20.888847 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:30:20.888847 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:21.535211 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:30:21.535211 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:22.151959 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:30:22.151959 [info ] [MainThread]: 
14:30:22.159603 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.159603 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.160601 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:30:22.161610 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:30:22.161610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.162602 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.162602 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.163602 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.165629 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:30:22.168629 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:30:22.170602 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.170602 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.171606 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:30:22.172602 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:30:22.172602 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.173602 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.174602 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:30:22.174602 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:30:22.175631 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.175631 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.176603 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.176603 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.180630 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:30:22.183600 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:30:22.184602 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.185603 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.186603 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:30:22.186603 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:30:22.187602 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.188602 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.189603 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:30:22.190605 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:30:22.191602 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.191602 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.192612 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.192612 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.196641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:30:22.200601 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:30:22.202058 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.202058 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:30:22.203057 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.203057 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.204061 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:30:22.205059 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:30:22.206069 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.207058 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.208060 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:30:22.208060 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.209058 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.214057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:30:22.215059 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.218093 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:30:22.219073 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.219073 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:30:22.220058 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.220058 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.221061 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:30:22.223061 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:30:22.223061 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.224074 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.225079 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:30:22.225079 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.230057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:30:22.230057 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:22.231058 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.231058 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.231058 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.270093 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:22.270093 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:30:22.272060 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.273106 [debug] [Thread-2  ]: finished collecting timing info
14:30:22.274058 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:30:22.274058 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:22.276061 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:30:22.294061 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:22.295064 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.296060 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:30:22.320094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:30:22.323061 [debug] [Thread-1  ]: finished collecting timing info
14:30:22.324060 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:30:22.327068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:23.542973 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:30:23.543998 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    )

select * from final
  );
  
14:30:23.548997 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:30:23.550985 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber
        ,cardtype as cardType
        ,expyear as expYear
        ,expmonth as expMonth
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardNumber
            ,cardType
            ,expYear
            ,expMonth
        from CreditCards
    )

select * from final
  );
  
14:30:26.151884 [debug] [Thread-1  ]: finished collecting timing info
14:30:26.151884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C1C3D0>]}
14:30:26.152884 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (1.0k rows, 154.6 KB processed)[0m in 3.88s]
14:30:26.154869 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:30:26.155849 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.156857 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:30:26.158849 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.158849 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.158849 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.174850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.176849 [debug] [Thread-1  ]: finished collecting timing info
14:30:26.176849 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:26.179851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:26.568649 [debug] [Thread-2  ]: finished collecting timing info
14:30:26.569641 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8CDA640>]}
14:30:26.570656 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.9 MB processed)[0m in 4.34s]
14:30:26.572647 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:30:26.573651 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.574654 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:30:26.576641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:26.577643 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.577643 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.596645 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:26.598638 [debug] [Thread-2  ]: finished collecting timing info
14:30:26.598638 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:26.607639 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:26.758433 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:30:26.760433 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrderSalesReason.salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrderSalesReason.salesOrder_id
            ,SalesOrderSalesReason.salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason

        left join SalesReason on SalesOrderSalesReason.salesReason_id = SalesReason.salesReason_id 
    )

select * from final
  );
  
14:30:27.202187 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:30:27.203152 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:30:30.209678 [debug] [Thread-2  ]: finished collecting timing info
14:30:30.210675 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8B63D60>]}
14:30:30.211674 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.64s]
14:30:30.213494 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:30:31.270053 [debug] [Thread-1  ]: finished collecting timing info
14:30:31.271088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E9CECFA0>]}
14:30:31.272050 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (110.6k rows, 864.3 KB processed)[0m in 5.11s]
14:30:31.274048 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:30:31.275050 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.276050 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:30:31.277052 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.277052 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.278077 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.313081 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.314084 [debug] [Thread-2  ]: finished collecting timing info
14:30:31.315067 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:31.318084 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:30:31.320051 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:31.326048 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join dim_Reasons on SalesOrders.salesOrder_id = dim_Reasons.salesOrder_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:30:50.785697 [debug] [Thread-2  ]: finished collecting timing info
14:30:50.786657 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be13fec-c8ca-4e7f-ba88-30d034bd357e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C221C0>]}
14:30:50.786657 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (10.2m rows, 26.6 MB processed)[0m in 19.51s]
14:30:50.788657 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:30:50.791683 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:30:50.792658 [info ] [MainThread]: 
14:30:50.793684 [info ] [MainThread]: Finished running 5 table models in 29.91s.
14:30:50.794658 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:50.794658 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:30:50.795657 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:30:50.796657 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:30:50.796657 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:30:50.812668 [info ] [MainThread]: 
14:30:50.815658 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:50.817661 [info ] [MainThread]: 
14:30:50.819678 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
14:30:50.820670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6E8C8DA60>]}


============================== 2022-05-04 11:19:33.399376 | 24582295-911c-46b9-910e-2a0cd71b3489 ==============================
11:19:33.399376 [info ] [MainThread]: Running with dbt=1.0.4
11:19:33.415009 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
11:19:33.415009 [debug] [MainThread]: Tracking: tracking
11:19:33.431586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D0F3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D103CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D103580>]}
11:19:34.341129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:19:34.341129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:19:34.356749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24582295-911c-46b9-910e-2a0cd71b3489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D3620D0>]}
11:19:34.372372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24582295-911c-46b9-910e-2a0cd71b3489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D1807F0>]}
11:19:34.372372 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
11:19:34.381872 [info ] [MainThread]: 
11:19:34.382872 [debug] [MainThread]: Acquiring new bigquery connection "master"
11:19:34.384869 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
11:19:34.384869 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:19:35.174194 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
11:19:35.174194 [info ] [MainThread]: 
11:19:35.219431 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.220429 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.220429 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
11:19:35.221443 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
11:19:35.222427 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.224431 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.224431 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.225431 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.225431 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.226429 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.239428 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.244430 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.246429 [debug] [Thread-1  ]: finished collecting timing info
11:19:35.247428 [debug] [Thread-2  ]: finished collecting timing info
11:19:35.247428 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:35.247428 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:35.278430 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
11:19:35.281433 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
11:19:35.283433 [debug] [Thread-2  ]: Opening a new connection, currently in state init
11:19:35.288430 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
11:19:35.345244 [debug] [Thread-1  ]: Opening a new connection, currently in state init
11:19:35.345244 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
11:19:37.020547 [debug] [Thread-1  ]: finished collecting timing info
11:19:37.021547 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.80s]
11:19:37.022548 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
11:19:37.023547 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.024554 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
11:19:37.025549 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.026549 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.026549 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.035552 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.036552 [debug] [Thread-1  ]: finished collecting timing info
11:19:37.037549 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:37.040834 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
11:19:37.040834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:37.040834 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
11:19:37.070033 [debug] [Thread-2  ]: finished collecting timing info
11:19:37.070033 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.85s]
11:19:37.072040 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
11:19:37.073035 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.074042 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
11:19:37.075046 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.076037 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.077039 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.082030 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.083031 [debug] [Thread-2  ]: finished collecting timing info
11:19:37.084033 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:37.087034 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
11:19:37.089033 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:37.098036 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
11:19:38.698079 [debug] [Thread-1  ]: finished collecting timing info
11:19:38.698079 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.67s]
11:19:38.713702 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
11:19:38.715293 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.716292 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
11:19:38.717712 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.717712 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.718714 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.728714 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.731716 [debug] [Thread-2  ]: finished collecting timing info
11:19:38.732716 [debug] [Thread-1  ]: finished collecting timing info
11:19:38.732716 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.66s]
11:19:38.733713 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:38.737713 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
11:19:38.738715 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
11:19:38.739720 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.740714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:38.740714 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
11:19:38.742717 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.743718 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.743718 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.752713 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.753723 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:38.754713 [debug] [Thread-2  ]: finished collecting timing info
11:19:38.756713 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:38.759715 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
11:19:38.762713 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:38.778715 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:40.501624 [debug] [Thread-2  ]: finished collecting timing info
11:19:40.501624 [debug] [Thread-1  ]: finished collecting timing info
11:19:40.501624 [error] [Thread-2  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 1.76s]
11:19:40.501624 [error] [Thread-1  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.78s]
11:19:40.501624 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
11:19:40.514075 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.515351 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
11:19:40.515506 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
11:19:40.516507 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.516507 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.517545 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.517545 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
11:19:40.518508 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.519506 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.527539 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.528506 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.528506 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.534516 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.534516 [debug] [Thread-2  ]: finished collecting timing info
11:19:40.535515 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:40.538542 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
11:19:40.538542 [debug] [Thread-1  ]: finished collecting timing info
11:19:40.539505 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:40.541505 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
11:19:40.542550 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
11:19:40.543506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:19:40.548517 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:40.549507 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
11:19:42.155266 [debug] [Thread-1  ]: finished collecting timing info
11:19:42.155266 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.64s]
11:19:42.170597 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
11:19:42.193463 [debug] [Thread-2  ]: finished collecting timing info
11:19:42.193601 [error] [Thread-2  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 1.68s]
11:19:42.193601 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
11:19:42.196568 [debug] [MainThread]: Acquiring new bigquery connection "master"
11:19:42.197567 [info ] [MainThread]: 
11:19:42.198676 [info ] [MainThread]: Finished running 8 tests in 7.81s.
11:19:42.199932 [debug] [MainThread]: Connection 'master' was properly closed.
11:19:42.199932 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
11:19:42.200936 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
11:19:42.201163 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
11:19:42.201163 [info ] [MainThread]: 
11:19:42.216771 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
11:19:42.216771 [info ] [MainThread]: 
11:19:42.216771 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
11:19:42.216771 [error] [MainThread]:   Got 504 results, configured to fail if != 0
11:19:42.216771 [info ] [MainThread]: 
11:19:42.225450 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
11:19:42.226451 [info ] [MainThread]: 
11:19:42.227442 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
11:19:42.229438 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
11:19:42.231438 [info ] [MainThread]: 
11:19:42.232453 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
11:19:42.234443 [info ] [MainThread]: 
11:19:42.236438 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
11:19:42.238457 [error] [MainThread]:   Got 10 results, configured to fail if != 0
11:19:42.239439 [info ] [MainThread]: 
11:19:42.240441 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
11:19:42.242440 [info ] [MainThread]: 
11:19:42.243447 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
11:19:42.245438 [error] [MainThread]:   Got 7 results, configured to fail if != 0
11:19:42.247438 [info ] [MainThread]: 
11:19:42.248439 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
11:19:42.250438 [info ] [MainThread]: 
11:19:42.251441 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
11:19:42.252439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D32AEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6E4C8DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6E4C80A0>]}


============================== 2022-05-09 13:49:00.769714 | 94306435-df1e-43e7-a1aa-a388250d542b ==============================
13:49:00.769714 [info ] [MainThread]: Running with dbt=1.0.4
13:49:00.770715 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:49:00.771731 [debug] [MainThread]: Tracking: tracking
13:49:00.799715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076921E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076943460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769438B0>]}
13:49:01.662822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
13:49:01.663822 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
13:49:01.663822 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
13:49:01.664823 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
13:49:01.665794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
13:49:01.665794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
13:49:01.666794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
13:49:01.666794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
13:49:01.667794 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
13:49:01.668104 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
13:49:01.668794 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
13:49:01.668794 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:49:01.669897 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
13:49:01.670429 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
13:49:01.670822 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:49:01.683822 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:49:01.716824 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:49:01.717823 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
13:49:01.724823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
13:49:01.726822 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
13:49:01.729829 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
13:49:01.736829 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
13:49:01.737830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
13:49:01.740830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
13:49:01.742830 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:49:01.749832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:49:01.750829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
13:49:01.753850 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
13:49:01.756829 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
13:49:01.759829 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:49:01.765832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:49:01.766830 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
13:49:01.769825 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
13:49:01.773828 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
13:49:02.039556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94306435-df1e-43e7-a1aa-a388250d542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076D030D0>]}
13:49:02.052556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94306435-df1e-43e7-a1aa-a388250d542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769D88E0>]}
13:49:02.052556 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:49:02.056556 [info ] [MainThread]: 
13:49:02.057558 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:02.059903 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:49:02.060556 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:49:03.740635 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:49:03.741705 [info ] [MainThread]: 
13:49:03.768423 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.769433 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.769433 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
13:49:03.769433 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
13:49:03.771435 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.772440 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.772440 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.773435 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.773435 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.774433 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.786471 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.791464 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.793934 [debug] [Thread-1  ]: finished collecting timing info
13:49:03.793934 [debug] [Thread-2  ]: finished collecting timing info
13:49:03.794738 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:03.794738 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:03.817469 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:49:03.821436 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:49:03.823437 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:49:03.824901 [debug] [Thread-2  ]: Opening a new connection, currently in state init
13:49:03.830462 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
13:49:03.831462 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
13:49:06.084369 [debug] [Thread-2  ]: finished collecting timing info
13:49:06.085370 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.31s]
13:49:06.086346 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:49:06.088343 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.088841 [info ] [Thread-2  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
13:49:06.090345 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.091346 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.092147 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.097345 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.099402 [debug] [Thread-2  ]: finished collecting timing info
13:49:06.099874 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:06.115377 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:49:06.116395 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:06.122340 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
13:49:06.374987 [debug] [Thread-1  ]: finished collecting timing info
13:49:06.376091 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.60s]
13:49:06.376948 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:49:06.377947 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.379171 [info ] [Thread-1  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
13:49:06.380948 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.380948 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.382088 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.385986 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.386947 [debug] [Thread-1  ]: finished collecting timing info
13:49:06.387951 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:06.389988 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:49:06.391788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:06.396982 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
13:49:08.343144 [debug] [Thread-2  ]: finished collecting timing info
13:49:08.344142 [info ] [Thread-2  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.25s]
13:49:08.345145 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:49:08.346142 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.347146 [info ] [Thread-2  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
13:49:08.348145 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.348682 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.349344 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.359144 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.361144 [debug] [Thread-2  ]: finished collecting timing info
13:49:08.361815 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:08.371147 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:49:08.396042 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:08.401041 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:08.794282 [debug] [Thread-1  ]: finished collecting timing info
13:49:08.794282 [info ] [Thread-1  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.41s]
13:49:08.796247 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:49:08.797246 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.797246 [info ] [Thread-1  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
13:49:08.798245 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.799245 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.799667 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.807289 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.809291 [debug] [Thread-1  ]: finished collecting timing info
13:49:08.809532 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:08.812281 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:49:08.861780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:08.867231 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:10.771020 [debug] [Thread-2  ]: finished collecting timing info
13:49:10.772067 [error] [Thread-2  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.42s]
13:49:10.774029 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:49:10.774029 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.775030 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
13:49:10.776031 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.776031 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.777233 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.783028 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.785030 [debug] [Thread-2  ]: finished collecting timing info
13:49:10.786363 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:10.789029 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:49:10.790883 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:49:10.796029 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:11.238738 [debug] [Thread-1  ]: finished collecting timing info
13:49:11.239736 [error] [Thread-1  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 2.44s]
13:49:11.241737 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:49:11.241737 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.242809 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
13:49:11.243739 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.244738 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.245274 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.251737 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.253965 [debug] [Thread-1  ]: finished collecting timing info
13:49:11.254739 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:11.259281 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:49:11.260796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:49:11.266774 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:49:13.024415 [debug] [Thread-2  ]: finished collecting timing info
13:49:13.025415 [error] [Thread-2  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 2.25s]
13:49:13.027544 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:49:13.697855 [debug] [Thread-1  ]: finished collecting timing info
13:49:13.698855 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.45s]
13:49:13.699858 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:49:13.701860 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:49:13.702861 [info ] [MainThread]: 
13:49:13.703870 [info ] [MainThread]: Finished running 8 tests in 11.65s.
13:49:13.704859 [debug] [MainThread]: Connection 'master' was properly closed.
13:49:13.705932 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:49:13.706859 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:49:13.706859 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
13:49:13.736955 [info ] [MainThread]: 
13:49:13.738570 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
13:49:13.739856 [info ] [MainThread]: 
13:49:13.741858 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
13:49:13.742858 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
13:49:13.744860 [info ] [MainThread]: 
13:49:13.746858 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
13:49:13.748350 [info ] [MainThread]: 
13:49:13.749887 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
13:49:13.750857 [error] [MainThread]:   Got 504 results, configured to fail if != 0
13:49:13.752869 [info ] [MainThread]: 
13:49:13.753907 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
13:49:13.756160 [info ] [MainThread]: 
13:49:13.757020 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
13:49:13.758856 [error] [MainThread]:   Got 7 results, configured to fail if != 0
13:49:13.760122 [info ] [MainThread]: 
13:49:13.761884 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
13:49:13.762858 [info ] [MainThread]: 
13:49:13.763861 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
13:49:13.765876 [error] [MainThread]:   Got 10 results, configured to fail if != 0
13:49:13.766856 [info ] [MainThread]: 
13:49:13.767934 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
13:49:13.768855 [info ] [MainThread]: 
13:49:13.770856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
13:49:13.771859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210769439D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107699C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021077E104C0>]}


============================== 2022-05-09 13:58:59.655347 | 6abcbcc6-25fe-49be-95ce-292de25bb424 ==============================
13:58:59.655347 [info ] [MainThread]: Running with dbt=1.0.4
13:58:59.655347 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:58:59.656348 [debug] [MainThread]: Tracking: tracking
13:58:59.670366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B48E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B74C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2B74880>]}
13:58:59.797345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
13:58:59.797345 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
13:58:59.798347 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
13:58:59.798997 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
13:58:59.799346 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\staging\stg_AdventureWorks_CreditCards.sql
13:58:59.800540 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
13:58:59.811376 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
13:58:59.842346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
13:58:59.844347 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
13:58:59.851347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
13:58:59.853347 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
13:58:59.861346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
13:58:59.863357 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
13:58:59.866347 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
13:58:59.872347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
13:58:59.933345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6abcbcc6-25fe-49be-95ce-292de25bb424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2EFA0D0>]}
13:58:59.946347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6abcbcc6-25fe-49be-95ce-292de25bb424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2D9CA90>]}
13:58:59.947684 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
13:58:59.950348 [info ] [MainThread]: 
13:58:59.952347 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:58:59.954348 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
13:58:59.954348 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:59:00.945714 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
13:59:00.946661 [info ] [MainThread]: 
13:59:00.954674 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.955670 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.956660 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
13:59:00.957014 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
13:59:00.958532 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:00.960302 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:00.960302 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.961299 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.961299 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.961299 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:00.973302 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:00.977456 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:00.979712 [debug] [Thread-1  ]: finished collecting timing info
13:59:00.979712 [debug] [Thread-2  ]: finished collecting timing info
13:59:00.980476 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:00.981471 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:01.003491 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
13:59:01.006491 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
13:59:01.008839 [debug] [Thread-1  ]: Opening a new connection, currently in state init
13:59:01.009455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
13:59:01.014459 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
13:59:01.015458 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
13:59:02.653611 [debug] [Thread-1  ]: finished collecting timing info
13:59:02.654525 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.70s]
13:59:02.656241 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
13:59:02.657255 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.657692 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
13:59:02.658254 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.659419 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.659419 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.665274 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.666500 [debug] [Thread-1  ]: finished collecting timing info
13:59:02.667649 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:02.670253 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
13:59:02.672255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:02.677250 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
13:59:03.026917 [debug] [Thread-2  ]: finished collecting timing info
13:59:03.027882 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.07s]
13:59:03.028881 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
13:59:03.029882 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.030977 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
13:59:03.031882 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.032883 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.032883 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.037904 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.039725 [debug] [Thread-2  ]: finished collecting timing info
13:59:03.039884 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:03.041904 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
13:59:03.044035 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:03.051883 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
13:59:04.198795 [debug] [Thread-1  ]: finished collecting timing info
13:59:04.199787 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.54s]
13:59:04.200807 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
13:59:04.201802 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.203028 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
13:59:04.203786 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.204790 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.205228 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.214787 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.215825 [debug] [Thread-1  ]: finished collecting timing info
13:59:04.217141 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:04.224820 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
13:59:04.225787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:04.232784 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:04.673785 [debug] [Thread-2  ]: finished collecting timing info
13:59:04.674930 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.64s]
13:59:04.676795 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
13:59:04.677788 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.678536 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
13:59:04.679785 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.680785 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.681783 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.695786 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.697475 [debug] [Thread-2  ]: finished collecting timing info
13:59:04.698246 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:04.703785 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
13:59:04.704786 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:04.710787 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:06.154871 [debug] [Thread-1  ]: finished collecting timing info
13:59:06.155870 [error] [Thread-1  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.95s]
13:59:06.157878 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
13:59:06.157878 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.158912 [info ] [Thread-1  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
13:59:06.159872 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.160872 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.160872 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.165891 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.167880 [debug] [Thread-1  ]: finished collecting timing info
13:59:06.168873 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:06.171899 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
13:59:06.173870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:06.178871 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:06.499909 [debug] [Thread-2  ]: finished collecting timing info
13:59:06.501351 [error] [Thread-2  ]: 6 of 8 FAIL 504 unique_dim_Products_product_sk.................................. [[31mFAIL 504[0m in 1.82s]
13:59:06.503350 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
13:59:06.503350 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.504350 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
13:59:06.506352 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.506352 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.507671 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.516350 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.518102 [debug] [Thread-2  ]: finished collecting timing info
13:59:06.518697 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:06.521349 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
13:59:06.523360 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
13:59:06.529834 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
13:59:07.888154 [debug] [Thread-1  ]: finished collecting timing info
13:59:07.889152 [error] [Thread-1  ]: 7 of 8 FAIL 7 unique_dim_Reasons_reason_sk...................................... [[31mFAIL 7[0m in 1.73s]
13:59:07.890157 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
13:59:08.282136 [debug] [Thread-2  ]: finished collecting timing info
13:59:08.283136 [error] [Thread-2  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.78s]
13:59:08.283752 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
13:59:08.285769 [debug] [MainThread]: Acquiring new bigquery connection "master"
13:59:08.286791 [info ] [MainThread]: 
13:59:08.287926 [info ] [MainThread]: Finished running 8 tests in 8.34s.
13:59:08.288778 [debug] [MainThread]: Connection 'master' was properly closed.
13:59:08.289907 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
13:59:08.289907 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
13:59:08.290806 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
13:59:08.316765 [info ] [MainThread]: 
13:59:08.318805 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
13:59:08.320784 [info ] [MainThread]: 
13:59:08.321932 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
13:59:08.324764 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
13:59:08.325847 [info ] [MainThread]: 
13:59:08.326763 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
13:59:08.328766 [info ] [MainThread]: 
13:59:08.329763 [error] [MainThread]: [31mFailure in test unique_dim_Products_product_sk (models\marts\dim_Products.yml)[0m
13:59:08.331780 [error] [MainThread]:   Got 504 results, configured to fail if != 0
13:59:08.332765 [info ] [MainThread]: 
13:59:08.333768 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Products.yml\unique_dim_Products_product_sk.sql
13:59:08.335764 [info ] [MainThread]: 
13:59:08.336763 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
13:59:08.338891 [error] [MainThread]:   Got 7 results, configured to fail if != 0
13:59:08.339764 [info ] [MainThread]: 
13:59:08.341870 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
13:59:08.343764 [info ] [MainThread]: 
13:59:08.345285 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
13:59:08.346765 [error] [MainThread]:   Got 10 results, configured to fail if != 0
13:59:08.347770 [info ] [MainThread]: 
13:59:08.348768 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
13:59:08.349766 [info ] [MainThread]: 
13:59:08.352074 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
13:59:08.353765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2BF8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D2BF8A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D40233D0>]}


============================== 2022-05-09 14:12:55.343393 | 88596dde-4278-4309-bfc7-dda7006a6e95 ==============================
14:12:55.343393 [info ] [MainThread]: Running with dbt=1.0.4
14:12:55.343393 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:12:55.344393 [debug] [MainThread]: Tracking: tracking
14:12:55.358395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5CDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5F4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D5F4F70>]}
14:12:55.472395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:12:55.472395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:12:55.479393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D8630D0>]}
14:12:55.493394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D687760>]}
14:12:55.493394 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:12:55.497393 [info ] [MainThread]: 
14:12:55.498393 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:12:55.500543 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:12:55.501316 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:57.436925 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:12:57.437886 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:58.286503 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:12:58.287462 [info ] [MainThread]: 
14:12:58.295461 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.296463 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.297467 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:12:58.298465 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:12:58.299465 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.300465 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.300465 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.301466 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.305484 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:12:58.308498 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:12:58.335943 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.336399 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:12:58.337259 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.338246 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:12:58.338673 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.339120 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.341246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:12:58.398777 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.399248 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.399778 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:12:58.399778 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:12:58.401214 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.401778 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.402775 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:12:58.403375 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:12:58.403799 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.403799 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.405164 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.405642 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.408802 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:12:58.411801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:12:58.413774 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.413892 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:12:58.414777 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.414777 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.415774 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:12:58.416789 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:12:58.417441 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.417957 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.418774 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:12:58.418774 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.419775 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.422812 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:12:58.422812 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.427798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:12:58.428832 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.429774 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:12:58.429774 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.430773 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.431775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:12:58.432404 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:12:58.432966 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.433404 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.433982 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:12:58.433982 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.434776 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.437807 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:12:58.437807 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.440797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:12:58.442135 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.442776 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:12:58.443241 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.443552 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.444775 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:12:58.444775 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:12:58.445908 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.447774 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:58.447774 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:12:58.448799 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.450233 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:12:58.450773 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.450773 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.487810 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:58.488809 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:12:58.525809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:12:58.525809 [debug] [Thread-2  ]: finished collecting timing info
14:12:58.526775 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:12:58.542773 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:12:58.543620 [debug] [Thread-1  ]: finished collecting timing info
14:12:58.543775 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:12:58.546803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.418125 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:12:59.419127 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:12:59.420762 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:12:59.426476 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
14:13:02.968670 [debug] [Thread-2  ]: finished collecting timing info
14:13:02.969664 [debug] [Thread-1  ]: finished collecting timing info
14:13:02.969664 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D8B84F0>]}
14:13:02.970671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46E982EE0>]}
14:13:02.971669 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.3 MB processed)[0m in 4.52s]
14:13:02.972638 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 4.52s]
14:13:02.974636 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:13:02.975653 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.975653 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:13:02.976653 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:13:02.977635 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.978776 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:13:02.979641 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:02.980638 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:02.980638 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.981639 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.982644 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:13:02.982644 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:02.996679 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:03.013667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:03.086085 [debug] [Thread-2  ]: finished collecting timing info
14:13:03.086404 [debug] [Thread-1  ]: finished collecting timing info
14:13:03.086404 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:03.087460 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:03.090077 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:13:03.097044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:03.958342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:13:03.960288 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:13:03.978090 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:13:03.980089 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSalesReason
    )

select * from final
  );
  
14:13:04.308131 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).')
14:13:05.689316 [debug] [Thread-2  ]: finished collecting timing info
14:13:05.690296 [debug] [Thread-2  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:13:05.690296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D907460>]}
14:13:05.691296 [error] [Thread-2  ]: 3 of 5 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.71s]
14:13:05.693297 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:13:07.443540 [debug] [Thread-1  ]: finished collecting timing info
14:13:07.444536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88596dde-4278-4309-bfc7-dda7006a6e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D953310>]}
14:13:07.444536 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.46s]
14:13:07.446509 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:13:07.447502 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:13:07.448501 [info ] [Thread-2  ]: 5 of 5 SKIP relation AdventureWorks_marts.fact_SalesOrdersDetails............... [[33mSKIP[0m]
14:13:07.450503 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:13:07.452505 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:13:07.453503 [info ] [MainThread]: 
14:13:07.454504 [info ] [MainThread]: Finished running 5 table models in 11.96s.
14:13:07.455501 [debug] [MainThread]: Connection 'master' was properly closed.
14:13:07.456508 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:13:07.457207 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:13:07.457501 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:13:07.457501 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:13:07.469502 [info ] [MainThread]: 
14:13:07.471502 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:13:07.473502 [info ] [MainThread]: 
14:13:07.474502 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:13:07.476689 [error] [MainThread]:   Table "SalesOrderSalesReason" must be qualified with a dataset (e.g. dataset.table).
14:13:07.478514 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:13:07.480502 [info ] [MainThread]: 
14:13:07.481617 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
14:13:07.482587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D82ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D82AE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D94C370>]}


============================== 2022-05-09 14:14:19.256284 | a4915d33-e076-441a-8276-9cd37aab37a8 ==============================
14:14:19.256284 [info ] [MainThread]: Running with dbt=1.0.4
14:14:19.257284 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:14:19.258305 [debug] [MainThread]: Tracking: tracking
14:14:19.273285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FBE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FC4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020191FC43D0>]}
14:14:19.398314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:14:19.398314 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:14:19.410314 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:14:19.439284 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:14:19.474284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201922960D0>]}
14:14:19.487506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201920F3CA0>]}
14:14:19.488158 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:14:19.491286 [info ] [MainThread]: 
14:14:19.492294 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:19.494284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:14:19.494284 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:20.389826 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:14:20.390402 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:21.323827 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:14:21.326828 [info ] [MainThread]: 
14:14:21.336827 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.337624 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:14:21.338826 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:21.338826 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.339826 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.345857 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:14:21.349827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:14:21.363863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:21.365747 [debug] [Thread-1  ]: finished collecting timing info
14:14:21.365833 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:21.382860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:14:22.244487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:14:22.246118 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesOrderSales
    )

select * from final
  );
  
14:14:22.653368 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).')
14:14:24.006570 [debug] [Thread-1  ]: finished collecting timing info
14:14:24.007582 [debug] [Thread-1  ]: Database Error in model dim_Reasons (models\marts\dim_Reasons.sql)
  Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:14:24.008091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4915d33-e076-441a-8276-9cd37aab37a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201923475B0>]}
14:14:24.008618 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_Reasons.............. [[31mERROR[0m in 2.67s]
14:14:24.010582 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:14:24.011585 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:14:24.012618 [info ] [MainThread]: 
14:14:24.013584 [info ] [MainThread]: Finished running 1 table model in 4.52s.
14:14:24.014586 [debug] [MainThread]: Connection 'master' was properly closed.
14:14:24.015582 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:14:24.016859 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:14:24.016859 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:14:24.030009 [info ] [MainThread]: 
14:14:24.030579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:14:24.032582 [info ] [MainThread]: 
14:14:24.034583 [error] [MainThread]: [33mDatabase Error in model dim_Reasons (models\marts\dim_Reasons.sql)[0m
14:14:24.036590 [error] [MainThread]:   Table "SalesOrderSales" must be qualified with a dataset (e.g. dataset.table).
14:14:24.038580 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_Reasons.sql
14:14:24.039590 [info ] [MainThread]: 
14:14:24.040781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:14:24.042587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019234FBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019234FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020192418970>]}


============================== 2022-05-09 14:15:12.708682 | a4ec5094-3ca4-41be-9f5d-daef8a2fbe50 ==============================
14:15:12.708682 [info ] [MainThread]: Running with dbt=1.0.4
14:15:12.709685 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:15:12.711076 [debug] [MainThread]: Tracking: tracking
14:15:12.724691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE934EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE945940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE945310>]}
14:15:12.849681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:15:12.849681 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:15:12.861689 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:15:12.892682 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:15:12.928682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DEC070D0>]}
14:15:12.940683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE98B490>]}
14:15:12.941951 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:12.944684 [info ] [MainThread]: 
14:15:12.945652 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:12.947665 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:15:12.947721 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:13.823053 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:13.823671 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:14.651430 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:14.652431 [info ] [MainThread]: 
14:15:14.659436 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.660467 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:15:14.661431 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:14.662793 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.663432 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.669456 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:15:14.673465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:15:14.686465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:14.688475 [debug] [Thread-1  ]: finished collecting timing info
14:15:14.688612 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:14.704483 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:15.532898 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:15:15.534899 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:15:19.053671 [debug] [Thread-1  ]: finished collecting timing info
14:15:19.054599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ec5094-3ca4-41be-9f5d-daef8a2fbe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DED87640>]}
14:15:19.055310 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (20.0 rows, 340.0 Bytes processed)[0m in 4.39s]
14:15:19.056619 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:15:19.058600 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:19.059601 [info ] [MainThread]: 
14:15:19.060599 [info ] [MainThread]: Finished running 1 table model in 6.11s.
14:15:19.061670 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:19.062599 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:15:19.062599 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:19.063927 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:15:19.077624 [info ] [MainThread]: 
14:15:19.078722 [info ] [MainThread]: [32mCompleted successfully[0m
14:15:19.080603 [info ] [MainThread]: 
14:15:19.082602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:15:19.083600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE98B460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE9BC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE9A6B20>]}


============================== 2022-05-09 14:15:29.968377 | 90ff6ed0-b3a1-4b92-bdfa-30007286f758 ==============================
14:15:29.968377 [info ] [MainThread]: Running with dbt=1.0.4
14:15:29.969377 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:15:29.970379 [debug] [MainThread]: Tracking: tracking
14:15:29.985380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9E90E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9EB4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9EB4490>]}
14:15:30.106376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:15:30.107377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:15:30.115377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90ff6ed0-b3a1-4b92-bdfa-30007286f758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AA1220D0>]}
14:15:30.128377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90ff6ed0-b3a1-4b92-bdfa-30007286f758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265A9FEC820>]}
14:15:30.129378 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:15:30.132382 [info ] [MainThread]: 
14:15:30.134379 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:30.136379 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:15:30.137379 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:15:30.933112 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:15:30.934394 [info ] [MainThread]: 
14:15:30.942409 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.943408 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.943408 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:15:30.944608 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
14:15:30.946516 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.947457 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.948408 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.948408 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.948408 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.949713 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.960409 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.966409 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.967413 [debug] [Thread-1  ]: finished collecting timing info
14:15:30.968539 [debug] [Thread-2  ]: finished collecting timing info
14:15:30.968539 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:30.969418 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:30.991441 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:15:30.995548 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
14:15:30.997405 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:15:30.998537 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:15:31.003442 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
14:15:31.004408 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:15:32.987323 [debug] [Thread-2  ]: finished collecting timing info
14:15:32.987323 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 2.04s]
14:15:32.989396 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
14:15:32.990286 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:32.991301 [info ] [Thread-2  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:15:32.992289 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:32.993308 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:32.993952 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:33.002286 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:33.004152 [debug] [Thread-2  ]: finished collecting timing info
14:15:33.004285 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:33.008286 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:15:33.010173 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:33.015288 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:15:33.599426 [debug] [Thread-1  ]: finished collecting timing info
14:15:33.599426 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.65s]
14:15:33.601390 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:15:33.602388 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.602388 [info ] [Thread-1  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:15:33.604408 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.604408 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.605389 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.609387 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.611594 [debug] [Thread-1  ]: finished collecting timing info
14:15:33.612485 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:33.616426 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:15:33.618289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:33.622334 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:15:34.917648 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.918619 [info ] [Thread-2  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.93s]
14:15:34.920617 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:15:34.920617 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.921627 [info ] [Thread-2  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:15:34.922613 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.922613 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.923614 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.931650 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.933132 [debug] [Thread-2  ]: finished collecting timing info
14:15:34.933610 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:34.935643 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:15:34.937326 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:34.942370 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:35.585393 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.586786 [info ] [Thread-1  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.98s]
14:15:35.588799 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:15:35.588799 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.589799 [info ] [Thread-1  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
14:15:35.590793 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.591796 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.591796 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.596822 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.598797 [debug] [Thread-1  ]: finished collecting timing info
14:15:35.598797 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:35.606828 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
14:15:35.607868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:35.613832 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:37.123708 [debug] [Thread-2  ]: finished collecting timing info
14:15:37.123708 [error] [Thread-2  ]: 5 of 8 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.20s]
14:15:37.125703 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:15:37.126753 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.126753 [info ] [Thread-2  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:15:37.128088 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.128710 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.129544 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.136709 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.137709 [debug] [Thread-2  ]: finished collecting timing info
14:15:37.138707 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:37.140707 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:15:37.142716 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:15:37.148711 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:37.831617 [debug] [Thread-1  ]: finished collecting timing info
14:15:37.832578 [info ] [Thread-1  ]: 6 of 8 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 2.24s]
14:15:37.834583 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
14:15:37.834583 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.835579 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:15:37.836579 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.837578 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.837976 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.842584 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.844677 [debug] [Thread-1  ]: finished collecting timing info
14:15:37.844677 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:37.848615 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:15:37.849618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:15:37.855613 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:15:39.457591 [debug] [Thread-2  ]: finished collecting timing info
14:15:39.457591 [error] [Thread-2  ]: 7 of 8 FAIL 10 unique_dim_Reasons_reason_sk..................................... [[31mFAIL 10[0m in 2.33s]
14:15:39.460266 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:15:40.398329 [debug] [Thread-1  ]: finished collecting timing info
14:15:40.399329 [error] [Thread-1  ]: 8 of 8 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.56s]
14:15:40.400334 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:15:40.402334 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:15:40.403332 [info ] [MainThread]: 
14:15:40.404337 [info ] [MainThread]: Finished running 8 tests in 10.27s.
14:15:40.405332 [debug] [MainThread]: Connection 'master' was properly closed.
14:15:40.406331 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:15:40.406848 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:15:40.407438 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:15:40.430364 [info ] [MainThread]: 
14:15:40.431340 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
14:15:40.433330 [info ] [MainThread]: 
14:15:40.434333 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:15:40.435330 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:15:40.436332 [info ] [MainThread]: 
14:15:40.437389 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:15:40.438335 [info ] [MainThread]: 
14:15:40.439447 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
14:15:40.441335 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:15:40.442346 [info ] [MainThread]: 
14:15:40.443331 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
14:15:40.444476 [info ] [MainThread]: 
14:15:40.445331 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:15:40.446332 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:15:40.448344 [info ] [MainThread]: 
14:15:40.449334 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:15:40.450334 [info ] [MainThread]: 
14:15:40.451504 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
14:15:40.453340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AB266640>]}


============================== 2022-05-09 14:20:05.608089 | 0d9040d5-8a4c-45b6-9216-1c7fe612ea77 ==============================
14:20:05.608089 [info ] [MainThread]: Running with dbt=1.0.4
14:20:05.609059 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:05.610279 [debug] [MainThread]: Tracking: tracking
14:20:05.626068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710EFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710F4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C710F4CD0>]}
14:20:05.743087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:20:05.743087 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:20:05.744086 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:20:05.756089 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:20:05.788092 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:20:05.790091 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:20:05.796091 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:20:05.842090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C713D70D0>]}
14:20:05.855059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C7123DCA0>]}
14:20:05.855059 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:05.858302 [info ] [MainThread]: 
14:20:05.859074 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:05.861087 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:05.862155 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:06.971831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:06.972518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:07.947410 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:07.948445 [info ] [MainThread]: 
14:20:07.956425 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.957411 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:07.958431 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:07.959409 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.960528 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:07.967433 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:07.970433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:07.986442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:07.987907 [debug] [Thread-1  ]: finished collecting timing info
14:20:07.988538 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:08.004442 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:08.909687 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:08.911029 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:20:12.464933 [debug] [Thread-1  ]: finished collecting timing info
14:20:12.465933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d9040d5-8a4c-45b6-9216-1c7fe612ea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C714F8DC0>]}
14:20:12.467459 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (20.0 rows, 340.0 Bytes processed)[0m in 4.51s]
14:20:12.469255 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:12.471086 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:12.472125 [info ] [MainThread]: 
14:20:12.472906 [info ] [MainThread]: Finished running 1 table model in 6.61s.
14:20:12.473940 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:12.474945 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:12.475938 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:12.475938 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:20:12.497956 [info ] [MainThread]: 
14:20:12.498904 [info ] [MainThread]: [32mCompleted successfully[0m
14:20:12.500324 [info ] [MainThread]: 
14:20:12.500921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:20:12.502904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C5E21E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C71452FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C71452CD0>]}


============================== 2022-05-09 14:20:26.205706 | 275787ea-2635-48bb-8def-6dc823cdcecd ==============================
14:20:26.205706 [info ] [MainThread]: Running with dbt=1.0.4
14:20:26.206707 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:20:26.207708 [debug] [MainThread]: Tracking: tracking
14:20:26.222728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D386E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3874B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3874220>]}
14:20:26.348710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:20:26.348710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:20:26.356707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '275787ea-2635-48bb-8def-6dc823cdcecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3AE20D0>]}
14:20:26.369707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '275787ea-2635-48bb-8def-6dc823cdcecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39DC700>]}
14:20:26.370707 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:26.373711 [info ] [MainThread]: 
14:20:26.374711 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:26.377728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:26.377728 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:27.279530 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:27.280529 [info ] [MainThread]: 
14:20:27.288552 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.288552 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.288552 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:20:27.289924 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:20:27.292554 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.292554 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.293651 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.294554 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.294554 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.307560 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.308553 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.316587 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.318106 [debug] [Thread-1  ]: finished collecting timing info
14:20:27.318106 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:27.319243 [debug] [Thread-2  ]: finished collecting timing info
14:20:27.342786 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:20:27.343580 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:27.346024 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:20:27.347024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:27.347986 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:20:27.352985 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:20:27.352985 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:20:29.276470 [debug] [Thread-1  ]: finished collecting timing info
14:20:29.277441 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.99s]
14:20:29.279440 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:20:29.620402 [debug] [Thread-2  ]: finished collecting timing info
14:20:29.620402 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_Reasons_reason_sk..................................... [[31mFAIL 10[0m in 2.33s]
14:20:29.622375 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:20:29.624692 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:29.625373 [info ] [MainThread]: 
14:20:29.627372 [info ] [MainThread]: Finished running 2 tests in 3.25s.
14:20:29.628373 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:29.629404 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:20:29.629404 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
14:20:29.630725 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:20:29.652372 [info ] [MainThread]: 
14:20:29.653450 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:20:29.655376 [info ] [MainThread]: 
14:20:29.656378 [error] [MainThread]: [31mFailure in test unique_dim_Reasons_reason_sk (models\marts\dim_Reasons.yml)[0m
14:20:29.659378 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:20:29.661378 [info ] [MainThread]: 
14:20:29.662376 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_Reasons.yml\unique_dim_Reasons_reason_sk.sql
14:20:29.663541 [info ] [MainThread]: 
14:20:29.665377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:20:29.666374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39C2CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D39DC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D3B746D0>]}


============================== 2022-05-09 14:20:47.046054 | f8d067fb-cfdc-486f-9298-7deec12a05d4 ==============================
14:20:47.046054 [info ] [MainThread]: Running with dbt=1.0.4
14:20:47.047055 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:47.048057 [debug] [MainThread]: Tracking: tracking
14:20:47.062056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33A95EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33AA5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33AA5730>]}
14:20:47.195093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:20:47.195093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:20:47.205057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8d067fb-cfdc-486f-9298-7deec12a05d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33D020D0>]}
14:20:47.219060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8d067fb-cfdc-486f-9298-7deec12a05d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC33BF8790>]}
14:20:47.220059 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:47.224058 [info ] [MainThread]: 
14:20:47.226098 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:47.228404 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:47.229123 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:48.086408 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:48.086408 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:48.903968 [debug] [MainThread]: Connection 'master' was properly closed.
14:20:48.903968 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:20:48.904997 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.


============================== 2022-05-09 14:20:56.270990 | efd26036-53d7-4466-9abc-0932c66509cd ==============================
14:20:56.270990 [info ] [MainThread]: Running with dbt=1.0.4
14:20:56.272000 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:20:56.272991 [debug] [MainThread]: Tracking: tracking
14:20:56.286992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300266EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002674730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002674E80>]}
14:20:56.399989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:20:56.400990 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
14:20:56.411989 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:20:56.440989 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:20:56.475988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230029440D0>]}
14:20:56.488990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230027BCCD0>]}
14:20:56.490147 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:20:56.492006 [info ] [MainThread]: 
14:20:56.493992 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:20:56.494990 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:20:56.495997 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:57.387999 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:20:57.389453 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:20:58.240311 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:20:58.242104 [info ] [MainThread]: 
14:20:58.249115 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.250117 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:20:58.251144 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:58.252553 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.253117 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.259152 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:20:58.262151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:20:58.278150 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:58.279230 [debug] [Thread-1  ]: finished collecting timing info
14:20:58.280116 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:20:58.299120 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:20:59.121697 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:20:59.123019 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:21:02.289083 [debug] [Thread-1  ]: finished collecting timing info
14:21:02.289083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efd26036-53d7-4466-9abc-0932c66509cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230029C3D00>]}
14:21:02.290317 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 4.04s]
14:21:02.291926 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:21:02.293955 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:02.294935 [info ] [MainThread]: 
14:21:02.295974 [info ] [MainThread]: Finished running 1 table model in 5.80s.
14:21:02.297007 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:02.297953 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:21:02.297953 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:02.299368 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
14:21:02.311934 [info ] [MainThread]: 
14:21:02.312936 [info ] [MainThread]: [32mCompleted successfully[0m
14:21:02.315938 [info ] [MainThread]: 
14:21:02.316936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:21:02.318935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002958C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002958910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230028A1B80>]}


============================== 2022-05-09 14:21:08.536513 | b1571ba5-0880-41f5-8b99-486405bf26a3 ==============================
14:21:08.536513 [info ] [MainThread]: Running with dbt=1.0.4
14:21:08.537516 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:21:08.538531 [debug] [MainThread]: Tracking: tracking
14:21:08.552516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E105E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E125670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E125A90>]}
14:21:08.670515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:21:08.671530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:21:08.678513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1571ba5-0880-41f5-8b99-486405bf26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E3920D0>]}
14:21:08.691514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1571ba5-0880-41f5-8b99-486405bf26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E284820>]}
14:21:08.693007 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:21:08.695518 [info ] [MainThread]: 
14:21:08.697594 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:08.699518 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:21:08.699518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:09.546321 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:21:09.547284 [info ] [MainThread]: 
14:21:09.555286 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.555286 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.556286 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
14:21:09.556286 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
14:21:09.558288 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.559286 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.559612 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.560284 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.560284 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.573320 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.573320 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.580326 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.581321 [debug] [Thread-1  ]: finished collecting timing info
14:21:09.582284 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:09.600424 [debug] [Thread-2  ]: finished collecting timing info
14:21:09.605319 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
14:21:09.606336 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:09.608736 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
14:21:09.609711 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:21:09.611156 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:21:09.616704 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
14:21:09.616704 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:21:11.625057 [debug] [Thread-1  ]: finished collecting timing info
14:21:11.626058 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 2.07s]
14:21:11.628031 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
14:21:11.771512 [debug] [Thread-2  ]: finished collecting timing info
14:21:11.772511 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 2.21s]
14:21:11.774513 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
14:21:11.775514 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:21:11.777022 [info ] [MainThread]: 
14:21:11.778515 [info ] [MainThread]: Finished running 2 tests in 3.08s.
14:21:11.779514 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:11.780517 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:21:11.780924 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
14:21:11.781551 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
14:21:11.798828 [info ] [MainThread]: 
14:21:11.799881 [info ] [MainThread]: [32mCompleted successfully[0m
14:21:11.801836 [info ] [MainThread]: 
14:21:11.802839 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:21:11.803839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E284550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E2844F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3E41CC10>]}


============================== 2022-05-09 14:22:21.221981 | 5d19acd7-2173-4f5c-b3af-8166e926838d ==============================
14:22:21.221981 [info ] [MainThread]: Running with dbt=1.0.4
14:22:21.222982 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:22:21.223982 [debug] [MainThread]: Tracking: tracking
14:22:21.236985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F72653A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7265400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7265160>]}
14:22:21.359011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:22:21.360012 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:22:21.371013 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:22:21.399981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:22:21.437012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d19acd7-2173-4f5c-b3af-8166e926838d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F75340D0>]}
14:22:21.448982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d19acd7-2173-4f5c-b3af-8166e926838d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F725F910>]}
14:22:21.449984 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:21.452986 [info ] [MainThread]: 
14:22:21.453999 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:21.457002 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:21.457983 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:22.295850 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:22.297073 [info ] [MainThread]: 
14:22:22.304512 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.304512 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.305228 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:22:22.305541 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:22:22.306760 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.307703 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.307703 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.308512 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.309227 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.323546 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.323546 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.332547 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.333739 [debug] [Thread-1  ]: finished collecting timing info
14:22:22.334512 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:22.335511 [debug] [Thread-2  ]: finished collecting timing info
14:22:22.357510 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:22.357510 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:22.361553 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:22.361553 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:22.363160 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:22:22.367509 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:22:22.369551 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:22:24.201148 [debug] [Thread-1  ]: finished collecting timing info
14:22:24.202110 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.90s]
14:22:24.203932 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:24.339076 [debug] [Thread-2  ]: finished collecting timing info
14:22:24.340040 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.03s]
14:22:24.341041 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:24.343039 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:24.344077 [info ] [MainThread]: 
14:22:24.345041 [info ] [MainThread]: Finished running 2 tests in 2.89s.
14:22:24.346042 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:24.347375 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:24.347879 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:22:24.348373 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:22:24.360067 [info ] [MainThread]: 
14:22:24.362059 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:22:24.363050 [info ] [MainThread]: 
14:22:24.364263 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:22:24.366040 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:22:24.368039 [info ] [MainThread]: 
14:22:24.369754 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:22:24.371044 [info ] [MainThread]: 
14:22:24.372044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:22:24.373234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F749A040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F749AA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F7543850>]}


============================== 2022-05-09 14:22:35.402130 | 5b1c986e-e758-40fa-b2d5-81e1f84ee2c7 ==============================
14:22:35.402130 [info ] [MainThread]: Running with dbt=1.0.4
14:22:35.403130 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:22:35.404131 [debug] [MainThread]: Tracking: tracking
14:22:35.419132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BB51C0>]}
14:22:35.549130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:22:35.549130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:22:35.557129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9E220D0>]}
14:22:35.569130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9D14730>]}
14:22:35.570504 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:35.574343 [info ] [MainThread]: 
14:22:35.575132 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:35.577146 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:22:35.577146 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:36.416885 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:36.417883 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:37.670867 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:37.671823 [info ] [MainThread]: 
14:22:37.680824 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.681824 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:22:37.683591 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:37.684385 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.684947 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.719264 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:22:37.723823 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:22:37.747882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:37.749247 [debug] [Thread-1  ]: finished collecting timing info
14:22:37.749247 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:37.766824 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:39.169258 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:22:39.171292 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:22:42.419150 [debug] [Thread-1  ]: finished collecting timing info
14:22:42.420151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b1c986e-e758-40fa-b2d5-81e1f84ee2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9F49EE0>]}
14:22:42.421278 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (38.2k rows, 1.3 MB processed)[0m in 4.74s]
14:22:42.422156 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:22:42.424164 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:42.425149 [info ] [MainThread]: 
14:22:42.426147 [info ] [MainThread]: Finished running 1 table model in 6.85s.
14:22:42.427148 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:42.428385 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:22:42.428906 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:42.429149 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:22:42.445183 [info ] [MainThread]: 
14:22:42.446146 [info ] [MainThread]: [32mCompleted successfully[0m
14:22:42.448172 [info ] [MainThread]: 
14:22:42.450166 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:22:42.452161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9DEAAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9BC6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B9E96B50>]}


============================== 2022-05-09 14:22:51.451485 | 91972192-c86e-4b53-a5f9-7e2315d46b70 ==============================
14:22:51.451485 [info ] [MainThread]: Running with dbt=1.0.4
14:22:51.452455 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:22:51.452923 [debug] [MainThread]: Tracking: tracking
14:22:51.466492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2375EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2385A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2385580>]}
14:22:51.581457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:22:51.581457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:22:51.589490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91972192-c86e-4b53-a5f9-7e2315d46b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A25E20D0>]}
14:22:51.603407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91972192-c86e-4b53-a5f9-7e2315d46b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A24D4790>]}
14:22:51.604051 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:22:51.606455 [info ] [MainThread]: 
14:22:51.608459 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:51.609457 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:22:51.610457 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:22:52.714719 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:22:52.715717 [info ] [MainThread]: 
14:22:52.722718 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.723715 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.723715 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:22:52.724767 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:22:52.726719 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.728385 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.728722 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.729728 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.729728 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.730960 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.743754 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.750715 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.752529 [debug] [Thread-1  ]: finished collecting timing info
14:22:52.753003 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:52.753003 [debug] [Thread-2  ]: finished collecting timing info
14:22:52.776575 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:22:52.777580 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:52.780015 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:22:52.781280 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:22:52.781981 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:22:52.785979 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:22:52.788990 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:22:54.753783 [debug] [Thread-1  ]: finished collecting timing info
14:22:54.754744 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.03s]
14:22:54.755779 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:22:55.006557 [debug] [Thread-2  ]: finished collecting timing info
14:22:55.007589 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 2.28s]
14:22:55.009564 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:22:55.012592 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:22:55.013558 [info ] [MainThread]: 
14:22:55.014558 [info ] [MainThread]: Finished running 2 tests in 3.41s.
14:22:55.015571 [debug] [MainThread]: Connection 'master' was properly closed.
14:22:55.016559 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:22:55.017331 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:22:55.017558 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:22:55.035558 [info ] [MainThread]: 
14:22:55.037558 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:22:55.039553 [info ] [MainThread]: 
14:22:55.040755 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:22:55.041557 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:22:55.043559 [info ] [MainThread]: 
14:22:55.044561 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:22:55.045779 [info ] [MainThread]: 
14:22:55.046574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:22:55.048558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A25AA880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148F49F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A2675A90>]}


============================== 2022-05-09 14:23:18.443630 | 487924d3-cae5-45e1-a544-b1c9c2b40016 ==============================
14:23:18.443630 [info ] [MainThread]: Running with dbt=1.0.4
14:23:18.444631 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:23:18.445601 [debug] [MainThread]: Tracking: tracking
14:23:18.460604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF2B53D0>]}
14:23:18.577637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:23:18.578639 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
14:23:18.589629 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:23:18.619601 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:23:18.659636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '487924d3-cae5-45e1-a544-b1c9c2b40016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF5840D0>]}
14:23:18.672602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '487924d3-cae5-45e1-a544-b1c9c2b40016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF4EAD90>]}
14:23:18.673600 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:18.676631 [info ] [MainThread]: 
14:23:18.678484 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:18.679631 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:18.681093 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:19.526660 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:19.528407 [info ] [MainThread]: 
14:23:19.534699 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.535701 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.535701 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:23:19.536707 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:23:19.537697 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.538699 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.539717 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.540419 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.540697 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.541511 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.552701 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.561732 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.563122 [debug] [Thread-1  ]: finished collecting timing info
14:23:19.563987 [debug] [Thread-2  ]: finished collecting timing info
14:23:19.564486 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:19.564699 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:19.589700 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:19.591732 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:19.593824 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:19.594443 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:23:19.598706 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:23:19.600733 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:23:21.428040 [debug] [Thread-2  ]: finished collecting timing info
14:23:21.429008 [error] [Thread-2  ]: 2 of 2 FAIL 19118 unique_dim_CreditCards_creditCard_sk.......................... [[31mFAIL 19118[0m in 1.89s]
14:23:21.430006 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:21.437048 [debug] [Thread-1  ]: finished collecting timing info
14:23:21.438165 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.90s]
14:23:21.439550 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:21.441567 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:21.442566 [info ] [MainThread]: 
14:23:21.442999 [info ] [MainThread]: Finished running 2 tests in 2.76s.
14:23:21.443567 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:21.444568 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:21.444568 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:23:21.445649 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:23:21.457563 [info ] [MainThread]: 
14:23:21.458568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:23:21.460564 [info ] [MainThread]: 
14:23:21.461746 [error] [MainThread]: [31mFailure in test unique_dim_CreditCards_creditCard_sk (models\marts\dim_CreditCards.yml)[0m
14:23:21.463564 [error] [MainThread]:   Got 19118 results, configured to fail if != 0
14:23:21.464710 [info ] [MainThread]: 
14:23:21.465561 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_CreditCards.yml\unique_dim_CreditCards_creditCard_sk.sql
14:23:21.466582 [info ] [MainThread]: 
14:23:21.467565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:23:21.469563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF6F6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF5845E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218AF593760>]}


============================== 2022-05-09 14:23:29.911887 | b54c9801-1e0b-41f3-8038-269455516b1b ==============================
14:23:29.911887 [info ] [MainThread]: Running with dbt=1.0.4
14:23:29.912889 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:23:29.913859 [debug] [MainThread]: Tracking: tracking
14:23:29.927858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB5EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB641C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFB64E20>]}
14:23:30.050856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:23:30.051858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:23:30.058892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFDD20D0>]}
14:23:30.072858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFCC4730>]}
14:23:30.072858 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:30.075859 [info ] [MainThread]: 
14:23:30.077859 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:30.078859 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:23:30.079858 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:30.938228 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:30.938228 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:31.745530 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:31.746523 [info ] [MainThread]: 
14:23:31.754485 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.755491 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:23:31.756485 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:31.757488 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.757488 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.781482 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:23:31.785491 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:23:31.802218 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:31.804030 [debug] [Thread-1  ]: finished collecting timing info
14:23:31.804219 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:31.820218 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:32.674302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:23:32.676278 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:23:35.825666 [debug] [Thread-1  ]: finished collecting timing info
14:23:35.826684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54c9801-1e0b-41f3-8038-269455516b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFE69C70>]}
14:23:35.827629 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 4.07s]
14:23:35.829137 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:23:35.832058 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:35.832580 [info ] [MainThread]: 
14:23:35.833252 [info ] [MainThread]: Finished running 1 table model in 5.76s.
14:23:35.834469 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:35.835161 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:23:35.835993 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:35.836473 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
14:23:35.853030 [info ] [MainThread]: 
14:23:35.854090 [info ] [MainThread]: [32mCompleted successfully[0m
14:23:35.856043 [info ] [MainThread]: 
14:23:35.857287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:23:35.859040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFDD2DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DECC8F280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFE46B80>]}


============================== 2022-05-09 14:23:42.556743 | 5cf3fc77-1c25-4ac7-9071-3b01edc924a8 ==============================
14:23:42.556743 [info ] [MainThread]: Running with dbt=1.0.4
14:23:42.556743 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:23:42.557745 [debug] [MainThread]: Tracking: tracking
14:23:42.572743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC65EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC75490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FC75340>]}
14:23:42.688743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:23:42.688743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:23:42.696743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cf3fc77-1c25-4ac7-9071-3b01edc924a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FED20D0>]}
14:23:42.708745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cf3fc77-1c25-4ac7-9071-3b01edc924a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FDC4790>]}
14:23:42.709951 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:23:42.712741 [info ] [MainThread]: 
14:23:42.714002 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:42.715745 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:23:42.715745 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:23:43.536106 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:23:43.536106 [info ] [MainThread]: 
14:23:43.543105 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.543105 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.544108 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
14:23:43.545175 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
14:23:43.547107 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.548109 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.548109 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.549197 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.549443 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.550085 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.562892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.569921 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.572187 [debug] [Thread-1  ]: finished collecting timing info
14:23:43.572187 [debug] [Thread-2  ]: finished collecting timing info
14:23:43.572884 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:43.573141 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:43.597923 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
14:23:43.600885 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
14:23:43.601976 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:23:43.603169 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:23:43.608885 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
14:23:43.608885 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:23:45.549162 [debug] [Thread-1  ]: finished collecting timing info
14:23:45.549162 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 2.00s]
14:23:45.551373 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
14:23:45.727197 [debug] [Thread-2  ]: finished collecting timing info
14:23:45.728199 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.18s]
14:23:45.729237 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
14:23:45.731195 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:23:45.732195 [info ] [MainThread]: 
14:23:45.733199 [info ] [MainThread]: Finished running 2 tests in 3.02s.
14:23:45.734193 [debug] [MainThread]: Connection 'master' was properly closed.
14:23:45.735195 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:23:45.735592 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
14:23:45.736403 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
14:23:45.756232 [info ] [MainThread]: 
14:23:45.757227 [info ] [MainThread]: [32mCompleted successfully[0m
14:23:45.759234 [info ] [MainThread]: 
14:23:45.760193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:23:45.762206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FE9A880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43CD8F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B44FF5F910>]}


============================== 2022-05-09 14:24:39.403875 | 19d5157f-8397-455d-be9d-24cd4975ce2a ==============================
14:24:39.403875 [info ] [MainThread]: Running with dbt=1.0.4
14:24:39.404843 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:24:39.404843 [debug] [MainThread]: Tracking: tracking
14:24:39.419842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5983E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59A4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59A4A90>]}
14:24:39.532871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:24:39.533869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:24:39.541871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5C130D0>]}
14:24:39.554838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5B00820>]}
14:24:39.555736 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:39.557840 [info ] [MainThread]: 
14:24:39.558843 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:39.561222 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:24:39.562421 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:40.713863 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:40.714863 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:41.671987 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:24:41.672986 [info ] [MainThread]: 
14:24:41.680983 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.680983 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:24:41.683533 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.683985 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.684986 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.707019 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:24:41.710019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:24:41.712474 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:24:41.715992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:24:41.736020 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:41.737872 [debug] [Thread-1  ]: finished collecting timing info
14:24:41.737984 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:41.753018 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:24:45.850839 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:24:45.852803 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:24:49.814441 [debug] [Thread-1  ]: finished collecting timing info
14:24:49.815458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19d5157f-8397-455d-be9d-24cd4975ce2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5CB6FD0>]}
14:24:49.816405 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 8.13s]
14:24:49.817404 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:24:49.819405 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:49.820596 [info ] [MainThread]: 
14:24:49.821408 [info ] [MainThread]: Finished running 1 table model in 10.26s.
14:24:49.822405 [debug] [MainThread]: Connection 'master' was properly closed.
14:24:49.822405 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:24:49.823407 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:24:49.823828 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:24:49.836030 [info ] [MainThread]: 
14:24:49.837423 [info ] [MainThread]: [32mCompleted successfully[0m
14:24:49.838426 [info ] [MainThread]: 
14:24:49.840406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:24:49.841647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5BF7D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B59F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7B5AD2D90>]}


============================== 2022-05-09 14:24:59.321109 | a2a91a23-d86b-491f-8e15-1ef198c202ba ==============================
14:24:59.321109 [info ] [MainThread]: Running with dbt=1.0.4
14:24:59.321109 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:24:59.322652 [debug] [MainThread]: Tracking: tracking
14:24:59.336099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC5D4190>]}
14:24:59.459099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:24:59.459099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:24:59.467100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a91a23-d86b-491f-8e15-1ef198c202ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC8420D0>]}
14:24:59.481098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a91a23-d86b-491f-8e15-1ef198c202ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC734760>]}
14:24:59.481098 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:24:59.484105 [info ] [MainThread]: 
14:24:59.486105 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:24:59.487105 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:24:59.488136 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:00.317562 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:25:00.318561 [info ] [MainThread]: 
14:25:00.326565 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.327559 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.327559 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:25:00.328562 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:25:00.329627 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.331560 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.331560 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.332569 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.332569 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.333570 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.343589 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.360884 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.361585 [debug] [Thread-1  ]: finished collecting timing info
14:25:00.363000 [debug] [Thread-2  ]: finished collecting timing info
14:25:00.363000 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:00.364011 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:00.385589 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:25:00.388559 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:25:00.390384 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:25:00.391035 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:25:00.396590 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:25:00.399560 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:25:02.314023 [debug] [Thread-1  ]: finished collecting timing info
14:25:02.314023 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.98s]
14:25:02.316996 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:25:02.495993 [debug] [Thread-2  ]: finished collecting timing info
14:25:02.495993 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.16s]
14:25:02.497998 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:25:02.499995 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:25:02.501996 [info ] [MainThread]: 
14:25:02.503156 [info ] [MainThread]: Finished running 2 tests in 3.02s.
14:25:02.504563 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:02.505472 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:25:02.506450 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:25:02.506994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:25:02.527995 [info ] [MainThread]: 
14:25:02.529009 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:25:02.531001 [info ] [MainThread]: 
14:25:02.531997 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:25:02.533998 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:25:02.534999 [info ] [MainThread]: 
14:25:02.536009 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:25:02.537994 [info ] [MainThread]: 
14:25:02.538998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:25:02.540996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC80A820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFC96FF2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFDC8DCBB0>]}


============================== 2022-05-09 14:26:20.690193 | 7430c674-7a0b-4d37-ab96-ae1a188a56c0 ==============================
14:26:20.690193 [info ] [MainThread]: Running with dbt=1.0.4
14:26:20.690193 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:20.691193 [debug] [MainThread]: Tracking: tracking
14:26:20.706196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADD5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADE5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEADE5940>]}
14:26:20.828196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:20.829196 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:26:20.841195 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:26:20.871193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:26:20.910193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB0A50D0>]}
14:26:20.927194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB031460>]}
14:26:20.928468 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:20.931197 [info ] [MainThread]: 
14:26:20.932195 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:20.934204 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:20.935198 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:22.025181 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:26:22.025181 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:22.800395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:26:22.802396 [info ] [MainThread]: 
14:26:22.810395 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.811396 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:26:22.813399 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:22.813963 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.814398 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.821405 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:26:22.825397 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:26:22.827065 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:26:22.830432 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:26:22.850423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:22.852203 [debug] [Thread-1  ]: finished collecting timing info
14:26:22.852609 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:22.868424 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:26:23.717570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:23.719562 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:26:24.637962 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name countryRegion_id is ambiguous at [63:32]')
14:26:26.558394 [debug] [Thread-1  ]: finished collecting timing info
14:26:26.559029 [debug] [Thread-1  ]: Database Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Column name countryRegion_id is ambiguous at [63:32]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:26:26.559607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7430c674-7a0b-4d37-ab96-ae1a188a56c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB15EB80>]}
14:26:26.559607 [error] [Thread-1  ]: 1 of 1 ERROR creating table model AdventureWorks_marts.dim_SalesTerritories..... [[31mERROR[0m in 3.75s]
14:26:26.561454 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:26.563390 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:26.563390 [info ] [MainThread]: 
14:26:26.564390 [info ] [MainThread]: Finished running 1 table model in 5.63s.
14:26:26.566400 [debug] [MainThread]: Connection 'master' was properly closed.
14:26:26.567031 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:26:26.567585 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:26:26.568077 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:26:26.580394 [info ] [MainThread]: 
14:26:26.581478 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:26:26.583389 [info ] [MainThread]: 
14:26:26.584392 [error] [MainThread]: [33mDatabase Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
14:26:26.586410 [error] [MainThread]:   Column name countryRegion_id is ambiguous at [63:32]
14:26:26.587392 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.sql
14:26:26.589393 [info ] [MainThread]: 
14:26:26.590391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:26:26.591391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB214D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB214D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEB2140D0>]}


============================== 2022-05-09 14:26:53.722086 | a4607667-3ec0-4654-b544-7a4853497ce9 ==============================
14:26:53.722086 [info ] [MainThread]: Running with dbt=1.0.4
14:26:53.723086 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:26:53.724480 [debug] [MainThread]: Tracking: tracking
14:26:53.739092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7444F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7444100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA74443A0>]}
14:26:53.860116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:26:53.861090 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:26:53.875089 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:26:53.906086 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:26:53.945085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA77150D0>]}
14:26:53.958086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA749C220>]}
14:26:53.959086 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:26:53.962088 [info ] [MainThread]: 
14:26:53.963087 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:53.965087 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:26:53.965087 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:54.857628 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:26:54.857628 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:55.665543 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:26:55.718287 [info ] [MainThread]: 
14:26:55.726302 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.727299 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:26:55.729301 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:55.730298 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.731305 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.738323 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:26:55.741323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:26:55.742325 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:26:55.746300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:26:55.769313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:55.770312 [debug] [Thread-1  ]: finished collecting timing info
14:26:55.771402 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:55.788334 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:26:56.620815 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:26:56.622297 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:26:59.538207 [debug] [Thread-1  ]: finished collecting timing info
14:26:59.539175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4607667-3ec0-4654-b544-7a4853497ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA77B5C10>]}
14:26:59.539175 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 3.81s]
14:26:59.541335 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:26:59.543176 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:26:59.544178 [info ] [MainThread]: 
14:26:59.545855 [info ] [MainThread]: Finished running 1 table model in 5.58s.
14:26:59.547179 [debug] [MainThread]: Connection 'master' was properly closed.
14:26:59.548174 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:26:59.548174 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:26:59.549191 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:26:59.562529 [info ] [MainThread]: 
14:26:59.563702 [info ] [MainThread]: [32mCompleted successfully[0m
14:26:59.565178 [info ] [MainThread]: 
14:26:59.567179 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:26:59.568181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7884E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7884DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA78843D0>]}


============================== 2022-05-09 14:27:06.939645 | 48f04524-90bd-4c83-a9e7-0ca52f435169 ==============================
14:27:06.939645 [info ] [MainThread]: Running with dbt=1.0.4
14:27:06.940645 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:27:06.941945 [debug] [MainThread]: Tracking: tracking
14:27:06.956632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD163C5D30>]}
14:27:07.077645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:27:07.078645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:27:07.086649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f04524-90bd-4c83-a9e7-0ca52f435169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166230D0>]}
14:27:07.099645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f04524-90bd-4c83-a9e7-0ca52f435169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD16517790>]}
14:27:07.100786 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:27:07.103616 [info ] [MainThread]: 
14:27:07.104614 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:07.106654 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:27:07.107646 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:27:09.698579 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:27:09.699573 [info ] [MainThread]: 
14:27:09.707554 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.707554 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.708062 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:27:09.709084 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:27:09.710554 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.711963 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.712557 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.713557 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.714748 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.715655 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.726554 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.736595 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.738555 [debug] [Thread-1  ]: finished collecting timing info
14:27:09.738929 [debug] [Thread-2  ]: finished collecting timing info
14:27:09.739757 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:09.739757 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:09.763554 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:27:09.765588 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:27:09.767995 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:27:09.768552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:27:09.773550 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:27:09.774552 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:27:11.696806 [debug] [Thread-1  ]: finished collecting timing info
14:27:11.696806 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.99s]
14:27:11.699416 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:27:12.267360 [debug] [Thread-2  ]: finished collecting timing info
14:27:12.268323 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.56s]
14:27:12.269321 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:27:12.271323 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:27:12.272323 [info ] [MainThread]: 
14:27:12.273326 [info ] [MainThread]: Finished running 2 tests in 5.17s.
14:27:12.275250 [debug] [MainThread]: Connection 'master' was properly closed.
14:27:12.275323 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:27:12.276417 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:27:12.277334 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:27:12.295353 [info ] [MainThread]: 
14:27:12.296591 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:27:12.298351 [info ] [MainThread]: 
14:27:12.300342 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:27:12.302345 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:27:12.303364 [info ] [MainThread]: 
14:27:12.304356 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:27:12.305356 [info ] [MainThread]: 
14:27:12.306355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:27:12.308354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD034DF2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166AD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD166ADD00>]}


============================== 2022-05-09 14:46:46.458134 | 9a41fd36-c96a-47fe-a8ee-de4a3855ef69 ==============================
14:46:46.458134 [info ] [MainThread]: Running with dbt=1.0.4
14:46:46.459135 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:46:46.460151 [debug] [MainThread]: Tracking: tracking
14:46:46.476136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF598E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C53D0>]}
14:46:46.592135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:46:46.593134 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
14:46:46.594135 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
14:46:46.594500 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
14:46:46.595149 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
14:46:46.595660 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
14:46:46.596136 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
14:46:46.596829 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
14:46:46.597134 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
14:46:46.598135 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
14:46:46.598135 [debug] [MainThread]: Partial parsing: update schema file: dbt_IA_AdventureWorks://models\staging\source.yml
14:46:46.599395 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:46:46.611170 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
14:46:46.642134 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
14:46:46.644135 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:46:46.651134 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:46:46.653150 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
14:46:46.657534 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
14:46:46.667135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
14:46:46.668135 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
14:46:46.672239 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
14:46:46.675135 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
14:46:46.684169 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
14:46:46.686259 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
14:46:46.689169 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
14:46:46.692169 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
14:46:46.697164 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
14:46:46.701078 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
14:46:46.709136 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
14:46:46.712137 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
14:46:46.716135 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
14:46:46.861135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF9870A0>]}
14:46:46.874138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C53D0>]}
14:46:46.875135 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:46:46.878138 [info ] [MainThread]: 
14:46:46.879138 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:46.881231 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:46:46.882154 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:48.090658 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:46:48.091659 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:48.994363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:46:48.995349 [info ] [MainThread]: 
14:46:49.003335 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.003335 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:46:49.005338 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.006335 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.007412 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.014364 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:46:49.017365 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:46:49.018794 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:46:49.022372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:46:49.044346 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.046433 [debug] [Thread-1  ]: finished collecting timing info
14:46:49.046433 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:49.069363 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:46:49.919624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:46:49.921625 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:46:53.278656 [debug] [Thread-1  ]: finished collecting timing info
14:46:53.279658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a41fd36-c96a-47fe-a8ee-de4a3855ef69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5C5880>]}
14:46:53.280768 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 4.27s]
14:46:53.283656 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:46:53.285655 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:46:53.286658 [info ] [MainThread]: 
14:46:53.287681 [info ] [MainThread]: Finished running 1 table model in 6.41s.
14:46:53.288704 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:53.290139 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:46:53.290655 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:46:53.290655 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:46:53.308430 [info ] [MainThread]: 
14:46:53.309656 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:53.311296 [info ] [MainThread]: 
14:46:53.312655 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:46:53.313656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF77D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5BF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF616880>]}


============================== 2022-05-09 14:47:00.265806 | 4a426cbc-03e6-469e-ba82-4355ea9b1212 ==============================
14:47:00.265806 [info ] [MainThread]: Running with dbt=1.0.4
14:47:00.266802 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:47:00.267769 [debug] [MainThread]: Tracking: tracking
14:47:00.281770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF72EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF734D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF734BE0>]}
14:47:00.401798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:47:00.401798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:47:00.409798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a426cbc-03e6-469e-ba82-4355ea9b1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF9A10D0>]}
14:47:00.422766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a426cbc-03e6-469e-ba82-4355ea9b1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF7C0730>]}
14:47:00.423766 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:47:00.426768 [info ] [MainThread]: 
14:47:00.427782 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:47:00.429768 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:47:00.430956 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:47:01.269754 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:47:01.271147 [info ] [MainThread]: 
14:47:01.278613 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.278613 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.279611 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:47:01.280062 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:47:01.281829 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.282614 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.282614 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.283682 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.284625 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.285068 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.296611 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.304615 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.306210 [debug] [Thread-1  ]: finished collecting timing info
14:47:01.306210 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:01.306878 [debug] [Thread-2  ]: finished collecting timing info
14:47:01.329911 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:47:01.330880 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:01.333915 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:47:01.333915 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:47:01.335880 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:47:01.339876 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:47:01.339876 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:47:03.288451 [debug] [Thread-1  ]: finished collecting timing info
14:47:03.288451 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.01s]
14:47:03.290494 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:47:03.503301 [debug] [Thread-2  ]: finished collecting timing info
14:47:03.504436 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 2.22s]
14:47:03.505264 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:47:03.507264 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:47:03.508605 [info ] [MainThread]: 
14:47:03.509937 [info ] [MainThread]: Finished running 2 tests in 3.08s.
14:47:03.510466 [debug] [MainThread]: Connection 'master' was properly closed.
14:47:03.511368 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:47:03.512398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:47:03.512398 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:47:03.531278 [info ] [MainThread]: 
14:47:03.533264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:47:03.535265 [info ] [MainThread]: 
14:47:03.536264 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:47:03.537266 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:47:03.538263 [info ] [MainThread]: 
14:47:03.540263 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:47:03.541264 [info ] [MainThread]: 
14:47:03.542515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:47:03.544266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF969DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF7C02B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFA387F0>]}


============================== 2022-05-09 14:50:08.657845 | 9b3ed4b4-797f-4ce6-a405-69fc204ddec6 ==============================
14:50:08.657845 [info ] [MainThread]: Running with dbt=1.0.4
14:50:08.658846 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:50:08.659858 [debug] [MainThread]: Tracking: tracking
14:50:08.674848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A24E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A45670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A45B20>]}
14:50:08.794846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:08.794846 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:50:08.806881 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:50:08.836845 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:50:08.874846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653D100D0>]}
14:50:08.886846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653A453A0>]}
14:50:08.887847 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:08.889850 [info ] [MainThread]: 
14:50:08.891847 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:08.892854 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:50:08.894366 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:09.553391 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:09.554351 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:10.097646 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:10.098504 [info ] [MainThread]: 
14:50:10.106516 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.107170 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:50:10.108517 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.109007 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.109571 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.116547 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:50:10.122554 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:50:10.123517 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:50:10.126550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:50:10.154724 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.155725 [debug] [Thread-1  ]: finished collecting timing info
14:50:10.156724 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:10.171724 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:10.766130 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:10.767092 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:50:15.183823 [debug] [Thread-1  ]: finished collecting timing info
14:50:15.184786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3ed4b4-797f-4ce6-a405-69fc204ddec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653DEDAC0>]}
14:50:15.185314 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (20.0 rows, 2.5 KB processed)[0m in 5.08s]
14:50:15.186794 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:15.188803 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:15.189784 [info ] [MainThread]: 
14:50:15.190844 [info ] [MainThread]: Finished running 1 table model in 6.30s.
14:50:15.191810 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:15.192958 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:50:15.193366 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:15.193787 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:50:15.209171 [info ] [MainThread]: 
14:50:15.210076 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:15.211789 [info ] [MainThread]: 
14:50:15.212803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:50:15.214789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E653E88370>]}


============================== 2022-05-09 14:50:22.515754 | 190e50eb-977c-4eb4-a920-918ea3cb313e ==============================
14:50:22.515754 [info ] [MainThread]: Running with dbt=1.0.4
14:50:22.516754 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:50:22.517815 [debug] [MainThread]: Tracking: tracking
14:50:22.532720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A47E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A75130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674A75A30>]}
14:50:22.697719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:50:22.697719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:50:22.706880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190e50eb-977c-4eb4-a920-918ea3cb313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674CE10D0>]}
14:50:22.723720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '190e50eb-977c-4eb4-a920-918ea3cb313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AE8760>]}
14:50:22.724717 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:22.726720 [info ] [MainThread]: 
14:50:22.728720 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:22.730720 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:22.730720 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:23.337943 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:23.339205 [info ] [MainThread]: 
14:50:23.346216 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.347255 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.347255 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:50:23.348217 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:50:23.350217 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.351314 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.351314 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.352217 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.352958 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.353520 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.365258 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.372251 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.374218 [debug] [Thread-1  ]: finished collecting timing info
14:50:23.375216 [debug] [Thread-2  ]: finished collecting timing info
14:50:23.375216 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:23.375216 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:23.400251 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:23.402252 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:23.404312 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:23.404312 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:50:23.410658 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:50:23.413310 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:50:25.152318 [debug] [Thread-1  ]: finished collecting timing info
14:50:25.153321 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.80s]
14:50:25.155283 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:25.329923 [debug] [Thread-2  ]: finished collecting timing info
14:50:25.330897 [error] [Thread-2  ]: 2 of 2 FAIL 10 unique_dim_SalesTerritories_territory_sk......................... [[31mFAIL 10[0m in 1.98s]
14:50:25.332896 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:25.333896 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:25.335280 [info ] [MainThread]: 
14:50:25.335920 [info ] [MainThread]: Finished running 2 tests in 2.61s.
14:50:25.337892 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:25.337892 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:25.338893 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:50:25.339559 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:50:25.358783 [info ] [MainThread]: 
14:50:25.358890 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:25.360891 [info ] [MainThread]: 
14:50:25.362905 [error] [MainThread]: [31mFailure in test unique_dim_SalesTerritories_territory_sk (models\marts\dim_SalesTerritories.yml)[0m
14:50:25.364893 [error] [MainThread]:   Got 10 results, configured to fail if != 0
14:50:25.365891 [info ] [MainThread]: 
14:50:25.366893 [info ] [MainThread]:   compiled SQL at target\compiled\dbt_IA_AdventureWorks\models\marts\dim_SalesTerritories.yml\unique_dim_SalesTerritories_territory_sk.sql
14:50:25.368891 [info ] [MainThread]: 
14:50:25.369893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
14:50:25.371893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AF1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674AE8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B674D78340>]}


============================== 2022-05-09 14:50:42.113016 | 7d375c24-d00b-4391-a201-b235ff6f13bb ==============================
14:50:42.113016 [info ] [MainThread]: Running with dbt=1.0.4
14:50:42.113731 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:50:42.115037 [debug] [MainThread]: Tracking: tracking
14:50:42.129735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C8FFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C905F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C905220>]}
14:50:42.247761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:42.248761 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_SalesTerritories.sql
14:50:42.259760 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
14:50:42.292760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
14:50:42.331760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CBCD0D0>]}
14:50:42.343732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117C976DC0>]}
14:50:42.344731 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:42.347761 [info ] [MainThread]: 
14:50:42.348733 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:42.349732 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:50:42.350735 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:43.013758 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:43.013758 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:43.748618 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:43.749605 [info ] [MainThread]: 
14:50:43.757601 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.757601 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:50:43.759879 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:43.760610 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.761260 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.768636 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:50:43.773604 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:50:43.775610 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:50:43.778601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:50:43.807638 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:43.808604 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.810121 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:43.825637 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:44.369853 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:50:44.371296 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:50:48.006906 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.007869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d375c24-d00b-4391-a201-b235ff6f13bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CC7DA90>]}
14:50:48.008471 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 4.25s]
14:50:48.009869 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:50:48.011868 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:48.012868 [info ] [MainThread]: 
14:50:48.013888 [info ] [MainThread]: Finished running 1 table model in 5.66s.
14:50:48.014871 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:48.016249 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:50:48.016868 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:48.017161 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:50:48.032869 [info ] [MainThread]: 
14:50:48.034141 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:48.035150 [info ] [MainThread]: 
14:50:48.036152 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:50:48.038152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021169A2E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CD46D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117CD46340>]}


============================== 2022-05-09 14:50:53.894456 | de1f6220-eb0c-45c6-9c74-001ebd126d33 ==============================
14:50:53.894456 [info ] [MainThread]: Running with dbt=1.0.4
14:50:53.894456 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:50:53.895460 [debug] [MainThread]: Tracking: tracking
14:50:53.911457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688BE2E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C05C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C05F70>]}
14:50:54.027455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:50:54.028947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:50:54.036466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1f6220-eb0c-45c6-9c74-001ebd126d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688E710D0>]}
14:50:54.049456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1f6220-eb0c-45c6-9c74-001ebd126d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688D67760>]}
14:50:54.050652 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:50:54.053458 [info ] [MainThread]: 
14:50:54.055457 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:54.056457 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:50:54.057457 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:54.728563 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:50:54.729562 [info ] [MainThread]: 
14:50:54.737561 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.737561 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.738581 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
14:50:54.738581 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
14:50:54.740586 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.742565 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.742565 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.743565 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.744670 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.745082 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.755563 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.762595 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.764649 [debug] [Thread-1  ]: finished collecting timing info
14:50:54.764649 [debug] [Thread-2  ]: finished collecting timing info
14:50:54.765561 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:54.766288 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:54.790595 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
14:50:54.793563 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
14:50:54.795151 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:50:54.795560 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:50:54.801562 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
14:50:54.801562 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
14:50:56.454208 [debug] [Thread-1  ]: finished collecting timing info
14:50:56.455206 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.71s]
14:50:56.456209 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
14:50:56.612760 [debug] [Thread-2  ]: finished collecting timing info
14:50:56.612760 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 1.87s]
14:50:56.614855 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
14:50:56.616904 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:50:56.617904 [info ] [MainThread]: 
14:50:56.618866 [info ] [MainThread]: Finished running 2 tests in 2.56s.
14:50:56.619876 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:56.619876 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:50:56.620898 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
14:50:56.621621 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
14:50:56.641945 [info ] [MainThread]: 
14:50:56.643668 [info ] [MainThread]: [32mCompleted successfully[0m
14:50:56.645866 [info ] [MainThread]: 
14:50:56.646868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:50:56.648874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688C87820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F5D2F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022688EFDC40>]}


============================== 2022-05-09 14:52:02.356965 | 05dd308c-b91a-4cab-860f-0a65e6cd4b93 ==============================
14:52:02.356965 [info ] [MainThread]: Running with dbt=1.0.4
14:52:02.357966 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:52:02.358969 [debug] [MainThread]: Tracking: tracking
14:52:02.372983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9077EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90784550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90784B50>]}
14:52:02.491002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:52:02.491002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:52:02.498966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D909F20D0>]}
14:52:02.511967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D908116D0>]}
14:52:02.513089 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
14:52:02.515970 [info ] [MainThread]: 
14:52:02.517970 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:02.519966 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
14:52:02.519966 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:14.478694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
14:52:14.478694 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:15.075953 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
14:52:15.076957 [info ] [MainThread]: 
14:52:15.084967 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.085951 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.086956 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:52:15.087963 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:52:15.088953 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.089440 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.090020 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.090020 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.092953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
14:52:15.096986 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
14:52:15.098021 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.098734 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
14:52:15.098952 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.099132 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.099953 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
14:52:15.100956 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:15.100956 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.102522 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.102955 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:15.103953 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.104110 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.106954 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
14:52:15.106954 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.110954 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
14:52:15.111704 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.112438 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
14:52:15.113009 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.113092 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.113954 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
14:52:15.114670 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:15.115333 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.115952 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.116954 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:15.116954 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.117960 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.121987 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
14:52:15.121987 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.125988 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
14:52:15.126660 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.127112 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
14:52:15.128092 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.128092 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.128988 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:15.128988 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
14:52:15.130368 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.130955 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.130955 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.132037 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:15.136992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
14:52:15.137987 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.139330 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.139963 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.142055 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
14:52:15.142986 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
14:52:15.144165 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.145611 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:52:15.145611 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.146196 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.147205 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
14:52:15.147205 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.148206 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.152233 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
14:52:15.153207 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
14:52:15.154206 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.155333 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.156205 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
14:52:15.156205 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.157205 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.157692 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.158420 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
14:52:15.195242 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.197215 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.197215 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.198510 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
14:52:15.198674 [debug] [Thread-2  ]: finished collecting timing info
14:52:15.239240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.239240 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:15.254240 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:15.255661 [debug] [Thread-1  ]: finished collecting timing info
14:52:15.256491 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
14:52:15.258205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:15.818235 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
14:52:15.820630 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
14:52:15.822247 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
14:52:15.822708 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
14:52:18.870296 [debug] [Thread-1  ]: finished collecting timing info
14:52:18.870296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A57550>]}
14:52:18.871666 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 3.67s]
14:52:18.873291 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
14:52:18.874297 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.875301 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
14:52:18.876297 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:18.877297 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.877297 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.894295 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:18.896176 [debug] [Thread-1  ]: finished collecting timing info
14:52:18.897019 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:18.900201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:19.475483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
14:52:19.476440 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
14:52:19.980471 [debug] [Thread-2  ]: finished collecting timing info
14:52:19.980471 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A604F0>]}
14:52:19.981467 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 4.83s]
14:52:19.983148 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
14:52:19.984164 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:19.984164 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
14:52:19.986160 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:19.986160 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:19.987161 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:20.023195 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:20.024158 [debug] [Thread-2  ]: finished collecting timing info
14:52:20.024727 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:20.026196 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:52:20.896845 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
14:52:20.898429 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
14:52:22.808685 [debug] [Thread-1  ]: finished collecting timing info
14:52:22.809681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91B58FD0>]}
14:52:22.810645 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 3.93s]
14:52:22.812645 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
14:52:24.234135 [debug] [Thread-2  ]: finished collecting timing info
14:52:24.234912 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A608E0>]}
14:52:24.235559 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 4.25s]
14:52:24.237135 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
14:52:24.238132 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.238132 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
14:52:24.240134 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.240134 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.241136 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.287171 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.288172 [debug] [Thread-1  ]: finished collecting timing info
14:52:24.288172 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:24.293740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:24.834417 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
14:52:24.883934 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesOrder_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
14:52:25.746119 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: salesOrder_id at [116:14]')
14:52:26.630754 [debug] [Thread-1  ]: finished collecting timing info
14:52:26.631751 [debug] [Thread-1  ]: Database Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)
  Unrecognized name: salesOrder_id at [116:14]
  compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:52:26.632788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dd308c-b91a-4cab-860f-0a65e6cd4b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91BC55E0>]}
14:52:26.633749 [error] [Thread-1  ]: 5 of 5 ERROR creating table model AdventureWorks_marts.fact_SalesOrdersDetails.. [[31mERROR[0m in 2.39s]
14:52:26.635750 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
14:52:26.637761 [debug] [MainThread]: Acquiring new bigquery connection "master"
14:52:26.638804 [info ] [MainThread]: 
14:52:26.639771 [info ] [MainThread]: Finished running 5 table models in 24.12s.
14:52:26.640771 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:26.641658 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
14:52:26.642106 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
14:52:26.642762 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
14:52:26.643217 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
14:52:26.667420 [info ] [MainThread]: 
14:52:26.667811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:52:26.669800 [info ] [MainThread]: 
14:52:26.671578 [error] [MainThread]: [33mDatabase Error in model fact_SalesOrdersDetails (models\marts\fact_SalesOrdersDetails.sql)[0m
14:52:26.672750 [error] [MainThread]:   Unrecognized name: salesOrder_id at [116:14]
14:52:26.673750 [error] [MainThread]:   compiled SQL at target\run\dbt_IA_AdventureWorks\models\marts\fact_SalesOrdersDetails.sql
14:52:26.675298 [info ] [MainThread]: 
14:52:26.675776 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
14:52:26.677288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D908111C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D909D5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90ACD460>]}


============================== 2022-05-11 02:16:37.973675 | eab84cd1-63de-4b10-9370-c13df492d0b5 ==============================
02:16:37.973675 [info ] [MainThread]: Running with dbt=1.0.4
02:16:37.974648 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:16:37.975644 [debug] [MainThread]: Tracking: tracking
02:16:38.006649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA64820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA64100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDA645E0>]}
02:16:39.172149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:16:39.173147 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\fact_SalesOrdersDetails.sql
02:16:39.192168 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:16:39.240147 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:16:39.260147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDCB90D0>]}
02:16:39.283161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDAE1E50>]}
02:16:39.284148 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:16:39.292157 [info ] [MainThread]: 
02:16:39.293150 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:39.295147 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522"
02:16:39.296149 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:40.793471 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:16:40.794432 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:41.463215 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:16:41.464249 [info ] [MainThread]: 
02:16:41.684441 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.685440 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.685440 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:16:41.686439 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:16:41.687439 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.687439 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.688440 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.688440 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.692476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:16:41.695476 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:16:41.698010 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.699011 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:16:41.699011 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.700048 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.700048 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:16:41.702016 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:16:41.702016 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.703010 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.704013 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:16:41.704013 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.705017 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.708009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:16:41.709010 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.712047 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:16:41.713009 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.713009 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.714010 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:16:41.715013 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:16:41.716012 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.716012 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.718013 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:16:41.718013 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:16:41.719049 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.719666 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.719666 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.720677 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.723232 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:16:41.727246 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:16:41.729250 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.730233 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:16:41.730233 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.731237 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.731237 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:16:41.732262 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:16:41.733236 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.734234 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.735232 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:16:41.735232 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.736234 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.739231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:16:41.740231 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.743232 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:16:41.744232 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.745245 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:16:41.745245 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.746238 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.747237 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:16:41.748233 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:16:41.748233 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.749270 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.750235 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:16:41.751236 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.755231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:16:41.755231 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:41.756234 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.757232 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.776268 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:41.776268 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.778236 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:16:41.778236 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.778236 [debug] [Thread-2  ]: finished collecting timing info
02:16:41.779235 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:16:41.780238 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:41.781234 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:16:41.798235 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:16:41.798235 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.799234 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:16:41.837265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:16:41.857235 [debug] [Thread-1  ]: finished collecting timing info
02:16:41.858232 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:16:41.860234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:42.521335 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:16:42.523386 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:16:42.524323 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:16:42.549715 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:16:45.408120 [debug] [Thread-1  ]: finished collecting timing info
02:16:45.411122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDD90910>]}
02:16:45.412152 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 154.6 KB processed)[0m in 3.63s]
02:16:45.415121 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:16:45.415121 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.416121 [info ] [Thread-1  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
02:16:45.418121 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:45.418121 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.419121 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.435120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:45.451490 [debug] [Thread-1  ]: finished collecting timing info
02:16:45.451490 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:45.454490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:45.684095 [debug] [Thread-2  ]: finished collecting timing info
02:16:45.685128 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDE41910>]}
02:16:45.686101 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 1.3 MB processed)[0m in 3.93s]
02:16:45.688094 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:16:45.688094 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.689089 [info ] [Thread-2  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
02:16:45.690089 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:45.691091 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.693090 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.730125 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:45.765197 [debug] [Thread-2  ]: finished collecting timing info
02:16:45.765197 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:45.769195 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:16:46.093984 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:16:46.095986 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
02:16:46.436829 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:16:46.438075 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
02:16:48.780006 [debug] [Thread-1  ]: finished collecting timing info
02:16:48.781003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEE726A0>]}
02:16:48.781003 [info ] [Thread-1  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 340.0 Bytes processed)[0m in 3.36s]
02:16:48.782967 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:16:49.439877 [debug] [Thread-2  ]: finished collecting timing info
02:16:49.439877 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDE3B1C0>]}
02:16:49.440827 [info ] [Thread-2  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 2.5 KB processed)[0m in 3.75s]
02:16:49.442828 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:16:49.443831 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.443831 [info ] [Thread-1  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
02:16:49.445829 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:49.445829 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.446828 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.485850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:49.486850 [debug] [Thread-1  ]: finished collecting timing info
02:16:49.487846 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:16:49.489852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:16:50.101507 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:16:50.102505 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `valid-sol-346522`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `valid-sol-346522`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
02:17:01.183481 [debug] [Thread-1  ]: finished collecting timing info
02:17:01.184482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab84cd1-63de-4b10-9370-c13df492d0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2FD0>]}
02:17:01.184482 [info ] [Thread-1  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (785.5k rows, 29.4 MB processed)[0m in 11.74s]
02:17:01.186487 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:17:01.188495 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:01.189479 [info ] [MainThread]: 
02:17:01.190479 [info ] [MainThread]: Finished running 5 table models in 21.90s.
02:17:01.192480 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:01.192480 [debug] [MainThread]: Connection 'list_valid-sol-346522' was properly closed.
02:17:01.193481 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:17:01.194480 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
02:17:01.194480 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:17:01.219517 [info ] [MainThread]: 
02:17:01.220481 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:01.222481 [info ] [MainThread]: 
02:17:01.223484 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
02:17:01.224481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EDCB9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEEB2E50>]}


============================== 2022-05-11 02:17:25.025140 | e284098a-f769-4d8c-bec3-a5753f3a01f6 ==============================
02:17:25.025140 [info ] [MainThread]: Running with dbt=1.0.4
02:17:25.026139 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:17:25.027143 [debug] [MainThread]: Tracking: tracking
02:17:25.039153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EEDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EF3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57EF3220>]}
02:17:25.168175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:17:25.168175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:17:25.179143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e284098a-f769-4d8c-bec3-a5753f3a01f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE581610D0>]}
02:17:25.194161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e284098a-f769-4d8c-bec3-a5753f3a01f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE57F8B730>]}
02:17:25.195144 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:25.198141 [info ] [MainThread]: 
02:17:25.199141 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:25.200140 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:17:25.201141 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:25.912838 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:17:25.913829 [info ] [MainThread]: 
02:17:25.921688 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.921688 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.921688 [info ] [Thread-1  ]: 1 of 8 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:17:25.922725 [info ] [Thread-2  ]: 2 of 8 START test not_null_dim_Products_product_sk.............................. [RUN]
02:17:25.923692 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.925691 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.925691 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.926693 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.926693 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.927694 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.939726 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.943728 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.945725 [debug] [Thread-2  ]: finished collecting timing info
02:17:25.945725 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:25.969690 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:17:25.970695 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:17:25.974689 [debug] [Thread-1  ]: finished collecting timing info
02:17:25.975694 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:25.978723 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:17:25.978723 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
02:17:25.980717 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:25.985722 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:17:27.761647 [debug] [Thread-1  ]: finished collecting timing info
02:17:27.762647 [info ] [Thread-1  ]: 1 of 8 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.84s]
02:17:27.764652 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:17:27.764652 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.765652 [info ] [Thread-1  ]: 3 of 8 START test not_null_dim_Reasons_reason_sk................................ [RUN]
02:17:27.766647 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.766647 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.767647 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.774647 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.775646 [debug] [Thread-1  ]: finished collecting timing info
02:17:27.776646 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:27.779646 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:27.780646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:27.787646 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
02:17:27.822985 [debug] [Thread-2  ]: finished collecting timing info
02:17:27.823986 [info ] [Thread-2  ]: 2 of 8 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.90s]
02:17:27.824963 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:17:27.825963 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.826961 [info ] [Thread-2  ]: 4 of 8 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
02:17:27.827961 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.827961 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.828961 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.833961 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.834975 [debug] [Thread-2  ]: finished collecting timing info
02:17:27.835961 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:27.837994 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:17:27.838961 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:27.843964 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
02:17:29.565304 [debug] [Thread-1  ]: finished collecting timing info
02:17:29.566298 [info ] [Thread-1  ]: 3 of 8 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.80s]
02:17:29.568300 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:29.568300 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.569313 [info ] [Thread-1  ]: 5 of 8 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:17:29.570298 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.571301 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.571301 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.580298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.581298 [debug] [Thread-1  ]: finished collecting timing info
02:17:29.582297 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:29.585311 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:17:29.586299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:29.591308 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:29.642332 [debug] [Thread-2  ]: finished collecting timing info
02:17:29.643333 [info ] [Thread-2  ]: 4 of 8 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 1.82s]
02:17:29.644299 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:17:29.645299 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.645299 [info ] [Thread-2  ]: 6 of 8 START test unique_dim_Products_product_sk................................ [RUN]
02:17:29.647303 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.647303 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.648307 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.652336 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.653301 [debug] [Thread-2  ]: finished collecting timing info
02:17:29.653301 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:29.657300 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:17:29.659321 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:29.664299 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:31.496266 [debug] [Thread-1  ]: finished collecting timing info
02:17:31.497265 [info ] [Thread-1  ]: 5 of 8 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 1.93s]
02:17:31.498267 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:17:31.499271 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.499271 [info ] [Thread-1  ]: 7 of 8 START test unique_dim_Reasons_reason_sk.................................. [RUN]
02:17:31.500268 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.501267 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.501267 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.508269 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.539276 [debug] [Thread-1  ]: finished collecting timing info
02:17:31.540274 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:31.545270 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:31.547268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:17:31.554266 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:31.631269 [debug] [Thread-2  ]: finished collecting timing info
02:17:31.632269 [info ] [Thread-2  ]: 6 of 8 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 1.99s]
02:17:31.633269 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:17:31.634267 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.635267 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
02:17:31.636267 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.637269 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.637269 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.644267 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.645267 [debug] [Thread-2  ]: finished collecting timing info
02:17:31.646268 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:31.649267 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:17:31.650267 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:17:31.655265 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `valid-sol-346522`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:33.332509 [debug] [Thread-1  ]: finished collecting timing info
02:17:33.333506 [info ] [Thread-1  ]: 7 of 8 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 1.83s]
02:17:33.335507 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:33.545987 [debug] [Thread-2  ]: finished collecting timing info
02:17:33.546989 [info ] [Thread-2  ]: 8 of 8 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 1.91s]
02:17:33.547990 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:17:33.548990 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:33.549989 [info ] [MainThread]: 
02:17:33.549989 [info ] [MainThread]: Finished running 8 tests in 8.35s.
02:17:33.550991 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
02:17:33.551994 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:17:33.567989 [info ] [MainThread]: 
02:17:33.568987 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:33.569990 [info ] [MainThread]: 
02:17:33.570990 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
02:17:33.571991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE581C56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE592C7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE592C7FD0>]}


============================== 2022-05-11 02:18:21.286726 | d9034a29-b811-4f59-8c06-610aab53dcf9 ==============================
02:18:21.286726 [info ] [MainThread]: Running with dbt=1.0.4
02:18:21.287727 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:18:21.288727 [debug] [MainThread]: Tracking: tracking
02:18:21.304729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7D3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7F1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25E7F1F70>]}
02:18:21.599563 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:18:21.600555 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:18:21.602556 [info ] [MainThread]: 
02:18:21.603571 [info ] [MainThread]: 
02:18:21.604555 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-11 02:18:41.919832 | 789f4fe5-f659-45d9-a96b-960862181a7b ==============================
02:18:41.919832 [info ] [MainThread]: Running with dbt=1.0.4
02:18:41.920833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
02:18:41.921833 [debug] [MainThread]: Tracking: tracking
02:18:41.935837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C33E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51AC0>]}
02:18:42.060868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:18:42.060868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:18:42.069833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '789f4fe5-f659-45d9-a96b-960862181a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08EC20D0>]}
02:18:42.084849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '789f4fe5-f659-45d9-a96b-960862181a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08CDF850>]}
02:18:42.085833 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:18:42.089833 [info ] [MainThread]: 
02:18:42.090863 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:42.092834 [debug] [ThreadPool]: Acquiring new bigquery connection "list_valid-sol-346522_AdventureWorks_marts"
02:18:42.093833 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:42.780179 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
02:18:42.781180 [info ] [MainThread]: 
02:18:42.787183 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.787183 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.788181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:42.789183 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:18:42.790182 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.791184 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.791184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.792186 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.797182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:42.800181 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:18:42.802181 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.802181 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.803182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:42.804182 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:18:42.805182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.806185 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.808188 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:18:42.809183 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:18:42.810183 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.810183 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.811183 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.812181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.817184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
02:18:42.823196 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:18:42.825198 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.826183 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.827185 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
02:18:42.828183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:18:42.829181 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.830182 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.831181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:18:42.832182 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:18:42.832182 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.833182 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.834181 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.834181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.841184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
02:18:42.847183 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
02:18:42.848182 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.849184 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.850182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
02:18:42.851183 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
02:18:42.852182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.852182 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.853182 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:18:42.854181 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:18:42.855190 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.856183 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.857184 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.858188 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.865182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
02:18:42.871181 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:18:42.873187 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.873187 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.874181 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
02:18:42.875184 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:18:42.876181 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.877183 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.878181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:42.879184 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:18:42.879184 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.880182 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.880182 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.881182 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.887183 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:42.943180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:18:42.944180 [debug] [Thread-1  ]: finished collecting timing info
02:18:42.945182 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.946182 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:42.946182 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.947190 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:18:42.947190 [debug] [Thread-2  ]: finished collecting timing info
02:18:42.948181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:18:42.949182 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:18:42.950181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:18:42.950181 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:42.951180 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:18:42.951180 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:18:42.995179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:18:42.995179 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:42.996179 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.010178 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.012178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:18:43.012178 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:18:43.013180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.013180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.014183 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:18:43.014183 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.015182 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.015182 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.016181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:43.017181 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:18:43.017181 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.017181 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.018182 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.018182 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:18:43.047179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:43.047179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.048179 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.057181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.059181 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:18:43.059181 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.060180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.060180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.061179 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:43.061179 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.061179 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.062184 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.063183 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:18:43.063183 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:18:43.064182 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.064182 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.065180 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.065180 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:18:43.072179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:18:43.072179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.073179 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.077180 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:18:43.077180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.078180 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.078180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.078180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.079180 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:18:43.079180 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.080188 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.080188 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.081180 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:18:43.081180 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:18:43.082179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.082179 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.082179 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.083179 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:18:43.087179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:18:43.088180 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.088180 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.093179 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:18:43.094181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.094181 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.095181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.095181 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.095181 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:18:43.096181 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.096181 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.097180 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.097180 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:18:43.098179 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:18:43.098179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.098179 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.099179 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.099179 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:18:43.103179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:18:43.104179 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.105181 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.105181 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.138178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
02:18:43.138178 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.139179 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.140179 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:18:43.140179 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.141192 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.141192 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.142188 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:18:43.142188 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.143179 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.143179 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
02:18:43.144194 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.144194 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.149178 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:18:43.149178 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:18:43.150179 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.151180 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.151180 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.152198 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.156179 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:18:43.156179 [debug] [Thread-1  ]: finished collecting timing info
02:18:43.157179 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:18:43.158179 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.158179 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.159194 [debug] [Thread-2  ]: finished collecting timing info
02:18:43.159194 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:18:43.160193 [debug] [MainThread]: Connection 'master' was properly closed.
02:18:43.161179 [debug] [MainThread]: Connection 'list_valid-sol-346522_AdventureWorks_marts' was properly closed.
02:18:43.161179 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:18:43.162181 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:18:43.177185 [info ] [MainThread]: Done.
02:18:43.181183 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
02:18:43.182181 [info ] [MainThread]: Building catalog
02:18:43.185182 [debug] [MainThread]: Opening a new connection, currently in state init
02:18:43.836893 [debug] [ThreadPool]: Acquiring new bigquery connection "valid-sol-346522.information_schema"
02:18:43.837886 [debug] [ThreadPool]: Acquiring new bigquery connection "valid-sol-346522.information_schema"
02:18:43.853879 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:43.856852 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:43.862891 [debug] [ThreadPool]: On valid-sol-346522.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "connection_name": "valid-sol-346522.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `valid-sol-346522`.`AdventureWorks_marts`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks_marts'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `valid-sol-346522`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `valid-sol-346522`.`AdventureWorks_marts`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:18:43.863852 [debug] [ThreadPool]: On valid-sol-346522.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "dev", "connection_name": "valid-sol-346522.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `valid-sol-346522`.`AdventureWorks`.__TABLES__
        where (upper(dataset_id) = upper('adventureworks'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `valid-sol-346522`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `valid-sol-346522`.`AdventureWorks`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:18:48.094412 [info ] [MainThread]: Catalog written to C:\Users\jpedr\Dev\dbt_IA_AdventureWorks\dbt_IA_AdventureWorks\target\catalog.json
02:18:48.095413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08C51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08FBBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08FBBEE0>]}
02:18:49.257210 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:18:49.257210 [debug] [MainThread]: Connection 'valid-sol-346522.information_schema' was properly closed.
02:18:49.258230 [debug] [MainThread]: Connection 'valid-sol-346522.information_schema' was properly closed.


============================== 2022-05-11 02:18:56.243388 | 59f0a4a5-416b-4083-b455-e63b36a56242 ==============================
02:18:56.243388 [info ] [MainThread]: Running with dbt=1.0.4
02:18:56.244364 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
02:18:56.245359 [debug] [MainThread]: Tracking: tracking
02:18:56.260353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71B1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCD71BC70>]}
02:18:56.263354 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:18:56.265352 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:18:56.266352 [info ] [MainThread]: 
02:18:56.267354 [info ] [MainThread]: 
02:18:56.268354 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-13 00:14:49.709272 | e4c67b0b-b156-424e-a647-8c5a2a160fdd ==============================
00:14:49.709272 [info ] [MainThread]: Running with dbt=1.0.4
00:14:49.710272 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
00:14:49.710272 [debug] [MainThread]: Tracking: tracking
00:14:49.740272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B46D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B471D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B471280>]}
00:14:53.548854 [debug] [MainThread]: Executing "git --help"
00:14:53.602852 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
00:14:53.602852 [debug] [MainThread]: STDERR: "b''"
00:14:53.609852 [debug] [MainThread]: Acquiring new bigquery connection "debug"
00:14:53.609852 [debug] [MainThread]: Opening a new connection, currently in state init
00:14:53.621947 [debug] [MainThread]: On debug: select 1 as id
00:14:55.575406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3992AF280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AC195640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3AC195130>]}
00:14:56.467499 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-13 00:32:31.848847 | a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e ==============================
00:32:31.848847 [info ] [MainThread]: Running with dbt=1.0.4
00:32:31.849847 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:32:31.850848 [debug] [MainThread]: Tracking: tracking
00:32:31.879849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C0410DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04112BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04112D90>]}
00:32:31.947846 [info ] [MainThread]: Unable to do partial parsing because profile has changed
00:32:31.948847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04167FD0>]}
00:32:33.095413 [debug] [MainThread]: Parsing macros\adapters.sql
00:32:33.142414 [debug] [MainThread]: Parsing macros\catalog.sql
00:32:33.155412 [debug] [MainThread]: Parsing macros\etc.sql
00:32:33.159413 [debug] [MainThread]: Parsing macros\materializations\copy.sql
00:32:33.165414 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
00:32:33.196415 [debug] [MainThread]: Parsing macros\materializations\seed.sql
00:32:33.200414 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
00:32:33.203413 [debug] [MainThread]: Parsing macros\materializations\table.sql
00:32:33.211412 [debug] [MainThread]: Parsing macros\materializations\view.sql
00:32:33.218415 [debug] [MainThread]: Parsing macros\adapters\columns.sql
00:32:33.242414 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
00:32:33.250412 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
00:32:33.257417 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
00:32:33.275416 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
00:32:33.284413 [debug] [MainThread]: Parsing macros\adapters\relation.sql
00:32:33.299413 [debug] [MainThread]: Parsing macros\adapters\schema.sql
00:32:33.302412 [debug] [MainThread]: Parsing macros\etc\datetime.sql
00:32:33.316412 [debug] [MainThread]: Parsing macros\etc\statement.sql
00:32:33.325413 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
00:32:33.328413 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
00:32:33.330414 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
00:32:33.331412 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
00:32:33.332412 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
00:32:33.334410 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
00:32:33.337412 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
00:32:33.341413 [debug] [MainThread]: Parsing macros\materializations\configs.sql
00:32:33.345413 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
00:32:33.349414 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
00:32:33.357411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
00:32:33.369410 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
00:32:33.371411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
00:32:33.386411 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
00:32:33.404411 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
00:32:33.409415 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
00:32:33.421417 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
00:32:33.426423 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
00:32:33.431414 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
00:32:33.433412 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
00:32:33.442415 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
00:32:33.460411 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
00:32:33.467411 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
00:32:33.479411 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
00:32:33.492411 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
00:32:33.494410 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
00:32:33.511410 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
00:32:33.513412 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
00:32:33.518411 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
00:32:33.520412 [debug] [MainThread]: Parsing tests\generic\builtin.sql
00:32:33.525412 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
00:32:33.527412 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
00:32:33.529412 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
00:32:33.531412 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
00:32:33.533412 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
00:32:33.536412 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
00:32:33.544420 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
00:32:33.548411 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
00:32:33.559410 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
00:32:33.561411 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
00:32:33.564411 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
00:32:33.565411 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
00:32:33.567412 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
00:32:33.569412 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
00:32:33.571412 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
00:32:33.575411 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
00:32:33.577412 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
00:32:33.587412 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
00:32:33.589411 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
00:32:33.590411 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
00:32:33.593413 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
00:32:33.595412 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
00:32:33.598411 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
00:32:33.600412 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
00:32:33.606411 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
00:32:33.608412 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
00:32:33.610412 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
00:32:33.613412 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
00:32:33.615411 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
00:32:33.617411 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
00:32:33.632412 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
00:32:33.635413 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
00:32:33.637413 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
00:32:33.639413 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
00:32:33.650412 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
00:32:33.653414 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
00:32:33.655412 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
00:32:33.658412 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
00:32:33.661412 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
00:32:33.664412 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
00:32:33.667411 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
00:32:33.669412 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
00:32:33.671412 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
00:32:33.675412 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
00:32:33.677412 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
00:32:33.678412 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
00:32:33.680412 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
00:32:33.682412 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
00:32:33.708411 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
00:32:33.713412 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
00:32:33.716410 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
00:32:33.721411 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
00:32:33.728411 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
00:32:33.732427 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
00:32:33.734412 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
00:32:33.738411 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
00:32:33.743412 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
00:32:33.749412 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
00:32:33.752414 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
00:32:33.754411 [debug] [MainThread]: Parsing macros\sql\groupby.sql
00:32:33.756412 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
00:32:33.763413 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
00:32:33.765411 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
00:32:33.767412 [debug] [MainThread]: Parsing macros\sql\pivot.sql
00:32:33.772412 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
00:32:33.774412 [debug] [MainThread]: Parsing macros\sql\star.sql
00:32:33.779411 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
00:32:33.784412 [debug] [MainThread]: Parsing macros\sql\union.sql
00:32:33.795411 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
00:32:33.804411 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
00:32:33.807412 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
00:32:33.809411 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
00:32:34.252530 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
00:32:34.291528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
00:32:34.293526 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
00:32:34.300526 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
00:32:34.302529 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
00:32:34.309528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
00:32:34.311527 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
00:32:34.320528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
00:32:34.322527 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
00:32:34.330527 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
00:32:34.334526 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
00:32:34.337525 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
00:32:34.340555 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
00:32:34.344556 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
00:32:34.347548 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
00:32:34.350557 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
00:32:34.353527 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
00:32:34.356526 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
00:32:34.359527 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
00:32:34.527528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C044090D0>]}
00:32:34.542527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C0438F550>]}
00:32:34.543527 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:32:34.546527 [info ] [MainThread]: 
00:32:34.589526 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:32:34.591527 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
00:32:34.592529 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:35.858706 [debug] [ThreadPool]: Acquiring new bigquery connection "create_snappy-meridian-350123_AdventureWorks_marts"
00:32:35.858706 [debug] [ThreadPool]: Acquiring new bigquery connection "create_snappy-meridian-350123_AdventureWorks_marts"
00:32:35.859702 [debug] [ThreadPool]: BigQuery adapter: Creating schema "snappy-meridian-350123.AdventureWorks_marts".
00:32:35.859702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:32:36.650304 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
00:32:36.651305 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:37.257314 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
00:32:37.259308 [info ] [MainThread]: 
00:32:37.292307 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.292307 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.293307 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:32:37.294306 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:32:37.295309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.296307 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.297308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.297308 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.307305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:32:37.311310 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:32:37.313306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.314306 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:32:37.314306 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.315326 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.316310 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:32:37.317306 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:32:37.318310 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.318310 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.319305 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:32:37.320305 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.320305 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.326305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:32:37.326305 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.332307 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:32:37.333304 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.334308 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:32:37.335305 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.335305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.336305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:32:37.337307 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:32:37.338308 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.339318 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.339318 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.341307 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:32:37.346307 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:32:37.347309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.348308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.348308 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.352306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:32:37.353309 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:32:37.355306 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.356321 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:32:37.356321 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.357311 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.358309 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:32:37.358309 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.359311 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.363308 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:32:37.365309 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:32:37.365309 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.366308 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.367309 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.371306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:32:37.373307 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:32:37.374306 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.375305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:32:37.375305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.376309 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.377310 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:32:37.377310 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.378310 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.383305 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:32:37.384305 [info ] [Thread-1  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
00:32:37.385306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.386306 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.387309 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:32:37.388312 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.388312 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.389309 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.390307 [info ] [Thread-2  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:32:37.416306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.417305 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.418305 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.418305 [debug] [Thread-1  ]: finished collecting timing info
00:32:37.419307 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:32:37.419307 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:37.463306 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.506308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:32:37.508310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:32:37.514307 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
00:32:37.561306 [debug] [Thread-2  ]: finished collecting timing info
00:32:37.562306 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:32:37.566307 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:32:37.568335 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:37.574309 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
00:32:41.661864 [debug] [Thread-2  ]: finished collecting timing info
00:32:41.663865 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C04566B80>]}
00:32:41.663865 [info ] [Thread-2  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.25s]
00:32:41.665866 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:32:41.666867 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.666867 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
00:32:41.667866 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.668868 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.668868 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.732866 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.759865 [debug] [Thread-2  ]: finished collecting timing info
00:32:41.759865 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:41.764885 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:32:41.766865 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:41.772866 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
00:32:41.848870 [debug] [Thread-1  ]: finished collecting timing info
00:32:41.848870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045580D0>]}
00:32:41.849870 [info ] [Thread-1  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.46s]
00:32:41.850868 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:32:41.851868 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.852880 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:32:41.854867 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.854867 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.855869 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.926871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.965870 [debug] [Thread-1  ]: finished collecting timing info
00:32:41.966867 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:41.973868 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:32:41.978868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:32:41.987867 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
00:32:45.647699 [debug] [Thread-2  ]: finished collecting timing info
00:32:45.648694 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045DF760>]}
00:32:45.649696 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.98s]
00:32:45.651696 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
00:32:45.846713 [debug] [Thread-1  ]: finished collecting timing info
00:32:45.847697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041FFAC0>]}
00:32:45.848717 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.99s]
00:32:45.850721 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:32:45.852698 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.853698 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
00:32:45.854695 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.854695 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.855695 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.916696 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.918698 [debug] [Thread-2  ]: finished collecting timing info
00:32:45.918698 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:45.924696 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:32:45.926700 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:32:45.933696 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
00:32:51.146608 [debug] [Thread-2  ]: finished collecting timing info
00:32:51.147640 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e5e3c4-8e4d-4d1d-9f72-462a0bbced0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041FF9A0>]}
00:32:51.148640 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 5.29s]
00:32:51.150610 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:32:51.152611 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:32:51.152611 [info ] [MainThread]: 
00:32:51.154610 [info ] [MainThread]: Finished running 5 table models in 16.61s.
00:32:51.155611 [debug] [MainThread]: Connection 'master' was properly closed.
00:32:51.155611 [debug] [MainThread]: Connection 'create_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:32:51.156627 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:32:51.157624 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:32:51.157624 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
00:32:51.174612 [info ] [MainThread]: 
00:32:51.175610 [info ] [MainThread]: [32mCompleted successfully[0m
00:32:51.177616 [info ] [MainThread]: 
00:32:51.178610 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
00:32:51.180610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C044740D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C045ADB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C041D8310>]}


============================== 2022-05-13 00:52:49.629588 | 637889ba-6ce8-4aa4-888f-34061c8bd85b ==============================
00:52:49.629588 [info ] [MainThread]: Running with dbt=1.0.4
00:52:49.630588 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:52:49.631590 [debug] [MainThread]: Tracking: tracking
00:52:49.645588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4CE711F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4CE71700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DB82F10>]}
00:52:49.924152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:52:49.924152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:52:49.942151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DDE40D0>]}
00:52:49.964151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DCFF850>]}
00:52:49.965150 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
00:52:49.970154 [info ] [MainThread]: 
00:52:49.972155 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:52:49.974153 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
00:52:49.975154 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:52:51.122786 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
00:52:51.123786 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:52:51.691785 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
00:52:51.692785 [info ] [MainThread]: 
00:52:51.699786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.699786 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.700786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:52:51.701787 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:52:51.702786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.702786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.703786 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.703786 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.709786 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
00:52:51.714786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
00:52:51.716785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.717786 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.717786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
00:52:51.718785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
00:52:51.719785 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.720785 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.721785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:52:51.722784 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:52:51.722784 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.723785 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.723785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.724787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.728785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer"
00:52:51.731785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
00:52:51.733785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.733785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.734786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Customer
00:52:51.735785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
00:52:51.736785 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.736785 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.737787 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:52:51.738786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:52:51.738786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.738786 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.739785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.740787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.744783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails"
00:52:51.747786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason"
00:52:51.749785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.749785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.750786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderDetails
00:52:51.751786 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrderSalesReason
00:52:51.751786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.752784 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.753785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:52:51.754786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:52:51.754786 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.755787 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.756787 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.756787 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.761783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders"
00:52:51.766785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
00:52:51.768785 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.768785 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.769788 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesOrders
00:52:51.770785 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
00:52:51.771786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.771786 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.772787 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:52:51.773785 [info ] [Thread-2  ]: 1 of 5 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
00:52:51.773785 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.774785 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:51.775785 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.775785 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.780785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
00:52:51.780785 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.830786 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:51.830786 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.831786 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
00:52:51.832786 [debug] [Thread-2  ]: finished collecting timing info
00:52:51.832786 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.833785 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:51.834787 [info ] [Thread-1  ]: 2 of 5 START table model AdventureWorks_marts.dim_Products...................... [RUN]
00:52:51.853784 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:52:51.854786 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
00:52:51.855787 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.856786 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
00:52:51.909785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:52:51.911784 [debug] [Thread-1  ]: finished collecting timing info
00:52:51.913785 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
00:52:51.919783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:52:52.498783 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
00:52:52.501786 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
00:52:52.503788 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
00:52:52.504786 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
00:52:55.805471 [debug] [Thread-2  ]: finished collecting timing info
00:52:55.806471 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DEE4760>]}
00:52:55.807472 [info ] [Thread-2  ]: 1 of 5 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 4.03s]
00:52:55.808472 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
00:52:55.809472 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.809472 [info ] [Thread-2  ]: 3 of 5 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
00:52:55.810472 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:55.811472 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.811472 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.827470 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:55.828471 [debug] [Thread-2  ]: finished collecting timing info
00:52:55.828471 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
00:52:55.831472 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:52:55.887475 [debug] [Thread-1  ]: finished collecting timing info
00:52:55.888475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DE6A100>]}
00:52:55.888475 [info ] [Thread-1  ]: 2 of 5 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 77.3 KB processed)[0m in 4.03s]
00:52:55.890472 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
00:52:55.890472 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.891474 [info ] [Thread-1  ]: 4 of 5 START table model AdventureWorks_marts.dim_SalesTerritories.............. [RUN]
00:52:55.892474 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:55.893476 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.893476 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.936472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:55.938472 [debug] [Thread-1  ]: finished collecting timing info
00:52:55.938472 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:52:55.945472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:52:56.396026 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
00:52:56.397024 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') || '-' || coalesce(cast(reasonName as 
    string
), '') || '-' || coalesce(cast(reassonType as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
00:52:56.528025 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
00:52:56.529027 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') || '-' || coalesce(cast(rowguid as 
    string
), '') || '-' || coalesce(cast(countryName as 
    string
), '') || '-' || coalesce(cast(costYtd as 
    string
), '') || '-' || coalesce(cast(salesYtd as 
    string
), '') || '-' || coalesce(cast(costLastYear as 
    string
), '') || '-' || coalesce(cast(salesLastYear as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final
  );
  
00:52:59.413025 [debug] [Thread-2  ]: finished collecting timing info
00:52:59.414024 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DF0FC70>]}
00:52:59.414024 [info ] [Thread-2  ]: 3 of 5 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 170.0 Bytes processed)[0m in 3.60s]
00:52:59.416025 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
00:53:00.501210 [debug] [Thread-1  ]: finished collecting timing info
00:53:00.502209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5DF0FF40>]}
00:53:00.503209 [info ] [Thread-1  ]: 4 of 5 OK created table model AdventureWorks_marts.dim_SalesTerritories......... [[32mCREATE TABLE (10.0 rows, 1.7 KB processed)[0m in 4.61s]
00:53:00.505210 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
00:53:00.506208 [debug] [Thread-2  ]: Began running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.506208 [info ] [Thread-2  ]: 5 of 5 START table model AdventureWorks_marts.fact_SalesOrdersDetails........... [RUN]
00:53:00.508209 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:00.509213 [debug] [Thread-2  ]: Began compiling node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.509213 [debug] [Thread-2  ]: Compiling model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.564208 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:00.566210 [debug] [Thread-2  ]: finished collecting timing info
00:53:00.567210 [debug] [Thread-2  ]: Began executing node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:00.569209 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:53:01.134209 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"
00:53:01.136209 [debug] [Thread-2  ]: On model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`fact_SalesOrdersDetails`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesOrders as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheader`
),

SalesOrders as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        /* Foreing Key */
        ,salespersonid -- maybe delete
        ,customerid as customer_id
        ,territoryid as territory_id
        ,creditcardid as creditCard_id
        /* Columns */
        ,"status" as orderStatus
        ,taxamt
        ,comment
        ,duedate as dueDate
        ,freight
        ,cast(shipdate as timestamp) as shipDate
        ,subtotal
        ,totaldue as totalDue
        ,cast(orderdate as timestamp) as orderDate
        ,accountnumber as accountNumber
        ,revisionnumber as revisionNumber
        ,onlineorderflag as onlineOrderFlag
        ,purchaseordernumber as purchaseOrderNumber
        ,creditcardapprovalcode as creditCardApprovalCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrders
),  __dbt__cte__stg_AdventureWorks_SalesOrderDetails as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderdetail`
),

SalesOrderDetails as (
    select
        /* Natural Key */
        salesorderid as salesOrder_id
        ,salesorderdetailid as salesOrderDetail_id
        /* Foreing Key */
        ,productid as product_id
        ,specialofferid as specialOffer_id
        /* Columns */
        ,orderqty as orderQty
        ,unitprice as unitPrice
        ,unitpricediscount as unitPriceDiscount
        ,carriertrackingnumber as carrierTrackingNumber
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesOrderDetails
),  __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesorderheadersalesreason`
),

SalesOrderSalesReason as (
    select
        /* Natural/Foreing Key */
        salesorderid as salesOrder_id
        ,salesreasonid as salesReason_id
        /* Columns */
        ,cast(modifieddate as timestamp) as modifiedDate 
    from source
)

select * from SalesOrderSalesReason
),/* from Stage */
    SalesOrders as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrders 
    ),

    SalesOrderDetails as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderDetails
    ),

    SalesOrderSalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesOrderSalesReason 
    ),

    /* from Dimensions */
    dim_CreditCards as (
        select
            creditCard_sk
            ,creditCard_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
    ),

    dim_Products as (
        select
            product_sk
            ,product_id        
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
    ),

    dim_Reasons as (
        select
            reason_sk
            ,salesReason_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
    ),
    
    dim_SalesTerritories as (
        select
            territory_sk
            ,territory_id
        from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
    ),


    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(SalesOrders.salesOrder_id as 
    string
), '') || '-' || coalesce(cast(SalesOrderDetails.salesOrderDetail_id as 
    string
), '') as 
    string
))) as salesOrdersDetais_sk --hashed surrogate key
            /* Natural Key */
            ,SalesOrders.salesOrder_id
            ,SalesOrderDetails.salesOrderDetail_id
            /* Foreing Key */
            ,creditCard_sk
            ,product_sk
            ,reason_sk
            ,territory_sk
            /* Columns */
            ,orderQty
            ,unitPrice
            ,unitPriceDiscount
            ,carrierTrackingNumber

            ,SalesOrders.orderStatus
            ,SalesOrders.taxamt
            ,SalesOrders.comment
            ,SalesOrders.dueDate
            ,SalesOrders.freight
            ,SalesOrders.shipDate
            ,SalesOrders.subtotal
            ,SalesOrders.totalDue
            ,SalesOrders.orderDate
            ,SalesOrders.accountNumber
            ,SalesOrders.revisionNumber
            ,SalesOrders.onlineOrderFlag
            ,SalesOrders.purchaseOrderNumber
            ,SalesOrders.creditCardApprovalCode
            ,SalesOrders.rowguid
            ,SalesOrders.modifiedDate
        from SalesOrderDetails

        left join SalesOrders on SalesOrderDetails.salesOrder_id = SalesOrders.salesOrder_id

        left join dim_CreditCards on SalesOrders.creditCard_id = dim_CreditCards.creditCard_id
        left join dim_Products on SalesOrderDetails.product_id = dim_Products.product_id
        left join SalesOrderSalesReason on SalesOrders.salesOrder_id = SalesOrderSalesReason.salesOrder_id
        left join dim_Reasons on SalesOrderSalesReason.salesReason_id = dim_Reasons.salesReason_id
        left join dim_SalesTerritories on SalesOrders.territory_id = dim_SalesTerritories.territory_id
    )

select * from final
  );
  
00:53:07.996810 [debug] [Thread-2  ]: finished collecting timing info
00:53:07.997817 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637889ba-6ce8-4aa4-888f-34061c8bd85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF3AF40>]}
00:53:07.997817 [info ] [Thread-2  ]: 5 of 5 OK created table model AdventureWorks_marts.fact_SalesOrdersDetails...... [[32mCREATE TABLE (131.9k rows, 15.1 MB processed)[0m in 7.49s]
00:53:07.999809 [debug] [Thread-2  ]: Finished running node model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails
00:53:08.001810 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:53:08.002812 [info ] [MainThread]: 
00:53:08.003809 [info ] [MainThread]: Finished running 5 table models in 18.03s.
00:53:08.004813 [debug] [MainThread]: Connection 'master' was properly closed.
00:53:08.005810 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
00:53:08.005810 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
00:53:08.006809 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
00:53:08.006809 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.fact_SalesOrdersDetails' was properly closed.
00:53:08.024808 [info ] [MainThread]: 
00:53:08.025809 [info ] [MainThread]: [32mCompleted successfully[0m
00:53:08.026813 [info ] [MainThread]: 
00:53:08.027810 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
00:53:08.028810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5EF96D00>]}


============================== 2022-05-13 02:13:22.999785 | 29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb ==============================
02:13:22.999785 [info ] [MainThread]: Running with dbt=1.0.4
02:13:23.000784 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:13:23.001801 [debug] [MainThread]: Tracking: tracking
02:13:23.018803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A17319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A1731700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14749D0>]}
02:13:23.840784 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
02:13:23.841784 [debug] [MainThread]: Partial parsing: added file: dbt_IA_AdventureWorks://models\staging\scr_AdventureWorks.yml
02:13:23.842785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_countryregion
02:13:23.842785 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_creditcard
02:13:23.843784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_customer
02:13:23.843784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_product
02:13:23.844784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderdetail
02:13:23.844784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheader
02:13:23.845784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesorderheadersalesreason
02:13:23.845784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesreason
02:13:23.846784 [debug] [MainThread]: Partial parsing: deleted source source.dbt_IA_AdventureWorks.AdventureWorks_BQ.airbyte_salesterritory
02:13:23.847784 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:13:23.858786 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:13:23.892784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:13:23.893784 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:13:23.902784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:13:23.903784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:13:23.906784 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:13:23.914785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:13:23.915784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:13:23.918784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
02:13:23.922785 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:13:23.929785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:13:23.931787 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:13:23.933784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:13:23.936783 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:13:23.939784 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:13:23.942784 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:13:23.948784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:13:23.950783 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:13:23.952786 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:13:24.080785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B183B0D0>]}
02:13:24.094785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B1474880>]}
02:13:24.094785 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:13:24.097783 [info ] [MainThread]: 
02:13:24.099788 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:24.101788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:13:24.101788 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:25.224370 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:13:25.225370 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:25.837387 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:13:25.838370 [info ] [MainThread]: 
02:13:25.847373 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.848370 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:13:25.851389 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:25.852370 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.853371 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.863372 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:13:25.867371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:13:25.884382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:25.885369 [debug] [Thread-1  ]: finished collecting timing info
02:13:25.886369 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:25.905368 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:13:26.509967 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:13:26.511984 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') || '-' || coalesce(cast(cardType as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:13:29.573967 [debug] [Thread-1  ]: finished collecting timing info
02:13:29.574969 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb286e-40c2-43f3-9c2c-4e8c0b1dfddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B17EA850>]}
02:13:29.574969 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 3.72s]
02:13:29.576977 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:13:29.579970 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:29.580981 [info ] [MainThread]: 
02:13:29.581970 [info ] [MainThread]: Finished running 1 table model in 5.48s.
02:13:29.582969 [debug] [MainThread]: Connection 'master' was properly closed.
02:13:29.583970 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:13:29.584969 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:13:29.584969 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:13:29.598970 [info ] [MainThread]: 
02:13:29.600969 [info ] [MainThread]: [32mCompleted successfully[0m
02:13:29.602972 [info ] [MainThread]: 
02:13:29.603970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:13:29.604970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B1563BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14CBA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B14C6430>]}


============================== 2022-05-13 02:13:40.863457 | 18eaa0af-e744-4243-9101-b3993efa9dd9 ==============================
02:13:40.863457 [info ] [MainThread]: Running with dbt=1.0.4
02:13:40.864457 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:13:40.865467 [debug] [MainThread]: Tracking: tracking
02:13:40.882459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309BDC4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001308B0D1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001308B0D1940>]}
02:13:41.015008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:13:41.016007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:13:41.028008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eaa0af-e744-4243-9101-b3993efa9dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0460D0>]}
02:13:41.042011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eaa0af-e744-4243-9101-b3993efa9dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309BE6E850>]}
02:13:41.042011 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:13:41.046009 [info ] [MainThread]: 
02:13:41.048013 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:41.050011 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:13:41.050011 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:13:41.640009 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:13:41.641011 [info ] [MainThread]: 
02:13:41.649009 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.649009 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.649009 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:13:41.650031 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:13:41.652009 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.654011 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.654011 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.655009 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.655009 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.655009 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.669007 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.676011 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.719008 [debug] [Thread-1  ]: finished collecting timing info
02:13:41.719008 [debug] [Thread-2  ]: finished collecting timing info
02:13:41.720009 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:41.720009 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:41.743007 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:13:41.746008 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:13:41.748024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:13:41.749012 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:13:41.757009 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:13:41.757009 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:13:43.483007 [debug] [Thread-1  ]: finished collecting timing info
02:13:43.485009 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.83s]
02:13:43.488022 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:13:43.870008 [debug] [Thread-2  ]: finished collecting timing info
02:13:43.870008 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.22s]
02:13:43.872015 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:13:43.874009 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:13:43.875021 [info ] [MainThread]: 
02:13:43.877023 [info ] [MainThread]: Finished running 2 tests in 2.83s.
02:13:43.878020 [debug] [MainThread]: Connection 'master' was properly closed.
02:13:43.879009 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:13:43.879009 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:13:43.880009 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:13:43.899017 [info ] [MainThread]: 
02:13:43.901009 [info ] [MainThread]: [32mCompleted successfully[0m
02:13:43.903010 [info ] [MainThread]: 
02:13:43.904010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:13:43.905009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013088F0D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0D3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309C0D3940>]}


============================== 2022-05-13 02:14:03.451556 | e616d884-da4e-4025-9d7d-e7e3376f7592 ==============================
02:14:03.451556 [info ] [MainThread]: Running with dbt=1.0.4
02:14:03.452560 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:14:03.453559 [debug] [MainThread]: Tracking: tracking
02:14:03.468556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9DE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9E4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DED9E4C10>]}
02:14:03.630556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:14:03.631556 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:14:03.643556 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:14:03.674556 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:14:03.713556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDD2B0D0>]}
02:14:03.726556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA66B20>]}
02:14:03.727556 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:03.730569 [info ] [MainThread]: 
02:14:03.731556 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:03.733558 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:14:03.733558 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:04.353557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:04.354556 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:04.957146 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:04.958146 [info ] [MainThread]: 
02:14:04.965166 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.966148 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:14:04.968148 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:04.969150 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.970147 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:04.976147 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:14:04.979147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:14:04.995147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:04.996146 [debug] [Thread-1  ]: finished collecting timing info
02:14:04.996146 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:05.014146 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:05.609146 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:05.611152 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') || '-' || coalesce(cast(cardNumber as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:14:09.355878 [debug] [Thread-1  ]: finished collecting timing info
02:14:09.356879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e616d884-da4e-4025-9d7d-e7e3376f7592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDD51220>]}
02:14:09.357878 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 677.5 KB processed)[0m in 4.39s]
02:14:09.358895 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:09.360880 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:09.361881 [info ] [MainThread]: 
02:14:09.362884 [info ] [MainThread]: Finished running 1 table model in 5.63s.
02:14:09.363880 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:09.364881 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:14:09.365879 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:09.365879 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:14:09.375879 [info ] [MainThread]: 
02:14:09.376879 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:09.379884 [info ] [MainThread]: 
02:14:09.380883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:14:09.381880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA3A820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA3A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DEDA90D30>]}


============================== 2022-05-13 02:14:16.101532 | 844e6562-c223-4832-85ba-7cc23145e3c6 ==============================
02:14:16.101532 [info ] [MainThread]: Running with dbt=1.0.4
02:14:16.101532 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:14:16.102534 [debug] [MainThread]: Tracking: tracking
02:14:16.117536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB493DC0>]}
02:14:16.299532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:14:16.299532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:14:16.308534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844e6562-c223-4832-85ba-7cc23145e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB6F70D0>]}
02:14:16.324533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844e6562-c223-4832-85ba-7cc23145e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB5F2760>]}
02:14:16.324533 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:16.328534 [info ] [MainThread]: 
02:14:16.330535 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:16.332534 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:16.333540 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:16.929532 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:16.930539 [info ] [MainThread]: 
02:14:16.937536 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.937536 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.938534 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:14:16.938534 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:14:16.940535 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.941534 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.941534 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.941534 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.942534 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.942534 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.953533 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.961533 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.963535 [debug] [Thread-1  ]: finished collecting timing info
02:14:16.963535 [debug] [Thread-2  ]: finished collecting timing info
02:14:16.964536 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:16.964536 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:16.992533 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:16.995533 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:16.997533 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:16.997533 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:14:17.004532 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:14:17.006540 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:14:18.693532 [debug] [Thread-1  ]: finished collecting timing info
02:14:18.694533 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.75s]
02:14:18.696534 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:19.087532 [debug] [Thread-2  ]: finished collecting timing info
02:14:19.087532 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.15s]
02:14:19.089561 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:19.091534 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:19.092545 [info ] [MainThread]: 
02:14:19.093534 [info ] [MainThread]: Finished running 2 tests in 2.76s.
02:14:19.094536 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:19.095534 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:19.096535 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:14:19.097544 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:14:19.116543 [info ] [MainThread]: 
02:14:19.117534 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:19.119537 [info ] [MainThread]: 
02:14:19.121542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:14:19.122534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB6C0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB5DED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1DB79B310>]}


============================== 2022-05-13 02:14:35.791284 | e184579e-f3d7-4293-bf80-9580894b1614 ==============================
02:14:35.791284 [info ] [MainThread]: Running with dbt=1.0.4
02:14:35.792284 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:14:35.792284 [debug] [MainThread]: Tracking: tracking
02:14:35.806284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C092DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9AFC41640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9AFC419A0>]}
02:14:35.924285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:14:35.925285 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:14:35.941284 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:14:35.974283 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:14:36.013893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0C9A0D0>]}
02:14:36.029893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C09AC430>]}
02:14:36.030896 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:36.034895 [info ] [MainThread]: 
02:14:36.035896 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:36.037894 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:14:36.038893 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:36.612892 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:36.613893 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:37.215893 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:37.216894 [info ] [MainThread]: 
02:14:37.222896 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.223895 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_CreditCards................... [RUN]
02:14:37.224896 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.225894 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.225894 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.231895 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards
02:14:37.234896 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CreditCards"
02:14:37.249894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.251895 [debug] [Thread-1  ]: finished collecting timing info
02:14:37.252894 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:37.273893 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:37.863893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_CreditCards"
02:14:37.864894 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_CreditCards: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_CreditCards"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_CreditCards as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_creditcard`
),

CreditCards as (
    select
        /* Natural Key */
        creditcardid as creditCard_id
        /* Columms */
        ,cardnumber as cardNumber --sensible data
        ,cardtype as cardType
        --,expyear as expYear --sensible data
        --,expmonth as expMonth --sensible data
        ,modifieddate as modifiedDate
    from source
)

select * from CreditCards
),CreditCards as (
        select * from __dbt__cte__stg_AdventureWorks_CreditCards 
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(creditCard_id as 
    string
), '') as 
    string
))) as creditCard_sk --hashed surrogate key
            /* Natural Key */
            ,creditCard_id
            /* Columms */
            ,cardType
        from CreditCards
    )

select * from final
  );
  
02:14:41.266087 [debug] [Thread-1  ]: finished collecting timing info
02:14:41.267087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e184579e-f3d7-4293-bf80-9580894b1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0CF4CD0>]}
02:14:41.268089 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_CreditCards.............. [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 4.04s]
02:14:41.269090 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_CreditCards
02:14:41.272103 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:41.273089 [info ] [MainThread]: 
02:14:41.274091 [info ] [MainThread]: Finished running 1 table model in 5.24s.
02:14:41.275090 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:41.275090 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:14:41.276090 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:41.276090 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_CreditCards' was properly closed.
02:14:41.289087 [info ] [MainThread]: 
02:14:41.290089 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:41.291089 [info ] [MainThread]: 
02:14:41.293110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:14:41.294089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0A001F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0A00130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9C0B80BE0>]}


============================== 2022-05-13 02:14:47.749276 | dd691c19-3603-47e3-89e1-306667da73a5 ==============================
02:14:47.749276 [info ] [MainThread]: Running with dbt=1.0.4
02:14:47.750277 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_CreditCards'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:14:47.751277 [debug] [MainThread]: Tracking: tracking
02:14:47.766276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E06E94E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E761A1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E761A11F0>]}
02:14:47.884276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:14:47.885282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:14:47.893276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd691c19-3603-47e3-89e1-306667da73a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E071160D0>]}
02:14:47.908279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd691c19-3603-47e3-89e1-306667da73a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E06F60850>]}
02:14:47.909277 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:14:47.912276 [info ] [MainThread]: 
02:14:47.914278 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:47.916276 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:14:47.917277 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:14:48.495277 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:14:48.496276 [info ] [MainThread]: 
02:14:48.503278 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.503278 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.504281 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_CreditCards_creditCard_sk........................ [RUN]
02:14:48.504281 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_CreditCards_creditCard_sk.......................... [RUN]
02:14:48.506278 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.507277 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.508280 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.508280 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.509278 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.509278 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.522276 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.530277 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.532277 [debug] [Thread-1  ]: finished collecting timing info
02:14:48.532277 [debug] [Thread-2  ]: finished collecting timing info
02:14:48.533297 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:48.534292 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:48.560279 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"
02:14:48.563277 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"
02:14:48.565282 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:14:48.566280 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:14:48.571276 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
where creditCard_sk is null



      
    ) dbt_internal_test
02:14:48.572276 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select creditCard_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_CreditCards`
  where creditCard_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:14:50.376837 [debug] [Thread-1  ]: finished collecting timing info
02:14:50.377839 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_CreditCards_creditCard_sk.............................. [[32mPASS[0m in 1.87s]
02:14:50.378839 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5
02:14:50.730838 [debug] [Thread-2  ]: finished collecting timing info
02:14:50.731838 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_CreditCards_creditCard_sk................................ [[32mPASS[0m in 2.22s]
02:14:50.733839 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445
02:14:50.735839 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:14:50.736838 [info ] [MainThread]: 
02:14:50.736838 [info ] [MainThread]: Finished running 2 tests in 2.82s.
02:14:50.738848 [debug] [MainThread]: Connection 'master' was properly closed.
02:14:50.738848 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:14:50.739840 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_CreditCards_creditCard_sk.b1f54e1fd5' was properly closed.
02:14:50.740840 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_CreditCards_creditCard_sk.cfb6763445' was properly closed.
02:14:50.761841 [info ] [MainThread]: 
02:14:50.762840 [info ] [MainThread]: [32mCompleted successfully[0m
02:14:50.763841 [info ] [MainThread]: 
02:14:50.764840 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:14:50.766839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E070E1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E070FAD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E071A0EE0>]}


============================== 2022-05-13 02:15:40.632135 | 3bb22b8f-5215-412f-9c84-0941606c0a85 ==============================
02:15:40.632135 [info ] [MainThread]: Running with dbt=1.0.4
02:15:40.633137 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:15:40.634137 [debug] [MainThread]: Tracking: tracking
02:15:40.649136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433763670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433774A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433774280>]}
02:15:40.766134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:15:40.766134 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:15:40.767136 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_CreditCards.sql
02:15:40.779134 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:15:40.813135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:15:40.816136 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:15:40.824137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:15:40.887134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433AB2AF0>]}
02:15:40.902135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A43381A970>]}
02:15:40.903136 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:15:40.906144 [info ] [MainThread]: 
02:15:40.907135 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:40.909137 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:15:40.910136 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:41.496709 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:15:41.496709 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:42.091707 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:15:42.092711 [info ] [MainThread]: 
02:15:42.100710 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.101709 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:15:42.102713 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.102713 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.103709 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:15:42.109708 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:15:42.112709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:15:42.150710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.151707 [debug] [Thread-1  ]: finished collecting timing info
02:15:42.152710 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:15:42.168710 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:15:42.778707 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:42.780708 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            distinct product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:15:46.175933 [debug] [Thread-1  ]: finished collecting timing info
02:15:46.175933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bb22b8f-5215-412f-9c84-0941606c0a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433B0BDF0>]}
02:15:46.176934 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 58.6 KB processed)[0m in 4.07s]
02:15:46.178945 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:15:46.180949 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:46.181933 [info ] [MainThread]: 
02:15:46.182935 [info ] [MainThread]: Finished running 1 table model in 5.27s.
02:15:46.183935 [debug] [MainThread]: Connection 'master' was properly closed.
02:15:46.184934 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:15:46.185937 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:15:46.185937 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
02:15:46.204934 [info ] [MainThread]: 
02:15:46.205934 [info ] [MainThread]: [32mCompleted successfully[0m
02:15:46.207937 [info ] [MainThread]: 
02:15:46.208936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:15:46.210935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A42087E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4337C3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A433BA4E50>]}


============================== 2022-05-13 02:15:55.558679 | 3280bdd9-7503-450a-a5e8-5e09105e3125 ==============================
02:15:55.558679 [info ] [MainThread]: Running with dbt=1.0.4
02:15:55.559678 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:15:55.560680 [debug] [MainThread]: Tracking: tracking
02:15:55.574680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF0649D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064EB0>]}
02:15:55.694678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:15:55.695678 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:15:55.707677 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:15:55.742680 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:15:55.790678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF3990D0>]}
02:15:55.803679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF064880>]}
02:15:55.804679 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:15:55.807678 [info ] [MainThread]: 
02:15:55.809680 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:55.811686 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:15:55.811686 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:56.417277 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:15:56.418292 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:56.980277 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:15:56.981280 [info ] [MainThread]: 
02:15:56.989279 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Products
02:15:56.989279 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Products...................... [RUN]
02:15:56.991279 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Products"
02:15:56.991279 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Products
02:15:56.992277 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Products
02:15:57.000277 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products
02:15:57.005277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_Products"
02:15:57.055277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:57.057278 [debug] [Thread-1  ]: finished collecting timing info
02:15:57.057278 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Products
02:15:57.080277 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:15:57.702278 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Products"
02:15:57.704277 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Products: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Products"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_Products as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_product`
),

Products as (
    select
        /* Natural Key */
        productid as product_id
        /* Foreing Key */
        ,productmodelid as productModel_id
        ,productsubcategoryid as productSubcategory_id
        /* Columns */
        ,"name" as productName
        ,productnumber as productNumber
    
        ,size
        ,class
        ,color
        ,style
        ,"weight" as productWeight
        ,makeflag as makeFlag
        ,listprice as listPrice
        ,productline as productLine
        ,cast(sellenddate as timestamp) as sellEndDate
        ,reorderpoint as reorderPoint
        ,standardcost as standardCost
        ,cast(sellstartdate as timestamp) as sellStartDate
        ,cast(discontinueddate as timestamp) as discontinuedDate
        ,safetystocklevel as safetyStockLevel
        ,daystomanufacture as daysToManufacture
        ,finishedgoodsflag as finishedGoodsFlag
        ,sizeunitmeasurecode as sizeUnitMmeasureCode
        ,weightunitmeasurecode as weightUnitMeasureCode
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from Products
),Products as (
        select * from __dbt__cte__stg_AdventureWorks_Products 
    ),


    surrogate as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(product_id as 
    string
), '') || '-' || coalesce(cast(productModel_id as 
    string
), '') || '-' || coalesce(cast(productSubcategory_id as 
    string
), '') as 
    string
))) as product_sk --hashed surrogate key
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber
        
            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode
            ,rowguid
        from Products
    ),

    final as (
        select
            /* Surrogate Key */
            product_sk
            /* Natural Key */
            ,product_id
            /* Foreing Key */
            ,productModel_id
            ,productSubcategory_id
            /* Columns */
            ,productName
            ,productNumber

            ,size
            ,class
            ,color
            ,style
            ,productWeight
            ,makeFlag
            ,listPrice
            ,productLine
            ,sellEndDate
            ,reorderPoint
            ,standardCost
            ,sellStartDate
            ,discontinuedDate
            ,safetyStockLevel
            ,daysToManufacture
            ,finishedGoodsFlag
            ,sizeUnitMmeasureCode
            ,weightUnitMeasureCode

        from surrogate
    )

select * from final
  );
  
02:16:00.570898 [debug] [Thread-1  ]: finished collecting timing info
02:16:00.570898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3280bdd9-7503-450a-a5e8-5e09105e3125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF4A0BE0>]}
02:16:00.571897 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Products................. [[32mCREATE TABLE (504.0 rows, 58.6 KB processed)[0m in 3.58s]
02:16:00.573913 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Products
02:16:00.575903 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:00.576906 [info ] [MainThread]: 
02:16:00.577898 [info ] [MainThread]: Finished running 1 table model in 4.77s.
02:16:00.578898 [debug] [MainThread]: Connection 'master' was properly closed.
02:16:00.579900 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:16:00.579900 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:16:00.580898 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Products' was properly closed.
02:16:00.592901 [info ] [MainThread]: 
02:16:00.593901 [info ] [MainThread]: [32mCompleted successfully[0m
02:16:00.595909 [info ] [MainThread]: 
02:16:00.597897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:16:00.598899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF3990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF0C89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBBF4A0C10>]}


============================== 2022-05-13 02:16:22.454738 | 04898bc5-6fec-4ea7-8454-7a9fcdd20228 ==============================
02:16:22.454738 [info ] [MainThread]: Running with dbt=1.0.4
02:16:22.454738 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Products'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:16:22.455739 [debug] [MainThread]: Tracking: tracking
02:16:22.469743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E73D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E84940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4E84340>]}
02:16:22.606740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:16:22.607740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:16:22.621741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04898bc5-6fec-4ea7-8454-7a9fcdd20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D50D60D0>]}
02:16:22.636740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04898bc5-6fec-4ea7-8454-7a9fcdd20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4F0D7C0>]}
02:16:22.637740 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:16:22.641740 [info ] [MainThread]: 
02:16:22.643741 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:22.645739 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:16:22.646740 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:16:23.265738 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:16:23.266739 [info ] [MainThread]: 
02:16:23.273741 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.273741 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.274746 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Products_product_sk.............................. [RUN]
02:16:23.274746 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Products_product_sk................................ [RUN]
02:16:23.276741 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.278743 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.278743 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.279739 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.280741 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.280741 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.298740 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.307741 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.309743 [debug] [Thread-1  ]: finished collecting timing info
02:16:23.309743 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:23.334738 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"
02:16:23.335738 [debug] [Thread-2  ]: finished collecting timing info
02:16:23.336740 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:23.337741 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:16:23.340749 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"
02:16:23.343740 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:16:23.346739 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
where product_sk is null



      
    ) dbt_internal_test
02:16:23.349739 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select product_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Products`
  where product_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:16:24.949346 [debug] [Thread-1  ]: finished collecting timing info
02:16:24.949346 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Products_product_sk.................................... [[32mPASS[0m in 1.67s]
02:16:24.951347 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f
02:16:25.313348 [debug] [Thread-2  ]: finished collecting timing info
02:16:25.314345 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Products_product_sk...................................... [[32mPASS[0m in 2.04s]
02:16:25.316362 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5
02:16:25.318347 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:16:25.319348 [info ] [MainThread]: 
02:16:25.321361 [info ] [MainThread]: Finished running 2 tests in 2.68s.
02:16:25.322351 [debug] [MainThread]: Connection 'master' was properly closed.
02:16:25.323356 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:16:25.324350 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Products_product_sk.35fdf90e5f' was properly closed.
02:16:25.324350 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Products_product_sk.36e276c0d5' was properly closed.
02:16:25.341346 [info ] [MainThread]: 
02:16:25.342346 [info ] [MainThread]: [32mCompleted successfully[0m
02:16:25.343347 [info ] [MainThread]: 
02:16:25.345356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:16:25.347349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4EE7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D4F0D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D515FD60>]}


============================== 2022-05-13 02:17:06.975441 | cb4a2537-b01c-47f9-8bb5-9da26713e10b ==============================
02:17:06.975441 [info ] [MainThread]: Running with dbt=1.0.4
02:17:06.975441 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:17:06.976443 [debug] [MainThread]: Tracking: tracking
02:17:06.990443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCF9FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFA4BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFA4D90>]}
02:17:07.107441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:17:07.107441 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Reasons.sql
02:17:07.108442 [debug] [MainThread]: Partial parsing: updated file: dbt_IA_AdventureWorks://models\marts\dim_Products.sql
02:17:07.121441 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:17:07.152441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:17:07.154441 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:17:07.161441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:17:07.217441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD2ED0D0>]}
02:17:07.230443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFB5790>]}
02:17:07.231445 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:07.234442 [info ] [MainThread]: 
02:17:07.235442 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:07.237443 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:17:07.237443 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:07.827442 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:17:07.827442 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:08.468441 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:17:08.469443 [info ] [MainThread]: 
02:17:08.477443 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.477443 [info ] [Thread-1  ]: 1 of 1 START table model AdventureWorks_marts.dim_Reasons....................... [RUN]
02:17:08.479442 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:08.480445 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.481446 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.488442 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason
02:17:08.491441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesReason"
02:17:08.505441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:08.506441 [debug] [Thread-1  ]: finished collecting timing info
02:17:08.507458 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:08.523441 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:09.092441 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_Reasons"
02:17:09.093443 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_Reasons: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_Reasons"} */


  create or replace table `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  
  
  OPTIONS()
  as (
    with
     __dbt__cte__stg_AdventureWorks_SalesReason as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesreason`
),

SalesReason as (
    select
        /* Natural Key */
        salesreasonid as salesReason_id
        /* Columns */
        ,"name" as reasonName
        ,reasontype as reassonType
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesReason
),SalesReason as (
        select * from __dbt__cte__stg_AdventureWorks_SalesReason 
    ),

    final as (
        select
            /* Surrogate Key */
            distinct to_hex(md5(cast(coalesce(cast(salesReason_id as 
    string
), '') as 
    string
))) as reason_sk --hashed surrogate key
            /* Natural Key */
            ,salesReason_id
            /* Columms */
            ,reasonName
            ,reassonType
        from SalesReason
    )

select * from final
  );
  
02:17:12.102675 [debug] [Thread-1  ]: finished collecting timing info
02:17:12.103676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4a2537-b01c-47f9-8bb5-9da26713e10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD333FA0>]}
02:17:12.103676 [info ] [Thread-1  ]: 1 of 1 OK created table model AdventureWorks_marts.dim_Reasons.................. [[32mCREATE TABLE (10.0 rows, 170.0 Bytes processed)[0m in 3.62s]
02:17:12.105676 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_Reasons
02:17:12.107677 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:12.108676 [info ] [MainThread]: 
02:17:12.109676 [info ] [MainThread]: Finished running 1 table model in 4.87s.
02:17:12.111679 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:12.111679 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:17:12.112678 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:17:12.112678 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_Reasons' was properly closed.
02:17:12.126689 [info ] [MainThread]: 
02:17:12.127697 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:12.128686 [info ] [MainThread]: 
02:17:12.130677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:17:12.131678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FCFF2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD1D0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231FD02DB80>]}


============================== 2022-05-13 02:17:23.309989 | 1471e4ea-13fd-4e38-8aff-05747f4a5bf7 ==============================
02:17:23.309989 [info ] [MainThread]: Running with dbt=1.0.4
02:17:23.310991 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_Reasons'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:17:23.311992 [debug] [MainThread]: Tracking: tracking
02:17:23.326992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AE3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AF4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0AF40A0>]}
02:17:23.450989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:17:23.451989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:17:23.459990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1471e4ea-13fd-4e38-8aff-05747f4a5bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0D460D0>]}
02:17:23.473991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1471e4ea-13fd-4e38-8aff-05747f4a5bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0B637C0>]}
02:17:23.474992 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:17:23.477991 [info ] [MainThread]: 
02:17:23.478992 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:23.480991 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:17:23.480991 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:17:24.078990 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:17:24.078990 [info ] [MainThread]: 
02:17:24.085992 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.085992 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.086992 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_Reasons_reason_sk................................ [RUN]
02:17:24.087992 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_Reasons_reason_sk.................................. [RUN]
02:17:24.088994 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.089994 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.090992 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.090992 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.091991 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.091991 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.103989 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.113990 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.114990 [debug] [Thread-1  ]: finished collecting timing info
02:17:24.115992 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:24.137989 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"
02:17:24.138991 [debug] [Thread-2  ]: finished collecting timing info
02:17:24.139991 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:24.144990 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"
02:17:24.145990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:17:24.146991 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:17:24.151991 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select reason_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
  where reason_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:17:24.153007 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_Reasons`
where reason_sk is null



      
    ) dbt_internal_test
02:17:25.810571 [debug] [Thread-1  ]: finished collecting timing info
02:17:25.811578 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_Reasons_reason_sk...................................... [[32mPASS[0m in 1.72s]
02:17:25.813571 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1
02:17:26.278165 [debug] [Thread-2  ]: finished collecting timing info
02:17:26.279165 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_Reasons_reason_sk........................................ [[32mPASS[0m in 2.19s]
02:17:26.280164 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf
02:17:26.282165 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:17:26.283166 [info ] [MainThread]: 
02:17:26.284168 [info ] [MainThread]: Finished running 2 tests in 2.80s.
02:17:26.285167 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:26.286170 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:17:26.287166 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_Reasons_reason_sk.1fa7e3cda1' was properly closed.
02:17:26.287166 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_Reasons_reason_sk.a7846e36bf' was properly closed.
02:17:26.306167 [info ] [MainThread]: 
02:17:26.307165 [info ] [MainThread]: [32mCompleted successfully[0m
02:17:26.309164 [info ] [MainThread]: 
02:17:26.310164 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:17:26.311166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DDC0E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0B571F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F0DDFF10>]}


============================== 2022-05-13 02:18:49.734742 | 9a5b8fa3-7609-4781-b958-c21a22931d77 ==============================
02:18:49.734742 [info ] [MainThread]: Running with dbt=1.0.4
02:18:49.735735 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:18:49.736736 [debug] [MainThread]: Tracking: tracking
02:18:49.748735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C43E5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C443BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C443B50>]}
02:18:49.780348 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:18:49.781349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C4997F0>]}
02:18:49.884348 [debug] [MainThread]: Parsing macros\adapters.sql
02:18:49.909349 [debug] [MainThread]: Parsing macros\catalog.sql
02:18:49.915349 [debug] [MainThread]: Parsing macros\etc.sql
02:18:49.918349 [debug] [MainThread]: Parsing macros\materializations\copy.sql
02:18:49.921349 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
02:18:49.937349 [debug] [MainThread]: Parsing macros\materializations\seed.sql
02:18:49.941350 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
02:18:49.944350 [debug] [MainThread]: Parsing macros\materializations\table.sql
02:18:49.949350 [debug] [MainThread]: Parsing macros\materializations\view.sql
02:18:49.952350 [debug] [MainThread]: Parsing macros\adapters\columns.sql
02:18:49.963349 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
02:18:49.966350 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
02:18:49.969350 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
02:18:49.977348 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
02:18:49.983357 [debug] [MainThread]: Parsing macros\adapters\relation.sql
02:18:49.993349 [debug] [MainThread]: Parsing macros\adapters\schema.sql
02:18:49.996349 [debug] [MainThread]: Parsing macros\etc\datetime.sql
02:18:50.005349 [debug] [MainThread]: Parsing macros\etc\statement.sql
02:18:50.011362 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
02:18:50.014351 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
02:18:50.015350 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
02:18:50.016350 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
02:18:50.017349 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
02:18:50.020349 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
02:18:50.022351 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
02:18:50.025350 [debug] [MainThread]: Parsing macros\materializations\configs.sql
02:18:50.028348 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
02:18:50.033349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
02:18:50.040349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
02:18:50.051349 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
02:18:50.053350 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
02:18:50.066350 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
02:18:50.083349 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
02:18:50.088350 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
02:18:50.098349 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
02:18:50.102350 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
02:18:50.105350 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
02:18:50.108354 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
02:18:50.116349 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
02:18:50.133349 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
02:18:50.140350 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
02:18:50.151349 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
02:18:50.164350 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
02:18:50.166349 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
02:18:50.184348 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
02:18:50.187348 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
02:18:50.192349 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
02:18:50.194349 [debug] [MainThread]: Parsing tests\generic\builtin.sql
02:18:50.197349 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
02:18:50.199349 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
02:18:50.202351 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
02:18:50.204349 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
02:18:50.205349 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
02:18:50.209349 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
02:18:50.216349 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
02:18:50.219349 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
02:18:50.229350 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
02:18:50.231349 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
02:18:50.234349 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
02:18:50.235350 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
02:18:50.237351 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
02:18:50.239351 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
02:18:50.241351 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
02:18:50.245348 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
02:18:50.247350 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
02:18:50.256351 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
02:18:50.257348 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
02:18:50.259349 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
02:18:50.261351 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
02:18:50.264348 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
02:18:50.268350 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
02:18:50.271351 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
02:18:50.282350 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
02:18:50.285349 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
02:18:50.286349 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
02:18:50.289349 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
02:18:50.290350 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
02:18:50.293351 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
02:18:50.298350 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
02:18:50.300349 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
02:18:50.302349 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
02:18:50.304349 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
02:18:50.313348 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
02:18:50.316349 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
02:18:50.318348 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
02:18:50.320349 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
02:18:50.322350 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
02:18:50.325349 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
02:18:50.328349 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
02:18:50.330349 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
02:18:50.332349 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
02:18:50.335348 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
02:18:50.337349 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
02:18:50.338350 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
02:18:50.340349 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
02:18:50.341349 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
02:18:50.368350 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
02:18:50.372349 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
02:18:50.376349 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
02:18:50.381349 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
02:18:50.387349 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
02:18:50.390348 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
02:18:50.393349 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
02:18:50.396348 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
02:18:50.400348 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
02:18:50.407349 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
02:18:50.410350 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
02:18:50.412348 [debug] [MainThread]: Parsing macros\sql\groupby.sql
02:18:50.414350 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
02:18:50.421350 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
02:18:50.423348 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
02:18:50.425349 [debug] [MainThread]: Parsing macros\sql\pivot.sql
02:18:50.430349 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
02:18:50.433350 [debug] [MainThread]: Parsing macros\sql\star.sql
02:18:50.438349 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
02:18:50.443349 [debug] [MainThread]: Parsing macros\sql\union.sql
02:18:50.453348 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
02:18:50.462349 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
02:18:50.464349 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
02:18:50.466349 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
02:18:51.039945 [debug] [MainThread]: 1603: static parser failed on marts\dim_CreditCards.sql
02:18:51.086950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_CreditCards.sql
02:18:51.088946 [debug] [MainThread]: 1603: static parser failed on marts\dim_Products.sql
02:18:51.097944 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Products.sql
02:18:51.098945 [debug] [MainThread]: 1603: static parser failed on marts\dim_Reasons.sql
02:18:51.107946 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_Reasons.sql
02:18:51.109946 [debug] [MainThread]: 1603: static parser failed on marts\dim_SalesTerritories.sql
02:18:51.118945 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\dim_SalesTerritories.sql
02:18:51.120945 [debug] [MainThread]: 1603: static parser failed on marts\fact_SalesOrdersDetails.sql
02:18:51.130947 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts\fact_SalesOrdersDetails.sql
02:18:51.133945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CountryRegions.sql
02:18:51.139947 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_CreditCards.sql
02:18:51.143946 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Customer.sql
02:18:51.148945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_Products.sql
02:18:51.153945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderDetails.sql
02:18:51.156944 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrders.sql
02:18:51.160945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesOrderSalesReason.sql
02:18:51.163946 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesReason.sql
02:18:51.168945 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_AdventureWorks_SalesTerritories.sql
02:18:51.446946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C7B6FA0>]}
02:18:51.470945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C4E4BB0>]}
02:18:51.471946 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:18:51.474945 [info ] [MainThread]: 
02:18:51.476948 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:51.477947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:18:51.478946 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:52.587947 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:18:52.588947 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:18:53.207945 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:18:53.208946 [info ] [MainThread]: 
02:18:53.214945 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.215945 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
02:18:53.217946 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:53.218948 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.219948 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.227945 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:18:53.230944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:18:53.231943 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:18:53.236950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:18:53.258946 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:18:53.259946 [debug] [Thread-1  ]: finished collecting timing info
02:18:53.259946 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.283945 [debug] [Thread-1  ]: finished collecting timing info
02:18:53.284944 [debug] [Thread-1  ]: Compilation Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
  Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
  > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
02:18:53.285945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5b8fa3-7609-4781-b958-c21a22931d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C8793D0>]}
02:18:53.285945 [error] [Thread-1  ]: 1 of 1 ERROR creating view model AdventureWorks_marts.dim_SalesTerritories...... [[31mERROR[0m in 0.07s]
02:18:53.287947 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:18:53.289945 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:18:53.289945 [info ] [MainThread]: 
02:18:53.290944 [info ] [MainThread]: Finished running 1 view model in 1.81s.
02:18:53.292948 [debug] [MainThread]: Connection 'master' was properly closed.
02:18:53.293949 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:18:53.293949 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:18:53.294947 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:18:53.316952 [info ] [MainThread]: 
02:18:53.323946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:18:53.325948 [info ] [MainThread]: 
02:18:53.327946 [error] [MainThread]: [33mCompilation Error in model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)[0m
02:18:53.328948 [error] [MainThread]:   Trying to create view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`, but it currently exists as a table. Either drop `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
02:18:53.329945 [error] [MainThread]:   
02:18:53.330944 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
02:18:53.331945 [error] [MainThread]:   > called by macro handle_existing_table (macros\materializations\models\view\helpers.sql)
02:18:53.332945 [error] [MainThread]:   > called by macro create_or_replace_view (macros\materializations\models\view\create_or_replace_view.sql)
02:18:53.334945 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
02:18:53.335948 [error] [MainThread]:   > called by model dim_SalesTerritories (models\marts\dim_SalesTerritories.sql)
02:18:53.337947 [info ] [MainThread]: 
02:18:53.338946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
02:18:53.339946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C72BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C81F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE1C81F220>]}


============================== 2022-05-13 02:20:02.715816 | 37c5bf65-a242-4cc0-9215-5d7d1a52c0f6 ==============================
02:20:02.715816 [info ] [MainThread]: Running with dbt=1.0.4
02:20:02.715816 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
02:20:02.716816 [debug] [MainThread]: Tracking: tracking
02:20:02.730817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD130A4E20>]}
02:20:02.885821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:20:02.886819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:20:02.896816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133040D0>]}
02:20:02.915816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD13227730>]}
02:20:02.916817 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:20:02.918821 [info ] [MainThread]: 
02:20:02.919818 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:02.920818 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123"
02:20:02.921817 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:03.505817 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:20:03.505817 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:04.090331 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:20:04.092330 [info ] [MainThread]: 
02:20:04.101330 [debug] [Thread-1  ]: Began running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.102330 [info ] [Thread-1  ]: 1 of 1 START view model AdventureWorks_marts.dim_SalesTerritories............... [RUN]
02:20:04.103330 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.104333 [debug] [Thread-1  ]: Began compiling node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.105330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.150330 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories
02:20:04.154329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_SalesTerritories"
02:20:04.155329 [debug] [Thread-1  ]: Compiling model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions
02:20:04.160926 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.stg_AdventureWorks_CountryRegions"
02:20:04.191929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.192928 [debug] [Thread-1  ]: finished collecting timing info
02:20:04.192928 [debug] [Thread-1  ]: Began executing node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:04.237928 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_IA_AdventureWorks.dim_SalesTerritories"
02:20:04.239928 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:20:04.248930 [debug] [Thread-1  ]: On model.dbt_IA_AdventureWorks.dim_SalesTerritories: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "model.dbt_IA_AdventureWorks.dim_SalesTerritories"} */


  create or replace view `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  OPTIONS()
  as with
     __dbt__cte__stg_AdventureWorks_SalesTerritories as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_salesterritory`
),

SalesTerritories as (
    select
        /* Natural Key */
        territoryid as territory_id
        /* Foreing Key */
        ,countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as territoryName
        ,"group" as territoryGroup
        ,costytd as costYtd
        ,salesytd as salesYtd
        ,costlastyear as costLastYear
        ,saleslastyear as salesLastYear
        ,rowguid
        ,cast(modifieddate as timestamp) as modifiedDate
    from source
)

select * from SalesTerritories
),  __dbt__cte__stg_AdventureWorks_CountryRegions as (
with source as (
    select * from `snappy-meridian-350123`.`AdventureWorks`.`airbyte_countryregion`
),

CountryRegions as (
    select
        /* Natural Key */
        countryregioncode as countryRegion_id
        /* Columms */
        ,"name" as countryName
        ,modifieddate as modifiedDate
    from source
)

select * from CountryRegions
),SalesTerritories as (
        select * from __dbt__cte__stg_AdventureWorks_SalesTerritories
    ),

    CountryRegions as (
        select * from __dbt__cte__stg_AdventureWorks_CountryRegions
    ),

    final as (
        select
            /* Surrogate Key */
            to_hex(md5(cast(coalesce(cast(territory_id as 
    string
), '') || '-' || coalesce(cast(CountryRegions.countryRegion_id as 
    string
), '') as 
    string
))) as territory_sk --hashed surrogate key
            /* Natural Key */
            ,territory_id
            /* Foreing Key */
            ,CountryRegions.countryRegion_id
            /* Columms */
            ,territoryName
            ,territoryGroup
            ,costYtd
            ,salesYtd
            ,costLastYear
            ,salesLastYear
            ,rowguid
            ,countryName
        from SalesTerritories

        left join CountryRegions on SalesTerritories.countryRegion_id=CountryRegions.countryRegion_id
    )

select * from final;


02:20:05.448173 [debug] [Thread-1  ]: finished collecting timing info
02:20:05.449174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c5bf65-a242-4cc0-9215-5d7d1a52c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133B6FD0>]}
02:20:05.450174 [info ] [Thread-1  ]: 1 of 1 OK created view model AdventureWorks_marts.dim_SalesTerritories.......... [[32mOK[0m in 1.35s]
02:20:05.452175 [debug] [Thread-1  ]: Finished running node model.dbt_IA_AdventureWorks.dim_SalesTerritories
02:20:05.454175 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:05.455174 [info ] [MainThread]: 
02:20:05.457174 [info ] [MainThread]: Finished running 1 view model in 2.54s.
02:20:05.458173 [debug] [MainThread]: Connection 'master' was properly closed.
02:20:05.459172 [debug] [MainThread]: Connection 'list_snappy-meridian-350123' was properly closed.
02:20:05.459172 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:20:05.460174 [debug] [MainThread]: Connection 'model.dbt_IA_AdventureWorks.dim_SalesTerritories' was properly closed.
02:20:05.487172 [info ] [MainThread]: 
02:20:05.488175 [info ] [MainThread]: [32mCompleted successfully[0m
02:20:05.490174 [info ] [MainThread]: 
02:20:05.491172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:20:05.493177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD132E8D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD13211C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD133B6E80>]}


============================== 2022-05-13 02:20:16.288947 | 451f689d-919f-4712-8cac-2609f9eac89f ==============================
02:20:16.288947 [info ] [MainThread]: Running with dbt=1.0.4
02:20:16.289946 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='C:\\Users\\jpedr\\.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['dim_SalesTerritories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
02:20:16.290949 [debug] [MainThread]: Tracking: tracking
02:20:16.304947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A83460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A83BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12A830A0>]}
02:20:16.422947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:20:16.422947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:20:16.431946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '451f689d-919f-4712-8cac-2609f9eac89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12CE40D0>]}
02:20:16.446949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '451f689d-919f-4712-8cac-2609f9eac89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12C04730>]}
02:20:16.447953 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:20:16.450946 [info ] [MainThread]: 
02:20:16.451948 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:16.454949 [debug] [ThreadPool]: Acquiring new bigquery connection "list_snappy-meridian-350123_AdventureWorks_marts"
02:20:16.454949 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:20:17.010947 [info ] [MainThread]: Concurrency: 2 threads (target='second_bq')
02:20:17.011949 [info ] [MainThread]: 
02:20:17.019948 [debug] [Thread-1  ]: Began running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.019948 [debug] [Thread-2  ]: Began running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.020952 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_SalesTerritories_territory_sk.................... [RUN]
02:20:17.020952 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_SalesTerritories_territory_sk...................... [RUN]
02:20:17.022949 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.024965 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.024965 [debug] [Thread-1  ]: Began compiling node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.025948 [debug] [Thread-2  ]: Began compiling node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.025948 [debug] [Thread-1  ]: Compiling test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.026947 [debug] [Thread-2  ]: Compiling test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.041947 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.049951 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.050948 [debug] [Thread-1  ]: finished collecting timing info
02:20:17.051949 [debug] [Thread-2  ]: finished collecting timing info
02:20:17.051949 [debug] [Thread-1  ]: Began executing node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:17.052949 [debug] [Thread-2  ]: Began executing node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:17.080947 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"
02:20:17.084949 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"
02:20:17.086951 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:20:17.087948 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:20:17.092946 [debug] [Thread-1  ]: On test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
where territory_sk is null



      
    ) dbt_internal_test
02:20:17.092946 [debug] [Thread-2  ]: On test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "dbt_IA_AdventureWorks", "target_name": "second_bq", "node_id": "test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select territory_sk as unique_field
  from `snappy-meridian-350123`.`AdventureWorks_marts`.`dim_SalesTerritories`
  where territory_sk is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:20:19.158057 [debug] [Thread-1  ]: finished collecting timing info
02:20:19.159055 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_SalesTerritories_territory_sk.......................... [[32mPASS[0m in 2.14s]
02:20:19.161057 [debug] [Thread-1  ]: Finished running node test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c
02:20:19.314058 [debug] [Thread-2  ]: finished collecting timing info
02:20:19.315072 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_SalesTerritories_territory_sk............................ [[32mPASS[0m in 2.29s]
02:20:19.316059 [debug] [Thread-2  ]: Finished running node test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e
02:20:19.318074 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:20:19.319057 [info ] [MainThread]: 
02:20:19.320066 [info ] [MainThread]: Finished running 2 tests in 2.87s.
02:20:19.321059 [debug] [MainThread]: Connection 'master' was properly closed.
02:20:19.322058 [debug] [MainThread]: Connection 'list_snappy-meridian-350123_AdventureWorks_marts' was properly closed.
02:20:19.322058 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.not_null_dim_SalesTerritories_territory_sk.fb977a903c' was properly closed.
02:20:19.323057 [debug] [MainThread]: Connection 'test.dbt_IA_AdventureWorks.unique_dim_SalesTerritories_territory_sk.961d7da74e' was properly closed.
02:20:19.341057 [info ] [MainThread]: 
02:20:19.342057 [info ] [MainThread]: [32mCompleted successfully[0m
02:20:19.344081 [info ] [MainThread]: 
02:20:19.345058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:20:19.347058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12BF0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12BF0DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E12D7BE80>]}
